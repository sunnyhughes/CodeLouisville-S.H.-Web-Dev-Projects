var Yw=Object.defineProperty;var u=(dc,Fa)=>Yw(dc,"name",{value:Fa,configurable:!0});(()=>{var dc={179:(be,J,f)=>{be=f.nmd(be);var sn=200,wn="__lodash_hash_undefined__",Xt=1,Bt=2,Yt=9007199254740991,yn="[object Arguments]",nt="[object Array]",mt="[object AsyncFunction]",Hn="[object Boolean]",Pe="[object Date]",xe="[object Error]",N="[object Function]",ut="[object GeneratorFunction]",vt="[object Map]",Je="[object Number]",Ma="[object Null]",xt="[object Object]",Dr="[object Promise]",Di="[object Proxy]",Tr="[object RegExp]",Ar="[object Set]",se="[object String]",$t="[object Symbol]",me="[object Undefined]",Ti="[object WeakMap]",ko="[object ArrayBuffer]",or="[object DataView]",bn="[object Float32Array]",Na="[object Float64Array]",R="[object Int8Array]",ze="[object Int16Array]",Fe="[object Int32Array]",Jr="[object Uint8Array]",ar="[object Uint8ClampedArray]",ke="[object Uint16Array]",La="[object Uint32Array]",Ua=/[\\^$.*+?()[\]{}|]/g,je=/^\[object .+?Constructor\]$/,Ze=/^(?:0|[1-9]\d*)$/,We={};We[bn]=We[Na]=We[R]=We[ze]=We[Fe]=We[Jr]=We[ar]=We[ke]=We[La]=!0,We[yn]=We[nt]=We[ko]=We[Hn]=We[or]=We[Pe]=We[xe]=We[N]=We[vt]=We[Je]=We[xt]=We[Tr]=We[Ar]=We[se]=We[Ti]=!1;var Pr=typeof f.g=="object"&&f.g&&f.g.Object===Object&&f.g,ge=typeof self=="object"&&self&&self.Object===Object&&self,ve=Pr||ge||Function("return this")(),Ai=J&&!J.nodeType&&J,Fr=Ai&&!0&&be&&!be.nodeType&&be,fc=Fr&&Fr.exports===Ai,Ro=fc&&Pr.process,Oa=function(){try{return Ro&&Ro.binding&&Ro.binding("util")}catch(b){}}(),Pi=Oa&&Oa.isTypedArray;function Ha(b,C){for(var M=-1,Z=b==null?0:b.length,Ee=0,Q=[];++M<Z;){var Ne=b[M];C(Ne,M,b)&&(Q[Ee++]=Ne)}return Q}u(Ha,"arrayFilter");function Do(b,C){for(var M=-1,Z=C.length,Ee=b.length;++M<Z;)b[Ee+M]=C[M];return b}u(Do,"arrayPush");function ce(b,C){for(var M=-1,Z=b==null?0:b.length;++M<Z;)if(C(b[M],M,b))return!0;return!1}u(ce,"arraySome");function At(b,C){for(var M=-1,Z=Array(b);++M<b;)Z[M]=C(M);return Z}u(At,"baseTimes");function rt(b){return function(C){return b(C)}}u(rt,"baseUnary");function Wa(b,C){return b.has(C)}u(Wa,"cacheHas");function Fi(b,C){return b==null?void 0:b[C]}u(Fi,"getValue");function sr(b){var C=-1,M=Array(b.size);return b.forEach(function(Z,Ee){M[++C]=[Ee,Z]}),M}u(sr,"mapToArray");function U(b,C){return function(M){return b(C(M))}}u(U,"overArg");function gc(b){var C=-1,M=Array(b.size);return b.forEach(function(Z){M[++C]=Z}),M}u(gc,"setToArray");var pc=Array.prototype,Zr=Function.prototype,ei=Object.prototype,ti=ve["__core-js_shared__"],To=Zr.toString,Jt=ei.hasOwnProperty,Ao=function(){var b=/[^.]+$/.exec(ti&&ti.keys&&ti.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),mc=ei.toString,vc=RegExp("^"+To.call(Jt).replace(Ua,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wc=fc?ve.Buffer:void 0,Mi=ve.Symbol,Sn=ve.Uint8Array,Ni=ei.propertyIsEnumerable,yc=pc.splice,cr=Mi?Mi.toStringTag:void 0,lr=Object.getOwnPropertySymbols,Ba=wc?wc.isBuffer:void 0,Mr=U(Object.keys,Object),Wn=wt(ve,"DataView"),Cn=wt(ve,"Map"),Li=wt(ve,"Promise"),Ui=wt(ve,"Set"),Po=wt(ve,"WeakMap"),ni=wt(Object,"create"),$a=In(Wn),cn=In(Cn),L=In(Li),bc=In(Ui),Fo=In(Po),Mo=Mi?Mi.prototype:void 0,No=Mo?Mo.valueOf:void 0;function Vt(b){var C=-1,M=b==null?0:b.length;for(this.clear();++C<M;){var Z=b[C];this.set(Z[0],Z[1])}}u(Vt,"Hash");function ln(){this.__data__=ni?ni(null):{},this.size=0}u(ln,"hashClear");function _n(b){var C=this.has(b)&&delete this.__data__[b];return this.size-=C?1:0,C}u(_n,"hashDelete");function Pt(b){var C=this.__data__;if(ni){var M=C[b];return M===wn?void 0:M}return Jt.call(C,b)?C[b]:void 0}u(Pt,"hashGet");function Oi(b){var C=this.__data__;return ni?C[b]!==void 0:Jt.call(C,b)}u(Oi,"hashHas");function xn(b,C){var M=this.__data__;return this.size+=this.has(b)?0:1,M[b]=ni&&C===void 0?wn:C,this}u(xn,"hashSet"),Vt.prototype.clear=ln,Vt.prototype.delete=_n,Vt.prototype.get=Pt,Vt.prototype.has=Oi,Vt.prototype.set=xn;function qt(b){var C=-1,M=b==null?0:b.length;for(this.clear();++C<M;){var Z=b[C];this.set(Z[0],Z[1])}}u(qt,"ListCache");function Hi(){this.__data__=[],this.size=0}u(Hi,"listCacheClear");function Va(b){var C=this.__data__,M=un(C,b);if(M<0)return!1;var Z=C.length-1;return M==Z?C.pop():yc.call(C,M,1),--this.size,!0}u(Va,"listCacheDelete");function qa(b){var C=this.__data__,M=un(C,b);return M<0?void 0:C[M][1]}u(qa,"listCacheGet");function ri(b){return un(this.__data__,b)>-1}u(ri,"listCacheHas");function Lo(b,C){var M=this.__data__,Z=un(M,b);return Z<0?(++this.size,M.push([b,C])):M[Z][1]=C,this}u(Lo,"listCacheSet"),qt.prototype.clear=Hi,qt.prototype.delete=Va,qt.prototype.get=qa,qt.prototype.has=ri,qt.prototype.set=Lo;function zt(b){var C=-1,M=b==null?0:b.length;for(this.clear();++C<M;){var Z=b[C];this.set(Z[0],Z[1])}}u(zt,"MapCache");function Uo(){this.size=0,this.__data__={hash:new Vt,map:new(Cn||qt),string:new Vt}}u(Uo,"mapCacheClear");function Wi(b){var C=$n(this,b).delete(b);return this.size-=C?1:0,C}u(Wi,"mapCacheDelete");function za(b){return $n(this,b).get(b)}u(za,"mapCacheGet");function De(b){return $n(this,b).has(b)}u(De,"mapCacheHas");function Sc(b,C){var M=$n(this,b),Z=M.size;return M.set(b,C),this.size+=M.size==Z?0:1,this}u(Sc,"mapCacheSet"),zt.prototype.clear=Uo,zt.prototype.delete=Wi,zt.prototype.get=za,zt.prototype.has=De,zt.prototype.set=Sc;function Bi(b){var C=-1,M=b==null?0:b.length;for(this.__data__=new zt;++C<M;)this.add(b[C])}u(Bi,"SetCache");function ja(b){return this.__data__.set(b,wn),this}u(ja,"setCacheAdd");function Nr(b){return this.__data__.has(b)}u(Nr,"setCacheHas"),Bi.prototype.add=Bi.prototype.push=ja,Bi.prototype.has=Nr;function Zt(b){var C=this.__data__=new qt(b);this.size=C.size}u(Zt,"Stack");function Cc(){this.__data__=new qt,this.size=0}u(Cc,"stackClear");function _c(b){var C=this.__data__,M=C.delete(b);return this.size=C.size,M}u(_c,"stackDelete");function Me(b){return this.__data__.get(b)}u(Me,"stackGet");function Bn(b){return this.__data__.has(b)}u(Bn,"stackHas");function Ga(b,C){var M=this.__data__;if(M instanceof qt){var Z=M.__data__;if(!Cn||Z.length<sn-1)return Z.push([b,C]),this.size=++M.size,this;M=this.__data__=new zt(Z)}return M.set(b,C),this.size=M.size,this}u(Ga,"stackSet"),Zt.prototype.clear=Cc,Zt.prototype.delete=_c,Zt.prototype.get=Me,Zt.prototype.has=Bn,Zt.prototype.set=Ga;function Oo(b,C){var M=Ur(b),Z=!M&&zi(b),Ee=!M&&!Z&&Vn(b),Q=!M&&!Z&&!Ee&&W(b),Ne=M||Z||Ee||Q,tt=Ne?At(b.length,String):[],dt=tt.length;for(var pe in b)(C||Jt.call(b,pe))&&!(Ne&&(pe=="length"||Ee&&(pe=="offset"||pe=="parent")||Q&&(pe=="buffer"||pe=="byteLength"||pe=="byteOffset")||dr(pe,dt)))&&tt.push(pe);return tt}u(Oo,"arrayLikeKeys");function un(b,C){for(var M=b.length;M--;)if($o(b[M][0],C))return M;return-1}u(un,"assocIndexOf");function $i(b,C,M){var Z=C(b);return Ur(b)?Z:Do(Z,M(b))}u($i,"baseGetAllKeys");function ur(b){return b==null?b===void 0?me:Ma:cr&&cr in Object(b)?oi(b):Bo(b)}u(ur,"baseGetTag");function ii(b){return V(b)&&ur(b)==yn}u(ii,"baseIsArguments");function Ka(b,C,M,Z,Ee){return b===C?!0:b==null||C==null||!V(b)&&!V(C)?b!==b&&C!==C:Ho(b,C,M,Z,Ka,Ee)}u(Ka,"baseIsEqual");function Ho(b,C,M,Z,Ee,Q){var Ne=Ur(b),tt=Ur(C),dt=Ne?nt:en(b),pe=tt?nt:en(C);dt=dt==yn?xt:dt,pe=pe==yn?xt:pe;var Ft=dt==xt,Le=pe==xt,it=dt==pe;if(it&&Vn(b)){if(!Vn(C))return!1;Ne=!0,Ft=!1}if(it&&!Ft)return Q||(Q=new Zt),Ne||W(b)?Qa(b,C,M,Z,Ee,Q):kc(b,C,dt,M,Z,Ee,Q);if(!(M&Xt)){var Qe=Ft&&Jt.call(b,"__wrapped__"),yt=Le&&Jt.call(C,"__wrapped__");if(Qe||yt){var le=Qe?b.value():b,tn=yt?C.value():C;return Q||(Q=new Zt),Ee(le,tn,M,Z,Q)}}return it?(Q||(Q=new Zt),Wo(b,C,M,Z,Ee,Q)):!1}u(Ho,"baseIsEqualDeep");function xc(b){if(!et(b)||qi(b))return!1;var C=qo(b)?vc:je;return C.test(In(b))}u(xc,"baseIsNative");function Ic(b){return V(b)&&Ge(b.length)&&!!We[ur(b)]}u(Ic,"baseIsTypedArray");function Ec(b){if(!Lr(b))return Mr(b);var C=[];for(var M in Object(b))Jt.call(b,M)&&M!="constructor"&&C.push(M);return C}u(Ec,"baseKeys");function Qa(b,C,M,Z,Ee,Q){var Ne=M&Xt,tt=b.length,dt=C.length;if(tt!=dt&&!(Ne&&dt>tt))return!1;var pe=Q.get(b);if(pe&&Q.get(C))return pe==C;var Ft=-1,Le=!0,it=M&Bt?new Bi:void 0;for(Q.set(b,C),Q.set(C,b);++Ft<tt;){var Qe=b[Ft],yt=C[Ft];if(Z)var le=Ne?Z(yt,Qe,Ft,C,b,Q):Z(Qe,yt,Ft,b,C,Q);if(le!==void 0){if(le)continue;Le=!1;break}if(it){if(!ce(C,function(tn,En){if(!Wa(it,En)&&(Qe===tn||Ee(Qe,tn,M,Z,Q)))return it.push(En)})){Le=!1;break}}else if(!(Qe===yt||Ee(Qe,yt,M,Z,Q))){Le=!1;break}}return Q.delete(b),Q.delete(C),Le}u(Qa,"equalArrays");function kc(b,C,M,Z,Ee,Q,Ne){switch(M){case or:if(b.byteLength!=C.byteLength||b.byteOffset!=C.byteOffset)return!1;b=b.buffer,C=C.buffer;case ko:return!(b.byteLength!=C.byteLength||!Q(new Sn(b),new Sn(C)));case Hn:case Pe:case Je:return $o(+b,+C);case xe:return b.name==C.name&&b.message==C.message;case Tr:case se:return b==C+"";case vt:var tt=sr;case Ar:var dt=Z&Xt;if(tt||(tt=gc),b.size!=C.size&&!dt)return!1;var pe=Ne.get(b);if(pe)return pe==C;Z|=Bt,Ne.set(b,C);var Ft=Qa(tt(b),tt(C),Z,Ee,Q,Ne);return Ne.delete(b),Ft;case $t:if(No)return No.call(b)==No.call(C)}return!1}u(kc,"equalByTag");function Wo(b,C,M,Z,Ee,Q){var Ne=M&Xt,tt=Vi(b),dt=tt.length,pe=Vi(C),Ft=pe.length;if(dt!=Ft&&!Ne)return!1;for(var Le=dt;Le--;){var it=tt[Le];if(!(Ne?it in C:Jt.call(C,it)))return!1}var Qe=Q.get(b);if(Qe&&Q.get(C))return Qe==C;var yt=!0;Q.set(b,C),Q.set(C,b);for(var le=Ne;++Le<dt;){it=tt[Le];var tn=b[it],En=C[it];if(Z)var kn=Ne?Z(En,tn,it,C,b,Q):Z(tn,En,it,b,C,Q);if(!(kn===void 0?tn===En||Ee(tn,En,M,Z,Q):kn)){yt=!1;break}le||(le=it=="constructor")}if(yt&&!le){var fe=b.constructor,qn=C.constructor;fe!=qn&&"constructor"in b&&"constructor"in C&&!(typeof fe=="function"&&fe instanceof fe&&typeof qn=="function"&&qn instanceof qn)&&(yt=!1)}return Q.delete(b),Q.delete(C),yt}u(Wo,"equalObjects");function Vi(b){return $i(b,ji,ai)}u(Vi,"getAllKeys");function $n(b,C){var M=b.__data__;return Xa(C)?M[typeof C=="string"?"string":"hash"]:M.map}u($n,"getMapData");function wt(b,C){var M=Fi(b,C);return xc(M)?M:void 0}u(wt,"getNative");function oi(b){var C=Jt.call(b,cr),M=b[cr];try{b[cr]=void 0;var Z=!0}catch(Q){}var Ee=mc.call(b);return Z&&(C?b[cr]=M:delete b[cr]),Ee}u(oi,"getRawTag");var ai=lr?function(b){return b==null?[]:(b=Object(b),Ha(lr(b),function(C){return Ni.call(b,C)}))}:zo,en=ur;(Wn&&en(new Wn(new ArrayBuffer(1)))!=or||Cn&&en(new Cn)!=vt||Li&&en(Li.resolve())!=Dr||Ui&&en(new Ui)!=Ar||Po&&en(new Po)!=Ti)&&(en=u(function(b){var C=ur(b),M=C==xt?b.constructor:void 0,Z=M?In(M):"";if(Z)switch(Z){case $a:return or;case cn:return vt;case L:return Dr;case bc:return Ar;case Fo:return Ti}return C},"getTag"));function dr(b,C){return C=C==null?Yt:C,!!C&&(typeof b=="number"||Ze.test(b))&&b>-1&&b%1==0&&b<C}u(dr,"isIndex");function Xa(b){var C=typeof b;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?b!=="__proto__":b===null}u(Xa,"isKeyable");function qi(b){return!!Ao&&Ao in b}u(qi,"isMasked");function Lr(b){var C=b&&b.constructor,M=typeof C=="function"&&C.prototype||ei;return b===M}u(Lr,"isPrototype");function Bo(b){return mc.call(b)}u(Bo,"objectToString");function In(b){if(b!=null){try{return To.call(b)}catch(C){}try{return b+""}catch(C){}}return""}u(In,"toSource");function $o(b,C){return b===C||b!==b&&C!==C}u($o,"eq");var zi=ii(function(){return arguments}())?ii:function(b){return V(b)&&Jt.call(b,"callee")&&!Ni.call(b,"callee")},Ur=Array.isArray;function si(b){return b!=null&&Ge(b.length)&&!qo(b)}u(si,"isArrayLike");var Vn=Ba||Rc;function Vo(b,C){return Ka(b,C)}u(Vo,"isEqual");function qo(b){if(!et(b))return!1;var C=ur(b);return C==N||C==ut||C==mt||C==Di}u(qo,"isFunction");function Ge(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=Yt}u(Ge,"isLength");function et(b){var C=typeof b;return b!=null&&(C=="object"||C=="function")}u(et,"isObject");function V(b){return b!=null&&typeof b=="object"}u(V,"isObjectLike");var W=Pi?rt(Pi):Ic;function ji(b){return si(b)?Oo(b):Ec(b)}u(ji,"keys");function zo(){return[]}u(zo,"stubArray");function Rc(){return!1}u(Rc,"stubFalse"),be.exports=Vo},724:()=>{},189:function(be,J,f){"use strict";var sn=this&&this.__spreadArray||function(nt,mt,Hn){if(Hn||arguments.length===2)for(var Pe=0,xe=mt.length,N;Pe<xe;Pe++)(N||!(Pe in mt))&&(N||(N=Array.prototype.slice.call(mt,0,Pe)),N[Pe]=mt[Pe]);return nt.concat(N||Array.prototype.slice.call(mt))};Object.defineProperty(J,"__esModule",{value:!0}),J.config=J.loadMessageBundle=J.BundleFormat=J.MessageFormat=void 0;var wn=f(926),Xt=f(800),Bt=f(800);Object.defineProperty(J,"MessageFormat",{enumerable:!0,get:function(){return Bt.MessageFormat}}),Object.defineProperty(J,"BundleFormat",{enumerable:!0,get:function(){return Bt.BundleFormat}});function Yt(nt){return function(mt,Hn){for(var Pe=[],xe=2;xe<arguments.length;xe++)Pe[xe-2]=arguments[xe];if(typeof mt=="number")throw new Error("Browser implementation does currently not support externalized strings.");return Xt.localize.apply(void 0,sn([mt,Hn],Pe,!1))}}u(Yt,"loadMessageBundle"),J.loadMessageBundle=Yt;function yn(nt){var mt;return(0,Xt.setPseudo)(((mt=nt==null?void 0:nt.locale)===null||mt===void 0?void 0:mt.toLowerCase())==="pseudo"),Yt}u(yn,"config"),J.config=yn,wn.default.install(Object.freeze({loadMessageBundle:Yt,config:yn}))},800:(be,J,f)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.config=J.loadMessageBundle=J.localize=J.format=J.setPseudo=J.isPseudo=J.isDefined=J.BundleFormat=J.MessageFormat=void 0;var sn=f(926),wn;(function(xe){xe.file="file",xe.bundle="bundle",xe.both="both"})(wn=J.MessageFormat||(J.MessageFormat={}));var Xt;(function(xe){xe.standalone="standalone",xe.languagePack="languagePack"})(Xt=J.BundleFormat||(J.BundleFormat={}));var Bt;(function(xe){function N(ut){var vt=ut;return vt&&Yt(vt.key)&&Yt(vt.comment)}u(N,"is"),xe.is=N})(Bt||(Bt={}));function Yt(xe){return typeof xe!="undefined"}u(Yt,"isDefined"),J.isDefined=Yt,J.isPseudo=!1;function yn(xe){J.isPseudo=xe}u(yn,"setPseudo"),J.setPseudo=yn;function nt(xe,N){var ut;return J.isPseudo&&(xe="\uFF3B"+xe.replace(/[aouei]/g,"$&$&")+"\uFF3D"),N.length===0?ut=xe:ut=xe.replace(/\{(\d+)\}/g,function(vt,Je){var Ma=Je[0],xt=N[Ma],Dr=vt;return typeof xt=="string"?Dr=xt:(typeof xt=="number"||typeof xt=="boolean"||xt===void 0||xt===null)&&(Dr=String(xt)),Dr}),ut}u(nt,"format"),J.format=nt;function mt(xe,N){for(var ut=[],vt=2;vt<arguments.length;vt++)ut[vt-2]=arguments[vt];return nt(N,ut)}u(mt,"localize"),J.localize=mt;function Hn(xe){return(0,sn.default)().loadMessageBundle(xe)}u(Hn,"loadMessageBundle"),J.loadMessageBundle=Hn;function Pe(xe){return(0,sn.default)().config(xe)}u(Pe,"config"),J.config=Pe},926:(be,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var f;function sn(){if(f===void 0)throw new Error("No runtime abstraction layer installed");return f}u(sn,"RAL"),function(wn){function Xt(Bt){if(Bt===void 0)throw new Error("No runtime abstraction layer provided");f=Bt}u(Xt,"install"),wn.install=Xt}(sn||(sn={})),J.default=sn}},Fa={};function Ye(be){var J=Fa[be];if(J!==void 0)return J.exports;var f=Fa[be]={id:be,loaded:!1,exports:{}};return dc[be].call(f.exports,f,f.exports,Ye),f.loaded=!0,f.exports}u(Ye,"__webpack_require__"),(()=>{Ye.n=be=>{var J=be&&be.__esModule?()=>be.default:()=>be;return Ye.d(J,{a:J}),J}})(),(()=>{Ye.d=(be,J)=>{for(var f in J)Ye.o(J,f)&&!Ye.o(be,f)&&Object.defineProperty(be,f,{enumerable:!0,get:J[f]})}})(),(()=>{Ye.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(be){if(typeof window=="object")return window}}()})(),(()=>{Ye.o=(be,J)=>Object.prototype.hasOwnProperty.call(be,J)})(),(()=>{Ye.r=be=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(be,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(be,"__esModule",{value:!0})}})(),(()=>{Ye.nmd=be=>(be.paths=[],be.children||(be.children=[]),be)})();var hc={};(()=>{"use strict";Ye.r(hc),Ye.d(hc,{StateKeys:()=>Ri,activate:()=>jw,ensureProvidersRegistered:()=>Wt,getOpenActionsService:()=>cc,getState:()=>pp,isPreRelease:()=>zw,updateState:()=>zu});var be={};Ye.r(be),Ye.d(be,{max:()=>bw,min:()=>yw});var J=Ye(189);J.config({messageFormat:J.MessageFormat.bundle,bundleFormat:J.BundleFormat.standalone});const f=require("vscode"),sn=new TextDecoder,wn=new TextEncoder,Xt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Bt(t){const e=wn.encode(t),n=new Array(e.length);for(let r=0;r<e.length;++r)n[r]=Xt[e[r]];return n.join("")}u(Bt,"encodeUtf8Hex");function Yt(t){const e=t.match(/(\w{2})/g);if(e===null)return"";const n=new Uint8Array(e.map(r=>parseInt(r,16)));return sn.decode(n)}u(Yt,"decodeUtf8Hex");const yn=/^[0-9a-f]{40}$/i;function nt(t){return t!==void 0&&yn.test(t)}u(nt,"isSha");const mt=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function Hn(t){return mt.test(t)}u(Hn,"isValidBranchName");function Pe(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}u(Pe,"shortenRef");const xe=47;function N(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}u(N,"asKey");function ut(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}u(ut,"asFileKey");function vt(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}u(vt,"asFileStorageKey");function Je(t){const e=t.path;let n=0,r=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===xe){if(!i){n=o+1;break}}else r===-1&&(i=!1,r=o+1);return r===-1?"":e.slice(n,r)}u(Je,"basename");function Ma(t){const e=t.path;if(e.length===1)return"/";let n,r=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(n=e.charCodeAt(o),n===xe){if(!i){r=o;break}}else i=!1;return r===-1?"/":e.slice(0,r)}u(Ma,"dirname");function xt(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}u(xt,"getParent");function Dr(t,e){const n=typeof e=="string"?e:e.path;return n.startsWith(t.path)?f.Uri.joinPath(t,n.substr(t.path.length)):f.Uri.joinPath(t,n)}u(Dr,"joinRelativePath");function Di(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),Tr(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):Tr(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}u(Di,"isChild");function Tr(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}u(Tr,"isDescendent");function Ar(t){return t&&typeof t=="object"&&"scheme"in t}u(Ar,"isSerializedUri");var se;(function(t){t.authoritySeparator="+",t.scheme="vscode-vfs",t.baseVirtualWorkspaceUri=f.Uri.parse(`${t.scheme}://`);function e(l){const{authority:d}=l,h=d.indexOf(t.authoritySeparator);return h!==-1?d.substr(0,h):d}u(e,"getProviderId"),t.getProviderId=e;function n(l){return l.scheme!==t.scheme?l:l.with({scheme:e(l)})}u(n,"getProviderUri"),t.getProviderUri=n;function r(l,d){const h=new Map,g=f.workspace.textDocuments;if(g.length===0)return h;for(const p of g)p.uri.scheme===l&&d.some(y=>Tr(p.uri,y))&&h.set(N(p.uri),p.uri);return h}u(r,"getOpenUris"),t.getOpenUris=r;function i(l){return l.scheme===t.scheme?l:l.with({scheme:t.scheme})}u(i,"getVirtualUri"),t.getVirtualUri=i;function o(l,d){const[h,g]=l.authority.split(t.authoritySeparator);let p;if(g)try{const y=JSON.parse(Yt(g));p=d?d(y):y}catch{}return{scheme:h,metadata:p}}u(o,"decodeAuthority"),t.decodeAuthority=o;function a(l,d){const h=d?`${t.authoritySeparator}${Bt(JSON.stringify(d))}`:"";return`${l}${h}`}u(a,"encodeAuthority"),t.encodeAuthority=a;function s(l){return l.authority.indexOf(t.authoritySeparator)===-1}u(s,"isCanonicalUri"),t.isCanonicalUri=s;function c(){var l,d;return(d=(l=f.workspace.workspaceFolders)==null?void 0:l.every(h=>h.uri.scheme===t.scheme))!=null?d:!1}u(c,"isVirtualWorkspace"),t.isVirtualWorkspace=c})(se||(se={}));var $t;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})($t||($t={}));var me;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(me||(me={}));var Ti;(function(t){function e(n){return n!==void 0&&n.type===bn.Active}u(e,"isActive"),t.isActive=e})(Ti||(Ti={}));var ko;(function(t){function e(n){const r=se.decodeAuthority(n).metadata;if(!(r===void 0||r.idx===void 0)){if(r.idx==="latest")return{type:or.Latest};if(nt(r.idx))return{type:or.SHA,sha:r.idx}}}u(e,"decode"),t.decode=e})(ko||(ko={}));var or;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(or||(or={}));var bn;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(bn||(bn={})),function(t){function e(n){return n!==void 0&&(n===t.Indexed||n===t.Match||n===t.Active)}u(e,"hasIndex"),t.hasIndex=e}(bn||(bn={}));var Na;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(Na||(Na={}));var R;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(R||(R={}));var ze;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})(ze||(ze={}));var Fe;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(Fe||(Fe={}));var Jr;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(Jr||(Jr={}));var ar;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File",t[t.Tag=5]="Tag"})(ar||(ar={}));var ke;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(ke||(ke={}));var La;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(La||(La={}));var Ua;(function(t){t.Browse="browse",t.Edit="edit"})(Ua||(Ua={}));var je;(function(t){t.CommitFailedError="CommitFailedError",t.DetachedHEADError="DetachedHEADError",t.InvalidBranchNameError="InvalidBranchNameError",t.InvalidCredentialsError="InvalidCredentialsError",t.MergeConflictError="MergeConflictError",t.NothingToCommitError="NothingToCommitError",t.SyncConflictsError="SyncConflictsError",t.SyncOrFetchError="SyncOrFetchError",t.UnresolvedConflictsError="UnresolvedConflictsError",t.Unknown="Unknown"})(je||(je={}));class Ze extends Error{constructor(e,n,r){super(typeof e=="string"?e:e.message);this.messageOrError=e,this.errorCode=n,this.action=r}static CommitFailedError(){return new Ze("Failed to create and push commit",je.CommitFailedError)}static DetachedHEADError(e){return new Ze(e,je.DetachedHEADError)}static InvalidBranchNameError(e,n=!1){const r=n?`Branch '${e}' already exists`:`Invalid branch name '${e}'`;return new Ze(r,je.InvalidBranchNameError)}static InvalidCredentialsError(e,n){return new Ze(e,je.InvalidCredentialsError,n)}static MergeConflictError(e){return new Ze(e,je.MergeConflictError)}static NothingToCommitError(e){return new Ze(e,je.NothingToCommitError)}static SyncOrFetchError(e=!1){const n=e?"Unable to sync the repository":"Unable to fetch the repository";return new Ze(n,je.SyncOrFetchError)}static SyncConflictsError(){const e="Sync operation will result in conflicts";return new Ze(e,je.SyncConflictsError)}static UnresolvedConflictsError(){return new Ze("You have unresolved merge conflicts.",je.UnresolvedConflictsError)}static asVirtualProviderErrorCode(e){return e instanceof Error&&"messageOrError"in e&&"errorCode"in e?e.errorCode:je.Unknown}}u(Ze,"VirtualProviderError");const We=6;var Pr;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(Pr||(Pr={}));var ge;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(ge||(ge={})),function(t){function e(n){return n===t.None||n===t.Latest||n===t.Match||n===t.TipPlusLatest?n:t.None}u(e,"sanitize"),t.sanitize=e}(ge||(ge={}));var ve;(function(t){t.Browse="browse",t.Edit="edit"})(ve||(ve={})),function(t){function e(r){return r===t.Browse||r===t.Edit?r:t.Edit}u(e,"sanitize"),t.sanitize=e;function n(r){return r===t.Browse?t.Edit:t.Browse}u(n,"toggle"),t.toggle=n}(ve||(ve={}));var Ai;(function(t){function e(n,r){return n.display===r.display&&n.index===r.index}u(e,"equals"),t.equals=e})(Ai||(Ai={}));var Fr;(function(t){const e=new Map([[ke.Branch,ge.None],[ke.RemoteBranch,ge.None],[ke.PullRequestBranch,ge.Match],[ke.PullRequestRemoteBranch,ge.Match],[ke.Commit,ge.Match],[ke.Tag,ge.Match]]),n=new Map([[ke.Branch,ve.Edit],[ke.RemoteBranch,ve.Edit],[ke.PullRequestBranch,ve.Browse],[ke.PullRequestRemoteBranch,ve.Browse],[ke.Commit,ve.Browse],[ke.Tag,ve.Browse]]);function r(o){var a,s;return{display:(a=n.get(o))!=null?a:ve.Edit,index:(s=e.get(o))!=null?s:ge.None}}u(r,"getDefault"),t.getDefault=r;function i(o){switch(o){case ke.Branch:case ke.RemoteBranch:return{display:ve.Browse,index:ge.Latest};case ke.PullRequestBranch:case ke.PullRequestRemoteBranch:return{display:ve.Browse,index:ge.Match};case ke.Commit:case ke.Tag:return{display:ve.Browse,index:ge.Match};default:return{display:ve.Edit,index:ge.None}}}u(i,"getIndexDefault"),t.getIndexDefault=i})(Fr||(Fr={}));const fc=null;var Ro=Ye(179),Oa=Ye.n(Ro);const Pi="modes",Ha="indexMemento";class Do{constructor(){this._onDidChange=new f.EventEmitter,this._onDidChangeAny=new f.EventEmitter,this.memoryState=new Map}static configure(e,n){ce.configPrefix=e,ce.state=n.workspaceState,n.subscriptions.push(f.workspace.onDidChangeConfiguration(ce.onConfigurationChanged,ce))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(this.configPrefix)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(Pi),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const n of this.memoryState.entries())this.modes[n[0]]=n[1];this._state.update(Pi,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(Ha),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,n,r){return r===void 0?f.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,n).get(e===void 0?this.configPrefix:e):f.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,n).get(e===void 0?this.configPrefix:e,r)}getMode(e,n,r){var i;const o=e.toString();let a=this.modes!==void 0?this.modes[o]:void 0;if(a!==void 0)return{display:ve.sanitize(a.display),index:ge.sanitize(a.index)};if(a=this.memoryState.get(o),a!==void 0)return a;if(n===ke.Branch||n===ke.RemoteBranch)switch((i=f.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:ve.Edit,index:ge.None};case"latest":return{display:ve.Browse,index:ge.Latest};case"tipPlusLatest":return{display:ve.Edit,index:ge.TipPlusLatest}}if(!r)return Fr.getDefault(n)}setMode(e,n){const r=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(r,n),Promise.resolve()):(this.modes[r]=n,this._state.update(Pi,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,n){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=n,this._state.update(Ha,this.indexMemento))}getAny(e,n,r){return r===void 0?f.workspace.getConfiguration(void 0,n).get(e):f.workspace.getConfiguration(void 0,n).get(e,r)}changed(e,n,r){var i;return(i=e==null?void 0:e.affectsConfiguration(`${this.configPrefix}.${n}`,r))!=null?i:!0}inspect(e,n){return f.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,n).inspect(e===void 0?this.configPrefix:e)}inspectAny(e,n){return f.workspace.getConfiguration(void 0,n).inspect(e)}async migrate(e,n,r){const i=ce.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(n,r.migrationFn!=null?r.migrationFn(i.globalValue):i.globalValue,f.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceValue):i.workspaceValue,f.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,f.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&r.fallbackValue!==void 0&&(await this.update(n,r.fallbackValue,f.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,n,r){const i=ce.inspect(e);if(i===void 0)return;const o=ce.inspect(n);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(n,r.migrationFn!=null?r.migrationFn(i.globalValue):i.globalValue,f.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceValue):i.workspaceValue,f.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,f.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,n,r){return f.workspace.getConfiguration(this.configPrefix).update(e,n,r)}updateAny(e,n,r,i){return f.workspace.getConfiguration(void 0,r===f.ConfigurationTarget.Global?void 0:i).update(e,n,r)}updateEffective(e,n){const r=ce.inspect(e);return r.workspaceFolderValue!==void 0?n===r.workspaceFolderValue?Promise.resolve(void 0):ce.update(e,n,f.ConfigurationTarget.WorkspaceFolder):r.workspaceValue!==void 0?n===r.workspaceValue?Promise.resolve(void 0):ce.update(e,n,f.ConfigurationTarget.Workspace):r.globalValue===n||r.globalValue===void 0&&n===r.defaultValue?Promise.resolve(void 0):ce.update(e,Oa()(n,r.defaultValue)?void 0:n,f.ConfigurationTarget.Global)}}u(Do,"Configuration");const ce=new Do,At="";var rt;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(rt||(rt={}));var Wa;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(Wa||(Wa={}));const Fi="[RemoteHub]",sr=u(class{static configure(t,e,n){this._isDebugging=t.extensionMode===f.ExtensionMode.Development,this.outputChannelName=e,this.logLevel=n}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,n;this._logLevel=t,this.level=this.toOrderedLevel(t),t===rt.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(n=this.output)!=null?n:f.window.createOutputChannel(this.outputChannelName)}static toOrderedLevel(t){switch(t){case rt.Off:return 0;case rt.Error:return 1;case rt.Warn:return 2;case rt.Info:return 3;case rt.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){sr.isDebugging&&console.log(this.timestamp,Fi,t!=null?t:At,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:At}${this.toLoggableParams(!0,e)}`)}static error(t,e,...n){if(!(this.level<1&&!sr.isDebugging)){if(e===void 0){const r=t instanceof Error?t.stack:void 0;if(r){const i=/.*\s*?at\s(.+?)\s/.exec(r);i!==null&&(e=i[1])}}sr.isDebugging&&console.error(this.timestamp,Fi,e!=null?e:At,...n,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:At}${this.toLoggableParams(!1,n)}
${String(t)}`)}}static log(t,...e){sr.isDebugging&&console.log(this.timestamp,Fi,t!=null?t:At,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:At}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){sr.isDebugging&&console.warn(this.timestamp,Fi,t!=null?t:At,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:At}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof f.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,n,r;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:At}else i=(r=(n=t.constructor)==null?void 0:n.name)!=null?r:At;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,At)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!sr.isDebugging)return At;const n=e.map(r=>this.toLoggable(r)).join(", ");return n.length!==0?` \u2014 ${n}`:At}},"_Logger");let U=sr;U.level=0,U._logLevel=rt.Off;const gc=new TextDecoder,pc=new TextEncoder;async function Zr(t){const e=typeof t=="string"?pc.encode(t):t;let n;if(globalThis.crypto.subtle)n=await globalThis.crypto.subtle.digest({name:"sha-1"},e);else{const r=new Ao;r.update(e),n=r.digest()}return globalThis.btoa(encodeURIComponent(gc.decode(n)))}u(Zr,"sha1");var ei;(function(t){t[t.BLOCK_SIZE=64]="BLOCK_SIZE"})(ei||(ei={}));function ti(t,e,n=32){const r=n-e,i=~((1<<r)-1);return(t<<e|(i&t)>>>r)>>>0}u(ti,"leftRotate");function To(t,e=0,n=t.byteLength,r=0){for(let i=0;i<n;i++)t[e+i]=r}u(To,"fill");const Jt=u(class{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._finished=!1}update(t){const e=this._buff;let n=this._buffLen,r=0;const i=t.byteLength;for(;r<i;){const o=Math.min(64-n,i-r);for(let a=0;a<o;a++)e[n++]=t[r++];n>=64&&(this._step(),n-=64,this._totalLen+=64)}this._buffLen=n}digest(){this._finished||(this._finished=!0,this._totalLen+=this._buffLen,this._wrapUp());const t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this._h0,!1),e.setUint32(4,this._h1,!1),e.setUint32(8,this._h2,!1),e.setUint32(12,this._h3,!1),e.setUint32(16,this._h4,!1),t}_wrapUp(){this._buff[this._buffLen++]=128,To(this._buff,this._buffLen),this._buffLen>56&&(this._step(),To(this._buff));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=Jt._bigBlock32,e=this._buffDV;for(let d=0;d<64;d+=4)t.setUint32(d,e.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)t.setUint32(d,ti(t.getUint32(d-12,!1)^t.getUint32(d-32,!1)^t.getUint32(d-56,!1)^t.getUint32(d-64,!1),1),!1);let n=this._h0,r=this._h1,i=this._h2,o=this._h3,a=this._h4,s,c,l;for(let d=0;d<80;d++)d<20?(s=r&i|~r&o,c=1518500249):d<40?(s=r^i^o,c=1859775393):d<60?(s=r&i|r&o|i&o,c=2400959708):(s=r^i^o,c=3395469782),l=ti(n,5)+s+a+c+t.getUint32(d*4,!1)&4294967295,a=o,o=i,i=ti(r,30),r=n,n=l;this._h0=this._h0+n&4294967295,this._h1=this._h1+r&4294967295,this._h2=this._h2+i&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}},"_SHA1Computer");let Ao=Jt;Ao._bigBlock32=new DataView(new ArrayBuffer(320));function mc(t){const e=globalThis.atob(t),n=e.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e.charCodeAt(i);return r}u(mc,"fromBase64");const{fromCharCode:vc}=String;function wc(t){let e;if(typeof t=="string")e=t;else{e="";for(let n=0,{length:r}=t;n<r;n++)e+=vc(t[n])}return globalThis.btoa(e)}u(wc,"toBase64");function Mi(t,e){if(t===e)return-1;let n=0;for(;t[n]===e[n];)n++;return n}u(Mi,"indexOfDifference");let Sn;var Ni;(function(t){function e(n){const r=cr(n);return Sn=f.env.uiKind===f.UIKind.Web,U.warn(`Running on the ${Sn?"web":"desktop"}${n.extensionRuntime!==f.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${r}; storageUri=${n.globalStorageUri.toString(!0)}`),r}u(e,"configure"),t.configure=e})(Ni||(Ni={}));const yc=/\/workspaceStorage\/(?<id>[^/]+)/i;function cr(t){var e;if(t.storageUri===void 0)return"";const n=yc.exec(t.storageUri.path);let r;if((e=n==null?void 0:n.groups)==null?void 0:e.id)r=n.groups.id;else{r=t.storageUri.path;const i=Mi(t.globalStorageUri.path,r),o=`/${t.extension.id}`;r.endsWith(o)?r=r.slice(i,-o.length):r=r.substr(i)}return/-[0-9]$/.test(r)?r.slice(0,-2):r}u(cr,"getWorkspaceId");var lr;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasRecentRepositories="remoteHub:hasRecentRepositories",t.HasSearchIndexes="gitHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="gitHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="gitHub:enabledAllSearchIndexes",t.HasPullRequestExtension="gitHub:hasPullRequestExtension"})(lr||(lr={}));const Ba=new Map;function Mr(t){return t==="isWeb"?Sn:t==="remoteName"?f.env.remoteName:t==="virtualWorkspace"?se.isVirtualWorkspace():t.startsWith("config.")?ce.getAny(t.substring(7)):Ba.get(t)}u(Mr,"getContext");function Wn(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}u(Wn,"isSupportedContextKey");async function Cn(t,e){Ba.set(t,e),!t.startsWith("continueOn:")&&await f.commands.executeCommand("setContext",t,e)}u(Cn,"setContext");var Li=Object.defineProperty,Ui=Object.getOwnPropertySymbols,Po=Object.prototype.hasOwnProperty,ni=Object.prototype.propertyIsEnumerable,$a=u((t,e,n)=>e in t?Li(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"go"),cn=u((t,e)=>{for(var n in e||(e={}))Po.call(e,n)&&$a(t,n,e[n]);if(Ui)for(var n of Ui(e))ni.call(e,n)&&$a(t,n,e[n]);return t},"at"),L=u((t,e)=>()=>(t&&(e=t(t=0)),e),"I"),bc=u((t,e)=>{for(var n in e)Li(t,n,{get:e[n],enumerable:!0})},"yc"),Fo=u((t,e,n)=>new Promise((r,i)=>{var o=u(c=>{try{s(n.next(c))}catch(l){i(l)}},"a"),a=u(c=>{try{s(n.throw(c))}catch(l){i(l)}},"o"),s=u(c=>c.done?r(c.value):Promise.resolve(c.value).then(o,a),"u");s((n=n.apply(t,e)).next())}),"Br"),Mo,No=L(()=>{Mo={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}}),Vt,ln,_n,Pt,Oi,xn,qt,Hi,Va,qa,ri,Lo=L(()=>{Vt="function",ln="object",_n="undefined",Pt="prototype",Oi="hasOwnProperty",xn=Object,qt=xn[Pt],Hi=xn.assign,Va=xn.create,qa=xn.defineProperty,ri=qt[Oi]});function zt(){return typeof globalThis!==_n&&globalThis?globalThis:typeof self!==_n&&self?self:typeof window!==_n&&window?window:typeof Ye.g!==_n&&Ye.g?Ye.g:null}u(zt,"ot");function Uo(t){throw new TypeError(t)}u(Uo,"Cr");function Wi(t){var e=Va;if(e)return e(t);if(t==null)return{};var n=typeof t;n!==ln&&n!==Vt&&Uo("Object prototype may only be an Object:"+t);function r(){}return u(r,"n"),r[Pt]=t,new r}u(Wi,"At");var za=L(()=>{Lo()});function De(t,e){typeof e!==Vt&&e!==null&&Uo("Class extends value "+String(e)+" is not a constructor or null"),Zt(t,e);function n(){this.constructor=t}u(n,"r"),t[Pt]=e===null?Wi(e):(n[Pt]=e[Pt],new n)}u(De,"z");var Sc,Bi,ja,Nr,Zt,Cc=L(()=>{Lo(),za(),Sc=(zt()||{}).Symbol,Bi=(zt()||{}).Reflect,ja=u(function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)qt[Oi].call(e,i)&&(t[i]=e[i])}return t},"Ic"),Nr=Hi||ja,Zt=u(function(t,e){return Zt=xn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r[Oi](i)&&(n[i]=r[i])},Zt(t,e)},"Di")}),_c=L(()=>{}),Me=L(()=>{Lo(),za(),Cc(),_c()});function Bn(t,e){return t&&si[wt].hasOwnProperty.call(t,e)}u(Bn,"Bt");function Ga(t){return t&&(t===si[wt]||t===Array[wt])}u(Ga,"Po");function Oo(t){return Ga(t)||t===Function[wt]}u(Oo,"Li");function un(t){if(t){if(Vn)return Vn(t);var e=t[$o]||t[wt]||(t[$n]?t[$n][wt]:null);if(e)return e}return null}u(un,"nr");function $i(t,e){var n=[],r=si.getOwnPropertyNames;if(r)n=r(t);else for(var i in t)typeof i=="string"&&Bn(t,i)&&n.push(i);if(n&&n.length>0)for(var o=0;o<n.length;o++)e(n[o])}u($i,"qn");function ur(t,e,n){return e!==$n&&typeof t[e]===oi&&(n||Bn(t,e))}u(ur,"_i");function ii(t){throw new TypeError("DynamicProto: "+t)}u(ii,"jn");function Ka(t){var e={};return $i(t,function(n){!e[n]&&ur(t,n,!1)&&(e[n]=t[n])}),e}u(Ka,"Ec");function Ho(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return!0;return!1}u(Ho,"Ui");function xc(t,e,n,r){function i(c,l,d){var h=l[d];if(h[en]&&r){var g=c[ai]||{};g[Lr]!==!1&&(h=(g[l[dr]]||{})[d]||h)}return function(){return h.apply(c,arguments)}}u(i,"i");var o={};$i(n,function(c){o[c]=i(e,n,c)});for(var a=un(t),s=[];a&&!Oo(a)&&!Ho(s,a);)$i(a,function(c){!o[c]&&ur(a,c,!Vn)&&(o[c]=i(e,a,c))}),s.push(a),a=un(a);return o}u(xc,"wc");function Ic(t,e,n,r){var i=null;if(t&&Bn(n,dr)){var o=t[ai]||{};if(i=(o[n[dr]]||{})[e],i||ii("Missing ["+e+"] "+oi),!i[qi]&&o[Lr]!==!1){for(var a=!Bn(t,e),s=un(t),c=[];a&&s&&!Oo(s)&&!Ho(c,s);){var l=s[e];if(l){a=l===r;break}c.push(s),s=un(s)}try{a&&(t[e]=i),i[qi]=1}catch(d){o[Lr]=!1}}}return i}u(Ic,"Pc");function Ec(t,e,n){var r=e[t];return r===n&&(r=un(e)[t]),typeof r!==oi&&ii("["+t+"] is not a "+oi),r}u(Ec,"bc");function Qa(t,e,n,r,i){function o(c,l){var d=u(function(){var h=Ic(this,l,c,d)||Ec(l,c,d);return h.apply(this,arguments)},"l");return d[en]=1,d}if(u(o,"a"),!Ga(t)){var a=n[ai]=n[ai]||{},s=a[e]=a[e]||{};a[Lr]!==!1&&(a[Lr]=!!i),$i(n,function(c){ur(n,c,!1)&&n[c]!==r[c]&&(s[c]=n[c],delete n[c],(!Bn(t,c)||t[c]&&!t[c][en])&&(t[c]=o(t,c)))})}}u(Qa,"Ac");function kc(t,e){if(Vn)for(var n=[],r=un(e);r&&!Oo(r)&&!Ho(n,r);){if(r===t)return!0;n.push(r),r=un(r)}return!1}u(kc,"Nc");function Wo(t,e){return Bn(t,wt)?t.name||e||In:((t||{})[$n]||{}).name||e||In}u(Wo,"Fi");function Vi(t,e,n,r){Bn(t,wt)||ii("theClass is an invalid class definition.");var i=t[wt];kc(i,e)||ii("["+Wo(t)+"] is not in class hierarchy of ["+Wo(e)+"]");var o=null;Bn(i,dr)?o=i[dr]:(o=Xa+Wo(t,"_")+"$"+Vo,Vo++,i[dr]=o);var a=Vi[Bo],s=!!a[zi];s&&r&&r[zi]!==void 0&&(s=!!r[zi]);var c=Ka(e),l=xc(i,e,c,s);n(e,l);var d=!!Vn&&!!a[Ur];d&&r&&(d=!!r[Ur]),Qa(i,o,e,c,d!==!1)}u(Vi,"Oi");var $n,wt,oi,ai,en,dr,Xa,qi,Lr,Bo,In,$o,zi,Ur,si,Vn,Vo,qo,Ge,et=L(()=>{$n="constructor",wt="prototype",oi="function",ai="_dynInstFuncs",en="_isDynProxy",dr="_dynClass",Xa="_dynCls$",qi="_dynInstChk",Lr=qi,Bo="_dfOpts",In="_unknown_",$o="__proto__",zi="useBaseInst",Ur="setInstFuncs",si=Object,Vn=si.getPrototypeOf,Vo=0,qo={setInstFuncs:!0,useBaseInst:!0},Vi[Bo]=qo,Ge=Vi}),V,W,ji=L(()=>{(function(t){t[t.CRITICAL=1]="CRITICAL",t[t.WARNING=2]="WARNING"})(V||(V={})),W={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103}});function zo(t){return qt.toString.call(t)}u(zo,"Bi");function Rc(t,e){return typeof t===e}u(Rc,"Hi");function b(t){return t===void 0||typeof t===_n}u(b,"fe");function C(t){return t===null||b(t)}u(C,"x");function M(t){return!C(t)}u(M,"Vi");function Z(t,e){return t&&ri.call(t,e)}u(Z,"Er");function Ee(t){return typeof t===ln}u(Ee,"st");function Q(t){return typeof t===Vt}u(Q,"B");function Ne(t,e,n,r){r===void 0&&(r=!1);var i=!1;if(!C(t))try{C(t[Pc])?C(t[Ac])||(t[Ac](Tc+e,n),i=!0):(t[Pc](e,n,r),i=!0)}catch(o){}return i}u(Ne,"Ht");function tt(t,e,n,r){if(r===void 0&&(r=!1),!C(t))try{C(t[Mc])?C(t[Fc])||t[Fc](Tc+e,n):t[Mc](e,n,r)}catch(i){}}u(tt,"Kn");function dt(t){var e=t,n=/([^\w\d_$])/g;return n.test(t)&&(e=t.replace(n,"_")),e}u(dt,"qi");function pe(t,e){if(t)for(var n in t)ri.call(t,n)&&e.call(t,n,t[n])}u(pe,"$");function Ft(t,e){if(t&&e){var n=e.length,r=t.length;if(t===e)return!0;if(r>=n){for(var i=r-1,o=n-1;o>=0;o--){if(t[i]!=e[o])return!1;i--}return!0}}return!1}u(Ft,"ji");function Le(t,e){return t&&e?t.indexOf(e)!==-1:!1}u(Le,"Te");function it(t){return zo(t)==="[object Date]"}u(it,"wr");function Qe(t){return zo(t)==="[object Array]"}u(Qe,"Fe");function yt(t){return zo(t)==="[object Error]"}u(yt,"Vt");function le(t){return typeof t=="string"}u(le,"U");function tn(t){return typeof t=="number"}u(tn,"ir");function En(t){return typeof t=="boolean"}u(En,"Gr");function kn(t){if(it(t)){var e=u(function(n){var r=String(n);return r.length===1&&(r="0"+r),r},"e");return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}u(kn,"Re");function fe(t,e,n){for(var r=t.length,i=0;i<r&&!(i in t&&e.call(n||t,t[i],i,t)===-1);i++);}u(fe,"R");function qn(t,e,n){for(var r=t.length,i=n||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in t&&t[o]===e)return o;return-1}u(qn,"Dt");function jo(t,e,n){for(var r=t.length,i=n||t,o=new Array(r),a=0;a<r;a++)a in t&&(o[a]=e.call(i,t[a],t));return o}u(jo,"qt");function Xu(t,e,n){var r=t.length,i=0,o;if(arguments.length>=3)o=arguments[2];else{for(;i<r&&!(i in t);)i++;o=t[i++]}for(;i<r;)i in t&&(o=e(o,t[i],i,t)),i++;return o}u(Xu,"Kr");function bt(t){return typeof t!="string"?t:t.replace(/^\s+|\s+$/g,"")}u(bt,"oe");function ci(t){var e=typeof t;e!==Vt&&(e!==ln||t===null)&&Uo("objKeys called on non-object");var n=[];for(var r in t)t&&ri.call(t,r)&&n.push(r);if(ed)for(var i=Ya.length,o=0;o<i;o++)t&&ri.call(t,Ya[o])&&n.push(Ya[o]);return n}u(ci,"Ye");function Gi(t,e,n,r){if(Nc)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),Nc(t,e,i),!0}catch(o){}return!1}u(Gi,"St");function dn(){var t=Date;return t.now?t.now():new t().getTime()}u(dn,"pe");function Te(t){return yt(t)?t.name:""}u(Te,"G");function Ie(t,e,n,r,i){var o=n;return t&&(o=t[e],o!==n&&(!i||i(o))&&(!r||r(n))&&(o=n,t[e]=o)),o}u(Ie,"K");function It(t,e,n){var r;return t?(r=t[e],!r&&C(r)&&(r=b(n)?{}:n,t[e]=r)):r=b(n)?{}:n,r}u(It,"me");function Yu(t){return!t}u(Yu,"Wn");function Dc(t){return!!t}u(Dc,"Pr");function zn(t){throw new Error(t)}u(zn,"Ae");function Ju(t,e,n){if(t&&e&&t!==e&&Ee(t)&&Ee(e)){var r=u(function(o){if(le(o)){var a=e[o];Q(a)?(!n||n(o,!0,e,t))&&(t[o]=function(s){return function(){var c=arguments;return e[s].apply(e,c)}}(o)):(!n||n(o,!1,e,t))&&(Z(t,o)&&delete t[o],Gi(t,o,function(){return e[o]},function(s){e[o]=s})||(t[o]=a))}},"n");for(var i in e)r(i)}return t}u(Ju,"Wr");function wp(t){return function(){function e(){var n=this;t&&pe(t,function(r,i){n[r]=i})}return u(e,"e"),e}()}u(wp,"Gi");function Zu(t){return t&&(t=xn(Hi?Hi({},t):t)),t}u(Zu,"Xn");var Tc,Ac,Pc,Fc,Mc,Nc,yp,bp,ed,Ya,Et=L(()=>{Me(),Tc="on",Ac="attachEvent",Pc="addEventListener",Fc="detachEvent",Mc="removeEventListener",Nc=qa,yp=xn.freeze,bp=xn.seal,ed=!{toString:null}.propertyIsEnumerable("toString"),Ya=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]});function kt(t){var e=zt();return e&&e[t]?e[t]:t===Uc&&Ja()?window:null}u(kt,"Ee");function Ja(){return Boolean(typeof window===ln&&window)}u(Ja,"ar");function Go(){return Ja()?window:kt(Uc)}u(Go,"It");function td(){return Boolean(typeof document===ln&&document)}u(td,"Jn");function jn(){return td()?document:kt(nd)}u(jn,"Ne");function Sp(){return Boolean(typeof navigator===ln&&navigator)}u(Sp,"Lo");function Gn(){return Sp()?navigator:kt(rd)}u(Gn,"Le");function Cp(){return Boolean(typeof history===ln&&history)}u(Cp,"_o");function _p(){return Cp()?history:kt(id)}u(_p,"Qi");function li(t){if(t&&dd){var e=kt("__mockLocation");if(e)return e}return typeof location===ln&&location?location:kt(od)}u(li,"$e");function xp(){return typeof console!==_n?console:kt(ad)}u(xp,"Zi");function hr(){return kt(sd)}u(hr,"Xe");function Ki(){return Boolean(typeof JSON===ln&&JSON||kt(Oc)!==null)}u(Ki,"gt");function Rn(){return Ki()?JSON||kt(Oc):null}u(Rn,"we");function Ip(){return kt(cd)}u(Ip,"Yi");function Ep(){return kt(ld)}u(Ep,"$i");function kp(){var t=Gn();return t&&t.product?t.product===ud:!1}u(kp,"ea");function Za(){var t=Gn();if(t&&(t.userAgent!==rs||ns===null)){rs=t.userAgent;var e=(rs||"").toLowerCase();ns=Le(e,es)||Le(e,ts)}return ns}u(Za,"jt");function Lc(t){if(t===void 0&&(t=null),!t){var e=Gn()||{};t=e?(e.userAgent||"").toLowerCase():""}var n=(t||"").toLowerCase();if(Le(n,es))return parseInt(n.split(es)[1]);if(Le(n,ts)){var r=parseInt(n.split(ts)[1]);if(r)return r+4}return null}u(Lc,"or");function we(t){var e=Object[Pt].toString.call(t),n="";return e==="[object Error]"?n="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'":Ki()&&(n=Rn().stringify(t)),e+n}u(we,"O");var Uc,nd,rd,id,od,ad,sd,Oc,cd,ld,ud,es,ts,ns,rs,dd,Ko=L(()=>{"use strict";Me(),Et(),Uc="window",nd="document",rd="navigator",id="history",od="location",ad="console",sd="performance",Oc="JSON",cd="crypto",ld="msCrypto",ud="ReactNative",es="msie",ts="trident/",ns=null,rs=null,dd=!1});function hd(t){return t?'"'+t.replace(/\"/g,"")+'"':""}u(hd,"Uo");function is(t,e){return(t||{}).logger||new Hc(e)}u(is,"Ft");var fd,gd,pd,Qi,Hc,Wc=L(()=>{"use strict";ji(),Ko(),et(),Et(),fd="AI (Internal): ",gd="AI: ",pd="AITR_",Qi=function(){function t(e,n,r,i){r===void 0&&(r=!1);var o=this;o.messageId=e,o.message=(r?gd:fd)+e;var a="";Ki()&&(a=Rn().stringify(i));var s=(n?" message:"+hd(n):"")+(i?" props:"+hd(a):"");o.message+=s}return u(t,"t"),t.dataType="MessageData",t}(),Hc=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};Ge(t,this,function(i){C(e)&&(e={}),i.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},i.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},i.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},i.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},i.throwInternal=function(s,c,l,d,h){h===void 0&&(h=!1);var g=new Qi(c,l,h,d);if(i.enableDebugExceptions())throw g;if(!b(g.message)){var p=i.consoleLoggingLevel();if(h){var y=+g.messageId;!r[y]&&p>=V.WARNING&&(i.warnToConsole(g.message),r[y]=!0)}else p>=V.WARNING&&i.warnToConsole(g.message);i.logInternalMessage(s,g)}},i.warnToConsole=function(s){var c=xp();if(c){var l="log";c.warn&&(l="warn"),Q(c[l])&&c[l](s)}},i.resetInternalMessageCount=function(){n=0,r={}},i.logInternalMessage=function(s,c){if(!a()){var l=!0,d=pd+c.messageId;if(r[d]?l=!1:r[d]=!0,l&&(s<=i.telemetryLoggingLevel()&&(i.queue.push(c),n++),n===i.maxInternalMessageLimit())){var h="Internal events throttle limit per PageView reached for this app.",g=new Qi(W.MessageLimitPerPVExceeded,h,!1);i.queue.push(g),i.warnToConsole(h)}}};function o(s,c){var l=e[s];return C(l)?c:l}u(o,"a");function a(){return n>=i.maxInternalMessageLimit()}u(a,"o")})}return u(t,"t"),t}()});function Xi(t,e,n,r,i){if(t){var o=t;if(Q(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(os);try{if(a=o.create(e(),r,i),a){if(s&&a.setCtx&&(a.setCtx(Yi.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(Yi.ChildrenContextKey);c||(c=[],s.setCtx(Yi.ChildrenContextKey,c)),c.push(a)}return o.setCtx(os,a),n(a)}}catch(l){a&&a.setCtx&&a.setCtx("exception",l)}finally{a&&o.fire(a),o.setCtx(os,s)}}}return n()}u(Xi,"ut");var ui,Yi,Bc,os,as=L(()=>{et(),Et(),ui="ctx",Yi=function(){function t(e,n,r){var i=this,o=!1;if(i.start=dn(),i.name=e,i.isAsync=r,i.isChildEvt=function(){return!1},Q(n)){var a;o=Gi(i,"payload",function(){return!a&&Q(n)&&(a=n(),n=null),a})}i.getCtx=function(s){return s?s===t.ParentContextKey||s===t.ChildrenContextKey?i[s]:(i[ui]||{})[s]:null},i.setCtx=function(s,c){if(s)if(s===t.ParentContextKey)i[s]||(i.isChildEvt=function(){return!0}),i[s]=c;else if(s===t.ChildrenContextKey)i[s]=c;else{var l=i[ui]=i[ui]||{};l[s]=c}},i.complete=function(){var s=0,c=i.getCtx(t.ChildrenContextKey);if(Qe(c))for(var l=0;l<c.length;l++){var d=c[l];d&&(s+=d.time)}i.time=dn()-i.start,i.exTime=i.time-s,i.complete=function(){},!o&&Q(n)&&(i.payload=n())}}return u(t,"t"),t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),Bc=function(){function t(e){this.ctx={},Ge(t,this,function(n){n.create=function(r,i,o){return new Yi(r,i,o)},n.fire=function(r){r&&(r.complete(),e&&e.perfEvent(r))},n.setCtx=function(r,i){if(r){var o=n[ui]=n[ui]||{};o[r]=i}},n.getCtx=function(r){return(n[ui]||{})[r]}})}return u(t,"t"),t}(),os="CoreUtils.doPerf"}),md,Rp=L(()=>{"use strict";as(),ji(),Et(),md=function(){function t(e,n){var r=this,i=null,o=Q(e.processTelemetry),a=Q(e.setNextPlugin);r._hasRun=!1,r.getPlugin=function(){return e},r.getNext=function(){return i},r.setNext=function(s){i=s},r.processTelemetry=function(s,c){c||(c=n);var l=e?e.identifier:"TelemetryPluginChain";Xi(c?c.core():null,function(){return l+":processTelemetry"},function(){if(e&&o){r._hasRun=!0;try{c.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,c)}catch(h){var d=i&&i._hasRun;(!i||!d)&&c.diagLog().throwInternal(V.CRITICAL,W.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+h),i&&!d&&i.processTelemetry(s,c)}}else i&&(r._hasRun=!0,i.processTelemetry(s,c))},function(){return{item:s}},!s.sync)}}return u(t,"t"),t}()});function $c(t,e){var n=[];if(t&&t.length>0)for(var r=null,i=0;i<t.length;i++){var o=t[i];if(o&&Q(o.processTelemetry)){var a=new md(o,e);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}u($c,"ra");function Dp(t,e,n){var r=[],i=!n;if(t)for(;t;){var o=t.getPlugin();(i||o===n)&&(i=!0,r.push(o)),t=t.getNext()}return i||r.push(n),$c(r,e)}u(Dp,"Gc");function Tp(t,e,n){var r=t,i=!1;return n&&t&&(r=[],fe(t,function(o){(i||o===n)&&(i=!0,r.push(o))})),n&&!i&&(r||(r=[]),r.push(n)),$c(r,e)}u(Tp,"Kc");var di,Vc=L(()=>{"use strict";Wc(),Rp(),Et(),di=function(){function t(e,n,r,i){var o=this,a=null;i!==null&&(e&&Q(e.getPlugin)?a=Dp(e,o,i||e.getPlugin()):i?a=Tp(e,o,i):b(i)&&(a=$c(e,o))),o.core=function(){return r},o.diagLog=function(){return is(r,n)},o.getCfg=function(){return n},o.getExtCfg=function(s,c){c===void 0&&(c={});var l;if(n){var d=n.extensionConfig;d&&s&&(l=d[s])}return l||c},o.getConfig=function(s,c,l){l===void 0&&(l=!1);var d,h=o.getExtCfg(s,null);return h&&!C(h[c])?d=h[c]:n&&!C(n[c])&&(d=n[c]),C(d)?l:d},o.hasNext=function(){return a!=null},o.getNext=function(){return a},o.setNext=function(s){a=s},o.processNext=function(s){var c=a;c&&(a=c.getNext(),c.processTelemetry(s,o))},o.createNew=function(s,c){return s===void 0&&(s=null),new t(s||a,n,r,c)}}return u(t,"t"),t}()}),vd,qc,wd=L(()=>{vd="iKey",qc="extensionConfig"}),Qo,hi,yd=L(()=>{"use strict";Vc(),Et(),wd(),Qo="getPlugin",hi=function(){function t(){var e=this,n=!1,r=null,i=null;e.core=null,e.diagLog=function(o){return e._getTelCtx(o).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(o){n=o},e.setNextPlugin=function(o){i=o},e.processNext=function(o,a){a?a.processNext(o):i&&Q(i.processTelemetry)&&i.processTelemetry(o,null)},e._getTelCtx=function(o){o===void 0&&(o=null);var a=o;if(!a){var s=r||new di(null,{},e.core);i&&i[Qo]?a=s.createNew(null,i[Qo]):a=s.createNew(null,i)}return a},e._baseTelInit=function(o,a,s,c){o&&Ie(o,qc,[],null,C),!c&&a&&(c=a.getProcessTelContext().getNext());var l=i;i&&i[Qo]&&(l=i[Qo]()),e.core=a,r=new di(c,o,a,l),n=!0}}return u(t,"t"),t.prototype.initialize=function(e,n,r,i){this._baseTelInit(e,n,r,i)},t}()});function zc(t,e){for(var n=[],r=null,i=t.getNext();i;){var o=i.getPlugin();o&&(r&&Q(r[Gc])&&Q(o[ss])&&r[Gc](o),(!Q(o[Kc])||!o[Kc]())&&n.push(o),r=o,i=i.getNext())}fe(n,function(a){a.initialize(t.getCfg(),t.core(),e,t.getNext())})}u(zc,"Qr");function bd(t){return t.sort(function(e,n){var r=0,i=Q(n[ss]);return Q(e[ss])?r=i?e[jc]-n[jc]:1:i&&(r=-1),r})}u(bd,"oa");var ss,jc,Gc,Kc,Sd=L(()=>{"use strict";Et(),ss="processTelemetry",jc="priority",Gc="setNextPlugin",Kc="isInitialized"}),cs,Cd,_d,Ap=L(()=>{"use strict";Me(),et(),yd(),Vc(),Sd(),Et(),cs=500,Cd="Channel has invalid priority",_d=function(t){De(e,t);function e(){var n=t.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=cs;var r;Ge(e,n,function(s,c){s.setNextPlugin=function(l){},s.processTelemetry=function(l,d){r&&fe(r,function(h){if(h.length>0){var g=n._getTelCtx(d).createNew(h);g.processNext(l)}})},s.getChannelControls=function(){return r},s.initialize=function(l,d,h){s.isInitialized()||(c.initialize(l,d,h),a((l||{}).channels,h),fe(r,function(g){return zc(new di(g,l,d),h)}))}});function i(s){fe(s,function(c){c.priority<cs&&zn(Cd+c.identifier)})}u(i,"i");function o(s){s&&s.length>0&&(s=s.sort(function(c,l){return c.priority-l.priority}),i(s),r.push(s))}u(o,"a");function a(s,c){if(r=[],s&&fe(s,function(d){return o(d)}),c){var l=[];fe(c,function(d){d.priority>cs&&l.push(d)}),o(l)}}return u(a,"o"),n}return u(e,"e"),e._staticInit=function(){var n=e.prototype;Gi(n,"ChannelControls",n.getChannelControls),Gi(n,"channelQueue",n.getChannelControls)}(),e}(hi)});function xd(t,e){var n=Xo[fr]||Jo[fr];return n||(n=Xo[fr]=Xo(t,e),Jo[fr]=n),n}u(xd,"ma");function ls(t){return t?t.isEnabled():!0}u(ls,"ri");function Pp(t){var e=t.cookieCfg=t.cookieCfg||{};if(Ie(e,"domain",t.cookieDomain,M,C),Ie(e,"path",t.cookiePath||"/",null,C),C(e[hs])){var n=void 0;b(t[Jc])||(n=!t[Jc]),b(t[Zc])||(n=!t[Zc]),e[hs]=n}return e}u(Pp,"Xc");function Qc(t,e){var n;if(t)n=t.getCookieMgr();else if(e){var r=e.cookieCfg;r[fr]?n=r[fr]:n=Xo(e)}return n||(n=xd(e,(t||{}).logger)),n}u(Qc,"cr");function Xo(t,e){var n=Pp(t||Jo),r=n.path||"/",i=n.domain,o=n[hs]!==!1,a={isEnabled:function(){var s=o&&Id(e),c=Jo[fr];return s&&c&&a!==c&&(s=ls(c)),s},setEnabled:function(s){o=s!==!1},set:function(s,c,l,d,h){if(ls(a)){var g={},p=bt(c||hn),y=p.indexOf(";");if(y!==-1&&(p=bt(c.substring(0,y)),g=Ed(c.substring(y+1))),Ie(g,"domain",d||i,Dc,b),!C(l)){var m=Za();if(b(g[ds])){var v=dn(),S=v+l*1e3;if(S>0){var w=new Date;w.setTime(S),Ie(g,ds,kd(w,m?Xc:Yc)||kd(w,m?Xc:Yc)||hn,Dc)}}m||Ie(g,"max-age",hn+l,null,b)}var x=li();x&&x.protocol==="https:"&&(Ie(g,"secure",null,null,b),fs===null&&(fs=!Td((Gn()||{}).userAgent)),fs&&Ie(g,"SameSite","None",null,b)),Ie(g,"path",h||r,null,b);var E=n.setCookie||Dd;E(s,Rd(p,g))}},get:function(s){var c=hn;return ls(a)&&(c=(n.getCookie||Fp)(s)),c},del:function(s,c){ls(a)&&a.purge(s,c)},purge:function(s,c){if(Id(e)){var l=(h={},h.path=c||"/",h[ds]="Thu, 01 Jan 1970 00:00:01 GMT",h);Za()||(l["max-age"]="0");var d=n.delCookie||Dd;d(s,Rd(hn,l))}var h}};return a[fr]=a,a}u(Xo,"ur");function Id(t){if(Yo===null){Yo=!1;try{var e=Ji||{};Yo=e[us]!==void 0}catch(n){t&&t.throwInternal(V.WARNING,W.CannotAccessCookie,"Cannot access document.cookie - "+Te(n),{exception:we(n)})}}return Yo}u(Id,"pa");function Ed(t){var e={};if(t&&t.length){var n=bt(t).split(";");fe(n,function(r){if(r=bt(r||hn),r){var i=r.indexOf("=");i===-1?e[r]=null:e[bt(r.substring(0,i))]=bt(r.substring(i+1))}})}return e}u(Ed,"ts");function kd(t,e){return Q(t[e])?t[e]():null}u(kd,"Yo");function Rd(t,e){var n=t||hn;return pe(e,function(r,i){n+="; "+r+(C(i)?hn:"="+i)}),n}u(Rd,"$o");function Fp(t){var e=hn;if(Ji){var n=Ji[us]||hn;el!==n&&(tl=Ed(n),el=n),e=bt(tl[t]||hn)}return e}u(Fp,"Jc");function Dd(t,e){Ji&&(Ji[us]=t+"="+e)}u(Dd,"es");function Td(t){return le(t)?!!(Le(t,"CPU iPhone OS 12")||Le(t,"iPad; CPU OS 12")||Le(t,"Macintosh; Intel Mac OS X 10_14")&&Le(t,"Version/")&&Le(t,"Safari")||Le(t,"Macintosh; Intel Mac OS X 10_14")&&Ft(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Le(t,"Chrome/5")||Le(t,"Chrome/6")||Le(t,"UnrealEngine")&&!Le(t,"Chrome")||Le(t,"UCBrowser/12")||Le(t,"UCBrowser/11")):!1}u(Td,"ii");var Xc,Yc,us,ds,hs,Jc,Zc,fr,hn,Yo,fs,el,Ji,tl,Jo,nl=L(()=>{ji(),Ko(),Et(),Xc="toGMTString",Yc="toUTCString",us="cookie",ds="expires",hs="enabled",Jc="isCookieUseDisabled",Zc="disableCookiesUsage",fr="_ckMgr",hn="",Yo=null,fs=null,el=null,Ji=jn(),tl={},Jo={}}),Ad,rl,il,Pd=L(()=>{"use strict";Me(),et(),Ap(),Vc(),Sd(),as(),nl(),Et(),wd(),Ad="Extensions must provide callback to initialize",rl="_notificationManager",il=function(){function t(){var e=!1,n,r,i,o,a;Ge(t,this,function(s){s._extensions=new Array,r=new _d,s.logger=Wi({throwInternal:function(c,l,d,h,g){g===void 0&&(g=!1)},warnToConsole:function(c){},resetInternalMessageCount:function(){}}),n=[],s.isInitialized=function(){return e},s.initialize=function(c,l,d,h){s.isInitialized()&&zn("Core should not be initialized more than once"),(!c||C(c.instrumentationKey))&&zn("Please provide instrumentation key"),i=h,s[rl]=h,s.config=c||{},c.extensions=C(c.extensions)?[]:c.extensions;var g=It(c,qc);g.NotificationManager=h,d&&(s.logger=d);var p=[];p.push.apply(p,l.concat(c.extensions)),p=bd(p);var y=[],m=[],v={};fe(p,function(S){(C(S)||C(S.initialize))&&zn(Ad);var w=S.priority,x=S.identifier;S&&w&&(C(v[w])?v[w]=x:d.warnToConsole("Two extensions have same priority #"+w+" - "+v[w]+", "+x)),!w||w<r.priority?y.push(S):m.push(S)}),p.push(r),y.push(r),p=bd(p),s._extensions=p,zc(new di([r],c,s),p),zc(new di(y,c,s),p),s._extensions=y,s.getTransmissionControls().length===0&&zn("No channels available"),e=!0,s.releaseQueue()},s.getTransmissionControls=function(){return r.getChannelControls()},s.track=function(c){Ie(c,vd,s.config.instrumentationKey,null,Yu),Ie(c,"time",kn(new Date),null,Yu),Ie(c,"ver","4.0",null,C),s.isInitialized()?s.getProcessTelContext().processNext(c):n.push(c)},s.getProcessTelContext=function(){var c=s._extensions,l=c;return(!c||c.length===0)&&(l=[r]),new di(l,s.config,s)},s.getNotifyMgr=function(){return i||(i=Wi({addNotificationListener:function(c){},removeNotificationListener:function(c){},eventsSent:function(c){},eventsDiscarded:function(c,l){},eventsSendRequest:function(c,l){}}),s[rl]=i),i},s.getCookieMgr=function(){return a||(a=Xo(s.config,s.logger)),a},s.setCookieMgr=function(c){a=c},s.getPerfMgr=function(){return o||s.config&&s.config.enablePerfMgr&&(o=new Bc(s.getNotifyMgr())),o},s.setPerfMgr=function(c){o=c},s.eventCnt=function(){return n.length},s.releaseQueue=function(){n.length>0&&(fe(n,function(c){s.getProcessTelContext().processNext(c)}),n=[])}})}return u(t,"t"),t}()}),ol,Fd=L(()=>{et(),Et(),ol=function(){function t(e){this.listeners=[];var n=!!(e||{}).perfEvtsSendAll;Ge(t,this,function(r){r.addNotificationListener=function(i){r.listeners.push(i)},r.removeNotificationListener=function(i){for(var o=qn(r.listeners,i);o>-1;)r.listeners.splice(o,1),o=qn(r.listeners,i)},r.eventsSent=function(i){fe(r.listeners,function(o){o&&o.eventsSent&&setTimeout(function(){return o.eventsSent(i)},0)})},r.eventsDiscarded=function(i,o){fe(r.listeners,function(a){a&&a.eventsDiscarded&&setTimeout(function(){return a.eventsDiscarded(i,o)},0)})},r.eventsSendRequest=function(i,o){fe(r.listeners,function(a){if(a&&a.eventsSendRequest)if(o)setTimeout(function(){return a.eventsSendRequest(i,o)},0);else try{a.eventsSendRequest(i,o)}catch(s){}})},r.perfEvent=function(i){i&&(n||!i.isChildEvt())&&fe(r.listeners,function(o){if(o&&o.perfEvent)if(i.isAsync)setTimeout(function(){return o.perfEvent(i)},0);else try{o.perfEvent(i)}catch(a){}})}})}return u(t,"t"),t}()}),al,Mp=L(()=>{Me(),Pd(),No(),Fd(),as(),Wc(),et(),Et(),al=function(t){De(e,t);function e(){var n=t.call(this)||this;return Ge(e,n,function(r,i){r.initialize=function(s,c,l,d){i.initialize(s,c,l||new Hc(s),d||new ol(s))},r.track=function(s){Xi(r.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){s===null&&(a(s),zn("Invalid telemetry item")),o(s),i.track(s)},function(){return{item:s}},!s.sync)},r.addNotificationListener=function(s){var c=r.getNotifyMgr();c&&c.addNotificationListener(s)},r.removeNotificationListener=function(s){var c=r.getNotifyMgr();c&&c.removeNotificationListener(s)},r.pollInternalLogs=function(s){var c=r.config.diagnosticLogInterval;return(!c||!(c>0))&&(c=1e4),setInterval(function(){var l=r.logger?r.logger.queue:[];fe(l,function(d){var h={name:s||"InternalMessageId: "+d.messageId,iKey:r.config.instrumentationKey,time:kn(new Date),baseType:Qi.dataType,baseData:{message:d.message}};r.track(h)}),l.length=0},c)};function o(s){if(C(s.name))throw a(s),Error("telemetry name required")}u(o,"a");function a(s){var c=r.getNotifyMgr();c&&c.eventsDiscarded([s],Mo.InvalidEvent)}u(a,"o")}),n}return u(e,"e"),e}(il)});function Md(t){t<0&&(t>>>=0),Zi=123456789+t&gr,eo=987654321-t&gr,cl=!0}u(Md,"os");function Nd(){try{var t=dn()&2147483647;Md((Math.random()*sl^t)+t)}catch(e){}}u(Nd,"ss");function Ld(t){return t>0?Math.floor(fi()/gr*(t+1))>>>0:0}u(Ld,"oi");function fi(t){var e,n=Ip()||Ep();return n&&n.getRandomValues?e=n.getRandomValues(new Uint32Array(1))[0]&gr:Za()?(cl||Nd(),e=Ud()&gr):e=Math.floor(sl*Math.random()|0),t||(e>>>=0),e}u(fi,"Ct");function Np(t){t?Md(t):Nd()}u(Np,"ha");function Ud(t){eo=36969*(eo&65535)+(eo>>16)&gr,Zi=18e3*(Zi&65535)+(Zi>>16)&gr;var e=(eo<<16)+(Zi&65535)>>>0&gr|0;return t||(e>>>=0),e}u(Ud,"si");var sl,gr,cl,Zi,eo,Od=L(()=>{Ko(),Et(),sl=4294967296,gr=4294967295,cl=!1,Zi=123456789,eo=987654321});function gi(t,e){var n=!1,r=Go();r&&(n=Ne(r,t,e),n=Ne(r.body,t,e)||n);var i=jn();return i&&(n=ea.Attach(i,t,e)||n),n}u(gi,"Mt");function Lp(){function t(){return Ld(15)}return u(t,"t"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Wd,function(e){var n=t()|0,r=e==="x"?n:n&3|8;return r.toString(16)})}u(Lp,"us");function Up(){var t=hr();return t&&t.now?t.now():dn()}u(Up,"cs");function gs(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=fi()>>>0,r=0,i="";i.length<t;)r++,i+=e.charAt(n&63),n>>>=6,r===5&&(n=(fi()<<2&4294967295|n&3)>>>0,r=0);return i}u(gs,"Wt");function Kn(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="",n,r=0;r<4;r++)n=fi(),e+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var i=t[8+(fi()&3)|0];return e.substr(0,8)+e.substr(9,4)+"4"+e.substr(13,3)+i+e.substr(16,3)+e.substr(19,12)}u(Kn,"Oe");function to(t,e){var n=xd(t,e),r=ps._canUseCookies;return no===null&&(no=[],Zo=r,Gi(ps,"_canUseCookies",function(){return Zo},function(i){Zo=i,fe(no,function(o){o.setEnabled(i)})})),qn(no,n)===-1&&no.push(n),En(r)&&n.setEnabled(r),En(Zo)&&n.setEnabled(Zo),n}u(to,"Jt");function Hd(){to().setEnabled(!1)}u(Hd,"ui");function Op(t){return to(null,t).isEnabled()}u(Op,"ya");function Hp(t,e){return to(null,t).get(e)}u(Hp,"Sa");function Wp(t,e,n,r){to(null,t).set(e,n,null,r)}u(Wp,"Ia");function Bp(t,e){return to(null,t).del(e)}u(Bp,"Ca");var no,Zo,ps,Wd,ea,$p=L(()=>{"use strict";Me(),nl(),Ko(),Et(),Od(),no=null,ps={_canUseCookies:void 0,isTypeof:Rc,isUndefined:b,isNullOrUndefined:C,hasOwnProperty:Z,isFunction:Q,isObject:Ee,isDate:it,isArray:Qe,isError:yt,isString:le,isNumber:tn,isBoolean:En,toISOString:kn,arrForEach:fe,arrIndexOf:qn,arrMap:jo,arrReduce:Xu,strTrim:bt,objCreate:Wi,objKeys:ci,objDefineAccessors:Gi,addEventHandler:gi,dateNow:dn,isIE:Za,disableCookies:Hd,newGuid:Lp,perfNow:Up,newId:gs,randomValue:Ld,random32:fi,mwcRandomSeed:Np,mwcRandom32:Ud,generateW3CId:Kn},Wd=/[xy]/g,ea={Attach:Ne,AttachEvent:Ne,Detach:tt,DetachEvent:tt}});function ll(t,e){if(t)for(var n=0;n<t.length&&!e(t[n],n);n++);}u(ll,"Ea");function ul(t,e,n,r,i){i>=0&&i<=2&&ll(t,function(o,a){var s=o.cbks,c=s[fl[i]];if(c){e.ctx=function(){var h=r[a]=r[a]||{};return h};try{c.apply(e.inst,n)}catch(h){var l=e.err;try{var d=s[fl[2]];d&&(e.err=h,d.apply(e.inst,n))}catch(g){}finally{e.err=l}}}})}u(ul,"Ta");function Vp(t){return function(){var e=this,n=arguments,r=t.h,i={name:t.n,inst:e,ctx:null,set:c},o=[],a=s([i],n);function s(d,h){return ll(h,function(g){d.push(g)}),d}u(s,"u");function c(d,h){n=s([],n),n[d]=h,a=s([i],n)}u(c,"s"),ul(r,i,a,o,0);var l=t.f;try{i.rslt=l.apply(e,n)}catch(d){throw i.err=d,ul(r,i,a,o,3),d}return ul(r,i,a,o,1),i.rslt}}u(Vp,"el");function qp(t){if(t){if(gl)return gl(t);var e=t[$d]||t[Pt]||t[Vd];if(e)return e}return null}u(qp,"tl");function Bd(t,e,n){var r=null;return t&&(Z(t,e)?r=t:n&&(r=Bd(qp(t),e,!1))),r}u(Bd,"ms");function zp(t,e,n){return t?dl(t[Pt],e,n,!1):null}u(zp,"wa");function dl(t,e,n,r){if(r===void 0&&(r=!0),t&&e&&n){var i=Bd(t,e,r);if(i){var o=i[e];if(typeof o===Vt){var a=o[hl];if(!a){a={i:0,n:e,f:o,h:[]};var s=Vp(a);s[hl]=a,i[e]=s}var c={id:a.i,cbks:n,rm:function(){var l=this.id;ll(a.h,function(d,h){if(d.id===l)return a.h.splice(h,1),1})}};return a.i++,a.h.push(c),c}}}return null}u(dl,"sn");var hl,fl,$d,Vd,gl,jp=L(()=>{Me(),Et(),hl="_aiHooks",fl=["req","rsp","hkErr","fnErr"],$d="__proto__",Vd="constructor",gl=Object.getPrototypeOf}),Se=L(()=>{Mp(),Pd(),yd(),Od(),$p(),Et(),Ko(),Me(),Fd(),as(),Wc(),ji(),jp(),nl()}),Be,qd=L(()=>{Be={requestContextHeader:"Request-Context",requestContextTargetKey:"appId",requestContextAppIdFormat:"appId=cid-v1:",requestIdHeader:"Request-Id",traceParentHeader:"traceparent",traceStateHeader:"tracestate",sdkContextHeader:"Sdk-Context",sdkContextHeaderAppIdRequest:"appId",requestContextHeaderLowerCase:"request-context"}});function pl(t,e,n){var r=e.length,i=zd(t,e);if(i.length!==r){for(var o=0,a=i;n[a]!==void 0;)o++,a=i.substring(0,150-3)+Kd(o);i=a}return i}u(pl,"ci");function zd(t,e){var n;return e&&(e=bt(e.toString()),e.length>150&&(n=e.substring(0,150),t.throwInternal(V.WARNING,W.NameTooLong,"name is too long.  It has been truncated to "+150+" characters.",{name:e},!0))),n||e}u(zd,"ba");function Mt(t,e,n){n===void 0&&(n=1024);var r;return e&&(n=n||1024,e=bt(e),e.toString().length>n&&(r=e.toString().substring(0,n),t.throwInternal(V.WARNING,W.StringValueTooLong,"string value is too long. It has been truncated to "+n+" characters.",{value:e},!0))),r||e}u(Mt,"ae");function ta(t,e){return vl(t,e,2048,W.UrlTooLong)}u(ta,"Tt");function ml(t,e){var n;return e&&e.length>32768&&(n=e.substring(0,32768),t.throwInternal(V.WARNING,W.MessageTruncated,"message is too long, it has been truncated to "+32768+" characters.",{message:e},!0)),n||e}u(ml,"Nr");function jd(t,e){var n;if(e){var r=""+e;r.length>32768&&(n=r.substring(0,32768),t.throwInternal(V.WARNING,W.ExceptionTruncated,"exception is too long, it has been truncated to "+32768+" characters.",{exception:e},!0))}return n||e}u(jd,"li");function Or(t,e){if(e){var n={};pe(e,function(r,i){if(Ee(i)&&Ki())try{i=Rn().stringify(i)}catch(o){t.throwInternal(V.WARNING,W.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:o},!0)}i=Mt(t,i,8192),r=pl(t,r,n),n[r]=i}),e=n}return e}u(Or,"ze");function Hr(t,e){if(e){var n={};pe(e,function(r,i){r=pl(t,r,n),n[r]=i}),e=n}return e}u(Hr,"Be");function Gd(t,e){return e&&vl(t,e,128,W.IdTooLong).toString()}u(Gd,"fi");function vl(t,e,n,r){var i;return e&&(e=bt(e),e.length>n&&(i=e.substring(0,n),t.throwInternal(V.WARNING,r,"input is too long, it has been truncated to "+n+" characters.",{data:e},!0))),i||e}u(vl,"pi");function Kd(t){var e="00"+t;return e.substr(e.length-3)}u(Kd,"Aa");var Qd,Dn=L(()=>{Se(),Qd={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768,sanitizeKeyAndAddUniqueness:pl,sanitizeKey:zd,sanitizeString:Mt,sanitizeUrl:ta,sanitizeMessage:ml,sanitizeException:jd,sanitizeProperties:Or,sanitizeMeasurements:Hr,sanitizeId:Gd,sanitizeInput:vl,padNumber:Kd,trim:bt}});function ro(t){var e=null;if(Q(Event))e=new Event(t);else{var n=jn();n&&n.createEvent&&(e=n.createEvent("Event"),e.initEvent(t,!0,!0))}return e}u(ro,"Lt");var Xd=L(()=>{Se()});function Ue(t,e){return e===void 0&&(e=!1),t==null?e:t.toString().toLowerCase()==="true"}u(Ue,"ee");function pr(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=""+t%1e3,n=""+Math.floor(t/1e3)%60,r=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,o=Math.floor(t/(1e3*60*60*24));return e=e.length===1?"00"+e:e.length===2?"0"+e:e,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r,i=i.length<2?"0"+i:i,(o>0?o+".":"")+i+":"+r+":"+n+"."+e}u(pr,"je");function wl(){var t=Gn();return"sendBeacon"in t&&t.sendBeacon}u(wl,"Dr");function Yd(t,e){var n=null;return fe(t,function(r){if(r.identifier===e)return n=r,-1}),n}u(Yd,"un");function Jd(t,e,n,r,i){return!i&&le(t)&&(t==="Script error."||t==="Script error")}u(Jd,"cn");var ms=L(()=>{Se()}),pi,vs,io,ws,yl,fn,Tn=L(()=>{pi="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",vs="sampleRate",io="ProcessLegacy",ws="http.method",yl="https://dc.services.visualstudio.com",fn="not_specified"}),mi,An,Zd=L(()=>{(function(t){t[t.LocalStorage=0]="LocalStorage",t[t.SessionStorage=1]="SessionStorage"})(mi||(mi={})),function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C",t[t.W3C=2]="W3C"}(An||(An={}))});function bl(){return Cl()?ys(mi.LocalStorage):null}u(bl,"Fa");function ys(t){try{if(C(zt()))return null;var e=new Date,n=kt(t===mi.LocalStorage?"localStorage":"sessionStorage");n.setItem(e.toString(),e.toString());var r=n.getItem(e.toString())!==e.toString();if(n.removeItem(e.toString()),!r)return n}catch(i){}return null}u(ys,"di");function Sl(){return oo()?ys(mi.SessionStorage):null}u(Sl,"Ra");function eh(){Wr=!1,Br=!1}u(eh,"pn");function Cl(){return Wr===void 0&&(Wr=!!ys(mi.LocalStorage)),Wr}u(Cl,"Fr");function th(t,e){var n=bl();if(n!==null)try{return n.getItem(e)}catch(r){Wr=!1,t.throwInternal(V.WARNING,W.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+Te(r),{exception:we(r)})}return null}u(th,"dn");function nh(t,e,n){var r=bl();if(r!==null)try{return r.setItem(e,n),!0}catch(i){Wr=!1,t.throwInternal(V.WARNING,W.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+Te(i),{exception:we(i)})}return!1}u(nh,"mn");function rh(t,e){var n=bl();if(n!==null)try{return n.removeItem(e),!0}catch(r){Wr=!1,t.throwInternal(V.WARNING,W.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+Te(r),{exception:we(r)})}return!1}u(rh,"vn");function oo(){return Br===void 0&&(Br=!!ys(mi.SessionStorage)),Br}u(oo,"wt");function Gp(){var t=[];return oo()&&pe(kt("sessionStorage"),function(e){t.push(e)}),t}u(Gp,"Ma");function bs(t,e){var n=Sl();if(n!==null)try{return n.getItem(e)}catch(r){Br=!1,t.throwInternal(V.WARNING,W.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+Te(r),{exception:we(r)})}return null}u(bs,"Zt");function Ss(t,e,n){var r=Sl();if(r!==null)try{return r.setItem(e,n),!0}catch(i){Br=!1,t.throwInternal(V.WARNING,W.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+Te(i),{exception:we(i)})}return!1}u(Ss,"Yt");function ih(t,e){var n=Sl();if(n!==null)try{return n.removeItem(e),!0}catch(r){Br=!1,t.throwInternal(V.WARNING,W.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+Te(r),{exception:we(r)})}return!1}u(ih,"gn");var Wr,Br,oh=L(()=>{Se(),Zd(),Wr=void 0,Br=void 0});function na(t){var e=Il,n=lh,r=n[e];return xl.createElement?n[e]||(r=n[e]=xl.createElement("a")):r={host:ch(t,!0)},r.href=t,e++,e>=n.length&&(e=0),Il=e,r}u(na,"dr");function ah(t){var e,n=na(t);return n&&(e=n.href),e}u(ah,"hn");function Kp(t){var e,n=na(t);return n&&(e=n.pathname),e}u(Kp,"_a");function sh(t,e){return t?t.toUpperCase()+" "+e:e}u(sh,"xn");function ch(t,e){var n=_l(t,e)||"";if(n){var r=n.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(r!=null&&r.length>3&&le(r[2])&&r[2].length>0)return r[2]+(r[3]||"")}return n}u(ch,"mi");function _l(t,e){var n=null;if(t){var r=t.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(r!=null&&r.length>2&&le(r[2])&&r[2].length>0&&(n=r[2]||"",e&&r.length>2)){var i=(r[1]||"").toLowerCase(),o=r[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),n+=o}}return n}u(_l,"yn");var xl,Il,lh,uh=L(()=>{Se(),xl=jn()||{},Il=0,lh=[null,null,null,null,null]});function Cs(t){return dh.indexOf(t.toLowerCase())!==-1}u(Cs,"Rr");function Qp(t,e,n,r){var i,o=r,a=r;if(e&&e.length>0){var s=na(e);if(i=s.host,!o)if(s.pathname!=null){var c=s.pathname.length===0?"/":s.pathname;c.charAt(0)!=="/"&&(c="/"+c),a=s.pathname,o=Mt(t,n?n+" "+c:c)}else o=Mt(t,e)}else i=r,o=r;return{target:i,name:o,data:a}}u(Qp,"xs");function ra(){var t=hr();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return dn()}u(ra,"mr");function Nt(t,e){var n=null;return t!==0&&e!==0&&!C(t)&&!C(e)&&(n=e-t),n}u(Nt,"ve");var dh,El,hh,$r,fh,gh=L(()=>{Se(),qd(),Dn(),Xd(),ms(),Tn(),oh(),uh(),dh=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],El={NotSpecified:fn,createDomEvent:ro,disableStorage:eh,isInternalApplicationInsightsEndpoint:Cs,canUseLocalStorage:Cl,getStorage:th,setStorage:nh,removeStorage:rh,canUseSessionStorage:oo,getSessionStorageKeys:Gp,getSessionStorage:bs,setSessionStorage:Ss,removeSessionStorage:ih,disableCookies:Hd,canUseCookies:Op,disallowsSameSiteNone:Td,setCookie:Wp,stringToBoolOrDefault:Ue,getCookie:Hp,deleteCookie:Bp,trim:bt,newId:gs,random32:function(){return fi(!0)},generateW3CId:Kn,isArray:Qe,isError:yt,isDate:it,toISOStringForIE8:kn,getIEVersion:Lc,msToTimeSpan:pr,isCrossOriginError:Jd,dump:we,getExceptionName:Te,addEventHandler:Ne,IsBeaconApiSupported:wl,getExtension:Yd},hh={parseUrl:na,getAbsoluteUrl:ah,getPathName:Kp,getCompleteUrl:sh,parseHost:ch,parseFullHost:_l},$r={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(t,e,n){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t.correlationHeaderExcludePatterns){for(var r=0;r<t.correlationHeaderExcludePatterns.length;r++)if(t.correlationHeaderExcludePatterns[r].test(e))return!1}var i=na(e).host.toLowerCase();if(i&&(i.indexOf(":443")!==-1||i.indexOf(":80")!==-1)&&(i=(_l(e,!0)||"").toLowerCase()),(!t||!t.enableCorsCorrelation)&&i&&i!==n)return!1;var o=t&&t.correlationHeaderDomains;if(o){var a;if(fe(o,function(l){var d=new RegExp(l.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(i)}),!a)return!1}var s=t&&t.correlationHeaderExcludedDomains;if(!s||s.length===0)return!0;for(var r=0;r<s.length;r++){var c=new RegExp(s[r].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(c.test(i))return!1}return i&&i.length>0},getCorrelationContext:function(t){if(t){var e=$r.getCorrelationContextValue(t,Be.requestContextTargetKey);if(e&&e!==$r.correlationIdPrefix)return e}},getCorrelationContextValue:function(t,e){if(t)for(var n=t.split(","),r=0;r<n.length;++r){var i=n[r].split("=");if(i.length===2&&i[0]===e)return i[1]}}},fh={Now:ra,GetDuration:Nt}});function ph(t){if(!t)return{};var e=t.split(mh),n=Xu(e,function(i,o){var a=o.split(vh);if(a.length===2){var s=a[0].toLowerCase(),c=a[1];i[s]=c}return i},{});if(ci(n).length>0){if(n.endpointsuffix){var r=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+r+"dc."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||yl}return n}u(ph,"vi");var mh,vh,wh,Xp=L(()=>{Tn(),Se(),mh=";",vh="=",wh={parse:ph}}),kl,yh=L(()=>{kl=function(){function t(){}return u(t,"t"),t}()}),Rl,bh=L(()=>{Me(),yh(),Rl=function(t){De(e,t);function e(){return t.call(this)||this}return u(e,"e"),e}(kl)}),Sh,Yp=L(()=>{Sh=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return u(t,"t"),t}()}),Dl,Jp=L(()=>{Me(),Yp(),Dn(),Se(),Tn(),Dl=function(t){De(e,t);function e(n,r,i){var o=t.call(this)||this;return o.name=Mt(n,i)||fn,o.data=r,o.time=kn(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1},o}return u(e,"e"),e}(Sh)}),Tl,Ch=L(()=>{Tl=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return u(t,"t"),t}()}),Pn,Zp=L(()=>{Me(),Ch(),Dn(),Tn(),Pn=function(t){De(e,t);function e(n,r,i,o){var a=t.call(this)||this;return a.aiDataContract={ver:1,name:1,properties:0,measurements:0},a.name=Mt(n,r)||fn,a.properties=Or(n,i),a.measurements=Hr(n,o),a}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(Tl)}),_h,em=L(()=>{_h=function(){function t(){}return u(t,"t"),t}()}),xh,tm=L(()=>{xh=function(){function t(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}}return u(t,"t"),t}()}),Ih,nm=L(()=>{Ih=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return u(t,"t"),t}()});function Al(t,e){var n=t;return n&&!le(n)&&(JSON&&JSON.stringify?(n=JSON.stringify(t),e&&(!n||n==="{}")&&(Q(t.toString)?n=t.toString():n=""+t)):n=""+t+" - (Missing JSON.stringify)"),n||""}u(Al,"Xa");function Eh(t,e){var n=t;return t&&(n=t[Is]||t[Ml]||"",n&&!le(n)&&(n=Al(n,!0)),t.filename&&(n=n+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(n||"").indexOf(e)===-1&&(n=e+": "+n),n||""}u(Eh,"Ms");function rm(t){return Ee(t)?"hasFullStack"in t&&"typeName"in t:!1}u(rm,"sl");function im(t){return Ee(t)?"ver"in t&&"exceptions"in t&&"properties"in t:!1}u(im,"ul");function kh(t){return t&&t.src&&le(t.src)&&t.obj&&Qe(t.obj)}u(kh,"ks");function ao(t){var e=t||"";le(e)||(le(e[nn])?e=e[nn]:e=""+e);var n=e.split(`
`);return{src:e,obj:n}}u(ao,"Mr");function om(t){for(var e=[],n=t.split(`
`),r=0;r<n.length;r++){var i=n[r];n[r+1]&&(i+="@"+n[r+1],r++),e.push(i)}return{src:t,obj:e}}u(om,"cl");function Rh(t){var e=null;if(t)try{if(t[nn])e=ao(t[nn]);else if(t[vi]&&t[vi][nn])e=ao(t[vi][nn]);else if(t.exception&&t.exception[nn])e=ao(t.exception[nn]);else if(kh(t))e=t;else if(kh(t[xs]))e=t[xs];else if(window.opera&&t[Is])e=om(t.message);else if(le(t))e=ao(t);else{var n=t[Is]||t[Ml]||"";le(t[Fl])&&(n&&(n+=`
`),n+=" from "+t[Fl]),n&&(e=ao(n))}}catch(r){e=ao(r)}return e||{src:"",obj:null}}u(Rh,"Ls");function am(t){var e="";return t&&(t.obj?fe(t.obj,function(n){e+=n+`
`}):e=t.src||""),e}u(am,"ll");function sm(t){var e,n=t.obj;if(n&&n.length>0){e=[];var r=0,i=0;fe(n,function(y){var m=y.toString();if(Es.regex.test(m)){var v=new Es(m,r++);i+=v.sizeInBytes,e.push(v)}});var o=32*1024;if(i>o)for(var a=0,s=e.length-1,c=0,l=a,d=s;a<s;){var h=e[a].sizeInBytes,g=e[s].sizeInBytes;if(c+=h+g,c>o){var p=d-l+1;e.splice(l,p);break}l=a,d=s,a++,s--}}return e}u(sm,"fl");function _s(t){var e="";if(t&&(e=t.typeName||t.name||"",!e))try{var n=/function (.{1,200})\(/,r=n.exec(t.constructor.toString());e=r&&r.length>1?r[1]:""}catch(i){}return e}u(_s,"hi");function Pl(t){if(t)try{if(!le(t)){var e=_s(t),n=Al(t,!1);return(!n||n==="{}")&&(t[vi]&&(t=t[vi],e=_s(t)),n=Al(t,!0)),n.indexOf(e)!==0&&e!=="String"?e+":"+n:n}}catch(r){}return""+(t||"")}u(Pl,"Ga");var Dh,vi,nn,xs,Fl,Is,Ml,Lt,Nl,Es,cm=L(()=>{Me(),em(),tm(),nm(),Dn(),Se(),Tn(),Dh="<no_method>",vi="error",nn="stack",xs="stackDetails",Fl="errorSrc",Is="message",Ml="description",Lt=function(t){De(e,t);function e(n,r,i,o,a,s){var c=t.call(this)||this;return c.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},im(r)?(c.exceptions=r.exceptions,c.properties=r.properties,c.measurements=r.measurements,r.severityLevel&&(c.severityLevel=r.severityLevel),r.id&&(c.id=r.id),r.problemGroup&&(c.problemGroup=r.problemGroup),c.ver=2,C(r.isManual)||(c.isManual=r.isManual)):(i||(i={}),c.exceptions=[new Nl(n,r,i)],c.properties=Or(n,i),c.measurements=Hr(n,o),a&&(c.severityLevel=a),s&&(c.id=s)),c}return u(e,"e"),e.CreateAutoException=function(n,r,i,o,a,s,c,l){var d=_s(a||s||n);return{message:Eh(n,d),url:r,lineNumber:i,columnNumber:o,error:Pl(a||s||n),evt:Pl(s||n),typeName:d,stackDetails:Rh(c||a||s),errorSrc:l}},e.CreateFromInterface=function(n,r,i,o){var a=r.exceptions&&jo(r.exceptions,function(c){return Nl.CreateFromInterface(n,c)}),s=new e(n,Nr({},r,{exceptions:a}),i,o);return s},e.prototype.toInterface=function(){var n=this,r=n.exceptions,i=n.properties,o=n.measurements,a=n.severityLevel,s=n.ver,c=n.problemGroup,l=n.id,d=n.isManual,h=r instanceof Array&&jo(r,function(g){return g.toInterface()})||void 0;return{ver:"4.0",exceptions:h,severityLevel:a,properties:i,measurements:o,problemGroup:c,id:l,isManual:d}},e.CreateSimpleException=function(n,r,i,o,a,s){return{exceptions:[{hasFullStack:!0,message:n,stack:a,typeName:r}]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=Pl,e}(xh),Nl=function(t){De(e,t);function e(n,r,i){var o=t.call(this)||this;if(o.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},rm(r))o.typeName=r.typeName,o.message=r.message,o[nn]=r[nn],o.parsedStack=r.parsedStack,o.hasFullStack=r.hasFullStack;else{var a=r,s=a&&a.evt;yt(a)||(a=a[vi]||s||a),o.typeName=Mt(n,_s(a))||fn,o.message=ml(n,Eh(r||a,o.typeName))||fn;var c=r[xs]||Rh(r);o.parsedStack=sm(c),o[nn]=jd(n,am(c)),o.hasFullStack=Qe(o.parsedStack)&&o.parsedStack.length>0,i&&(i.typeName=i.typeName||o.typeName)}return o}return u(e,"e"),e.prototype.toInterface=function(){var n=this.parsedStack instanceof Array&&jo(this.parsedStack,function(i){return i.toInterface()}),r={id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this[nn],parsedStack:n||void 0};return r},e.CreateFromInterface=function(n,r){var i=r.parsedStack instanceof Array&&jo(r.parsedStack,function(a){return Es.CreateFromInterface(a)})||r.parsedStack,o=new e(n,Nr({},r,{parsedStack:i}));return o},e}(Ih),Es=function(t){De(e,t);function e(n,r){var i=t.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},typeof n=="string"){var o=n;i.level=r,i.method=Dh,i.assembly=bt(o),i.fileName="",i.line=0;var a=o.match(e.regex);a&&a.length>=5&&(i.method=bt(a[2])||i.method,i.fileName=bt(a[4]),i.line=parseInt(a[5])||0)}else i.level=n.level,i.method=n.method,i.assembly=n.assembly,i.fileName=n.fileName,i.line=n.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=e.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}return u(e,"e"),e.CreateFromInterface=function(n){return new e(n,null)},e.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}(_h)}),Th,lm=L(()=>{Th=function(){function t(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}}return u(t,"t"),t}()}),Ll,um=L(()=>{(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(Ll||(Ll={}))}),Ah,dm=L(()=>{um(),Ah=function(){function t(){this.kind=Ll.Measurement}return u(t,"t"),t}()}),Ph,hm=L(()=>{Me(),dm(),Ph=function(t){De(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},n}return u(e,"e"),e}(Ah)}),Qn,fm=L(()=>{Me(),lm(),Dn(),hm(),Tn(),Qn=function(t){De(e,t);function e(n,r,i,o,a,s,c,l){var d=t.call(this)||this;d.aiDataContract={ver:1,metrics:1,properties:0};var h=new Ph;return h.count=o>0?o:void 0,h.max=isNaN(s)||s===null?void 0:s,h.min=isNaN(a)||a===null?void 0:a,h.name=Mt(n,r)||fn,h.value=i,d.metrics=[h],d.properties=Or(n,c),d.measurements=Hr(n,l),d}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}(Th)}),ks,Ul=L(()=>{Me(),Ch(),ks=function(t){De(e,t);function e(){var n=t.call(this)||this;return n.ver=2,n.properties={},n.measurements={},n}return u(e,"e"),e}(Tl)}),Fn,gm=L(()=>{Me(),Ul(),Dn(),ms(),Tn(),Fn=function(t){De(e,t);function e(n,r,i,o,a,s,c){var l=t.call(this)||this;return l.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},l.id=Gd(n,c),l.url=ta(n,i),l.name=Mt(n,r)||fn,isNaN(o)||(l.duration=pr(o)),l.properties=Or(n,a),l.measurements=Hr(n,s),l}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(ks)}),Fh,pm=L(()=>{Fh=function(){function t(){this.ver=2,this.success=!0,this.properties={},this.measurements={}}return u(t,"t"),t}()}),Xn,mm=L(()=>{Me(),Dn(),gh(),pm(),ms(),Xn=function(t){De(e,t);function e(n,r,i,o,a,s,c,l,d,h,g,p){d===void 0&&(d="Ajax");var y=t.call(this)||this;y.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},y.id=r,y.duration=pr(a),y.success=s,y.resultCode=c+"",y.type=Mt(n,d);var m=Qp(n,i,l,o);return y.data=ta(n,o)||m.data,y.target=Mt(n,m.target),h&&(y.target=y.target+" | "+h),y.name=Mt(n,m.name),y.properties=Or(n,g),y.measurements=Hr(n,p),y}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(Fh)}),Mh,vm=L(()=>{Mh=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return u(t,"t"),t}()}),mr,wm=L(()=>{Me(),vm(),Dn(),Tn(),mr=function(t){De(e,t);function e(n,r,i,o,a){var s=t.call(this)||this;return s.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},r=r||fn,s.message=ml(n,r),s.properties=Or(n,o),s.measurements=Hr(n,a),i&&(s.severityLevel=i),s}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}(Mh)}),Nh,ym=L(()=>{Me(),Ul(),Nh=function(t){De(e,t);function e(){var n=t.call(this)||this;return n.ver=2,n.properties={},n.measurements={},n}return u(e,"e"),e}(ks)}),vr,bm=L(()=>{Me(),ym(),Dn(),Tn(),vr=function(t){De(e,t);function e(n,r,i,o,a,s,c){var l=t.call(this)||this;return l.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},l.url=ta(n,i),l.name=Mt(n,r)||fn,l.properties=Or(n,a),l.measurements=Hr(n,s),c&&(l.domProcessing=c.domProcessing,l.duration=c.duration,l.networkConnect=c.networkConnect,l.perfTotal=c.perfTotal,l.receivedResponse=c.receivedResponse,l.sentRequest=c.sentRequest),l}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(Nh)}),wr,Sm=L(()=>{Me(),bh(),wr=function(t){De(e,t);function e(n,r){var i=t.call(this)||this;return i.aiDataContract={baseType:1,baseData:1},i.baseType=n,i.baseData=r,i}return u(e,"e"),e}(Rl)}),ia,Cm=L(()=>{(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(ia||(ia={}))}),Lh,_m=L(()=>{Se(),Lh=function(){function t(){}return u(t,"t"),t.getConfig=function(e,n,r,i){i===void 0&&(i=!1);var o;return r&&e.extensionConfig&&e.extensionConfig[r]&&!C(e.extensionConfig[r][n])?o=e.extensionConfig[r][n]:o=e[n],C(o)?i:o},t}()});function Vr(t){var e="ai."+t+".";return function(n){return e+n}}u(Vr,"er");var so,ot,oa,wi,Rs,yr,qr,co,Ds,Uh=L(()=>{Me(),Se(),so=Vr("application"),ot=Vr("device"),oa=Vr("location"),wi=Vr("operation"),Rs=Vr("session"),yr=Vr("user"),qr=Vr("cloud"),co=Vr("internal"),Ds=function(t){De(e,t);function e(){return t.call(this)||this}return u(e,"e"),e}(wp({applicationVersion:so("ver"),applicationBuild:so("build"),applicationTypeId:so("typeId"),applicationId:so("applicationId"),applicationLayer:so("layer"),deviceId:ot("id"),deviceIp:ot("ip"),deviceLanguage:ot("language"),deviceLocale:ot("locale"),deviceModel:ot("model"),deviceFriendlyName:ot("friendlyName"),deviceNetwork:ot("network"),deviceNetworkName:ot("networkName"),deviceOEMName:ot("oemName"),deviceOS:ot("os"),deviceOSVersion:ot("osVersion"),deviceRoleInstance:ot("roleInstance"),deviceRoleName:ot("roleName"),deviceScreenResolution:ot("screenResolution"),deviceType:ot("type"),deviceMachineName:ot("machineName"),deviceVMName:ot("vmName"),deviceBrowser:ot("browser"),deviceBrowserVersion:ot("browserVersion"),locationIp:oa("ip"),locationCountry:oa("country"),locationProvince:oa("province"),locationCity:oa("city"),operationId:wi("id"),operationName:wi("name"),operationParentId:wi("parentId"),operationRootId:wi("rootId"),operationSyntheticSource:wi("syntheticSource"),operationCorrelationVector:wi("correlationVector"),sessionId:Rs("id"),sessionIsFirst:Rs("isFirst"),sessionIsNew:Rs("isNew"),userAccountAcquisitionDate:yr("accountAcquisitionDate"),userAccountId:yr("accountId"),userAgent:yr("userAgent"),userId:yr("id"),userStoreRegion:yr("storeRegion"),userAuthUserId:yr("authUserId"),userAnonymousUserAcquisitionDate:yr("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:yr("authUserAcquisitionDate"),cloudName:qr("name"),cloudRole:qr("role"),cloudRoleVer:qr("roleVer"),cloudRoleInstance:qr("roleInstance"),cloudEnvironment:qr("environment"),cloudLocation:qr("location"),cloudDeploymentUnit:qr("deploymentUnit"),internalNodeName:co("nodeName"),internalSdkVersion:co("sdkVersion"),internalAgentVersion:co("agentVersion"),internalSnippet:co("snippet"),internalSdkSrc:co("sdkSrc")}))}),Yn,xm=L(()=>{Dn(),Se(),Tn(),Yn=function(){function t(){}return u(t,"t"),t.create=function(e,n,r,i,o,a){if(r=Mt(i,r)||fn,C(e)||C(n)||C(r))throw Error("Input doesn't contain all required fields");var s={name:r,time:kn(new Date),iKey:"",ext:a||{},tags:[],data:{},baseType:n,baseData:e};return C(o)||pe(o,function(c,l){s.data[c]=l}),s},t}()}),Ut,He,Im=L(()=>{Uh(),Ut={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},He=new Ds}),lo,Ts,Ol,ht=L(()=>{gh(),Xp(),qd(),Tn(),bh(),yh(),Jp(),Zp(),cm(),fm(),gm(),Ul(),mm(),wm(),bm(),Sm(),Cm(),_m(),Uh(),Dn(),xm(),Im(),Zd(),ms(),Xd(),oh(),uh(),lo="AppInsightsPropertiesPlugin",Ts="AppInsightsChannelPlugin",Ol="ApplicationInsightsAnalytics"}),Oh,Em=L(()=>{ht(),Se(),et(),Oh=function(){function t(e,n,r,i){Ge(t,this,function(o){var a=null,s=[],c=!1,l;r&&(l=r.logger);function d(){r&&fe(r.getTransmissionControls(),function(g){fe(g,function(p){return p.flush(!0)})})}u(d,"l");function h(g){s.push(g),a||(a=setInterval(function(){var p=s.slice(0),y=!1;s=[],fe(p,function(m){m()?y=!0:s.push(m)}),s.length===0&&(clearInterval(a),a=null),y&&d()},100))}u(h,"f"),o.trackPageView=function(g,p){var y=g.name;if(C(y)||typeof y!="string"){var m=jn();y=g.name=m&&m.title||""}var v=g.uri;if(C(v)||typeof v!="string"){var S=li();v=g.uri=S&&S.href||""}if(!i.isPerformanceTimingSupported()){e.sendPageViewInternal(g,p),d(),l.throwInternal(V.WARNING,W.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var w=!1,x,E=i.getPerformanceTiming().navigationStart;E>0&&(x=Nt(E,+new Date),i.shouldCollectDuration(x)||(x=void 0));var I;!C(p)&&!C(p.duration)&&(I=p.duration),(n||!isNaN(I))&&(isNaN(I)&&(p||(p={}),p.duration=x),e.sendPageViewInternal(g,p),d(),w=!0);var D=6e4;p||(p={}),h(function(){var B=!1;try{if(i.isPerformanceTimingDataReady()){B=!0;var P={name:y,uri:v};i.populatePageViewPerformanceEvent(P),!P.isValid&&!w?(p.duration=x,e.sendPageViewInternal(g,p)):(w||(p.duration=P.durationMs,e.sendPageViewInternal(g,p)),c||(e.sendPageViewPerformanceInternal(P,p),c=!0))}else E>0&&Nt(E,+new Date)>D&&(B=!0,w||(p.duration=D,e.sendPageViewInternal(g,p)))}catch(G){l.throwInternal(V.CRITICAL,W.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Te(G),{exception:we(G)})}return B})}})}return u(t,"t"),t}()}),Hh,Wh,km=L(()=>{ht(),Se(),Hh=function(){function t(e,n){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=n,this._logger=e}return u(t,"t"),t.prototype.trackPreviousPageVisit=function(e,n){try{var r=this.restartPageVisitTimer(e,n);r&&this.pageVisitTimeTrackingHandler(r.pageName,r.pageUrl,r.pageVisitTime)}catch(i){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+we(i))}},t.prototype.restartPageVisitTimer=function(e,n){try{var r=this.stopPageVisitTimer();return this.startPageVisitTimer(e,n),r}catch(i){return this._logger.warnToConsole("Call to restart failed: "+we(i)),null}},t.prototype.startPageVisitTimer=function(e,n){try{if(oo()){bs(this._logger,this.prevPageVisitDataKeyName)!=null&&zn("Cannot call startPageVisit consecutively without first calling stopPageVisit");var r=new Wh(e,n),i=Rn().stringify(r);Ss(this._logger,this.prevPageVisitDataKeyName,i)}}catch(o){this._logger.warnToConsole("Call to start failed: "+we(o))}},t.prototype.stopPageVisitTimer=function(){try{if(oo()){var e=dn(),n=bs(this._logger,this.prevPageVisitDataKeyName);if(n&&Ki()){var r=Rn().parse(n);return r.pageVisitTime=e-r.pageVisitStartTime,ih(this._logger,this.prevPageVisitDataKeyName),r}else return null}return null}catch(i){return this._logger.warnToConsole("Stop page visit timer failed: "+we(i)),null}},t}(),Wh=function(){function t(e,n){this.pageVisitStartTime=dn(),this.pageName=e,this.pageUrl=n}return u(t,"t"),t}()}),Bh,Rm=L(()=>{ht(),Se(),Bh=function(){function t(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return u(t,"t"),t.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var n=this.getPerformanceNavigationTiming(),r=this.getPerformanceTiming(),i=0,o=0,a=0,s=0,c=0;(n||r)&&(n?(i=n.duration,o=n.startTime===0?n.connectEnd:Nt(n.startTime,n.connectEnd),a=Nt(n.requestStart,n.responseStart),s=Nt(n.responseStart,n.responseEnd),c=Nt(n.responseEnd,n.loadEventEnd)):(i=Nt(r.navigationStart,r.loadEventEnd),o=Nt(r.navigationStart,r.connectEnd),a=Nt(r.requestStart,r.responseStart),s=Nt(r.responseStart,r.responseEnd),c=Nt(r.responseEnd,r.loadEventEnd)),i===0?this._logger.throwInternal(V.WARNING,W.ErrorPVCalc,"error calculating page view performance.",{total:i,network:o,request:a,response:s,dom:c}):this.shouldCollectDuration(i,o,a,s,c)?i<Math.floor(o)+Math.floor(a)+Math.floor(s)+Math.floor(c)?this._logger.throwInternal(V.WARNING,W.ClientPerformanceMathError,"client performance math error.",{total:i,network:o,request:a,response:s,dom:c}):(e.durationMs=i,e.perfTotal=e.duration=pr(i),e.networkConnect=pr(o),e.sentRequest=pr(a),e.receivedResponse=pr(s),e.domProcessing=pr(c),e.isValid=!0):this._logger.throwInternal(V.WARNING,W.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:o,request:a,response:s,dom:c}))},t.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?hr().timing:null},t.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?hr().getEntriesByType("navigation")[0]:null},t.prototype.isPerformanceNavigationTimingSupported=function(){var e=hr();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},t.prototype.isPerformanceTimingSupported=function(){var e=hr();return e&&e.timing},t.prototype.isPerformanceTimingDataReady=function(){var e=hr(),n=e?e.timing:0;return n&&n.domainLookupStart>0&&n.navigationStart>0&&n.responseStart>0&&n.requestStart>0&&n.loadEventEnd>0&&n.responseEnd>0&&n.connectEnd>0&&n.domLoading>0},t.prototype.shouldCollectDuration=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Gn()||{},i=["googlebot","adsbot-google","apis-google","mediapartners-google"],o=r.userAgent,a=!1;if(o)for(var s=0;s<i.length;s++)a=a||o.toLowerCase().indexOf(i[s])!==-1;if(a)return!1;for(var s=0;s<e.length;s++)if(e[s]<0||e[s]>=this.MAX_DURATION_ALLOWED)return!1;return!0},t}()});function aa(t,e){t&&t.dispatchEvent&&e&&t.dispatchEvent(e)}u(aa,"Pn");var Hl,As,Wl,Bl,Dm=L(()=>{Me(),ht(),Se(),Em(),km(),Rm(),et(),Hl="duration",As="event",Wl=function(t){De(e,t);function e(){var n=t.call(this)||this;n.identifier=Ol,n.priority=180,n.autoRoutePVDelay=500;var r,i,o,a=0,s,c;return Ge(e,n,function(l,d){var h=li(!0);s=h&&h.href||"",l.getCookieMgr=function(){return Qc(l.core)},l.processTelemetry=function(v,S){Xi(l.core,function(){return l.identifier+":processTelemetry"},function(){var w=!1,x=l._telemetryInitializers.length;S=l._getTelCtx(S);for(var E=0;E<x;++E){var I=l._telemetryInitializers[E];if(I)try{if(I.apply(null,[v])===!1){w=!0;break}}catch(D){S.diagLog().throwInternal(V.CRITICAL,W.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Te(D),{exception:we(D)},!0)}}w||l.processNext(v,S)},function(){return{item:v}},!v.sync)},l.trackEvent=function(v,S){try{var w=Yn.create(v,Pn.dataType,Pn.envelopeType,l.diagLog(),S);l.core.track(w)}catch(x){l.diagLog().throwInternal(V.WARNING,W.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Te(x),{exception:we(x)})}},l.startTrackEvent=function(v){try{r.start(v)}catch(S){l.diagLog().throwInternal(V.CRITICAL,W.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Te(S),{exception:we(S)})}},l.stopTrackEvent=function(v,S,w){try{r.stop(v,void 0,S)}catch(x){l.diagLog().throwInternal(V.CRITICAL,W.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Te(x),{exception:we(x)})}},l.trackTrace=function(v,S){try{var w=Yn.create(v,mr.dataType,mr.envelopeType,l.diagLog(),S);l.core.track(w)}catch(x){l.diagLog().throwInternal(V.WARNING,W.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Te(x),{exception:we(x)})}},l.trackMetric=function(v,S){try{var w=Yn.create(v,Qn.dataType,Qn.envelopeType,l.diagLog(),S);l.core.track(w)}catch(x){l.diagLog().throwInternal(V.CRITICAL,W.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Te(x),{exception:we(x)})}},l.trackPageView=function(v,S){try{var w=v||{};l._pageViewManager.trackPageView(w,Nr({},w.properties,w.measurements,S)),l.config.autoTrackPageVisitTime&&l._pageVisitTimeManager.trackPreviousPageVisit(w.name,w.uri)}catch(x){l.diagLog().throwInternal(V.CRITICAL,W.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Te(x),{exception:we(x)})}},l.sendPageViewInternal=function(v,S,w){var x=jn();x&&(v.refUri=v.refUri===void 0?x.referrer:v.refUri);var E=Yn.create(v,Fn.dataType,Fn.envelopeType,l.diagLog(),S,w);l.core.track(E),a=0},l.sendPageViewPerformanceInternal=function(v,S,w){var x=Yn.create(v,vr.dataType,vr.envelopeType,l.diagLog(),S,w);l.core.track(x)},l.trackPageViewPerformance=function(v,S){try{l._pageViewPerformanceManager.populatePageViewPerformanceEvent(v),l.sendPageViewPerformanceInternal(v,S)}catch(w){l.diagLog().throwInternal(V.CRITICAL,W.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Te(w),{exception:we(w)})}},l.startTrackPage=function(v){try{if(typeof v!="string"){var S=jn();v=S&&S.title||""}i.start(v)}catch(w){l.diagLog().throwInternal(V.CRITICAL,W.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Te(w),{exception:we(w)})}},l.stopTrackPage=function(v,S,w,x){try{if(typeof v!="string"){var E=jn();v=E&&E.title||""}if(typeof S!="string"){var I=li();S=I&&I.href||""}i.stop(v,S,w,x),l.config.autoTrackPageVisitTime&&l._pageVisitTimeManager.trackPreviousPageVisit(v,S)}catch(D){l.diagLog().throwInternal(V.CRITICAL,W.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Te(D),{exception:we(D)})}},l.sendExceptionInternal=function(v,S,w){var x=v.exception||v.error||new Error(fn),E=new Lt(l.diagLog(),x,v.properties||S,v.measurements,v.severityLevel,v.id).toInterface(),I=Yn.create(E,Lt.dataType,Lt.envelopeType,l.diagLog(),S,w);l.core.track(I)},l.trackException=function(v,S){try{l.sendExceptionInternal(v,S)}catch(w){l.diagLog().throwInternal(V.CRITICAL,W.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Te(w),{exception:we(w)})}},l._onerror=function(v){var S=v&&v.error,w=v&&v.evt;try{if(!w){var x=Go();x&&(w=x[As])}var E=v&&v.url||(jn()||{}).URL,I=v.errorSrc||"window.onerror@"+E+":"+(v.lineNumber||0)+":"+(v.columnNumber||0),D={errorSrc:I,url:E,lineNumber:v.lineNumber||0,columnNumber:v.columnNumber||0,message:v.message};Jd(v.message,v.url,v.lineNumber,v.columnNumber,v.error)?m(Lt.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",E,v.lineNumber||0,v.columnNumber||0,S,w,null,I),D):(v.errorSrc||(v.errorSrc=I),l.trackException({exception:v,severityLevel:ia.Error},D))}catch(P){var B=S?S.name+", "+S.message:"null";l.diagLog().throwInternal(V.CRITICAL,W.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Te(P),{exception:we(P),errorString:B})}},l.addTelemetryInitializer=function(v){l._telemetryInitializers.push(v)},l.initialize=function(v,S,w,x){if(!l.isInitialized()){if(C(S))throw Error("Error initializing");d.initialize(v,S,w,x),l.setInitialized(!1);var E=l._getTelCtx(),I=l.identifier;l.config=E.getExtCfg(I);var D=e.getDefaultConfig(v);D!==void 0&&pe(D,function(z,ne){l.config[z]=E.getConfig(I,z,ne),l.config[z]===void 0&&(l.config[z]=ne)}),l.config.isStorageUseDisabled&&eh();var B={instrumentationKey:function(){return v.instrumentationKey},accountId:function(){return l.config.accountId||v.accountId},sessionRenewalMs:function(){return l.config.sessionRenewalMs||v.sessionRenewalMs},sessionExpirationMs:function(){return l.config.sessionExpirationMs||v.sessionExpirationMs},sampleRate:function(){return l.config.samplingPercentage||v.samplingPercentage},sdkExtension:function(){return l.config.sdkExtension||v.sdkExtension},isBrowserLinkTrackingEnabled:function(){return l.config.isBrowserLinkTrackingEnabled||v.isBrowserLinkTrackingEnabled},appId:function(){return l.config.appId||v.appId}};l._pageViewPerformanceManager=new Bh(l.core),l._pageViewManager=new Oh(n,l.config.overridePageViewDuration,l.core,l._pageViewPerformanceManager),l._pageVisitTimeManager=new Hh(l.diagLog(),function(z,ne,oe){return g(z,ne,oe)}),l._telemetryInitializers=l._telemetryInitializers||[],p(B),r=new Bl(l.diagLog(),"trackEvent"),r.action=function(z,ne,oe,he){he||(he={}),he[Hl]=oe.toString(),l.trackEvent({name:z,properties:he})},i=new Bl(l.diagLog(),"trackPageView"),i.action=function(z,ne,oe,he,Ce){C(he)&&(he={}),he[Hl]=oe.toString();var Oe={name:z,uri:ne,properties:he,measurements:Ce};l.sendPageViewInternal(Oe,he)};var P=Go(),G=_p(),ee=li(!0),te=n;if(l.config.disableExceptionTracking===!1&&!l.config.autoExceptionInstrumented&&P){var X="onerror",ae=P[X];P.onerror=function(z,ne,oe,he,Ce){var Oe=P[As],mn=ae&&ae(z,ne,oe,he,Ce);return mn!==!0&&te._onerror(Lt.CreateAutoException(z,ne,oe,he,Ce,Oe)),mn},l.config.autoExceptionInstrumented=!0}if(l.config.disableExceptionTracking===!1&&l.config.enableUnhandledPromiseRejectionTracking===!0&&!l.config.autoUnhandledPromiseInstrumented&&P){var k="onunhandledrejection",O=P[k];P[k]=function(z){var ne=P[As],oe=O&&O.call(P,z);return oe!==!0&&te._onerror(Lt.CreateAutoException(z.reason.toString(),ee?ee.href:"",0,0,z,ne)),oe},l.config.autoUnhandledPromiseInstrumented=!0}if(l.config.enableAutoRouteTracking===!0&&G&&Q(G.pushState)&&Q(G.replaceState)&&P&&typeof Event!="undefined"){var j=n;fe(w,function(z){z.identifier===lo&&(o=z)}),G.pushState=function(z){return function(){var ne=z.apply(this,arguments);return aa(P,ro(j.config.namePrefix+"pushState")),aa(P,ro(j.config.namePrefix+"locationchange")),ne}}(G.pushState),G.replaceState=function(z){return function(){var ne=z.apply(this,arguments);return aa(P,ro(j.config.namePrefix+"replaceState")),aa(P,ro(j.config.namePrefix+"locationchange")),ne}}(G.replaceState),P.addEventListener&&(P.addEventListener(j.config.namePrefix+"popstate",function(){aa(P,ro(j.config.namePrefix+"locationchange"))}),P.addEventListener(j.config.namePrefix+"locationchange",function(){if(o&&o.context&&o.context.telemetryTrace){o.context.telemetryTrace.traceID=Kn();var z="_unknown_";ee&&ee.pathname&&(z=ee.pathname+(ee.hash||"")),o.context.telemetryTrace.name=z}c&&(s=c),c=ee&&ee.href||"",setTimeout(function(ne){j.trackPageView({refUri:ne,properties:{duration:0}})}.bind(n,s),j.autoRoutePVDelay)}))}l.setInitialized(!0)}};function g(v,S,w){var x={PageName:v,PageUrl:S};l.trackMetric({name:"PageVisitTime",average:w,max:w,min:w,sampleCount:1},x)}u(g,"m");function p(v){if(!v.isBrowserLinkTrackingEnabled()){var S=["/browserLinkSignalR/","/__browserLink/"],w=u(function(x){if(x.baseType===Xn.dataType){var E=x.baseData;if(E){for(var I=0;I<S.length;I++)if(E.target&&E.target.indexOf(S[I])>=0)return!1}}return!0},"y");y(w)}}u(p,"C");function y(v){l._telemetryInitializers.push(v)}u(y,"E");function m(v,S){var w=Yn.create(v,Lt.dataType,Lt.envelopeType,l.diagLog(),S);l.core.track(w)}u(m,"b")}),n}return u(e,"e"),e.getDefaultConfig=function(n){return n||(n={}),n.sessionRenewalMs=30*60*1e3,n.sessionExpirationMs=24*60*60*1e3,n.disableExceptionTracking=Ue(n.disableExceptionTracking),n.autoTrackPageVisitTime=Ue(n.autoTrackPageVisitTime),n.overridePageViewDuration=Ue(n.overridePageViewDuration),n.enableUnhandledPromiseRejectionTracking=Ue(n.enableUnhandledPromiseRejectionTracking),(isNaN(n.samplingPercentage)||n.samplingPercentage<=0||n.samplingPercentage>=100)&&(n.samplingPercentage=100),n.isStorageUseDisabled=Ue(n.isStorageUseDisabled),n.isBrowserLinkTrackingEnabled=Ue(n.isBrowserLinkTrackingEnabled),n.enableAutoRouteTracking=Ue(n.enableAutoRouteTracking),n.namePrefix=n.namePrefix||"",n.enableDebug=Ue(n.enableDebug),n.disableFlushOnBeforeUnload=Ue(n.disableFlushOnBeforeUnload),n.disableFlushOnUnload=Ue(n.disableFlushOnUnload,n.disableFlushOnBeforeUnload),n},e.Version="2.6.4",e}(hi),Bl=function(){function t(e,n){var r=this,i={};r.start=function(o){typeof i[o]!="undefined"&&e.throwInternal(V.WARNING,W.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:o,key:o},!0),i[o]=+new Date},r.stop=function(o,a,s,c){var l=i[o];if(isNaN(l))e.throwInternal(V.WARNING,W.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:o,key:o},!0);else{var d=+new Date,h=Nt(l,d);r.action(o,a,h,s,c)}delete i[o],i[o]=void 0}}return u(t,"t"),t}()}),$h=L(()=>{Dm()}),Vh,qh,Tm=L(()=>{ht(),Se(),et(),Vh=function(){function t(e){var n=[];Ge(t,this,function(r){r.enqueue=function(i){n.push(i)},r.count=function(){return n.length},r.clear=function(){n.length=0},r.getItems=function(){return n.slice(0)},r.batchPayloads=function(i){if(i&&i.length>0){var o=e.emitLineDelimitedJson()?i.join(`
`):"["+i.join(",")+"]";return o}return null},r.markAsSent=function(i){r.clear()},r.clearSent=function(i){}})}return u(t,"t"),t}(),qh=function(){function t(e,n){var r=!1,i;Ge(t,this,function(o){var a=l(t.BUFFER_KEY),s=l(t.SENT_BUFFER_KEY);i=a.concat(s),i.length>t.MAX_BUFFER_SIZE&&(i.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,i),o.enqueue=function(h){if(i.length>=t.MAX_BUFFER_SIZE){r||(e.throwInternal(V.WARNING,W.SessionStorageBufferFull,"Maximum buffer size reached: "+i.length,!0),r=!0);return}i.push(h),d(t.BUFFER_KEY,i)},o.count=function(){return i.length},o.clear=function(){i=[],d(t.BUFFER_KEY,[]),d(t.SENT_BUFFER_KEY,[]),r=!1},o.getItems=function(){return i.slice(0)},o.batchPayloads=function(h){if(h&&h.length>0){var g=n.emitLineDelimitedJson()?h.join(`
`):"["+h.join(",")+"]";return g}return null},o.markAsSent=function(h){i=c(h,i),d(t.BUFFER_KEY,i);var g=l(t.SENT_BUFFER_KEY);g instanceof Array&&h instanceof Array&&(g=g.concat(h),g.length>t.MAX_BUFFER_SIZE&&(e.throwInternal(V.CRITICAL,W.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+g.length,!0),g.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,g))},o.clearSent=function(h){var g=l(t.SENT_BUFFER_KEY);g=c(h,g),d(t.SENT_BUFFER_KEY,g)};function c(h,g){var p=[];return fe(g,function(y){!Q(y)&&qn(h,y)===-1&&p.push(y)}),p}u(c,"s");function l(h){var g=h;try{g=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+g:g;var p=bs(e,g);if(p){var y=Rn().parse(p);if(le(y)&&(y=Rn().parse(y)),y&&Qe(y))return y}}catch(m){e.throwInternal(V.CRITICAL,W.FailedToRestoreStorageBuffer," storage key: "+g+", "+Te(m),{exception:we(m)})}return[]}u(l,"c");function d(h,g){var p=h;try{p=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+p:p;var y=JSON.stringify(g);Ss(e,p,y)}catch(m){Ss(e,p,JSON.stringify([])),e.throwInternal(V.WARNING,W.FailedToSetStorageBuffer," storage key: "+p+", "+Te(m)+". Buffer cleared",{exception:we(m)})}}u(d,"l")})}return u(t,"t"),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}()});function at(t,e,n){return Ie(t,e,n,Dc)}u(at,"xe");var Ps,qe,ft,$l,Ke,zh,Vl,jh,Gh,Kh,Qh,Xh,Am=L(()=>{Me(),ht(),Se(),Ps="baseType",qe="baseData",ft="properties",$l="true",Ke=function(){function t(){}return u(t,"t"),t.extractPropsAndMeasurements=function(e,n,r){C(e)||pe(e,function(i,o){tn(o)?r[i]=o:le(o)?n[i]=o:Ki()&&(n[i]=Rn().stringify(o))})},t.createEnvelope=function(e,n,r,i){var o=new Dl(e,i,n);at(o,"sampleRate",r[vs]),(r[qe]||{}).startTime&&(o.time=kn(r[qe].startTime)),o.iKey=r.iKey;var a=r.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",a),t.extractPartAExtensions(r,o),r.tags=r.tags||[],Zu(o)},t.extractPartAExtensions=function(e,n){var r=n.tags=n.tags||{},i=e.ext=e.ext||{},o=e.tags=e.tags||[],a=i.user;a&&(at(r,He.userAuthUserId,a.authId),at(r,He.userId,a.id||a.localId));var s=i.app;s&&at(r,He.sessionId,s.sesId);var c=i.device;c&&(at(r,He.deviceId,c.id||c.localId),at(r,He.deviceType,c.deviceClass),at(r,He.deviceIp,c.ip),at(r,He.deviceModel,c.model),at(r,He.deviceType,c.deviceType));var l=e.ext.web;if(l){at(r,He.deviceLanguage,l.browserLang),at(r,He.deviceBrowserVersion,l.browserVer),at(r,He.deviceBrowser,l.browser);var d=n.data=n.data||{},h=d[qe]=d[qe]||{},g=h[ft]=h[ft]||{};at(g,"domain",l.domain),at(g,"isManual",l.isManual?$l:null),at(g,"screenRes",l.screenRes),at(g,"userConsent",l.userConsent?$l:null)}var p=i.os;p&&at(r,He.deviceOS,p.name);var y=i.trace;y&&(at(r,He.operationParentId,y.parentID),at(r,He.operationName,y.name),at(r,He.operationId,y.traceID));for(var m={},v=o.length-1;v>=0;v--){var S=o[v];pe(S,function(x,E){m[x]=E}),o.splice(v,1)}pe(o,function(x,E){m[x]=E});var w=Nr({},r,m);w[He.internalSdkVersion]||(w[He.internalSdkVersion]="javascript:"+t.Version),n.tags=Zu(w)},t.prototype.Init=function(e,n){this._logger=e,C(n[qe])&&this._logger.throwInternal(V.CRITICAL,W.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},t.Version="2.6.4",t}(),zh=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe].measurements||{},o=r[qe][ft]||{};Ke.extractPropsAndMeasurements(r.data,o,i);var a=r[qe];if(C(a))return n.warnToConsole("Invalid input for dependency data"),null;var s=a[ft]&&a[ft][ws]?a[ft][ws]:"GET",c=new Xn(n,a.id,a.target,a.name,a.duration,a.success,a.responseCode,s,a.type,a.correlationContext,o,i),l=new wr(Xn.dataType,c);return Ke.createEnvelope(n,Xn.envelopeType,r,l)},e.DependencyEnvelopeCreator=new e,e}(Ke),Vl=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i={},o={};r[Ps]!==Pn.dataType&&(i.baseTypeSource=r[Ps]),r[Ps]===Pn.dataType?(i=r[qe][ft]||{},o=r[qe].measurements||{}):r[qe]&&Ke.extractPropsAndMeasurements(r[qe],i,o),Ke.extractPropsAndMeasurements(r.data,i,o);var a=r[qe].name,s=new Pn(n,a,i,o),c=new wr(Pn.dataType,s);return Ke.createEnvelope(n,Pn.envelopeType,r,c)},e.EventEnvelopeCreator=new e,e}(Ke),jh=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe].measurements||{},o=r[qe][ft]||{};Ke.extractPropsAndMeasurements(r.data,o,i);var a=r[qe],s=Lt.CreateFromInterface(n,a,o,i),c=new wr(Lt.dataType,s);return Ke.createEnvelope(n,Lt.envelopeType,r,c)},e.ExceptionEnvelopeCreator=new e,e}(Ke),Gh=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe],o=i[ft]||{},a=i.measurements||{};Ke.extractPropsAndMeasurements(r.data,o,a);var s=new Qn(n,i.name,i.average,i.sampleCount,i.min,i.max,o,a),c=new wr(Qn.dataType,s);return Ke.createEnvelope(n,Qn.envelopeType,r,c)},e.MetricEnvelopeCreator=new e,e}(Ke),Kh=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i="duration",o,a=r[qe];!C(a)&&!C(a[ft])&&!C(a[ft][i])?(o=a[ft][i],delete a[ft][i]):!C(r.data)&&!C(r.data[i])&&(o=r.data[i],delete r.data[i]);var s=r[qe],c;((r.ext||{}).trace||{}).traceID&&(c=r.ext.trace.traceID);var l=s.id||c,d=s.name,h=s.uri,g=s[ft]||{},p=s.measurements||{};if(C(s.refUri)||(g.refUri=s.refUri),C(s.pageType)||(g.pageType=s.pageType),C(s.isLoggedIn)||(g.isLoggedIn=s.isLoggedIn.toString()),!C(s[ft])){var y=s[ft];pe(y,function(S,w){g[S]=w})}Ke.extractPropsAndMeasurements(r.data,g,p);var m=new Fn(n,d,h,o,g,p,l),v=new wr(Fn.dataType,m);return Ke.createEnvelope(n,Fn.envelopeType,r,v)},e.PageViewEnvelopeCreator=new e,e}(Ke),Qh=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe],o=i.name,a=i.uri||i.url,s=i[ft]||{},c=i.measurements||{};Ke.extractPropsAndMeasurements(r.data,s,c);var l=new vr(n,o,a,void 0,s,c,i),d=new wr(vr.dataType,l);return Ke.createEnvelope(n,vr.envelopeType,r,d)},e.PageViewPerformanceEnvelopeCreator=new e,e}(Ke),Xh=function(t){De(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe].message,o=r[qe].severityLevel,a=r[qe][ft]||{},s=r[qe].measurements||{};Ke.extractPropsAndMeasurements(r.data,a,s);var c=new mr(n,i,o,a,s),l=new wr(mr.dataType,c);return Ke.createEnvelope(n,mr.envelopeType,r,l)},e.TraceEnvelopeCreator=new e,e}(Ke)}),Yh,Pm=L(()=>{Se(),et(),Yh=function(){function t(e){Ge(t,this,function(n){n.serialize=function(a){var s=r(a,"root");try{return Rn().stringify(s)}catch(c){e.throwInternal(V.CRITICAL,W.CannotSerializeObject,c&&Q(c.toString)?c.toString():"Error serializing object",null,!0)}};function r(a,s){var c="__aiCircularRefCheck",l={};if(!a)return e.throwInternal(V.CRITICAL,W.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:s},!0),l;if(a[c])return e.throwInternal(V.WARNING,W.CircularReferenceDetected,"Circular reference detected while serializing object",{name:s},!0),l;if(!a.aiDataContract){if(s==="measurements")l=o(a,"number",s);else if(s==="properties")l=o(a,"string",s);else if(s==="tags")l=o(a,"string",s);else if(Qe(a))l=i(a,s);else{e.throwInternal(V.WARNING,W.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{Rn().stringify(a),l=a}catch(d){e.throwInternal(V.CRITICAL,W.CannotSerializeObject,d&&Q(d.toString)?d.toString():"Error serializing object",null,!0)}}return l}return a[c]=!0,pe(a.aiDataContract,function(d,h){var g=Q(h)?h()&1:h&1,p=Q(h)?h()&4:h&4,y=h&2,m=a[d]!==void 0,v=Ee(a[d])&&a[d]!==null;if(g&&!m&&!y)e.throwInternal(V.CRITICAL,W.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:d,name:s});else if(!p){var S=void 0;v?y?S=i(a[d],d):S=r(a[d],d):S=a[d],S!==void 0&&(l[d]=S)}}),delete a[c],l}u(r,"n");function i(a,s){var c;if(a)if(!Qe(a))e.throwInternal(V.CRITICAL,W.ItemNotInArray,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{c=[];for(var l=0;l<a.length;l++){var d=a[l],h=r(d,s+"["+l+"]");c.push(h)}}return c}u(i,"i");function o(a,s,c){var l;return a&&(l={},pe(a,function(d,h){if(s==="string")h===void 0?l[d]="undefined":h===null?l[d]="null":h.toString?l[d]=h.toString():l[d]="invalid field: toString() is not defined.";else if(s==="number")if(h===void 0)l[d]="undefined";else if(h===null)l[d]="null";else{var g=parseFloat(h);isNaN(g)?l[d]="NaN":l[d]=g}else l[d]="invalid field: "+c+" is of unknown type.",e.throwInternal(V.CRITICAL,l[d],null,!0)})),l}u(o,"a")})}return u(t,"t"),t}()}),Jh,ql,Fm=L(()=>{Se(),et(),Jh=function(){function t(){var e=Go(),n=jn(),r=!1,i=!0;Ge(t,this,function(o){try{if(e&&ea.Attach(e,"online",c)&&(ea.Attach(e,"offline",l),r=!0),n){var a=n.body||n;b(a.ononline)||(a.ononline=c,a.onoffline=l,r=!0)}if(r){var s=Gn();s&&!C(s.onLine)&&(i=s.onLine)}}catch(d){r=!1}o.isListening=r,o.isOnline=function(){var d=!0,h=Gn();return r?d=i:h&&!C(h.onLine)&&(d=h.onLine),d},o.isOffline=function(){return!o.isOnline()};function c(){i=!0}u(c,"s");function l(){i=!1}u(l,"c")})}return u(t,"t"),t.Offline=new t,t}(),ql=Jh.Offline}),Zh,Mm=L(()=>{Zh=function(){function t(){}return u(t,"t"),t.prototype.getHashCodeScore=function(e){var n=this.getHashCode(e)/t.INT_MAX_VALUE;return n*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e.length<t.MIN_INPUT_LENGTH;)e=e.concat(e);for(var n=5381,r=0;r<e.length;++r)n=(n<<5)+n+e.charCodeAt(r),n=n&n;return Math.abs(n)},t.INT_MAX_VALUE=2147483647,t.MIN_INPUT_LENGTH=8,t}()}),ef,Nm=L(()=>{Mm(),ht(),ef=function(){function t(){this.hashCodeGeneragor=new Zh,this.keys=new Ds}return u(t,"t"),t.prototype.getSamplingScore=function(e){var n=0;return e.tags&&e.tags[this.keys.userId]?n=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?n=this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?n=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?n=this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):n=Math.random()*100,n},t}()}),tf,Lm=L(()=>{Nm(),ht(),Se(),tf=function(){function t(e,n){this.INT_MAX_VALUE=2147483647,this._logger=n||is(null),(e>100||e<0)&&(this._logger.throwInternal(V.WARNING,W.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new ef}return u(t,"t"),t.prototype.isSampledIn=function(e){var n=this.sampleRate,r=!1;return n==null||n>=100||e.baseType===Qn.dataType?!0:(r=this.samplingScoreGenerator.getSamplingScore(e)<n,r)},t}()});function Fs(t){try{return t.responseText}catch(e){}return null}u(Fs,"Ci");var zl,Um=L(()=>{Me(),Tm(),Am(),Pm(),ht(),Se(),Fm(),Lm(),et(),zl=function(t){De(e,t);function e(){var n=t.call(this)||this;n.priority=1001,n.identifier=Ts,n._XMLHttpRequestSupported=!1;var r,i,o,a,s,c,l={};return Ge(e,n,function(d,h){function g(){zn("Method not implemented.")}u(g,"m"),d.pause=g,d.resume=g,d.flush=function(){try{d.triggerSend(!0,null,1)}catch(k){d.diagLog().throwInternal(V.CRITICAL,W.FlushFailed,"flush failed, telemetry will not be collected: "+Te(k),{exception:we(k)})}},d.onunloadFlush=function(){if((d._senderConfig.onunloadDisableBeacon()===!1||d._senderConfig.isBeaconApiDisabled()===!1)&&wl())try{d.triggerSend(!0,v,2)}catch(k){d.diagLog().throwInternal(V.CRITICAL,W.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Te(k),{exception:we(k)})}else d.flush()},d.teardown=g,d.addHeader=function(k,O){l[k]=O},d.initialize=function(k,O,j,z){h.initialize(k,O,j,z);var ne=d._getTelCtx(),oe=d.identifier;s=new Yh(O.logger),r=0,i=null,o=0,d._sender=null,c=0;var he=e._getDefaultAppInsightsChannelConfig();if(d._senderConfig=e._getEmptyAppInsightsChannelConfig(),pe(he,function(F,q){d._senderConfig[F]=function(){return ne.getConfig(oe,F,q())}}),d._buffer=d._senderConfig.enableSessionStorageBuffer()&&oo()?new qh(d.diagLog(),d._senderConfig):new Vh(d._senderConfig),d._sample=new tf(d._senderConfig.samplingPercentage(),d.diagLog()),ae(k)||d.diagLog().throwInternal(V.CRITICAL,W.InvalidInstrumentationKey,"Invalid Instrumentation key "+k.instrumentationKey),!Cs(d._senderConfig.endpointUrl())&&d._senderConfig.customHeaders()&&d._senderConfig.customHeaders().length>0&&fe(d._senderConfig.customHeaders(),function(F){n.addHeader(F.header,F.value)}),!d._senderConfig.isBeaconApiDisabled()&&wl())d._sender=v;else{var Ce=kt("XMLHttpRequest");if(Ce){var Oe=new Ce;"withCredentials"in Oe?(d._sender=S,d._XMLHttpRequestSupported=!0):typeof XDomainRequest!==_n&&(d._sender=G)}else{var mn=kt("fetch");mn&&(d._sender=w)}}},d.processTelemetry=function(k,O){O=d._getTelCtx(O);try{if(d._senderConfig.disableTelemetry())return;if(!k){O.diagLog().throwInternal(V.CRITICAL,W.CannotSendEmptyTelemetry,"Cannot send empty telemetry");return}if(k.baseData&&!k.baseType){O.diagLog().throwInternal(V.CRITICAL,W.InvalidEvent,"Cannot send telemetry without baseData and baseType");return}if(k.baseType||(k.baseType="EventData"),!d._sender){O.diagLog().throwInternal(V.CRITICAL,W.SenderNotInitialized,"Sender was not initialized");return}if(p(k))k[vs]=d._sample.sampleRate;else{O.diagLog().throwInternal(V.WARNING,W.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:d._sample.sampleRate});return}var j=e.constructEnvelope(k,d._senderConfig.instrumentationKey(),O.diagLog());if(!j){O.diagLog().throwInternal(V.CRITICAL,W.CreateEnvelopeError,"Unable to create an AppInsights envelope");return}var z=!1;if(k.tags&&k.tags[io]&&(fe(k.tags[io],function(Ce){try{Ce&&Ce(j)===!1&&(z=!0,O.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(Oe){O.diagLog().throwInternal(V.CRITICAL,W.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Te(Oe),{exception:we(Oe)},!0)}}),delete k.tags[io]),z)return;var ne=s.serialize(j),oe=d._buffer.getItems(),he=d._buffer.batchPayloads(oe);he&&he.length+ne.length>d._senderConfig.maxBatchSizeInBytes()&&d.triggerSend(!0,null,10),d._buffer.enqueue(ne),D()}catch(Ce){O.diagLog().throwInternal(V.WARNING,W.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Te(Ce),{exception:we(Ce)})}d.processNext(k,O)},d._xhrReadyStateChange=function(k,O,j){k.readyState===4&&y(k.status,O,k.responseURL,j,P(k),Fs(k)||k.response)},d.triggerSend=function(k,O,j){k===void 0&&(k=!0);try{if(d._senderConfig.disableTelemetry())d._buffer.clear();else{if(d._buffer.count()>0){var z=d._buffer.getItems();X(j||0,k),O?O.call(n,z,k):d._sender(z,k)}o=+new Date}clearTimeout(a),a=null,i=null}catch(oe){var ne=Lc();(!ne||ne>9)&&d.diagLog().throwInternal(V.CRITICAL,W.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Te(oe),{exception:we(oe)})}},d._onError=function(k,O,j){d.diagLog().throwInternal(V.WARNING,W.OnError,"Failed to send telemetry.",{message:O}),d._buffer.clearSent(k)},d._onPartialSuccess=function(k,O){for(var j=[],z=[],ne=O.errors.reverse(),oe=0,he=ne;oe<he.length;oe++){var Ce=he[oe],Oe=k.splice(Ce.index,1)[0];B(Ce.statusCode)?z.push(Oe):j.push(Oe)}k.length>0&&d._onSuccess(k,O.itemsAccepted),j.length>0&&d._onError(j,P(null,["partial success",O.itemsAccepted,"of",O.itemsReceived].join(" "))),z.length>0&&(E(z),d.diagLog().throwInternal(V.WARNING,W.TransmissionFailed,"Partial success. Delivered: "+k.length+", Failed: "+j.length+". Will retry to send "+z.length+" our of "+O.itemsReceived+" items"))},d._onSuccess=function(k,O){d._buffer.clearSent(k)},d._xdrOnLoad=function(k,O){var j=Fs(k);if(k&&(j+""=="200"||j===""))r=0,d._onSuccess(O,0);else{var z=x(j);z&&z.itemsReceived&&z.itemsReceived>z.itemsAccepted&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(O,z):d._onError(O,ee(k))}};function p(k){return d._sample.isSampledIn(k)}u(p,"C");function y(k,O,j,z,ne,oe){var he=null;if(d._appId||(he=x(oe),he&&he.appId&&(d._appId=he.appId)),(k<200||k>=300)&&k!==0){if((k===301||k===307||k===308)&&!m(j)){d._onError(O,ne);return}!d._senderConfig.isRetryDisabled()&&B(k)?(E(O),d.diagLog().throwInternal(V.WARNING,W.TransmissionFailed,". Response code "+k+". Will retry to send "+O.length+" items.")):d._onError(O,ne)}else if(ql.isOffline()){if(!d._senderConfig.isRetryDisabled()){var Ce=10;E(O,Ce),d.diagLog().throwInternal(V.WARNING,W.TransmissionFailed,". Offline - Response Code: "+k+". Offline status: "+ql.isOffline()+". Will retry to send "+O.length+" items.")}}else m(j),k===206?(he||(he=x(oe)),he&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(O,he):d._onError(O,ne)):(r=0,d._onSuccess(O,z))}u(y,"E");function m(k){return c>=10?!1:!C(k)&&k!==""&&k!==d._senderConfig.endpointUrl()?(d._senderConfig.endpointUrl=function(){return k},++c,!0):!1}u(m,"b");function v(k,O){var j=d._senderConfig.endpointUrl(),z=d._buffer.batchPayloads(k),ne=new Blob([z],{type:"text/plain;charset=UTF-8"}),oe=Gn().sendBeacon(j,ne);oe?(d._buffer.markAsSent(k),d._onSuccess(k,k.length)):(S(k,!0),d.diagLog().throwInternal(V.WARNING,W.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}u(v,"p");function S(k,O){var j=new XMLHttpRequest,z=d._senderConfig.endpointUrl();try{j[pi]=!0}catch(oe){}j.open("POST",z,O),j.setRequestHeader("Content-type","application/json"),Cs(z)&&j.setRequestHeader(Be.sdkContextHeader,Be.sdkContextHeaderAppIdRequest),fe(ci(l),function(oe){j.setRequestHeader(oe,l[oe])}),j.onreadystatechange=function(){return d._xhrReadyStateChange(j,k,k.length)},j.onerror=function(oe){return d._onError(k,P(j),oe)};var ne=d._buffer.batchPayloads(k);j.send(ne),d._buffer.markAsSent(k)}u(S,"g");function w(k,O){var j=d._senderConfig.endpointUrl(),z=d._buffer.batchPayloads(k),ne=new Blob([z],{type:"text/plain;charset=UTF-8"}),oe=new Headers;Cs(j)&&oe.append(Be.sdkContextHeader,Be.sdkContextHeaderAppIdRequest),fe(ci(l),function(Oe){oe.append(Oe,l[Oe])});var he={method:"POST",headers:oe,body:ne},Ce=new Request(j,he);fetch(Ce).then(function(Oe){if(Oe.ok)Oe.text().then(function(mn){y(Oe.status,k,Oe.url,k.length,Oe.statusText,mn)}),d._buffer.markAsSent(k);else throw Error(Oe.statusText)}).catch(function(Oe){d._onError(k,Oe.message)})}u(w,"y");function x(k){try{if(k&&k!==""){var O=Rn().parse(k);if(O&&O.itemsReceived&&O.itemsReceived>=O.itemsAccepted&&O.itemsReceived-O.itemsAccepted===O.errors.length)return O}}catch(j){d.diagLog().throwInternal(V.CRITICAL,W.InvalidBackendResponse,"Cannot parse the response. "+Te(j),{response:k})}return null}u(x,"w");function E(k,O){if(O===void 0&&(O=1),!(!k||k.length===0)){d._buffer.clearSent(k),r++;for(var j=0,z=k;j<z.length;j++){var ne=z[j];d._buffer.enqueue(ne)}I(O),D()}}u(E,"L");function I(k){var O=10,j;if(r<=1)j=O;else{var z=(Math.pow(2,r)-1)/2,ne=Math.floor(Math.random()*z*O)+1;ne=k*ne,j=Math.max(Math.min(ne,3600),O)}var oe=dn()+j*1e3;i=oe}u(I,"k");function D(){if(!a){var k=i?Math.max(0,i-dn()):0,O=Math.max(d._senderConfig.maxBatchInterval(),k);a=setTimeout(function(){d.triggerSend(!0,null,1)},O)}}u(D,"Q");function B(k){return k===408||k===429||k===500||k===503}u(B,"ye");function P(k,O){return k?"XMLHttpRequest,Status:"+k.status+",Response:"+Fs(k)||0||0:O}u(P,"J");function G(k,O){var j=Go(),z=new XDomainRequest;z.onload=function(){return d._xdrOnLoad(z,k)},z.onerror=function(Ce){return d._onError(k,ee(z),Ce)};var ne=j&&j.location&&j.location.protocol||"";if(d._senderConfig.endpointUrl().lastIndexOf(ne,0)!==0){d.diagLog().throwInternal(V.WARNING,W.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),d._buffer.clear();return}var oe=d._senderConfig.endpointUrl().replace(/^(https?:)/,"");z.open("POST",oe);var he=d._buffer.batchPayloads(k);z.send(he),d._buffer.markAsSent(k)}u(G,"de");function ee(k,O){return k?"XDomainRequest,Response:"+Fs(k)||0:O}u(ee,"be");function te(){var k="getNotifyMgr";return d.core[k]?d.core[k]():d.core._notificationManager}u(te,"pt");function X(k,O){var j=te();if(j&&j.eventsSendRequest)try{j.eventsSendRequest(k,O)}catch(z){d.diagLog().throwInternal(V.CRITICAL,W.NotificationException,"send request notification failed: "+Te(z),{exception:we(z)})}}u(X,"it");function ae(k){var O=C(k.disableInstrumentationKeyValidation)?!1:k.disableInstrumentationKeyValidation;if(O)return!0;var j="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",z=new RegExp(j);return z.test(k.instrumentationKey)}u(ae,"dt")}),n}return u(e,"e"),e.constructEnvelope=function(n,r,i){var o;switch(r!==n.iKey&&!C(r)?o=Nr({},n,{iKey:r}):o=n,o.baseType){case Pn.dataType:return Vl.EventEnvelopeCreator.Create(i,o);case mr.dataType:return Xh.TraceEnvelopeCreator.Create(i,o);case Fn.dataType:return Kh.PageViewEnvelopeCreator.Create(i,o);case vr.dataType:return Qh.PageViewPerformanceEnvelopeCreator.Create(i,o);case Lt.dataType:return jh.ExceptionEnvelopeCreator.Create(i,o);case Qn.dataType:return Gh.MetricEnvelopeCreator.Create(i,o);case Xn.dataType:return zh.DependencyEnvelopeCreator.Create(i,o);default:return Vl.EventEnvelopeCreator.Create(i,o)}},e._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){}}},e._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0,customHeaders:void 0}},e}(hi)}),nf=L(()=>{Um()}),rf,jl,of,Om=L(()=>{et(),ht(),Se(),rf="ai_session",jl=function(){function t(){}return u(t,"t"),t}(),of=function(){function t(e,n){var r=this,i,o,a=is(n),s=Qc(n);Ge(t,r,function(c){e||(e={}),Q(e.sessionExpirationMs)||(e.sessionExpirationMs=function(){return t.acquisitionSpan}),Q(e.sessionRenewalMs)||(e.sessionRenewalMs=function(){return t.renewalSpan}),c.config=e;var l=c.config.sessionCookiePostfix&&c.config.sessionCookiePostfix()?c.config.sessionCookiePostfix():c.config.namePrefix&&c.config.namePrefix()?c.config.namePrefix():"";i=u(function(){return rf+l},"i"),c.automaticSession=new jl,c.update=function(){var m=dn(),v=!1,S=c.automaticSession;S.id||(v=!d(S,m));var w=c.config.sessionExpirationMs();if(!v&&w>0){var x=c.config.sessionRenewalMs(),E=m-S.acquisitionDate,I=m-S.renewalDate;v=E<0||I<0,v=v||E>w,v=v||I>x}v?g(m):(!o||m-o>t.cookieUpdateInterval)&&p(S,m)},c.backup=function(){var m=c.automaticSession;y(m.id,m.acquisitionDate,m.renewalDate)};function d(m,v){var S=!1,w=s.get(i());if(w&&Q(w.split))S=h(m,w);else{var x=th(a,i());x&&(S=h(m,x))}return S||!!m.id}u(d,"l");function h(m,v){var S=!1,w=", session will be reset",x=v.split("|");if(x.length>=2)try{var E=+x[1]||0,I=+x[2]||0;isNaN(E)||E<=0?a.throwInternal(V.WARNING,W.SessionRenewalDateIsZero,"AI session acquisition date is 0"+w):isNaN(I)||I<=0?a.throwInternal(V.WARNING,W.SessionRenewalDateIsZero,"AI session renewal date is 0"+w):x[0]&&(m.id=x[0],m.acquisitionDate=E,m.renewalDate=I,S=!0)}catch(D){a.throwInternal(V.CRITICAL,W.ErrorParsingAISessionCookie,"Error parsing ai_session value ["+(v||"")+"]"+w+" - "+Te(D),{exception:we(D)})}return S}u(h,"f");function g(m){var v=c.config||{},S=(v.getNewId?v.getNewId():null)||gs;c.automaticSession.id=S(v.idLength?v.idLength():22),c.automaticSession.acquisitionDate=m,p(c.automaticSession,m),Cl()||a.throwInternal(V.WARNING,W.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}u(g,"m");function p(m,v){var S=m.acquisitionDate;m.renewalDate=v;var w=c.config,x=w.sessionRenewalMs(),E=S+w.sessionExpirationMs()-v,I=[m.id,S,v],D=0;E<x?D=E/1e3:D=x/1e3;var B=w.cookieDomain?w.cookieDomain():null;s.set(i(),I.join("|"),w.sessionExpirationMs()>0?D:null,B),o=v}u(p,"C");function y(m,v,S){nh(a,i(),[m,v,S].join("|"))}u(y,"E")})}return u(t,"t"),t.acquisitionSpan=864e5,t.renewalSpan=18e5,t.cookieUpdateInterval=6e4,t}()}),af,Hm=L(()=>{af=function(){function t(){}return u(t,"t"),t}()}),sf,Wm=L(()=>{sf=function(){function t(){this.id="browser",this.deviceClass="Browser"}return u(t,"t"),t}()}),cf,lf,Bm=L(()=>{cf="2.6.4",lf=function(){function t(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:"+cf}return u(t,"t"),t}()});function uf(t){return!(typeof t!="string"||!t||t.match(/,|;|=| |\|/))}u(uf,"ju");var df,$m=L(()=>{et(),ht(),Se(),df=function(){function t(e,n){this.isNewUser=!1;var r=is(n),i=Qc(n),o;Ge(t,this,function(a){a.config=e;var s=a.config.userCookiePostfix&&a.config.userCookiePostfix()?a.config.userCookiePostfix():"";o=u(function(){return t.userCookieName+s},"a");var c=i.get(o());if(c){a.isNewUser=!1;var l=c.split(t.cookieSeparator);l.length>0&&(a.id=l[0])}if(!a.id){var d=e||{},h=(d.getNewId?d.getNewId():null)||gs;a.id=h(d.idLength?e.idLength():22);var g=31536e3,p=kn(new Date);a.accountAcquisitionDate=p,a.isNewUser=!0;var y=[a.id,p];i.set(o(),y.join(t.cookieSeparator),g);var m=e.namePrefix&&e.namePrefix()?e.namePrefix()+"ai_session":"ai_session";rh(r,m)}a.accountId=e.accountId?e.accountId():void 0;var v=i.get(t.authUserCookieName);if(v){v=decodeURI(v);var S=v.split(t.cookieSeparator);S[0]&&(a.authenticatedId=S[0]),S.length>1&&S[1]&&(a.accountId=S[1])}a.setAuthenticatedUserContext=function(w,x,E){E===void 0&&(E=!1);var I=!uf(w)||x&&!uf(x);if(I){r.throwInternal(V.WARNING,W.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}a.authenticatedId=w;var D=a.authenticatedId;x&&(a.accountId=x,D=[a.authenticatedId,a.accountId].join(t.cookieSeparator)),E&&i.set(t.authUserCookieName,encodeURI(D))},a.clearAuthenticatedUserContext=function(){a.authenticatedId=null,a.accountId=null,i.del(t.authUserCookieName)}})}return u(t,"t"),t.cookieSeparator="|",t.userCookieName="ai_user",t.authUserCookieName="ai_authUser",t}()}),hf,Vm=L(()=>{hf=function(){function t(){}return u(t,"t"),t}()}),ff,qm=L(()=>{ht(),Se(),ff=function(){function t(e,n,r,i){var o=this;o.traceID=e||Kn(),o.parentID=n,o.name=r;var a=li();!r&&a&&a.pathname&&(o.name=a.pathname),o.name=Mt(i,o.name)}return u(t,"t"),t}()});function uo(t,e){t&&t[e]&&ci(t[e]).length===0&&delete t[e]}u(uo,"Or");var sa,ca,gf,zm=L(()=>{et(),Se(),Om(),ht(),Hm(),Wm(),Bm(),$m(),Vm(),qm(),sa="ext",ca="tags",gf=function(){function t(e,n){var r=this,i=e.logger;this.appId=function(){return null},Ge(t,this,function(o){o.application=new af,o.internal=new lf(n),Ja()&&(o.sessionManager=new of(n,e),o.device=new sf,o.location=new hf,o.user=new df(n,e),o.telemetryTrace=new ff(void 0,void 0,void 0,i),o.session=new jl),o.applySessionContext=function(a,s){var c=o.session,l=o.sessionManager;c&&le(c.id)?Ie(It(a.ext,Ut.AppExt),"sesId",c.id):l&&l.automaticSession&&Ie(It(a.ext,Ut.AppExt),"sesId",l.automaticSession.id,le)},o.applyOperatingSystemContxt=function(a,s){Ie(a.ext,Ut.OSExt,o.os)},o.applyApplicationContext=function(a,s){var c=o.application;if(c){var l=It(a,ca);Ie(l,He.applicationVersion,c.ver,le),Ie(l,He.applicationBuild,c.build,le)}},o.applyDeviceContext=function(a,s){var c=o.device;if(c){var l=It(It(a,sa),Ut.DeviceExt);Ie(l,"localId",c.id,le),Ie(l,"ip",c.ip,le),Ie(l,"model",c.model,le),Ie(l,"deviceClass",c.deviceClass,le)}},o.applyInternalContext=function(a,s){var c=o.internal;if(c){var l=It(a,ca);Ie(l,He.internalAgentVersion,c.agentVersion,le),Ie(l,He.internalSdkVersion,c.sdkVersion,le),(a.baseType===Qi.dataType||a.baseType===Fn.dataType)&&(Ie(l,He.internalSnippet,c.snippetVer,le),Ie(l,He.internalSdkSrc,c.sdkSrc,le))}},o.applyLocationContext=function(a,s){var c=r.location;c&&Ie(It(a,ca,[]),He.locationIp,c.ip,le)},o.applyOperationContext=function(a,s){var c=o.telemetryTrace;if(c){var l=It(It(a,sa),Ut.TraceExt,{traceID:void 0,parentID:void 0});Ie(l,"traceID",c.traceID,le),Ie(l,"name",c.name,le),Ie(l,"parentID",c.parentID,le)}},o.applyWebContext=function(a,s){var c=r.web;c&&Ie(It(a,sa),Ut.WebExt,c)},o.applyUserContext=function(a,s){var c=o.user;if(c){var l=It(a,ca,[]);Ie(l,He.userAccountId,c.accountId,le);var d=It(It(a,sa),Ut.UserExt);Ie(d,"id",c.id,le),Ie(d,"authId",c.authenticatedId,le)}},o.cleanUp=function(a,s){var c=a.ext;c&&(uo(c,Ut.DeviceExt),uo(c,Ut.UserExt),uo(c,Ut.WebExt),uo(c,Ut.OSExt),uo(c,Ut.AppExt),uo(c,Ut.TraceExt))}})}return u(t,"t"),t}()}),pf,Gl,jm=L(()=>{Me(),et(),Se(),zm(),ht(),pf=function(t){De(e,t);function e(){var n=t.call(this)||this;n.priority=110,n.identifier=lo;var r,i;return Ge(e,n,function(o,a){o.initialize=function(c,l,d,h){a.initialize(c,l,d,h);var g=o._getTelCtx(),p=o.identifier,y=e.getDefaultConfig();i=i||{},pe(y,function(m,v){i[m]=function(){return g.getConfig(p,m,v())}}),o.context=new gf(l,i),r=Yd(d,Ts),o.context.appId=function(){return r?r._appId:null},o._extConfig=i},o.processTelemetry=function(c,l){if(!C(c)){l=o._getTelCtx(l),c.name===Fn.envelopeType&&l.diagLog().resetInternalMessageCount();var d=o.context||{};if(d.session&&typeof o.context.session.id!="string"&&d.sessionManager&&d.sessionManager.update(),s(c,l),d.user&&d.user.isNewUser){d.user.isNewUser=!1;var h=new Qi(W.SendBrowserInfoOnUserInit,(Gn()||{}).userAgent||"");l.diagLog().logInternalMessage(V.CRITICAL,h)}o.processNext(c,l)}};function s(c,l){It(c,"tags",[]),It(c,"ext",{});var d=o.context;d.applySessionContext(c,l),d.applyApplicationContext(c,l),d.applyDeviceContext(c,l),d.applyOperationContext(c,l),d.applyUserContext(c,l),d.applyOperatingSystemContxt(c,l),d.applyWebContext(c,l),d.applyLocationContext(c,l),d.applyInternalContext(c,l),d.cleanUp(c,l)}u(s,"u")}),n}return u(e,"e"),e.getDefaultConfig=function(){var n={instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}};return n},e}(hi),Gl=pf}),mf=L(()=>{jm()});function vf(t,e,n){var r=0,i=t[e],o=t[n];return i&&o&&(r=Nt(i,o)),r}u(vf,"ec");function yi(t,e,n,r,i){var o=0,a=vf(n,r,i);return a&&(o=zr(t,e,pr(a))),o}u(yi,"xr");function zr(t,e,n){var r="ajaxPerf",i=0;if(t&&e&&n){var o=t[r]=t[r]||{};o[e]=n,i=1}return i}u(zr,"tr");function Gm(t,e){var n=t.perfTiming,r=e[jt]||{},i=0,o="name",a="Start",s="End",c="domainLookup",l="connect",d="redirect",h="request",g="response",p="duration",y="startTime",m=c+a,v=c+s,S=l+a,w=l+s,x=h+a,E=h+s,I=g+a,D=g+s,B=d+a,P=d=s,G="transferSize",ee="encodedBodySize",te="decodedBodySize",X="serverTiming";if(n){i|=yi(r,d,n,B,P),i|=yi(r,c,n,m,v),i|=yi(r,l,n,S,w),i|=yi(r,h,n,x,E),i|=yi(r,g,n,I,D),i|=yi(r,"networkConnect",n,y,w),i|=yi(r,"sentRequest",n,x,D);var ae=n[p];ae||(ae=vf(n,y,D)||0),i|=zr(r,p,ae),i|=zr(r,"perfTotal",ae);var k=n[X];if(k){var O={};fe(k,function(j,z){var ne=dt(j[o]||""+z),oe=O[ne]||{};pe(j,function(he,Ce){(he!==o&&le(Ce)||tn(Ce))&&(oe[he]&&(Ce=oe[he]+";"+Ce),(Ce||!le(Ce))&&(oe[he]=Ce))}),O[ne]=oe}),i|=zr(r,X,O)}i|=zr(r,G,n[G]),i|=zr(r,ee,n[ee]),i|=zr(r,te,n[te])}else t.perfMark&&(i|=zr(r,"missing",t.perfAttempts));i&&(e[jt]=r)}u(Gm,"hl");var jt,wf,Kl,Km=L(()=>{ht(),Se(),et(),jt="properties",wf=function(){function t(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1}return u(t,"t"),t}(),Kl=function(){function t(e,n,r){var i=this,o=r,a="responseText";i.perfMark=null,i.completed=!1,i.requestHeadersSize=null,i.requestHeaders=null,i.responseReceivingDuration=null,i.callbackDuration=null,i.ajaxTotalDuration=null,i.aborted=0,i.pageUrl=null,i.requestUrl=null,i.requestSize=0,i.method=null,i.status=null,i.requestSentTime=null,i.responseStartedTime=null,i.responseFinishedTime=null,i.callbackFinishedTime=null,i.endTime=null,i.xhrMonitoringState=new wf,i.clientFailure=0,i.traceID=e,i.spanID=n,Ge(t,i,function(s){s.getAbsoluteUrl=function(){return s.requestUrl?ah(s.requestUrl):null},s.getPathName=function(){return s.requestUrl?ta(o,sh(s.method,s.requestUrl)):null},s.CreateTrackItem=function(c,l,d){if(s.ajaxTotalDuration=Math.round(Nt(s.requestSentTime,s.responseFinishedTime)*1e3)/1e3,s.ajaxTotalDuration<0)return null;var h=(m={id:"|"+s.traceID+"."+s.spanID,target:s.getAbsoluteUrl(),name:s.getPathName(),type:c,startTime:null,duration:s.ajaxTotalDuration,success:+s.status>=200&&+s.status<400,responseCode:+s.status,method:s.method},m[jt]={HttpMethod:s.method},m);if(s.requestSentTime&&(h.startTime=new Date,h.startTime.setTime(s.requestSentTime)),Gm(s,h),l&&ci(s.requestHeaders).length>0&&(h[jt]=h[jt]||{},h[jt].requestHeaders=s.requestHeaders),d){var g=d();if(g){var p=g.correlationContext;if(p&&(h.correlationContext=p),g.headerMap&&ci(g.headerMap).length>0&&(h[jt]=h[jt]||{},h[jt].responseHeaders=g.headerMap),s.status>=400){var y=g.type;h[jt]=h[jt]||{},(y===""||y==="text")&&(h[jt][a]=g[a]?g.statusText+" - "+g[a]:g.statusText),y==="json"&&(h[jt][a]=g.response?g.statusText+" - "+JSON.stringify(g.response):g.statusText)}}}return h;var m}})}return u(t,"t"),t}()}),Qm,Xm=L(()=>{Se(),Se(),Qm=function(){function t(){}return u(t,"t"),t.GetLength=function(e){var n=0;if(!C(e)){var r="";try{r=e.toString()}catch(i){}n=r.length,n=isNaN(n)?0:n}return n},t}()}),Ql,Ym=L(()=>{Se(),Ql=function(){function t(e,n){var r=this;r.traceFlag=t.DEFAULT_TRACE_FLAG,r.version=t.DEFAULT_VERSION,e&&t.isValidTraceId(e)?r.traceId=e:r.traceId=Kn(),n&&t.isValidSpanId(n)?r.spanId=n:r.spanId=Kn().substr(0,16)}return u(t,"t"),t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}()});function Jm(){var t=zt();return!t||C(t.Request)||C(t.Request[Pt])||C(t[go])?null:t[go]}u(Jm,"yl");function Zm(t){var e=!1;if(typeof XMLHttpRequest!==_n&&!C(XMLHttpRequest)){var n=XMLHttpRequest[Pt];e=!C(n)&&!C(n.open)&&!C(n.send)&&!C(n.abort)}var r=Lc();if(r&&r<9&&(e=!1),e)try{var i=new XMLHttpRequest;i[Gt]={};var o=XMLHttpRequest[Pt].open;XMLHttpRequest[Pt].open=o}catch(a){e=!1,la(t,W.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:we(a)})}return e}u(Zm,"Sl");function Ms(t){var e="";try{!C(t)&&!C(t[Gt])&&!C(t[Gt].requestUrl)&&(e+="(url: '"+t[Gt].requestUrl+"')")}catch(n){}return e}u(Ms,"Pi");function la(t,e,n,r,i){t[fo]()[Yl](V.CRITICAL,e,n,r,i)}u(la,"Rn");function Ns(t,e,n,r,i){t[fo]()[Yl](V.WARNING,e,n,r,i)}u(Ns,"wi");function ua(t,e,n){return function(r){la(t,e,n,{ajaxDiagnosticsMessage:Ms(r.inst),exception:we(r.err)})}}u(ua,"Dn");function ho(t,e){return t&&e?t.indexOf(e):-1}u(ho,"zr");var Xl,fo,Gt,Yl,go,Jl,Zl,ev=L(()=>{Me(),ht(),Se(),Km(),Xm(),Ym(),et(),Xl="ai.ajxmn.",fo="diagLog",Gt="ajaxData",Yl="throwInternal",go="fetch",Jl=0,Zl=function(t){De(e,t);function e(){var n=t.call(this)||this;n.identifier=e.identifier,n.priority=120;var r="trackDependencyDataInternal",i=li(),o=!1,a=!1,s=i&&i.host&&i.host.toLowerCase(),c=e.getEmptyConfig(),l=!1,d=0,h,g,p,y,m=!1,v=0,S=!1,w=[],x={},E;return Ge(e,n,function(I,D){I.initialize=function(F,q,Y,K){if(!I.isInitialized()){D.initialize(F,q,Y,K);var re=I._getTelCtx(),de=e.getDefaultConfig();pe(de,function(Tt,Rr){c[Tt]=re.getConfig(e.identifier,Tt,Rr)});var ue=c.distributedTracingMode;if(l=c.enableRequestHeaderTracking,m=c.enableAjaxPerfTracking,v=c.maxAjaxCallsPerView,S=c.enableResponseHeaderTracking,E=c.excludeRequestFromAutoTrackingPatterns,p=ue===An.AI||ue===An.AI_AND_W3C,g=ue===An.AI_AND_W3C||ue===An.W3C,m){var _e=F.instrumentationKey||"unkwn";_e.length>5?y=Xl+_e.substring(_e.length-5)+".":y=Xl+_e+"."}if(c.disableAjaxTracking===!1&&ee(),P(),Y.length>0&&Y){for(var Ve=void 0,Xe=0;!Ve&&Xe<Y.length;)Y[Xe]&&Y[Xe].identifier===lo&&(Ve=Y[Xe]),Xe++;Ve&&(h=Ve.context)}}},I.teardown=function(){fe(w,function(F){F.rm()}),w=[],o=!1,a=!1,I.setInitialized(!1)},I.trackDependencyData=function(F,q){I[r](F,q)},I.includeCorrelationHeaders=function(F,q,Y,K){var re=I._currentWindowHost||s;if(q){if($r.canIncludeCorrelationHeader(c,F.getAbsoluteUrl(),re)){if(Y||(Y={}),Y.headers=new Headers(Y.headers||(q instanceof Request?q.headers||{}:{})),p){var de="|"+F.traceID+"."+F.spanID;Y.headers.set(Be.requestIdHeader,de),l&&(F.requestHeaders[Be.requestIdHeader]=de)}var ue=c.appId||h&&h.appId();if(ue&&(Y.headers.set(Be.requestContextHeader,Be.requestContextAppIdFormat+ue),l&&(F.requestHeaders[Be.requestContextHeader]=Be.requestContextAppIdFormat+ue)),g){var _e=new Ql(F.traceID,F.spanID);Y.headers.set(Be.traceParentHeader,_e.toString()),l&&(F.requestHeaders[Be.traceParentHeader]=_e.toString())}}return Y}else if(K){if($r.canIncludeCorrelationHeader(c,F.getAbsoluteUrl(),re)){if(p){var de="|"+F.traceID+"."+F.spanID;K.setRequestHeader(Be.requestIdHeader,de),l&&(F.requestHeaders[Be.requestIdHeader]=de)}var ue=c.appId||h&&h.appId();if(ue&&(K.setRequestHeader(Be.requestContextHeader,Be.requestContextAppIdFormat+ue),l&&(F.requestHeaders[Be.requestContextHeader]=Be.requestContextAppIdFormat+ue)),g){var _e=new Ql(F.traceID,F.spanID);K.setRequestHeader(Be.traceParentHeader,_e.toString()),l&&(F.requestHeaders[Be.traceParentHeader]=_e.toString())}}return K}},I[r]=function(F,q,Y){if(v===-1||d<v){(c.distributedTracingMode===An.W3C||c.distributedTracingMode===An.AI_AND_W3C)&&typeof F.id=="string"&&F.id[F.id.length-1]!=="."&&(F.id+="."),C(F.startTime)&&(F.startTime=new Date);var K=Yn.create(F,Xn.dataType,Xn.envelopeType,I[fo](),q,Y);I.core.track(K)}else d===v&&la(I,W.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++d};function B(F){var q=!0;return(F||c.ignoreHeaders)&&fe(c.ignoreHeaders,function(Y){if(Y.toLowerCase()===F.toLowerCase())return q=!1,-1}),q}u(B,"ye");function P(){var F=Jm();if(F){var q=zt(),Y=F.polyfill;c.disableFetchTracking===!1?(w.push(dl(q,go,{req:function(K,re,de){var ue;if(o&&!te(null,re,de)&&!(Y&&a)){var _e=K.ctx();ue=he(re,de);var Ve=I.includeCorrelationHeaders(ue,re,de);Ve!==de&&K.set(1,Ve),_e.data=ue}},rsp:function(K,re){var de=K.ctx().data;de&&(K.rslt=K.rslt.then(function(ue){return Oe(K,(ue||{}).status,ue,de,function(){var _e={statusText:ue.statusText,headerMap:null,correlationContext:mn(ue)};if(S){var Ve={};ue.headers.forEach(function(Xe,Tt){B(Tt)&&(Ve[Tt]=Xe)}),_e.headerMap=Ve}return _e}),ue}).catch(function(ue){throw Oe(K,0,re,de,null,{error:ue.message}),ue}))},hkErr:ua(I,W.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),o=!0):Y&&w.push(dl(q,go,{req:function(K,re,de){te(null,re,de)}})),Y&&(q[go].polyfill=Y)}}u(P,"J");function G(F,q,Y){w.push(zp(F,q,Y))}u(G,"de");function ee(){Zm(I)&&!a&&(G(XMLHttpRequest,"open",{req:function(F,q,Y,K){var re=F.inst,de=re[Gt];!te(re,Y)&&X(re,!0)&&(!de||!de.xhrMonitoringState.openDone)&&ae(re,q,Y,K)},hkErr:ua(I,W.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),G(XMLHttpRequest,"send",{req:function(F,q){var Y=F.inst,K=Y[Gt];X(Y)&&!K.xhrMonitoringState.sendDone&&(ne("xhr",K),K.requestSentTime=ra(),I.includeCorrelationHeaders(K,void 0,void 0,Y),K.xhrMonitoringState.sendDone=!0)},hkErr:ua(I,W.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),G(XMLHttpRequest,"abort",{req:function(F){var q=F.inst,Y=q[Gt];X(q)&&!Y.xhrMonitoringState.abortDone&&(Y.aborted=1,Y.xhrMonitoringState.abortDone=!0)},hkErr:ua(I,W.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),l&&G(XMLHttpRequest,"setRequestHeader",{req:function(F,q,Y){var K=F.inst;X(K)&&B(q)&&(K[Gt].requestHeaders[q]=Y)},hkErr:ua(I,W.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),a=!0)}u(ee,"be");function te(F,q,Y){var K=!1,re=((le(q)?q:(q||{}).url||"")||"").toLowerCase();if(fe(E,function(_e){var Ve=_e;le(_e)&&(Ve=new RegExp(_e)),K||(K=Ve.test(re))}),K)return K;var de=ho(re,"?"),ue=ho(re,"#");return(de===-1||ue!==-1&&ue<de)&&(de=ue),de!==-1&&(re=re.substring(0,de)),C(F)?C(q)||(K=(typeof q=="object"?q[pi]===!0:!1)||(Y?Y[pi]===!0:!1)):K=F[pi]===!0||re[pi]===!0,K?x[re]||(x[re]=1):x[re]&&(K=!0),K}u(te,"pt");function X(F,q){var Y=!0,K=a;return C(F)||(Y=q===!0||!C(F[Gt])),K&&Y}u(X,"it");function ae(F,q,Y,K){var re=h&&h.telemetryTrace&&h.telemetryTrace.traceID||Kn(),de=Kn().substr(0,16),ue=new Kl(re,de,I[fo]());ue.method=q,ue.requestUrl=Y,ue.xhrMonitoringState.openDone=!0,ue.requestHeaders={},ue.async=K,F[Gt]=ue,k(F)}u(ae,"dt");function k(F){F[Gt].xhrMonitoringState.stateChangeAttached=ea.Attach(F,"readystatechange",function(){try{F&&F.readyState===4&&X(F)&&j(F)}catch(Y){var q=we(Y);(!q||ho(q.toLowerCase(),"c00c023f")===-1)&&la(I,W.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ms(F),exception:q})}})}u(k,"d");function O(F){try{var q=F.responseType;if(q===""||q==="text")return F.responseText}catch(Y){}return null}u(O,"T");function j(F){var q=F[Gt];q.responseFinishedTime=ra(),q.status=F.status;function Y(K,re){var de=re||{};de.ajaxDiagnosticsMessage=Ms(F),K&&(de.exception=we(K)),Ns(I,W.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",de)}u(Y,"D"),oe("xmlhttprequest",q,function(){try{var K=q.CreateTrackItem("Ajax",l,function(){var re={statusText:F.statusText,headerMap:null,correlationContext:z(F),type:F.responseType,responseText:O(F),response:F.response};if(S){var de=F.getAllResponseHeaders();if(de){var ue=bt(de).split(/[\r\n]+/),_e={};fe(ue,function(Ve){var Xe=Ve.split(": "),Tt=Xe.shift(),Rr=Xe.join(": ");B(Tt)&&(_e[Tt]=Rr)}),re.headerMap=_e}}return re});K?I[r](K):Y(null,{requestSentTime:q.requestSentTime,responseFinishedTime:q.responseFinishedTime})}finally{try{F[Gt]=null}catch(re){}}},function(K){Y(K,null)})}u(j,"N");function z(F){try{var q=F.getAllResponseHeaders();if(q!==null){var Y=ho(q.toLowerCase(),Be.requestContextHeaderLowerCase);if(Y!==-1){var K=F.getResponseHeader(Be.requestContextHeader);return $r.getCorrelationContext(K)}}}catch(re){Ns(I,W.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Ms(F),exception:we(re)})}}u(z,"A");function ne(F,q){if(q.requestUrl&&y&&m){var Y=hr();if(Y&&Q(Y.mark)){Jl++;var K=y+F+"#"+Jl;Y.mark(K);var re=Y.getEntriesByName(K);re&&re.length===1&&(q.perfMark=re[0])}}}u(ne,"H");function oe(F,q,Y,K){var re=q.perfMark,de=hr(),ue=c.maxAjaxPerfLookupAttempts,_e=c.ajaxPerfLookupDelay,Ve=q.requestUrl,Xe=0;u(function Tt(){try{if(de&&re){Xe++;for(var Rr=null,uc=de.getEntries(),Eo=uc.length-1;Eo>=0;Eo--){var vn=uc[Eo];if(vn){if(vn.entryType==="resource")vn.initiatorType===F&&(ho(vn.name,Ve)!==-1||ho(Ve,vn.name)!==-1)&&(Rr=vn);else if(vn.entryType==="mark"&&vn.name===re.name){q.perfTiming=Rr;break}if(vn.startTime<re.startTime-1e3)break}}}!re||q.perfTiming||Xe>=ue||q.async===!1?(re&&Q(de.clearMarks)&&de.clearMarks(re.name),q.perfAttempts=Xe,Y()):setTimeout(Tt,_e)}catch(Ku){K(Ku)}},"Ke")()}u(oe,"_");function he(F,q){var Y=h&&h.telemetryTrace&&h.telemetryTrace.traceID||Kn(),K=Kn().substr(0,16),re=new Kl(Y,K,I[fo]());re.requestSentTime=ra(),F instanceof Request?re.requestUrl=F?F.url:"":re.requestUrl=F;var de="GET";q&&q.method?de=q.method:F&&F instanceof Request&&(de=F.method),re.method=de;var ue={};if(l){var _e=new Headers((q?q.headers:0)||(F instanceof Request?F.headers||{}:{}));_e.forEach(function(Ve,Xe){B(Xe)&&(ue[Xe]=Ve)})}return re.requestHeaders=ue,ne("fetch",re),re}u(he,"j");function Ce(F){var q="";try{C(F)||(typeof F=="string"?q+="(url: '"+F+"')":q+="(url: '"+F.url+"')")}catch(Y){la(I,W.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:we(Y)})}return q}u(Ce,"Z");function Oe(F,q,Y,K,re,de){if(!K)return;function ue(_e,Ve,Xe){var Tt=Xe||{};Tt.fetchDiagnosticsMessage=Ce(Y),Ve&&(Tt.exception=we(Ve)),Ns(I,_e,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",Tt)}u(ue,"V"),K.responseFinishedTime=ra(),K.status=q,oe("fetch",K,function(){var _e=K.CreateTrackItem("Fetch",l,re);_e?I[r](_e):ue(W.FailedMonitorAjaxDur,null,{requestSentTime:K.requestSentTime,responseFinishedTime:K.responseFinishedTime})},function(_e){ue(W.FailedMonitorAjaxGetCorrelationHeader,_e,null)})}u(Oe,"ie");function mn(F){if(F&&F.headers)try{var q=F.headers.get(Be.requestContextHeader);return $r.getCorrelationContext(q)}catch(Y){Ns(I,W.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:Ce(F),exception:we(Y)})}}u(mn,"zt")}),n}return u(e,"e"),e.getDefaultConfig=function(){var n={maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:An.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"]};return n},e.getEmptyConfig=function(){var n=this.getDefaultConfig();return pe(n,function(r){n[r]=void 0}),n},e.prototype.processTelemetry=function(n,r){this.processNext(n,r)},e.identifier="AjaxDependencyPlugin",e}(hi)}),yf=L(()=>{ev()}),eu,tu,bf,Sf,nu,Cf=L(()=>{Se(),$h(),nf(),mf(),yf(),ht(),tu=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],bf={Default:0,Required:1,Array:2,Hidden:4},Sf={__proto__:null,PropertiesPluginIdentifier:lo,BreezeChannelIdentifier:Ts,AnalyticsPluginIdentifier:Ol,Util:El,CorrelationIdHelper:$r,UrlHelper:hh,DateTimeUtils:fh,ConnectionStringParser:wh,FieldType:bf,RequestHeaders:Be,DisabledPropertyName:pi,ProcessLegacy:io,SampleRate:vs,HttpMethod:ws,DEFAULT_BREEZE_ENDPOINT:yl,AIData:Rl,AIBase:kl,Envelope:Dl,Event:Pn,Exception:Lt,Metric:Qn,PageView:Fn,PageViewData:ks,RemoteDependencyData:Xn,Trace:mr,PageViewPerformance:vr,Data:wr,SeverityLevel:ia,ConfigurationManager:Lh,ContextTagKeys:Ds,DataSanitizer:Qd,TelemetryItemCreator:Yn,CtxTagKeys:He,Extensions:Ut,DistributedTracingModes:An},nu=function(){function t(e){var n=this;n._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var r=e.config||{};if(r.connectionString){var i=ph(r.connectionString),o=i.ingestionendpoint;r.endpointUrl=o?o+"/v2/track":r.endpointUrl,r.instrumentationKey=i.instrumentationkey||r.instrumentationKey}n.appInsights=new Wl,n.properties=new Gl,n.dependencies=new Zl,n.core=new al,n._sender=new zl,n.snippet=e,n.config=r,n.getSKUDefaults()}return u(t,"t"),t.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},t.prototype.trackEvent=function(e,n){this.appInsights.trackEvent(e,n)},t.prototype.trackPageView=function(e){var n=e||{};this.appInsights.trackPageView(n)},t.prototype.trackPageViewPerformance=function(e){var n=e||{};this.appInsights.trackPageViewPerformance(n)},t.prototype.trackException=function(e){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},t.prototype._onerror=function(e){this.appInsights._onerror(e)},t.prototype.trackTrace=function(e,n){this.appInsights.trackTrace(e,n)},t.prototype.trackMetric=function(e,n){this.appInsights.trackMetric(e,n)},t.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},t.prototype.stopTrackPage=function(e,n,r,i){this.appInsights.stopTrackPage(e,n,r,i)},t.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,n,r){this.appInsights.stopTrackEvent(e,n,r)},t.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},t.prototype.setAuthenticatedUserContext=function(e,n,r){r===void 0&&(r=!1),this.properties.context.user.setAuthenticatedUserContext(e,n,r)},t.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},t.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},t.prototype.flush=function(e){var n=this;e===void 0&&(e=!0),Xi(this.core,function(){return"AISKU.flush"},function(){fe(n.core.getTransmissionControls(),function(r){fe(r,function(i){i.flush(e)})})},null,e)},t.prototype.onunloadFlush=function(e){e===void 0&&(e=!0),fe(this.core.getTransmissionControls(),function(n){fe(n,function(r){r.onunloadFlush?r.onunloadFlush():r.flush(e)})})},t.prototype.loadAppInsights=function(e,n,r){var i=this;e===void 0&&(e=!1);var o=this;function a(s){if(s){var c="";C(o._snippetVersion)||(c+=o._snippetVersion),e&&(c+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=c||"-"),pe(o,function(l,d){le(l)&&!Q(d)&&l&&l[0]!=="_"&&tu.indexOf(l)===-1&&(s[l]=d)})}}return u(a,"o"),e&&o.config.extensions&&o.config.extensions.length>0&&zn("Extensions not allowed in legacy mode"),Xi(o.core,function(){return"AISKU.loadAppInsights"},function(){var s=[];s.push(o._sender),s.push(o.properties),s.push(o.dependencies),s.push(o.appInsights),o.core.initialize(o.config,s,n,r),o.context=o.properties.context,eu&&o.context&&(o.context.internal.sdkSrc=eu),a(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(i)}),o},t.prototype.updateSnippetDefinitions=function(e){Ju(e,this,function(n){return n&&tu.indexOf(n)===-1})},t.prototype.emptyQueue=function(){var e=this;try{if(Qe(e.snippet.queue)){for(var n=e.snippet.queue.length,r=0;r<n;r++){var i=e.snippet.queue[r];i()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(a){var o={};a&&Q(a.toString)&&(o.exception=a.toString())}},t.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},t.prototype.addHousekeepingBeforeUnload=function(e){if(Ja()||td()){var n=u(function(){e.onunloadFlush(!1),fe(e.appInsights.core._extensions,function(i){if(i.identifier===lo)return i&&i.context&&i.context._sessionManager&&i.context._sessionManager.backup(),-1})},"r");if(!e.appInsights.config.disableFlushOnBeforeUnload){var r=gi("beforeunload",n);r=gi("unload",n)||r,r=gi("pagehide",n)||r,r=gi("visibilitychange",n)||r,!r&&!kp()&&e.appInsights.core.logger.throwInternal(V.CRITICAL,W.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||(gi("pagehide",n),gi("visibilitychange",n))}},t.prototype.getSender=function(){return this._sender},t.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},t}(),function(){var t=null,e=!1,n=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var r=(document||{}).currentScript;r&&(t=r.src)}catch(s){}if(t)try{var i=t.toLowerCase();if(i){for(var o="",a=0;a<n.length;a++)if(i.indexOf(n[a])!==-1){o="cdn"+(a+1),i.indexOf("/scripts/")===-1&&(i.indexOf("/next/")!==-1?o+="-next":i.indexOf("/beta/")!==-1&&(o+="-beta")),eu=o+(e?".mod":"");break}}}catch(s){}}()}),_f,xf,tv=L(()=>{ht(),Se(),_f=["snippet","getDefaultConfig","_hasLegacyInitializers","_queue","_processLegacyInitializers"],xf=function(){function t(e,n){this._hasLegacyInitializers=!1,this._queue=[],this.config=t.getDefaultConfig(e.config),this.appInsightsNew=n,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return u(t,"t"),t.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=30*60*1e3,e.sessionExpirationMs=24*60*60*1e3,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=Ue(e.enableDebug),e.disableExceptionTracking=Ue(e.disableExceptionTracking),e.disableTelemetry=Ue(e.disableTelemetry),e.verboseLogging=Ue(e.verboseLogging),e.emitLineDelimitedJson=Ue(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=Ue(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=Ue(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=Ue(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=Ue(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=Ue(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Ue(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=Ue(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=Ue(e.isRetryDisabled),e.isCookieUseDisabled=Ue(e.isCookieUseDisabled),e.isStorageUseDisabled=Ue(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Ue(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=Ue(e.enableCorsCorrelation),e},t.prototype.addTelemetryInitializers=function(e){var n=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer(function(r){n._processLegacyInitializers(r)}),this._hasLegacyInitializers=!0),this._queue.push(e)},t.prototype.getCookieMgr=function(){return this.appInsightsNew.getCookieMgr()},t.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},t.prototype.stopTrackPage=function(e,n,r,i){this.appInsightsNew.stopTrackPage(e,n,r)},t.prototype.trackPageView=function(e,n,r,i,o){var a={name:e,uri:n,properties:r,measurements:i};this.appInsightsNew.trackPageView(a)},t.prototype.trackEvent=function(e,n,r){this.appInsightsNew.trackEvent({name:e})},t.prototype.trackDependency=function(e,n,r,i,o,a,s){this.appInsightsNew.trackDependencyData({id:e,target:r,type:i,duration:o,properties:{HttpMethod:n},success:a,responseCode:s})},t.prototype.trackException=function(e,n,r,i,o){this.appInsightsNew.trackException({exception:e})},t.prototype.trackMetric=function(e,n,r,i,o,a){this.appInsightsNew.trackMetric({name:e,average:n,sampleCount:r,min:i,max:o})},t.prototype.trackTrace=function(e,n,r){this.appInsightsNew.trackTrace({message:e,severityLevel:r})},t.prototype.flush=function(e){this.appInsightsNew.flush(e)},t.prototype.setAuthenticatedUserContext=function(e,n,r){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,n,r)},t.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},t.prototype._onerror=function(e,n,r,i,o){this.appInsightsNew._onerror({message:e,url:n,lineNumber:r,columnNumber:i,error:o})},t.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,n,r){this.appInsightsNew.stopTrackEvent(e,n,r)},t.prototype.downloadAndSetup=function(e){zn("downloadAndSetup not implemented in web SKU")},t.prototype.updateSnippetDefinitions=function(e){Ju(e,this,function(n){return n&&_f.indexOf(n)===-1})},t.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var n=this.trackPageView;this.trackPageView=function(o,a,s){n.apply(e,[null,o,a,s])}}var r="logPageView";typeof this.snippet[r]=="function"&&(this[r]=function(o,a,s){e.trackPageView(null,o,a,s)});var i="logEvent";return typeof this.snippet[i]=="function"&&(this[i]=function(o,a,s){e.trackEvent(o,a,s)}),this},t.prototype._processLegacyInitializers=function(e){return e.tags[io]=this._queue,e},t}()}),If,nv=L(()=>{tv(),Cf(),Se(),If=function(){function t(){}return u(t,"t"),t.getAppInsights=function(e,n){var r=new nu(e),i=n!==2;if(to(),n===2)return r.updateSnippetDefinitions(e),r.loadAppInsights(i),r;var o=new xf(e,r);return o.updateSnippetDefinitions(e),r.loadAppInsights(i),o},t}()}),Ef={};bc(Ef,{AppInsightsCore:()=>al,ApplicationAnalytics:()=>Wl,ApplicationInsights:()=>nu,ApplicationInsightsContainer:()=>If,BaseCore:()=>il,BaseTelemetryPlugin:()=>hi,CoreUtils:()=>ps,DependenciesPlugin:()=>Zl,DistributedTracingModes:()=>An,Event:()=>Pn,Exception:()=>Lt,LoggingSeverity:()=>V,Metric:()=>Qn,NotificationManager:()=>ol,PageView:()=>Fn,PageViewPerformance:()=>vr,PerfEvent:()=>Yi,PerfManager:()=>Bc,PropertiesPlugin:()=>Gl,RemoteDependencyData:()=>Xn,Sender:()=>zl,SeverityLevel:()=>ia,Telemetry:()=>Sf,Trace:()=>mr,Util:()=>El,_InternalMessageId:()=>W,doPerf:()=>Xi});var rv=L(()=>{Cf(),nv(),Se(),ht(),nf(),$h(),mf(),yf()}),iv=u(class{constructor(t,e){this._instantiationStatus=0,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=e,this._key=t}logEvent(t,e){if(!this._telemetryClient){this._instantiationStatus!==2&&this._eventQueue.push({eventName:t,data:e});return}this._telemetryClient.logEvent(t,e)}logException(t,e){if(!this._telemetryClient){this._instantiationStatus!==2&&this._exceptionQueue.push({exception:t,data:e});return}this._telemetryClient.logException(t,e)}flush(){return Fo(this,null,function*(){this._telemetryClient&&(yield this._telemetryClient.flush(),this._telemetryClient=void 0)})}_flushQueues(){this._eventQueue.forEach(({eventName:t,data:e})=>this.logEvent(t,e)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:t,data:e})=>this.logException(t,e)),this._exceptionQueue=[]}instantiateAppender(){this._instantiationStatus===0&&(this._instantiationStatus=1,this._clientFactory(this._key).then(t=>{this._telemetryClient=t,this._instantiationStatus=2,this._flushQueues()}).catch(t=>{console.error(t),this._instantiationStatus=2}))}},"Ln"),jr=u(class{constructor(t){this.vscodeAPI=t}getTelemetryLevel(){let t="telemetry",e="enableTelemetry";try{let n=this.vscodeAPI.env.telemetryConfiguration;return n.isUsageEnabled&&n.isErrorsEnabled&&n.isCrashEnabled?"on":n.isErrorsEnabled&&n.isCrashEnabled?"error":"off"}catch(n){return this.vscodeAPI.env.isTelemetryEnabled!==void 0?this.vscodeAPI.env.isTelemetryEnabled?"on":"off":this.vscodeAPI.workspace.getConfiguration(t).get(e)?"on":"off"}}static applyReplacements(t,e){for(let n of Object.keys(t))for(let r of e)r.lookup.test(n)&&(r.replacementString!==void 0?t[n]=r.replacementString:delete t[n])}static getInstance(t){return jr._instance||(jr._instance=new jr(t)),jr._instance}},"Ze"),ov=u(class{constructor(t,e,n,r,i,o){this.extensionId=t,this.extensionVersion=e,this.telemetryAppender=n,this.osShim=r,this.vscodeAPI=i,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!o,this.updateUserOptStatus(),i.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(i.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(i.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(i.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let t=jr.getInstance(this.vscodeAPI).getTelemetryLevel();this.userOptIn=t==="on",this.errorOptIn=t==="error"||this.userOptIn,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(t){if(!t)return"none";let e="other";return["ssh-remote","dev-container","attached-container","wsl","codespaces"].forEach(n=>{t.indexOf(`${n}`)===0&&(e=n)}),e}get extension(){return this._extension===void 0&&(this._extension=this.vscodeAPI.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(t,e){if(t===null||typeof t!="object"||typeof e!="function")return t;let n={};for(let r in t)n[r]=e(r,t[r]);return n}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?!(this.vscodeAPI.env.remoteName&&this.cleanRemoteName(this.vscodeAPI.env.remoteName)==="other"):!0}getCommonProperties(){let t=Object.create(null);if(t["common.os"]=this.osShim.platform,t["common.nodeArch"]=this.osShim.architecture,t["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),t["common.extname"]=this.extensionId,t["common.extversion"]=this.extensionVersion,this.vscodeAPI&&this.vscodeAPI.env){switch(t["common.vscodemachineid"]=this.vscodeAPI.env.machineId,t["common.vscodesessionid"]=this.vscodeAPI.env.sessionId,t["common.vscodeversion"]=this.vscodeAPI.version,t["common.isnewappinstall"]=this.vscodeAPI.env.isNewAppInstall?this.vscodeAPI.env.isNewAppInstall.toString():"false",t["common.product"]=this.vscodeAPI.env.appHost,this.vscodeAPI.env.uiKind){case this.vscodeAPI.UIKind.Web:t["common.uikind"]="web";break;case this.vscodeAPI.UIKind.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}t["common.remotename"]=this.cleanRemoteName(this.vscodeAPI.env.remoteName)}return t}anonymizeFilePaths(t,e){let n;if(t==null)return"";let r=[];this.vscodeAPI.env.appRoot!==""&&r.push(new RegExp(this.vscodeAPI.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&r.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=t;if(e){let o=[];for(let l of r)for(;(n=l.exec(t))&&n;)o.push([n.index,l.lastIndex]);let a=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,c=0;for(i="";(n=s.exec(t))&&n;)n[0]&&!a.test(n[0])&&o.every(([l,d])=>n.index<l||n.index>=d)&&(i+=t.substring(c,n.index)+"<REDACTED: user-file-path>",c=s.lastIndex);c<t.length&&(i+=t.substr(c))}for(let o of r)i=i.replace(o,"");return i}removePropertiesWithPossibleUserInfo(t){if(typeof t!="object")return;let e=Object.create(null);for(let n of Object.keys(t)){let r=t[n];if(!r)continue;let i=/@[a-zA-Z0-9-.]+/,o=/(key|token|sig|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/,a=/xox[pbaors]-[a-zA-Z0-9]+-[a-zA-Z0-9-]+?/;o.test(r.toLowerCase())?e[n]="<REDACTED: secret>":i.test(r)?e[n]="<REDACTED: email>":a.test(r)?e[n]="<REDACTED: token>":e[n]=r}return e}get telemetryLevel(){switch(jr.getInstance(this.vscodeAPI).getTelemetryLevel()){case"on":return"all";case"error":return"error";case"off":return"off"}}internalSendTelemetryEvent(t,e,n,r,i){if((this.userOptIn||i)&&t!==""){if(e=cn(cn({},e),this.getCommonProperties()),r){let o=this.cloneAndChange(e,(a,s)=>this.anonymizeFilePaths(s,this.firstParty));e=this.removePropertiesWithPossibleUserInfo(o)}t=`${this.extensionId}/${t}`,this.telemetryAppender.logEvent(t,{properties:e,measurements:n})}}sendTelemetryEvent(t,e,n){this.internalSendTelemetryEvent(t,e,n,!0,!1)}sendRawTelemetryEvent(t,e,n){this.internalSendTelemetryEvent(t,e,n,!1,!1)}sendDangerousTelemetryEvent(t,e,n,r=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryEvent(t,e,n,r,!0)}internalSendTelemetryErrorEvent(t,e,n,r,i,o){if((this.shouldSendErrorTelemetry()||o)&&t!==""){if(e=cn(cn({},e),this.getCommonProperties()),i){let a=this.cloneAndChange(e,(s,c)=>r===void 0||r.indexOf(s)!==-1?"REDACTED":this.anonymizeFilePaths(c,this.firstParty));e=this.removePropertiesWithPossibleUserInfo(a)}t=`${this.extensionId}/${t}`,this.telemetryAppender.logEvent(t,{properties:e,measurements:n})}}sendTelemetryErrorEvent(t,e,n,r){this.internalSendTelemetryErrorEvent(t,e,n,r,!0,!1)}sendDangerousTelemetryErrorEvent(t,e,n,r,i=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryErrorEvent(t,e,n,r,i,!0)}internalSendTelemetryException(t,e,n,r,i){if((this.shouldSendErrorTelemetry()||i)&&t){if(e=cn(cn({},e),this.getCommonProperties()),r){let o=this.cloneAndChange(e,(a,s)=>this.anonymizeFilePaths(s,this.firstParty));t.stack&&(t.stack=this.anonymizeFilePaths(t.stack,this.firstParty)),e=this.removePropertiesWithPossibleUserInfo(o)}this.telemetryAppender.logException(t,{properties:e,measurements:n})}}sendTelemetryException(t,e,n){this.internalSendTelemetryException(t,e,n,!0,!1)}sendDangerousTelemetryException(t,e,n,r=!0){this.telemetryAppender.instantiateAppender(),this.internalSendTelemetryException(t,e,n,r,!0)}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(t=>t.dispose()))}},"_n"),av=u((t,e)=>Fo(void 0,null,function*(){let n;try{let r=yield Promise.resolve().then(()=>(rv(),Ef)),i;t&&t.indexOf("AIF-")===0&&(i="https://vortex.data.microsoft.com/collect/v1"),n=new r.ApplicationInsights({config:{instrumentationKey:t,endpointUrl:i,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!0,disableInstrumentationKeyValidation:!0}}),n.loadAppInsights(),i&&fetch(i).catch(()=>n=void 0)}catch(r){return Promise.reject(r)}return{logEvent:(r,i)=>{let o=cn(cn({},i==null?void 0:i.properties),i==null?void 0:i.measurements);e!=null&&e.length&&jr.applyReplacements(o,e),n==null||n.trackEvent({name:r},o)},logException:(r,i)=>{let o=cn(cn({},i==null?void 0:i.properties),i==null?void 0:i.measurements);e!=null&&e.length&&jr.applyReplacements(o,e),n==null||n.trackException({exception:r,properties:o})},flush:()=>Fo(void 0,null,function*(){n==null||n.flush()})}}),"El"),sv=u(class extends ov{constructor(t,e,n,r,i){let o=new iv(n,a=>av(a,i));n&&n.indexOf("AIF-")===0&&(r=!0),super(t,e,o,{release:navigator.appVersion,platform:"web",architecture:"web"},f,r)}},"po");/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */const cv="Type of classified event does not match event properties",ru=u(class{constructor(t){this.context=t,this.sharedProperties={},ru._instance=this,this.reporter=new sv(t.extension.id,t.extension.packageJSON.version,ru.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==cv&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,n){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},n)}sendErrorEvent(t,e,n,r){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},n,r)}sendException(t,e,n){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},n)}setSharedProperty(t,e){this.sharedProperties[t]=e}reportWorkbenchLoadResult(t){const e="_codespaces.webeditor.connectWorkspace";f.env.appHost==="github.dev"&&(U.debug(`Executing ${e}`),t={...t,errorDetail:t.errorDetail instanceof Error?t.errorDetail.name:void 0},f.commands.executeCommand(e,t).then(n=>{},n=>{U.debug(`Failed to execute ${e}`,n)}))}},"_TelemetryService");let da=ru;da.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function ha(t){const e=performance.now()*.001;let n=Math.floor(e),r=Math.floor(e%1*1e9);return t!==void 0&&(n=n-t[0],r=r-t[1],r<0&&(n--,r+=1e9)),[n,r]}u(ha,"hrtime");let iu=0;function lv(){return iu===Number.MAX_SAFE_INTEGER&&(iu=0),++iu}u(lv,"getNextInstanceId");const bi=u(class{constructor(t,e,...n){this.context=t,this.instance=`[${lv().toString().padStart(5)}] `;var r,i,o,a,s,c;let l;if(typeof(e==null?void 0:e.log)=="boolean"?l=e.log?{}:void 0:l=(r=e==null?void 0:e.log)!=null?r:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:rt.Info,this.time=ha(),l){if(!U.enabled(this.logLevel))return;n.length?Ls(this.logLevel,`${this.instance}${(o=l.prefix)!=null?o:""}${t}${(a=l.message)!=null?a:""}`,...n):Ls(this.logLevel,`${this.instance}${(s=l.prefix)!=null?s:""}${t}${(c=l.message)!=null?c:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:ha(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=ha()}stop(t){this.restart(t)}logCore(t,e,n){var r,i,o,a,s,c,l;if(!U.enabled(this.logLevel))return;let d="";if(this.step){const[y,m]=ha(this.step.time),v=y*1e3+Math.floor(m/1e6);d=`${this.step.label?`${this.step.label} took `:""}${v} ms`}if(!n){Ls(this.logLevel,`${this.instance}${(r=e==null?void 0:e.prefix)!=null?r:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${d?` ${d}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[h,g]=ha(this.time),p=h*1e3+Math.floor(g/1e6);Ls(p>500?rt.Warn:this.logLevel,`${this.instance}${(a=e==null?void 0:e.prefix)!=null?a:""}${t}${(s=e==null?void 0:e.message)!=null?s:""}${(c=e==null?void 0:e.took)!=null?c:" took "}${p} ms${d?` (${d})`:""}${(l=e==null?void 0:e.suffix)!=null?l:""}`)}static start(t,e,...n){var r;(r=bi.watches.get(t))==null||r.log(),bi.watches.set(t,new bi(t,e,...n))}static log(t,e){var n;(n=bi.watches.get(t))==null||n.log(e)}static stop(t,e){var n;(n=bi.watches.get(t))==null||n.stop(e),bi.watches.delete(t)}},"_Stopwatch");let Ae=bi;Ae.watches=new Map;function Ls(t,e,...n){switch(t){case rt.Warn:U.warn(e,...n);break;case rt.Info:U.log(e,...n);break;default:U.debug(e,...n);break}}u(Ls,"log");class kf{constructor(e){this.providerService=e,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=f.Disposable.from(e.onDidChangeRepositories(n=>{for(const r of n.added)this.repositoryOpened(r);for(const r of n.removed)this.repositoryClosed(r)}),ce.onDidChange(n=>{for(const r of this.services.values()){const i=r.service.getRepository();n.affectsConfiguration("remoteHub.richNavigation.indexMode",i.uri)&&r.service.updateIndexMode().catch(o=>{U.error(o)})}}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const n=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(n,1)}}async repositoryOpened(e){const n=N(e.uri);if(!this.handledRepositories.has(n)){this.handledRepositories.add(n);for(const r of this.providers){const i=await r.createNavigationService(this.providerService,e);if(i!==void 0){const o=i();this.services.set(n,{service:o});break}}}}repositoryClosed(e){const n=N(e.uri);this.handledRepositories.delete(n);const r=this.services.get(n);r!==void 0&&(r.service.dispose(),this.services.delete(N(e.uri)))}}u(kf,"CodeNavigationServices");const fa=globalThis.fetch;async function uv(t,e,n){const r=new AbortController;n.onCancellationRequested(()=>r.abort());try{return await globalThis.fetch(t,{...e,signal:r.signal})}catch(i){throw n.isCancellationRequested?new CancellationError:i}}u(uv,"fetchWithCancellation");async function Jw(t,e,n,r,i){if(n===0)throw new CancellationError;const o=new CancellationTokenSource;r.onCancellationRequested(()=>o.cancel());try{const a=await uv(t,e,o.token);if(a.body){const s=[];let c=0;const l=a.body.getReader();let d=3;for(;;){let{done:h,value:g}=await l.read();if(h){const y=s.reduce((S,w)=>S+w.length,0),m=new Uint8Array(y);let v=0;for(const S of s)m.set(S,v),v+=S.length;return m}g&&(s.push(g),c+=g.length);const p=Math.floor(c/(1024*1024));if(d<p){d=p;const y={message:p+" MB"};i.report(y)}if(n!==void 0&&c>n)throw l.cancel(),o.cancel(),new Error("LIMIT_HIT")}}}catch(a){throw r.isCancellationRequested?new CancellationError:a}throw new CancellationError}u(Jw,"fetchUInt8ArrayWithMaxSizeAndCancellation");/*! (c) Andrea Giammarchi - ISC */var Us={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;Us.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,n,r){"use strict";var i=e.create,o=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,s=/%(?![0-9a-fA-F]{2})/g,c=/\+/g,l={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},d={append:function(w,x){y(this._ungap,w,x)},delete:function(w){delete this._ungap[w]},get:function(w){return this.has(w)?this._ungap[w][0]:null},getAll:function(w){return this.has(w)?this._ungap[w].slice(0):[]},has:function(w){return w in this._ungap},set:function(w,x){this._ungap[w]=[n(x)]},forEach:function(w,x){var E=this;for(var I in E._ungap)E._ungap[I].forEach(D,I);function D(B){w.call(x,B,n(I),E)}u(D,"invoke")},toJSON:function(){return{}},toString:function(){var w=[];for(var x in this._ungap)for(var E=v(x),I=0,D=this._ungap[x];I<D.length;I++)w.push(E+"="+v(D[I]));return w.join("&")}};for(var h in d)o(g.prototype,h,{configurable:!0,writable:!0,value:d[h]});Us.URLSearchParams=g;function g(w){var x=i(null);switch(o(this,"_ungap",{value:x}),!0){case!w:break;case typeof w=="string":w.charAt(0)==="?"&&(w=w.slice(1));for(var E=w.split("&"),I=0,D=E.length;I<D;I++){var B=E[I],P=B.indexOf("=");-1<P?y(x,m(B.slice(0,P)),m(B.slice(P+1))):B.length&&y(x,m(B),"")}break;case r(w):for(var I=0,D=w.length;I<D;I++){var B=w[I];y(x,B[0],B[1])}break;case"forEach"in w:w.forEach(p,x);break;default:for(var G in w)y(x,G,w[G])}}u(g,"URLSearchParams");function p(w,x){y(this,x,w)}u(p,"addEach");function y(w,x,E){var I=r(E)?E.join(","):E;x in w?w[x].push(I):w[x]=[I]}u(y,"appendTo");function m(w){return decodeURIComponent(w.replace(s,"%25").replace(c," "))}u(m,"decode");function v(w){return encodeURIComponent(w).replace(a,S)}u(v,"encode");function S(w){return l[w]}u(S,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(r){}"forEach"in t||(t.forEach=u(function(i,o){var a=this,s=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(c){!c.length||c in s||(s[c]=a.getAll(c)).forEach(function(l){i.call(o,l,c,a)})})},"forEach")),"keys"in t||(t.keys=u(function(){return n(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=u(function(){return n(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=u(function(){return n(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=u(function(){for(var i=this.entries(),o=i.next(),a=o.done,s=[],c=Object.create(null),l,d,h;!a;)h=o.value,d=h[0],s.push(d),d in c||(c[d]=[]),c[d].push(h[1]),o=i.next(),a=o.done;for(s.sort(),l=0;l<s.length;l++)this.delete(s[l]);for(l=0;l<s.length;l++)d=s[l],this.append(d,c[d].shift())},"sort"));function n(r,i){var o=[];return r.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}u(n,"iterator"),function(r){var i=r.defineProperty,o=r.getOwnPropertyDescriptor,a=u(function(h){function g(m,v){t.append.call(this,m,v),m=this.toString(),h.set.call(this._usp,m?"?"+m:"")}u(g,"append");function p(m){t.delete.call(this,m),m=this.toString(),h.set.call(this._usp,m?"?"+m:"")}u(p,"del");function y(m,v){t.set.call(this,m,v),m=this.toString(),h.set.call(this._usp,m?"?"+m:"")}return u(y,"set"),function(m,v){return m.append=g,m.delete=p,m.set=y,i(m,"_usp",{configurable:!0,writable:!0,value:v})}},"createSearchParamsPollute"),s=u(function(h){return function(g,p){return i(g,"_searchParams",{configurable:!0,writable:!0,value:h(p,g)}),p}},"createSearchParamsCreate"),c=u(function(h){var g=h.append;h.append=t.append,URLSearchParams.call(h,h._usp.search.slice(1)),h.append=g},"updateSearchParams"),l=u(function(h,g){if(!(h instanceof g))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+g.name)},"verifySearchParams"),d=u(function(h){var g=h.prototype,p=o(g,"searchParams"),y=o(g,"href"),m=o(g,"search"),v;!p&&m&&m.set&&(v=s(a(m)),r.defineProperties(g,{href:{get:function(){return y.get.call(this)},set:function(S){var w=this._searchParams;y.set.call(this,S),w&&c(w)}},search:{get:function(){return m.get.call(this)},set:function(S){var w=this._searchParams;m.set.call(this,S),w&&c(w)}},searchParams:{get:function(){return l(this,h),this._searchParams||v(this,new URLSearchParams(this.search.slice(1)))},set:function(S){l(this,h),v(this,S)}}}))},"upgradeClass");try{d(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&d(URL)}catch(h){}}(Object)})(Us.URLSearchParams.prototype,Object);const Rf=Us.URLSearchParams;var Os,dv=new Uint8Array(16);function hv(){if(!Os&&(Os=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Os))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Os(dv)}u(hv,"rng");const fv=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function gv(t){return typeof t=="string"&&fv.test(t)}u(gv,"validate");const pv=gv;for(var St=[],ou=0;ou<256;++ou)St.push((ou+256).toString(16).substr(1));function mv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(St[t[e+0]]+St[t[e+1]]+St[t[e+2]]+St[t[e+3]]+"-"+St[t[e+4]]+St[t[e+5]]+"-"+St[t[e+6]]+St[t[e+7]]+"-"+St[t[e+8]]+St[t[e+9]]+"-"+St[t[e+10]]+St[t[e+11]]+St[t[e+12]]+St[t[e+13]]+St[t[e+14]]+St[t[e+15]]).toLowerCase();if(!pv(n))throw TypeError("Stringified UUID is invalid");return n}u(mv,"stringify");const vv=mv;function wv(t,e,n){t=t||{};var r=t.random||(t.rng||hv)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return vv(r)}u(wv,"v4");const Df=wv,ie=J.loadMessageBundle(),au=60,su=au*60,ga=su*24,Tf=ga*7,Af=ga*30,Pf=ga*365;function po(t,e){typeof t!="number"&&(t=t.getTime());const n=Math.round((new Date().getTime()-t)/1e3);if(n<-30)return ie("date.fromNow.in","in {0}",po(new Date().getTime()+n*1e3,{ago:!1,short:e==null?void 0:e.short}));if(n<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?ie("date.fromNow.seconds.short.ago","secs ago"):ie("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?ie("date.fromNow.now.short","now"):ie("date.fromNow.now","Just now");let r;return n<au?(r=n,(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.seconds.singular.short.ago","{0} sec ago",r):ie("date.fromNow.seconds.singular.ago","{0} second ago",r):(e==null?void 0:e.short)?ie("date.fromNow.seconds.plural.short.ago","{0} secs ago",r):ie("date.fromNow.seconds.plural.ago","{0} seconds ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.seconds.singular.short","{0} sec",r):ie("date.fromNow.seconds.singular","{0} second",r):(e==null?void 0:e.short)?ie("date.fromNow.seconds.plural.short","{0} secs",r):ie("date.fromNow.seconds.plural","{0} seconds",r)):n<su?(r=Math.floor(n/au),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.minutes.singular.short.ago","{0} min ago",r):ie("date.fromNow.minutes.singular.ago","{0} minute ago",r):(e==null?void 0:e.short)?ie("date.fromNow.minutes.plural.short.ago","{0} mins ago",r):ie("date.fromNow.minutes.plural.ago","{0} minutes ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.minutes.singular.short","{0} min",r):ie("date.fromNow.minutes.singular","{0} minute",r):(e==null?void 0:e.short)?ie("date.fromNow.minutes.plural.short","{0} mins",r):ie("date.fromNow.minutes.plural","{0} minutes",r)):n<ga?(r=Math.floor(n/su),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.hours.singular.short.ago","{0} hr ago",r):ie("date.fromNow.hours.singular.ago","{0} hour ago",r):(e==null?void 0:e.short)?ie("date.fromNow.hours.plural.short.ago","{0} hrs ago",r):ie("date.fromNow.hours.plural.ago","{0} hours ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.hours.singular.short","{0} hr",r):ie("date.fromNow.hours.singular","{0} hour",r):(e==null?void 0:e.short)?ie("date.fromNow.hours.plural.short","{0} hrs",r):ie("date.fromNow.hours.plural","{0} hours",r)):n<Tf?(r=Math.floor(n/ga),(e==null?void 0:e.ago)?r===1?ie("date.fromNow.days.singular.ago","{0} day ago",r):ie("date.fromNow.days.plural.ago","{0} days ago",r):r===1?ie("date.fromNow.days.singular","{0} day",r):ie("date.fromNow.days.plural","{0} days",r)):n<Af?(r=Math.floor(n/Tf),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.weeks.singular.short.ago","{0} wk ago",r):ie("date.fromNow.weeks.singular.ago","{0} week ago",r):(e==null?void 0:e.short)?ie("date.fromNow.weeks.plural.short.ago","{0} wks ago",r):ie("date.fromNow.weeks.plural.ago","{0} weeks ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.weeks.singular.short","{0} wk",r):ie("date.fromNow.weeks.singular","{0} week",r):(e==null?void 0:e.short)?ie("date.fromNow.weeks.plural.short","{0} wks",r):ie("date.fromNow.weeks.plural","{0} weeks",r)):n<Pf?(r=Math.floor(n/Af),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.months.singular.short.ago","{0} mo ago",r):ie("date.fromNow.months.singular.ago","{0} month ago",r):(e==null?void 0:e.short)?ie("date.fromNow.months.plural.short.ago","{0} mos ago",r):ie("date.fromNow.months.plural.ago","{0} months ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.months.singular.short","{0} mo",r):ie("date.fromNow.months.singular","{0} month",r):(e==null?void 0:e.short)?ie("date.fromNow.months.plural.short","{0} mos",r):ie("date.fromNow.months.plural","{0} months",r)):(r=Math.floor(n/Pf),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.years.singular.short.ago","{0} yr ago",r):ie("date.fromNow.years.singular.ago","{0} year ago",r):(e==null?void 0:e.short)?ie("date.fromNow.years.plural.short.ago","{0} yrs ago",r):ie("date.fromNow.years.plural.ago","{0} years ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.years.singular.short","{0} yr",r):ie("date.fromNow.years.singular","{0} year",r):(e==null?void 0:e.short)?ie("date.fromNow.years.plural.short","{0} yrs",r):ie("date.fromNow.years.plural","{0} years",r))}u(po,"fromNow");var Ff,Rt;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Rt||(Rt={}));class Mf{constructor(){this[Ff]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,n=Rt.None){const r=this._map.get(e);if(!!r)return n!==Rt.None&&this.touch(r,n),r.value}set(e,n,r=Rt.None){let i=this._map.get(e);if(i)i.value=n,r!==Rt.None&&this.touch(i,r);else{switch(i={key:e,value:n,next:void 0,previous:void 0},r){case Rt.None:this.addItemLast(i);break;case Rt.First:this.addItemFirst(i);break;case Rt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const n=this._map.get(e);if(!!n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){const r=this._state;let i=this._head;for(;i;){if(n?e.bind(n)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const i={value:n.key,done:!1};return n=n.next,i}return{value:void 0,done:!0}}};return r}values(){const e=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const i={value:n.value,done:!1};return n=n.next,i}return{value:void 0,done:!0}}};return r}entries(){const e=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const i={value:[n.key,n.value],done:!1};return n=n.next,i}return{value:void 0,done:!0}}};return r}[(Ff=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,r=this.size;for(;n&&r>e;)this._map.delete(n.key),n=n.next,r--;this._head=n,this._size=r,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const n=e.next,r=e.previous;if(!n||!r)throw new Error("Invalid list");n.previous=r,r.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Rt.First&&n!==Rt.Last)){if(n===Rt.First){if(e===this._head)return;const r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===Rt.Last){if(e===this._tail)return;const r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((n,r)=>{e.push([r,n])}),e}fromJSON(e){this.clear();for(const[n,r]of e)this.set(n,r)}}u(Mf,"LinkedMap");class br extends Mf{constructor(e,n=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=Rt.AsNew){return super.get(e,n)}peek(e){return super.get(e,Rt.None)}set(e,n){return super.set(e,n,Rt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}u(br,"LRUCache");class Nf{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await f.commands.executeCommand(this.menuItem.command,e)}}u(Nf,"ContinueOnCommandQuickPickItem");var cu;(function(t){async function e(n,r,i){const o=yv(n).map(c=>new Nf(c)),a=f.window.createQuickPick(),s=[];try{return await new Promise(l=>{s.push(a.onDidHide(()=>l(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[d]=a.activeItems;l(d)}})),a.title=i,a.placeholder=r,a.items=o,a.show()})}finally{a.dispose(),s.forEach(c=>void c.dispose())}}u(e,"show"),t.show=e})(cu||(cu={}));function yv(t){var e,n,r,i,o;const a=new Map,[,s]=t.split(".");for(const l of f.extensions.all){const{name:d,displayName:h,contributes:g}=l.packageJSON;if(!g)continue;const p=(n=(e=g.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:n.continueOn;if(p==null?void 0:p.length){const y=new Map(((r=g.commands)!=null?r:[]).map(m=>[m.command,m]));for(const m of p){if(!m.command)continue;if(a.has(m.command)){U.warn(`Duplicate 'continueOn' menu command: ${m.command}`);continue}const v=y.get(m.command);if(!v){U.warn(`Unable to find 'continueOn' menu command: ${m.command}`);continue}if(!bv(m.when))continue;const S=(o=(i=m.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(m.command,{extension:{id:d,name:h,builtin:d===s},command:v.command,title:v.title,icon:typeof v.icon=="string"?v.icon:void 0,group:S>0?m.group.substr(0,S):m.group,order:S>0?Number(m.group.substr(S+1)):0,category:v.category})}}}function c(l,d){const h=l.group,g=d.group;if(h!==g){if(!h)return 1;if(!g||h==="navigation")return-1;if(g==="navigation")return 1;const p=h.localeCompare(g);if(p!==0)return p}return l.order<d.order?-1:l.order>d.order?1:l.title.localeCompare(d.title)}return u(c,"compareMenuItems"),[...a.values()].sort(c)}u(yv,"getContinueOnContributions");function bv(t){return t?t.split("&&").every(e=>{const n=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!n)return!0;const[,r,i,o,a,s]=n;if(i){if(i==="false")return!1;if(!Wn(i))return!0;const c=Mr(i);return r?!c:c}if(o&&a&&s)switch(a){case"==":return!Wn(o)||!Wn(s)||Mr(o)==Mr(s);case"!=":return!Wn(o)||!Wn(s)||Mr(o)!=Mr(s);case"=~":{if(!Wn(o))return!0;const c=Mr(o);try{return new RegExp(s.slice(1,-1)).test(String(c!=null?c:""))}catch{return!1}}}return!0}):!0}u(bv,"evaluateWhenClause");function Sv(t){return t!==void 0&&typeof t.then=="function"}u(Sv,"isPromise");const Cv="";function _v(...t){if(t.length===1){const e=t[0];return e===void 0?Cv:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof f.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}u(_v,"defaultResolver");function Sr(t){return(e,n,r)=>{let i;if(typeof r.value=="function"?i=r.value:typeof r.get=="function"&&(i=r.get),i===void 0)throw new Error("Not supported");const o=`$gate$${n}`;r.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:_v)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let c=this[s];if(c===void 0){let l;try{if(l=i.apply(this,a),l==null||!Sv(l))return l;this[s]=c=l.then(d=>(this[s]=void 0,d)).catch(d=>{throw this[s]=void 0,d})}catch(d){throw this[s]=void 0,d}}return c}}}u(Sr,"gate");var xv=Object.defineProperty,Iv=Object.getOwnPropertyDescriptor,Hs=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Iv(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&xv(e,n,i),i},"__decorateClass");const gn=J.loadMessageBundle();class mo{showGitHubStatus500Message(){return f.window.showErrorMessage(gn("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),gn("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void f.window.showErrorMessage(gn("401 error notification","The provided credentials are either invalid or expired."),gn("ok","OK"));const n=gn("401 error notification confirm","Reauthenticate");await f.window.showErrorMessage(gn("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),n)===n&&e()}async showStatus403Message(e){if(!e)return void f.window.showErrorMessage(gn("403 error notification","The provided credentials do not have the required access."),gn("ok","OK"));const n=gn("403 error notification confirm","Reauthenticate"),r=gn("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?");await f.window.showErrorMessage(r,n)===n&&e()}async showProviderNotFoundMessage(e){const n=Ev.get(e.id);if(n&&f.extensions.getExtension(n[0])===void 0){const r=gn("provider extension missing install","Install");if(await f.window.showInformationMessage(gn("provider extension not installed","Extension '{0}' is not installed. Would you like to install the extension and reload the window to open this workspace?",n[1]),{modal:!0},r)!==r)return;await f.commands.executeCommand("workbench.extensions.installExtension",n[0]),await f.commands.executeCommand("workbench.action.reloadWindow")}}}u(mo,"Messages"),Hs([Sr(()=>"")],mo.prototype,"showGitHubStatus500Message",1),Hs([Sr(()=>"")],mo.prototype,"showStatus401Message",1),Hs([Sr(()=>"")],mo.prototype,"showStatus403Message",1),Hs([Sr()],mo.prototype,"showProviderNotFoundMessage",1);const Ev=new Map([["github",["GitHub.remotehub","GitHub Repositories"]],["azurerepos",["ms-vscode.azure-repos","Azure Repos"]]]),lu=new mo,Ws=J.loadMessageBundle();async function Mn(t,e,n){var r,i,o,a,s;if(da.instance.publicLog2("openWorkspace",{location:e.location}),e.location===ze.AddToWorkspace){const l=(i=(r=f.workspace.workspaceFolders)==null?void 0:r.length)!=null?i:0;return void f.workspace.updateWorkspaceFolders(l,0,{uri:e.uri,name:e.name})}if(e.location===ze.CurrentWindow&&!(n==null?void 0:n.skipChangesPrompt)){const l=await t.getWorkspaceProvidersWithChanges();if(l.length){const d={title:Ws("continue","Continue")},h={title:Ws("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showWarningMessage(Sn?Ws("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(p=>p.name).join(", ")):Ws("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(p=>p.name).join(", ")),{modal:!0},d,h)!==d){da.instance.publicLog2("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const c=f.env.remoteName?!0:void 0;return e.filesToOpen&&(e.location===ze.CurrentWindow&&c===void 0&&((o=f.workspace.workspaceFolders)==null?void 0:o.length)===1&&f.workspace.workspaceFolders[0].uri.toString()===e.uri.toString()?await((a=cc())==null?void 0:a.openPendingFiles(e.uri,e.filesToOpen)):await((s=cc())==null?void 0:s.setPendingFilesToOpen(e.uri,e.filesToOpen))),da.instance.publicLog2("openWorkspace.success",{location:e.location,forceLocalWindow:String(c)}),void f.commands.executeCommand("vscode.openFolder",e.uri,{forceNewWindow:e.location===ze.NewWindow,forceLocalWindow:c})}u(Mn,"openWorkspace");const $e=J.loadMessageBundle();function kv(t,e,n){let r=!1;async function i(){var a;if(await Wt(t,void 0),!r){const c=t.getRemoteSourceProviders(),l=await((a=f.extensions.getExtension("vscode.git-base"))==null?void 0:a.activate()),d=l==null?void 0:l.getAPI(1);if(!d)return;c.map(h=>d.registerRemoteSourceProvider(h)),r=!0}const s=await f.commands.executeCommand("git-base.api.getRemoteSources",{title:$e("open remote repository","Open Remote Repository"),placeholder:$e("open repo placeholder","Enter a remote url, or select a remote provider"),showRecentSources:!0,providerLabel:c=>{var l;return(l=c.label)!=null?l:$e("open repo from","Open Repository from {0}",c.name)},urlLabel:c=>{const l=t.canOpenRemoteUrl(c);if(l){const{provider:d,urlType:h}=l;switch(h){case ar.Branch:return $e("remote url picker open branch","Open Branch from {0} Repository",d.name);case ar.Tag:return $e("remote url picker open tag","Open Tag from {0} Repository",d.name);case ar.Commit:return $e("remote url picker open commit","Open Commit from {0} Repository",d.name);case ar.File:return $e("remote url picker open file","Open File from {0} Repository",d.name);case ar.PullRequest:return $e("remote url picker open pull request","Open Pull Request from {0} Repository",d.name);default:return $e("remote url picker open repository","Open {0} Repository",d.name)}}return $e("remote url picker open unknown","Enter a Remote Url")}});if(!s){n.publicLog2("openRepository.abort",{reason:"abandoned"});return}try{const l=f.workspace.getConfiguration("window").get("openFoldersInNewWindow")==="on"?ze.NewWindow:ze.CurrentWindow,d=await t.createWorkspaceForRemoteUrl(s,void 0,l);if(!d){n.publicLog2("openRepository.abort",{reason:"aborted invalid url"});return}await Mn(t,d)}catch(c){if(n.sendException(c),Ze.asVirtualProviderErrorCode(c)===je.InvalidCredentialsError){const{action:l}=c;if(l){lu.showStatus401Message(()=>l());return}}U.error(c)}}u(i,"openRepository");async function o(a,s,c){if(c==null?void 0:c.workspaceFolder){const d=t.getRepository(c.workspaceFolder,s);if(d!==void 0)return d}const l=s?t.repositories.filter(d=>d.provider.id===s):t.repositories;if(l.length!==0){if(l.length>1){const d=await f.window.showQuickPick(l.map(h=>({label:h.name,description:h.provider.name,repository:h})),{placeHolder:a});return d?d.repository:void 0}return l[0]}}return u(o,"getRepository"),[f.commands.registerCommand("remoteHub.openRepository",()=>(n.publicLog2("command.openRepository"),i())),f.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(n.publicLog2("command.continueOn.openRepository"),i())),f.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{}),f.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{}),f.commands.registerCommand("remoteHub.continueOn",async()=>{var a;const s=await o($e("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(s===void 0)return;n.publicLog2("command.continueOn");const c=await cu.show(e,$e("continue on placeholder","Choose how you would like to continue working"),$e("continue on title","Continue '{0}' on",s.name));if(!c){n.publicLog2("command.continueOn.abort",{reason:"abandoned"});return}if(await t.changeStoreHasChanges(s.uri)){const d={title:$e("continue","Continue")},h={title:$e("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showWarningMessage($e("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0},d,h)!==d){n.publicLog2("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const{HEAD:l}=await s.getMetadata();if(((a=l.branch)==null?void 0:a.remote)!==void 0){const h=t.getRemoteUri(s.provider.id,{repo:l.branch.remote.repo}).toString(!0),g=await t.createWorkspaceForRemoteUrl(h);if(!g)throw new Error(`Unable to create workspace for URL: ${h}`);await c.execute({provider:s.provider,workspaceFolder:g.uri,name:l.branch.remote.name,url:h,ref:l.branch.name})}else{const d=t.getRemoteUri(s.provider.id,{repo:s.id});await c.execute({provider:s.provider,workspaceFolder:s.uri,name:s.name,url:d==null?void 0:d.toString(!0),ref:l.name})}}),f.commands.registerCommand("remoteHub.openOnDesktop",async a=>{if(!Sn)return;const s=await o($e("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,a);if(s===void 0)return;const c=await t.getBestRemoteUri(s.uri);c!==void 0&&(n.publicLog2("command.openOnDesktop"),f.env.openExternal(f.Uri.parse(`${f.env.uriScheme}://${e}/open?url=${encodeURIComponent(c.toString(!0))}`)))}),f.commands.registerCommand("remoteHub.openOnWeb",async a=>{if(Sn)return;const s=await o($e("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,a);if(s===void 0)return;const c=await t.getBestRemoteUri(s.uri);c!==void 0&&(n.publicLog2("command.openOnWeb"),f.env.openExternal(c))}),f.commands.registerCommand("remoteHub.goToRepository",async()=>{var a,s;n.publicLog2("command.goToRepository");const c=await o($e("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!c)return;const l=await t.getMetadata(c.uri);let d;const h={provider:c.provider,repo:c.id,path:((a=f.window.activeTextEditor)==null?void 0:a.document.uri)&&f.window.activeTextEditor.document.uri.scheme===se.scheme?t.getRelativeFilePath(f.window.activeTextEditor.document.uri):void 0};return l.HEAD.type===me.Branch&&(((s=f.window.activeTextEditor)==null?void 0:s.document)||l.defaultBranch.name!==l.HEAD.name)?d={...h,branch:l.HEAD.name}:l.HEAD.type===me.Tag?d={...h,tag:l.HEAD.name}:l.HEAD.type===me.Commit?d={...h,sha:l.HEAD.sha}:d={...h},f.commands.executeCommand("remoteHub.openOnRemote",d)}),f.commands.registerCommand("remoteHub.openOnRemote",async a=>{n.publicLog2("command.openOnRemote");const{provider:s,...c}=a,l=t.getRemoteUri(s.id,c);if(l){await f.env.openExternal(l);return}f.window.showErrorMessage($e("open on remote command provider not supported","Unable to open the resource on {0}",a.provider.name))}),f.commands.registerCommand("remoteHub.clone",async a=>{const s=await o($e("clone placeholder","Choose which repository to clone"),void 0,a);if(s!==void 0){if(n.publicLog2("command.clone"),a===void 0&&await t.changeStoreHasChanges(s.uri)){const c={title:$e("continue","Continue")},l={title:$e("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showWarningMessage($e("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0},c,l)!==c){n.publicLog2("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(s.uri)}}),f.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),f.commands.registerCommand("remoteHub.enableDebugLogging",()=>ce.updateEffective("logLevel",rt.Debug)),f.commands.registerCommand("remoteHub.disableDebugLogging",()=>ce.updateEffective("logLevel",rt.Warn)),f.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{t.changeStoreExportDebugInfo()}),f.commands.registerCommand("remoteHub.setContext",async(a,s)=>{if(!a.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await Cn(a,s)}),f.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const a={title:$e("continue on","Continue Working On...")};await f.window.showInformationMessage($e("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},a)===a&&await f.commands.executeCommand("remoteHub.continueOn")}),f.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>Sn?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}u(kv,"registerCommands");function Nn(t){return t}u(Nn,"command");async function Lf(t,e){return f.commands.executeCommand(t,e)}u(Lf,"executeCommand");function Rv(t,e){return t.reduce((r,i)=>{const o=e(i),a=r.get(o);return a===void 0?r.set(o,[i]):a.push(i),r},new Map)}u(Rv,"groupBy");function Zw(t){let e=0;for(const n of t){if(n===0)return!0;if(e++,e>8e3)break}return!1}u(Zw,"isBinary");function Dv(t,e,n=r=>r){return[...t.reduce((i,o)=>{const a=e(o),s=i.get(a);if(s===void 0)i.set(a,o);else{const c=n(s,o);c!==void 0&&i.set(a,c)}return i},new Map).values()]}u(Dv,"uniqueBy");function Bs(t,e){switch(t){case me.Branch:case me.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case me.Tag:return"$(tag)";case me.Commit:return"$(git-commit)"}}u(Bs,"headTypeToCodicon");function Uf(t){switch(t){case bn.Active:return"$(layers-active)";case bn.Match:return"$(layers-dot)";case bn.Indexed:return"$(layers)"}}u(Uf,"indexTypeToCodicon");function Tv(t,e){switch(t){case me.Branch:case me.RemoteBranch:return e?new f.ThemeIcon("git-pull-request"):new f.ThemeIcon("git-branch");case me.Tag:return new f.ThemeIcon("tag");case me.Commit:return new f.ThemeIcon("git-commit")}}u(Tv,"headTypeToThemeIcon");function*Av(t,e){for(const n of t)yield*e(n)}u(Av,"flatMap");function*Pv(t,e){for(const n of t)e(n)&&(yield n)}u(Pv,"filter");function*e0(t,e){for(const n of t){const r=e(n);r!=null&&(yield r)}}u(e0,"filterMap");function t0(t,e){for(const n of t)if(e(n))return n}u(t0,"find");function Fv(t,e){let n="";const r=t[Symbol.iterator]();let i=r.next();if(i.done)return n;for(;;){const o=i.value.toString();if(i=r.next(),i.done){n+=o;break}n+=o,n+=e}return n}u(Fv,"join");function*uu(t,e){for(const n of t)yield e(n)}u(uu,"map");function n0(t,e){for(const n of t)if(e(n))return!0;return!1}u(n0,"some");function*r0(...t){for(const e of t)for(const n of e)yield n}u(r0,"union");function*Mv(t){const e=new Set;for(const n of t)e.has(n)||(e.add(n),yield n)}u(Mv,"unique");const Nv="";function Lv(...t){if(t.length===1){const e=t[0];return e===void 0?Nv:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof f.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}u(Lv,"serialize_defaultResolver");function $s(t){return(e,n,r)=>{let i;if(typeof r.value=="function"?i=r.value:typeof r.get=="function"&&(i=r.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${n}`;r.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:Lv)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let c=this[s];const l=u(()=>i.apply(this,a),"run");return c===void 0?c=l():c=c.then(l,l),this[s]=c,c}}}u($s,"serialize");let du=0;function Uv(){return du===Number.MAX_SAFE_INTEGER&&(du=0),String(++du)}u(Uv,"getNextLockId");class Of{constructor(){this.id=Uv()}async synchronize(e){let n;const r=this.promise;this.promise=new Promise(i=>n=i),await r;try{return await e()}finally{n()}}}u(Of,"Lock");class pa{constructor(e){this.lock=new Of,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,n){let r;const i=new Ae(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:n?` \u2022 ${n}`:""},logLevel:rt.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>r=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:n?` \u2022 ${n}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:n?` \u2022 ${n}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),r()}}async synchronizeWrite(e,n){let r;const i=new Ae(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:n?` \u2022 ${n}`:""},logLevel:rt.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>r=o)}),i.restart({prefix:"(L) ",suffix:n?` \u2022 ${n}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:n?` \u2022 ${n}`:"",took:" locked for "}),r(),this.writer=void 0}}}u(pa,"ReaderWriterLock");class Hf{constructor(){this.locks=new Map}async synchronizeRead(e,n,r){let i=this.locks.get(e);return i===void 0&&(i=new pa(String(e)),this.locks.set(e,i)),i.synchronizeRead(n,r)}async synchronizeWrite(e,n,r){let i=this.locks.get(e);return i===void 0&&(i=new pa(String(e)),this.locks.set(e,i)),i.synchronizeWrite(n,r)}}u(Hf,"KeyedReaderWriterLock");const rn=J.loadMessageBundle(),ma=u(class{constructor(t,e,n,r){this.providerService=t,this.storageService=e,this.changeStore=n,this.workspaceId=r,this._onDidChange=new f.EventEmitter,this.cache=new Map,this.lock=new pa("WorkspaceRepositories"),this.disposable=f.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await f.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void f.window.showTextDocument(t)}onChangeStoreChanged(t){const e=Dv(t.map(n=>n.rootUri),n=>N(n)).map(n=>this.providerService.getRepository(n)).filter(n=>Boolean(n));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let n=this.cache.get("workspaceRepositories");return n===void 0&&(n=[...(await this.getCore()).values()].sort((r,i)=>i.timestamp-r.timestamp),this.cache.set("workspaceRepositories",n)),n},"WorkspaceRepositories.get");if(t){const n=N(t);e=e.filter(r=>N(r.canonicalUri)===n)}return e}async getCore(){return this.fromStorage(await this.storageService.get(ma.storageKey))}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(t){const e=await this.getRecents();if(e.length!==0)return e.filter(n=>n.provider.id===t)}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),n=`${t.workspaceId}/${N(t.uri)}`,r=e.get(n);if(r===void 0)return;const i=this.changeStore.getScopedChangeStore(r),o=await i.getChanges(r.uri);if(o.length!==0){const a={title:rn("remove remote repo prompt confirm","Yes")},s={title:rn("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await f.window.showWarningMessage(o.length===1?rn("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):rn("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0},a,s)!==a)return;await i.discardAll(r.uri)}this.cache.clear(),e.delete(n);try{await this.storageService.store(ma.storageKey,this.toStorage(e))}catch(a){throw U.error(a,"Failed to save workspace repositories"),a}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const n of t){const[{HEAD:r,pullRequest:i},o]=await Promise.all([n.getMetadata(),n.getIndexMetadata()]),a=await this.changeStore.getChanges(n.uri);e.set(`${this.workspaceId}/${N(n.uri)}`,{workspaceId:this.workspaceId,uri:n.uri,canonicalUri:n.canonicalUri,name:n.name,provider:n.provider,ref:{type:r.type,name:r.name},idx:(o==null?void 0:o.type)&&bn.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:Hv(a),timestamp:Date.now()})}try{await this.storageService.store(ma.storageKey,this.toStorage(e))}catch(n){throw U.error(n,"Failed to save workspace repositories"),n}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(n,r)=>(n==="uri"||n.endsWith("Uri"))&&Ar(r)?f.Uri.from(r):r);return new Map(e.workspaceRepositories)}catch(e){return U.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:ma.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let Wf=ma;Wf.storageKey="workspaceRepositories",Wf.storageSchemaVersion=1;function Bf(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}u(Bf,"hasChanges");function Ov(t){return Bf(t.changes)}u(Ov,"hasUncommittedChanges");function Hv(t){let e=0,n=0,r=0;for(const i of t)switch(i.type){case R.Created:e++;break;case R.Changed:n++;break;case R.Deleted:r++;break}return e||n||r?{added:e,changed:n,deleted:r,timestamp:Date.now()}:void 0}u(Hv,"toChangesSummary");function hu(t,{compact:e=!0,preamble:n,separator:r=", ",short:i=!1,single:o=!1}={}){if(!Bf(t))return rn("no changes","Everything up to date");const{added:a,changed:s,deleted:c}=t;if(o){const d=a+s+c;return d===1?rn("summary change","{0} change",d):rn("changes changes","{0} changes",d)}let l=`${n!=null?n:""}`;return(a||!e)&&(l+=i?`+${a}`:a===1?rn("file added","{0} file added",a):rn("files added","{0} files added",a),(s||c||!e)&&(l+=r)),(s||!e)&&(l+=i?`~${s}`:s===1?rn("file changed","{0} file changed",s):rn("files changed","{0} files changed",s),(c||!e)&&(l+=r)),(c||!e)&&(l+=i?`-${c}`:c===1?rn("file deleted","{0} file deleted",c):rn("files deleted","{0} files deleted",c)),l}u(hu,"formatChangesSummary");class Ot extends Error{constructor(e){var n;const r=typeof e=="string"?e:Ht.getProviderId(e);super(`No provider registered with ${r}`);this.id=r,(n=Error.captureStackTrace)==null||n.call(Error,this,Ot)}}u(Ot,"ProviderNotFoundError");class $f{constructor(e,n,r,i,o){this.providerService=e,this.uri=n,this.id=r,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}u($f,"VirtualRepository");var Ln;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(Ln||(Ln={}));var Re;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(Re||(Re={})),function(t){function e(n){return n!==void 0&&(n===t.Indexed||n===t.Match||n===t.Active)}u(e,"hasIndex"),t.hasIndex=e}(Re||(Re={}));var fu;(function(t){function e(n){return n!==void 0&&n.type===3}u(e,"isActive"),t.isActive=e})(fu||(fu={}));var on;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(on||(on={}));var Si;(function(t){function e(n){const r=se.decodeAuthority(n).metadata;if(!(r===void 0||r.idx===void 0)){if(r.idx==="latest")return{type:1};if(nt(r.idx))return{type:2,sha:r.idx}}}u(e,"decode"),t.decode=e})(Si||(Si={}));var i0=Ye(724),Wv=Object.defineProperty,Bv=Object.getOwnPropertyDescriptor,$v=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Bv(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Wv(e,n,i),i},"providers_decorateClass");const Vv=J.loadMessageBundle(),Vf="remoteHub.metadata.migration.invalidTagSha",Kt=u(class{constructor(t,e){this.telemetryService=t,this.workspaceState=e,this._providers=new Map,this._indexProviders=new Map,this._onDidChangeProviders=new f.EventEmitter,this._onDidChangeChangeStore=new f.EventEmitter,this._onDidChangeWorkspaceRepositories=new f.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new f.EventEmitter,this._onDidChangeRepository=new f.EventEmitter,this._onDidSyncRepository=new f.EventEmitter,this._onDidRefresh=new f.EventEmitter,this._onWillRefresh=new f.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=f.Disposable.from(f.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeChangeStore(){return this._onDidChangeChangeStore.event}get onDidChangeWorkspaceRepositories(){return this._onDidChangeWorkspaceRepositories.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(N(t.uri));!e||(U.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const n=N(e.uri);if(e.uri.scheme!==Kt.scheme||this._repositories.has(n))continue;const r=this.getProvider(e.uri);if(!r)continue;this._repositories.set(n,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),a=new $f(this,e.uri,i,o,r);this._repositories.set(n,a),this._onDidChangeRepositories.fire({added:[a],removed:[]}),this.telemetryService.publicLog2("repository.opened",{provider:r.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const n=N(e.uri);if(e.uri.scheme!==Kt.scheme||!this._repositories.has(n))continue;const r=this._repositories.get(n);this._repositories.delete(n),r&&(this._onDidChangeRepositories.fire({added:[],removed:[r]}),this.telemetryService.publicLog2("repository.closed",{repositories:this._repositories.size.toString()}))}Cn(lr.HasVirtualFolders,this._repositories.size!==0),Cn(lr.VirtualFolderProviders,Fv(Mv(uu(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...uu(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}registerVirtualIndexProvider(t,e){if(this._indexProviders.has(t))throw new Error(`Virtual index provider '${t}' has already been registered`);return this._indexProviders.set(t,e),{dispose:()=>{this._indexProviders.delete(t)}}}register(t,e,n,r,i,o,a,s){var c;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const l={id:t,name:e,provider:n,fs:r,storage:i,changeStore:o,metadataStore:a,workspaceRepositories:s};this._providers.set(t,l);const d=f.Disposable.from(l.metadataStore.onDidChange(h=>this.onMetadataChanged(h)),l.changeStore.onDidChange(h=>this._onDidChangeChangeStore.fire(h)),l.workspaceRepositories.onDidChange(async()=>{const h=await this.workspaceRepositoriesGetRepositories();Cn(lr.HasRecentRepositories,h.length>0),this._onDidChangeWorkspaceRepositories.fire()}));return this._onDidChangeProviders.fire({added:[l],removed:[]}),this.telemetryService.publicLog2("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(c=f.workspace.workspaceFolders)!=null?c:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const h=[];for(const[g,p]of[...this._repositories])(p==null?void 0:p.provider.id)===t&&(this._repositories.delete(g),h.push(p));this._onDidChangeRepositories.fire({added:[],removed:h}),this._onDidChangeProviders.fire({added:[],removed:[l]}),d.dispose()}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const n of this._providers.values()){t.push(...uu(this.getRepositories(n.id),i=>i.uri));const r=this._indexProviders.get(n.id);r!==void 0&&e.push(r)}this._onWillRefresh.fire(t),t.forEach(n=>this.getMetadataStore(n).refresh()),e.forEach(n=>n.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const n=f.workspace.getWorkspaceFolder(t);if(!n||n.uri.scheme!==Kt.scheme)return;const r=this._repositories.get(N(n.uri));if(!(e!==void 0&&(r==null?void 0:r.provider.id)!==e))return r!=null?r:void 0}getRepositories(t){return Pv(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}hasProvider(t,e){const n=typeof t=="string"?t:Kt.getProviderId(t),r=this._providers.get(n);return e!==void 0&&(r==null?void 0:r.id)!==e?!1:r!==void 0}getProvider(t){const e=typeof t=="string"?t:Kt.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.provider;if(n)return n;throw new Ot(t)}getChangeStore(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.changeStore;if(n)return n;throw new Ot(t)}getMetadataStore(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.metadataStore;if(n)return n;throw new Ot(t)}getWorkspaceRepositories(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.workspaceRepositories;if(n)return n;throw new Ot(t)}getFileSystemProvider(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.fs;if(n)return n;throw new Ot(t)}getStorageService(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.storage;if(n)return n;throw new Ot(t)}async getRecentRemoteSourceProviders(){return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Vv("pick","Choose a recent repository"),getRemoteSources:async()=>{const t=[];for(const[,e]of this._providers.entries()){const n=await e.workspaceRepositories.getRemoteWorkspaceSourceProvider(e.id);t.push(...n!=null?n:[])}if(t.length!==0)return Promise.all(t.sort((e,n)=>n.timestamp-e.timestamp).map(async e=>({providerId:e.provider.id,name:e.name,icon:"repo",description:po(e.timestamp,{ago:!0}),detail:`${e.provider.name}${e.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${e.pullRequest.id}`:""}${se.isCanonicalUri(e.uri)?"":`\xA0\xA0\u2022\xA0\xA0${Bs(e.ref.type)} ${e.ref.name}`}\xA0\xA0\u2022\xA0\xA0${hu(e.changes)}${e.idx?`\xA0\xA0\u2022\xA0\xA0${Uf(e.idx.type)}`:""}`,url:(await this.getBestRemoteUri(e.uri)).toString()})))}}}getRemoteSourceProviders(t){const e=u(n=>n.provider.getRemoteSourceProviders().map(i=>{var o;return{...i,getRecentRemoteSources:(o=i.getRecentRemoteSources)!=null?o:async()=>{var a;const s=(a=await n.workspaceRepositories.getRemoteWorkspaceSourceProvider(n.id))!=null?a:[];return Promise.all(s.map(async c=>({providerId:c.provider.id,name:c.name,icon:"repo",timestamp:c.timestamp,description:po(c.timestamp,{ago:!0}),detail:`${c.provider.name}${c.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${c.pullRequest.id}`:""}${se.isCanonicalUri(c.uri)?"":`\xA0\xA0\u2022\xA0\xA0${Bs(c.ref.type)} ${c.ref.name}`}\xA0\xA0\u2022\xA0\xA0${hu(c.changes)}${c.idx?`\xA0\xA0\u2022\xA0\xA0${Uf(c.idx.type)}`:""}`,url:(await this.getBestRemoteUri(c.uri)).toString()})))}}}),"createRemoteSourceProviders");if(t){const n=this.getProvider(t);return n?e(n):[]}return[...Av(this._providers.values(),n=>{var r;return(r=e(n))!=null?r:[]})]}async getWorkspaceProvidersWithChanges(){var t,e;const n=new Map;for(const r of(t=f.workspace.workspaceFolders)!=null?t:[])if(r.uri.scheme===se.scheme&&await this.getChangeStore(r.uri).hasChanges(r.uri)){const i=(e=this.getRepository(r.uri))==null?void 0:e.provider;if(!i)continue;n.set(i.id,i)}return[...n.values()]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new Ot(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const n=this.getProvider(e),r=n==null?void 0:n.provider.canOpenRemoteUrl(t);return r!==void 0?{provider:n,urlType:r}:void 0}for(const n of this._providers.values()){const r=n.provider.canOpenRemoteUrl(t);if(r!==void 0)return{provider:n,urlType:r}}}async createWorkspaceForRemoteUrl(t,e,n=ze.CurrentWindow){var r;const i=this.canOpenRemoteUrl(t,e);return(r=i==null?void 0:i.provider)==null?void 0:r.provider.createWorkspaceForRemoteUrl(t,n)}async openWorkspace(t,e){return Mn(this,t,e)}createProviderUri(t,e,n){return se.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(Kt.baseVirtualWorkspaceUri,e,n))}createRelativeProviderUri(t,e){return se.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const n=this.getProviderRootUri(t);let r=`${n.path}/`;r.endsWith("/")&&(r=r.slice(0,-1));const i=n.with({path:`${n.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===Kt.scheme?se.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return se.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,n){return this.getRepositoryProvider(t).createVirtualUri(Kt.baseVirtualWorkspaceUri,e,n)}async getBestRemoteUri(t,e){const{provider:n,repo:r,ref:i}=this.getVirtualUriMetadata(t);if(e===Ln.Repository)return this.getRemoteUri(n.id,{repo:r});if(e===Ln.PullRequest||e===void 0&&(i==null?void 0:i.type)===Fe.PullRequest){if((i==null?void 0:i.type)===Fe.PullRequest)return this.getRemoteUri(n.id,{repo:r,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===Ln.PullRequest&&o)return this.getRemoteUri(n.id,{repo:r,pullRequest:{id:o.id}})}if(e===Ln.Branch||e===void 0&&(i==null?void 0:i.type)===Fe.Branch){if((i==null?void 0:i.type)===Fe.Branch)return this.getRemoteUri(n.id,{repo:r,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===me.Branch||o.type===me.RemoteBranch&&e===Ln.Branch)return this.getRemoteUri(n.id,{repo:r,branch:o.branch.name})}if(e===Ln.Tag||e===void 0&&(i==null?void 0:i.type)===Fe.Tag){if((i==null?void 0:i.type)===Fe.Tag)return this.getRemoteUri(n.id,{repo:r,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===me.Tag)return this.getRemoteUri(n.id,{repo:r,tag:o.detached.name})}if(e===Ln.Commit||e===void 0&&((i==null?void 0:i.type)===Fe.Commit||(i==null?void 0:i.type)===Fe.Tree&&nt(i.id))){if((i==null?void 0:i.type)===Fe.Commit||(i==null?void 0:i.type)===Fe.Tree&&nt(i.id))return this.getRemoteUri(n.id,{repo:r,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===Ln.Commit||o.type===me.Commit)return this.getRemoteUri(n.id,{repo:r,sha:o.sha})}if(e===void 0)return this.getRemoteUri(n.id,{repo:r})}getCanonicalUri(t){let{authority:e}=t;const n=e.indexOf(Kt.authoritySeparator);return n!==-1&&(e=e.substr(0,n)),t.with({authority:e})}getRemoteUri(t,e){var n,r;return(r=(n=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:r.call(n,e)}getProviderRootUri(t){return t=se.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=se.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualCanonicalRootUri(t){const e=se.getVirtualUri(this.getProviderRootUri(t));let{authority:n}=e;const r=n.indexOf(Kt.authoritySeparator);return r!==-1&&(n=n.substr(0,r)),e.with({authority:n})}getVirtualRootUri(t){return se.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=f.workspace.getWorkspaceFolder(se.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,n){var r,i;const o=this.getChangeStore(t);return(i=(r=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:i.call(r,t,e,n,o)}async getCommitOperations(t,e){const n=this.getChangeStore(t);let r;return(e==null?void 0:e.staged)?(r=await n.getStagedChanges(t),r.length===0&&e.staged==="auto"&&(r=await n.getChanges(t))):r=await n.getChanges(t),r.map(o=>{const a=this.getRelativeFilePath(t,o.uri);switch(o.type){case R.Created:case R.Changed:return{type:o.type,path:a,fileType:o.fileType,content:n.readFile(o.uri).then(async s=>{if(!s)throw this.telemetryService.sendErrorEvent("changeStore.readFailed",{reason:"content undefined"}),new Error("No working content for created or changed commit operation");if(await Zr(s)!==o.hash)throw this.telemetryService.sendErrorEvent("changeStore.readFailed",{reason:"content hash mismatch"}),new Error("Working file content hash does not match expected file content hash");return s})};case R.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(t){return{...await this.getMetadataCore(this.getVirtualRootUri(t)),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getIndexProvider(t);return e?e.getIndexMetadata(t):void 0}getModeConfig(t,e,n){return ce.getMode(this.getVirtualRootUri(t),e,Boolean(n))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.id;return n?this._indexProviders.get(n):void 0}async getMetadataCore(t){const e=N(t);let n=this.pendingMetadataRequests.get(e);if(n)return n;let{revision:r,cachedMetadata:i}=await this.getMetadataStore(t).get(t);const o=(i==null?void 0:i.HEAD.type)===me.Tag;if(i!==void 0&&(!o||this.workspaceState.get(Vf)))return i;const a=this.getProvider(t);if(!a)throw new Ot(t);const s=Si.decode(t);(s==null?void 0:s.type)===on.SHA&&(r=s.sha),n=a.provider.createMetadata(t,r),this.pendingMetadataRequests.set(e,n);try{const c=await n;return await this.updateMetadataCore(t,c,{silent:!0}),o&&await this.workspaceState.update(Vf,!0),c}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(t,e){const n=new Ae(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.getMetadataStore(t).set(se.getVirtualUri(t),e.HEAD.sha,e)}finally{n.stop()}}updateMetadataCore(t,e,n){return this.getMetadataStore(t).set(se.getVirtualUri(t),e.HEAD.sha,e,n)}async clone(t){const{cloneUrl:e}=await this.getMetadata(t),r=ce.get("gitProtocol")==="http"?e.http:e.ssh;if(!r)throw new Error("No url found for clone");if(Sn)return void f.env.openExternal(f.Uri.parse(`${f.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(r)}`));const i=u(async o=>{try{await o.activate(),await f.commands.executeCommand("git.clone",r)}catch(a){U.error(a,"Unable to clone repository")}},"cloneRepository");if(f.workspace.isTrusted){const o=f.extensions.getExtension("vscode.git");if(o)await i(o);else throw new Error("Git extension not found")}else{const o=f.extensions.onDidChange(async()=>{const s=f.extensions.getExtension("vscode.git");s&&(await i(s),o.dispose())});await f.workspace.requestWorkspaceTrust()||o.dispose()}}createBranch(t,e,n,r){return this.getRepositoryProvider(t).createBranch(t,e,n,r)}createAndPushCommit(t,e,n,r,i,o){return this.getRepositoryProvider(t).createAndPushCommit(t,e,n,r,i,o)}createPullRequest(t,e,n,r,i){return this.getRepositoryProvider(t).createPullRequest(t,e,n,r,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}async fetchOrSync(t){await this.getChangeStore(t).hasChanges(t)?await this.fetch(t):await this.sync(t,{reason:"invoked"})}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var n;return(n=this.getRepositoryProvider(t))==null?void 0:n.getCommits(t,e)}compareCommits(t,e){var n;return(n=this.getRepositoryProvider(t))==null?void 0:n.compareCommits(t,e)}getFileContent(t,e,n){return this.getRepositoryProvider(t).getFileContent(t,e,n)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,n,r;return(r=(n=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:n.call(e,t))!=null?r:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var n,r;return(r=(n=this.getIndexProvider(t))==null?void 0:n.getSnapshots(t,e))!=null?r:Promise.resolve([])}async getTarGz(t,e,n){var r,i;return(i=(r=this.getRepositoryProvider(t)).getTarGz)==null?void 0:i.call(r,t,e,n)}async loadWorkspaceContents(t){return this.getRepositoryProvider(t).loadWorkspaceContents(t)}switchTo(t,e,n){return this.getRepositoryProvider(t).switchTo(t,e,n)}async sync(t,e){const n=this._repositories.get(N(t));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const r=this.getProvider(t),i=this.getIndexProvider(t);if(r===void 0)throw new Ot(t);let{to:o,reason:a,...s}=e!=null?e:{};o===void 0&&i&&(o=await i.resolveIndexRef(t,a==="user"));const c=this.getChangeStore(t);if(await c.hasMergeConflicts(t))throw Ze.UnresolvedConflictsError();return await r.provider.sync(t,c,{conflictResolution:Jr.Abort,...s,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}changeStoreApplyChangeset(t,e,n){return this.getChangeStore(t).applyChangeset(t,e,n)}changeStoreCreateFile(t,e){return this.getChangeStore(t).createFile(t,e)}changeStoreCreateDirectory(t){return this.getChangeStore(t).createDirectory(t)}changeStoreDeleteDirectory(t){return this.getChangeStore(t).deleteDirectory(t)}changeStoreDeleteFile(t){return this.getChangeStore(t).deleteFile(t)}changeStoreExportDebugInfo(){var t;for(const e of(t=f.workspace.workspaceFolders)!=null?t:[])this.getChangeStore(e.uri).exportDebugInfo(e.uri)}changeStoreGetChange(t){return this.getChangeStore(t).getChange(t)}changeStoreGetChanges(t,e){return this.getChangeStore(t).getChanges(this.stripUriScope(t),e)}changeStoreGetScopedChangeStore(t,e){const n=typeof e=="string"?e:e.workspaceId;return this.getChangeStore(t).getScopedChangeStore(n)}changeStoreGetScopedUri(t,e){const n=typeof e=="string"?e:e.workspaceId;return this.getChangeStore(t).getScopedUri(t,n)}changeStoreHasChanges(t){return this.getChangeStore(t).hasChanges(this.stripUriScope(t))}changeStoreMaybeHasChanges(t,e){return this.getChangeStore(t).maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}changeStoreReadFile(t){return this.getChangeStore(t).readFile(t)}changeStoreResolveDiffCommand(t,e,n,r){return this.getChangeStore(t).resolveDiffCommand(t,e,n,r)}changeStoreStat(t){return this.getChangeStore(t).stat(t)}changeStoreUpdateDirectoryEntries(t,e){return this.getChangeStore(t).updateDirectoryEntries(t,e)}changeStoreWriteFile(t,e,n,r){return this.getChangeStore(t).writeFile(t,e,n,r)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}getFromStorage(t,e){return this.getStorageService(t).get(e)}async storeInStorage(t,e,n){return this.getStorageService(t).store(e,n)}async deleteFromStorage(t,e){return this.getStorageService(t).delete(e)}async workspaceRepositoriesGetRepositoriesByCanonicalUri(){const t=await this.workspaceRepositoriesGetRepositories();return Rv(t.sort((e,n)=>n.timestamp-e.timestamp),e=>N(e.canonicalUri))}workspaceRepositoriesRemoveRepository(t){return this.getWorkspaceRepositories(t.uri).remove(t)}workspaceRepositoriesRefresh(){for(const[,t]of this._providers.entries())t.workspaceRepositories.refresh()}async workspaceRepositoriesGetRepositories(){const t=[];for(const[,e]of this._providers.entries()){const n=await e.workspaceRepositories.get();t.push(...n.filter(r=>r.provider.id===e.id))}return t}provideFileSearchResults(t,e,n){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,n)}provideTextSearchResults(t,e,n,r){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,n,r)}static getProviderId(t){const{authority:e}=t,n=e.indexOf(Kt.authoritySeparator);return n!==-1?e.substr(0,n):e}static isCanonicalUri(t){return t.authority.indexOf(Kt.authoritySeparator)===-1}},"_VirtualProviderService");let Ht=Kt;Ht.scheme="vscode-vfs",Ht.authoritySeparator="+",Ht.baseVirtualWorkspaceUri=f.Uri.parse(`${Kt.scheme}://`),$v([$s()],Ht.prototype,"getMetadataCore",1);function qv(t,e,n){return new Gr(new gu(t),new gu(e)).ComputeDiff(n).changes}u(qv,"stringDiff");class Cr{constructor(e,n,r,i){this.originalStart=e,this.originalLength=n,this.modifiedStart=r,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}u(Cr,"DiffChange");var qf;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(qf||(qf={}));function zf(t,e){return(e<<5)-e+t|0}u(zf,"numberHash");function zv(t,e){e=zf(149417,e);for(let n=0,r=t.length;n<r;n++)e=zf(t.charCodeAt(n),e);return e}u(zv,"stringHash");class gu{constructor(e){this.source=e}getElements(){const e=this.source,n=new Int32Array(e.length);for(let r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}}u(gu,"StringDiffSequence");class Ci{static Assert(e,n){if(!e)throw new Error(n)}}u(Ci,"Debug");class _i{static Copy(e,n,r,i,o){for(let a=0;a<o;a++)r[i+a]=e[n+a]}static Copy2(e,n,r,i,o){for(let a=0;a<o;a++)r[i+a]=e[n+a]}}u(_i,"MyArray");var jf;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(jf||(jf={}));class pu{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Cr(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,n){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,n),this.m_originalCount++}AddModifiedElement(e,n){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,n),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}u(pu,"DiffChangeHelper");class Gr{constructor(e,n,r=null){this.ContinueProcessingPredicate=r,this._originalSequence=e,this._modifiedSequence=n;const[i,o,a]=Gr._getElements(e),[s,c,l]=Gr._getElements(n);this._hasStrings=a&&l,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=c,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const n=e.getElements();if(Gr._isStringArray(n)){const r=new Int32Array(n.length);for(let i=0,o=n.length;i<o;i++)r[i]=zv(n[i],0);return[n,r,!0]}return n instanceof Int32Array?[[],n,!1]:[[],new Int32Array(n),!1]}ElementsAreEqual(e,n){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[n]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[n]:!0}ElementsAreStrictEqual(e,n){if(!this.ElementsAreEqual(e,n))return!1;const r=Gr._getStrictElement(this._originalSequence,e),i=Gr._getStrictElement(this._modifiedSequence,n);return r===i}static _getStrictElement(e,n){return typeof e.getStrictElement=="function"?e.getStrictElement(n):null}OriginalElementsAreEqual(e,n){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[n]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[n]:!0}ModifiedElementsAreEqual(e,n){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[n]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[n]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,n,r,i,o){const a=[!1];let s=this.ComputeDiffRecursive(e,n,r,i,a);return o&&(s=this.PrettifyChanges(s)),{quitEarly:a[0],changes:s}}ComputeDiffRecursive(e,n,r,i,o){for(o[0]=!1;e<=n&&r<=i&&this.ElementsAreEqual(e,r);)e++,r++;for(;n>=e&&i>=r&&this.ElementsAreEqual(n,i);)n--,i--;if(e>n||r>i){let h;return r<=i?(Ci.Assert(e===n+1,"originalStart should only be one more than originalEnd"),h=[new Cr(e,0,r,i-r+1)]):e<=n?(Ci.Assert(r===i+1,"modifiedStart should only be one more than modifiedEnd"),h=[new Cr(e,n-e+1,r,0)]):(Ci.Assert(e===n+1,"originalStart should only be one more than originalEnd"),Ci.Assert(r===i+1,"modifiedStart should only be one more than modifiedEnd"),h=[]),h}const a=[0],s=[0],c=this.ComputeRecursionPoint(e,n,r,i,a,s,o),l=a[0],d=s[0];if(c!==null)return c;if(!o[0]){const h=this.ComputeDiffRecursive(e,l,r,d,o);let g=[];return o[0]?g=[new Cr(l+1,n-(l+1)+1,d+1,i-(d+1)+1)]:g=this.ComputeDiffRecursive(l+1,n,d+1,i,o),this.ConcatenateChanges(h,g)}return[new Cr(e,n-e+1,r,i-r+1)]}WALKTRACE(e,n,r,i,o,a,s,c,l,d,h,g,p,y,m,v,S,w){let x=null,E=null,I=new pu,D=n,B=r,P=p[0]-v[0]-i,G=-1073741824,ee=this.m_forwardHistory.length-1;do{const te=P+e;te===D||te<B&&l[te-1]<l[te+1]?(h=l[te+1],y=h-P-i,h<G&&I.MarkNextChange(),G=h,I.AddModifiedElement(h+1,y),P=te+1-e):(h=l[te-1]+1,y=h-P-i,h<G&&I.MarkNextChange(),G=h-1,I.AddOriginalElement(h,y+1),P=te-1-e),ee>=0&&(l=this.m_forwardHistory[ee],e=l[0],D=1,B=l.length-1)}while(--ee>=-1);if(x=I.getReverseChanges(),w[0]){let te=p[0]+1,X=v[0]+1;if(x!==null&&x.length>0){const ae=x[x.length-1];te=Math.max(te,ae.getOriginalEnd()),X=Math.max(X,ae.getModifiedEnd())}E=[new Cr(te,g-te+1,X,m-X+1)]}else{I=new pu,D=a,B=s,P=p[0]-v[0]-c,G=1073741824,ee=S?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const te=P+o;te===D||te<B&&d[te-1]>=d[te+1]?(h=d[te+1]-1,y=h-P-c,h>G&&I.MarkNextChange(),G=h+1,I.AddOriginalElement(h+1,y+1),P=te+1-o):(h=d[te-1],y=h-P-c,h>G&&I.MarkNextChange(),G=h,I.AddModifiedElement(h+1,y+1),P=te-1-o),ee>=0&&(d=this.m_reverseHistory[ee],o=d[0],D=1,B=d.length-1)}while(--ee>=-1);E=I.getChanges()}return this.ConcatenateChanges(x,E)}ComputeRecursionPoint(e,n,r,i,o,a,s){let c=0,l=0,d=0,h=0,g=0,p=0;e--,r--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const y=n-e+(i-r),m=y+1,v=new Int32Array(m),S=new Int32Array(m),w=i-r,x=n-e,E=e-r,I=n-i,B=(x-w)%2==0;v[w]=e,S[x]=n,s[0]=!1;for(let P=1;P<=y/2+1;P++){let G=0,ee=0;d=this.ClipDiagonalBound(w-P,P,w,m),h=this.ClipDiagonalBound(w+P,P,w,m);for(let X=d;X<=h;X+=2){X===d||X<h&&v[X-1]<v[X+1]?c=v[X+1]:c=v[X-1]+1,l=c-(X-w)-E;const ae=c;for(;c<n&&l<i&&this.ElementsAreEqual(c+1,l+1);)c++,l++;if(v[X]=c,c+l>G+ee&&(G=c,ee=l),!B&&Math.abs(X-x)<=P-1&&c>=S[X])return o[0]=c,a[0]=l,ae<=S[X]&&1447>0&&P<=1447+1?this.WALKTRACE(w,d,h,E,x,g,p,I,v,S,c,n,o,l,i,a,B,s):null}const te=(G-e+(ee-r)-P)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(G,te))return s[0]=!0,o[0]=G,a[0]=ee,te>0&&1447>0&&P<=1447+1?this.WALKTRACE(w,d,h,E,x,g,p,I,v,S,c,n,o,l,i,a,B,s):(e++,r++,[new Cr(e,n-e+1,r,i-r+1)]);g=this.ClipDiagonalBound(x-P,P,x,m),p=this.ClipDiagonalBound(x+P,P,x,m);for(let X=g;X<=p;X+=2){X===g||X<p&&S[X-1]>=S[X+1]?c=S[X+1]-1:c=S[X-1],l=c-(X-x)-I;const ae=c;for(;c>e&&l>r&&this.ElementsAreEqual(c,l);)c--,l--;if(S[X]=c,B&&Math.abs(X-w)<=P&&c<=v[X])return o[0]=c,a[0]=l,ae>=v[X]&&1447>0&&P<=1447+1?this.WALKTRACE(w,d,h,E,x,g,p,I,v,S,c,n,o,l,i,a,B,s):null}if(P<=1447){let X=new Int32Array(h-d+2);X[0]=w-d+1,_i.Copy2(v,d,X,1,h-d+1),this.m_forwardHistory.push(X),X=new Int32Array(p-g+2),X[0]=x-g+1,_i.Copy2(S,g,X,1,p-g+1),this.m_reverseHistory.push(X)}}return this.WALKTRACE(w,d,h,E,x,g,p,I,v,S,c,n,o,l,i,a,B,s)}PrettifyChanges(e){for(let n=0;n<e.length;n++){const r=e[n],i=n<e.length-1?e[n+1].originalStart:this._originalElementsOrHash.length,o=n<e.length-1?e[n+1].modifiedStart:this._modifiedElementsOrHash.length,a=r.originalLength>0,s=r.modifiedLength>0;for(;r.originalStart+r.originalLength<i&&r.modifiedStart+r.modifiedLength<o&&(!a||this.OriginalElementsAreEqual(r.originalStart,r.originalStart+r.originalLength))&&(!s||this.ModifiedElementsAreEqual(r.modifiedStart,r.modifiedStart+r.modifiedLength));){const l=this.ElementsAreStrictEqual(r.originalStart,r.modifiedStart);if(this.ElementsAreStrictEqual(r.originalStart+r.originalLength,r.modifiedStart+r.modifiedLength)&&!l)break;r.originalStart++,r.modifiedStart++}let c=[null];if(n<e.length-1&&this.ChangesOverlap(e[n],e[n+1],c)){e[n]=c[0],e.splice(n+1,1),n--;continue}}for(let n=e.length-1;n>=0;n--){const r=e[n];let i=0,o=0;if(n>0){const h=e[n-1];i=h.originalStart+h.originalLength,o=h.modifiedStart+h.modifiedLength}const a=r.originalLength>0,s=r.modifiedLength>0;let c=0,l=this._boundaryScore(r.originalStart,r.originalLength,r.modifiedStart,r.modifiedLength);for(let h=1;;h++){const g=r.originalStart-h,p=r.modifiedStart-h;if(g<i||p<o||a&&!this.OriginalElementsAreEqual(g,g+r.originalLength)||s&&!this.ModifiedElementsAreEqual(p,p+r.modifiedLength))break;const m=(g===i&&p===o?5:0)+this._boundaryScore(g,r.originalLength,p,r.modifiedLength);m>l&&(l=m,c=h)}r.originalStart-=c,r.modifiedStart-=c;const d=[null];if(n>0&&this.ChangesOverlap(e[n-1],e[n],d)){e[n-1]=d[0],e.splice(n,1),n++;continue}}if(this._hasStrings)for(let n=1,r=e.length;n<r;n++){const i=e[n-1],o=e[n],a=o.originalStart-i.originalStart-i.originalLength,s=i.originalStart,c=o.originalStart+o.originalLength,l=c-s,d=i.modifiedStart,h=o.modifiedStart+o.modifiedLength,g=h-d;if(a<5&&l<20&&g<20){const p=this._findBetterContiguousSequence(s,l,d,g,a);if(p){const[y,m]=p;(y!==i.originalStart+i.originalLength||m!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=y-i.originalStart,i.modifiedLength=m-i.modifiedStart,o.originalStart=y+a,o.modifiedStart=m+a,o.originalLength=c-o.originalStart,o.modifiedLength=h-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,n,r,i,o){if(n<o||i<o)return null;const a=e+n-o+1,s=r+i-o+1;let c=0,l=0,d=0;for(let h=e;h<a;h++)for(let g=r;g<s;g++){const p=this._contiguousSequenceScore(h,g,o);p>0&&p>c&&(c=p,l=h,d=g)}return c>0?[l,d]:null}_contiguousSequenceScore(e,n,r){let i=0;for(let o=0;o<r;o++){if(!this.ElementsAreEqual(e+o,n+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,n){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(n>0){const r=e+n;if(this._OriginalIsBoundary(r-1)||this._OriginalIsBoundary(r))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,n){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(n>0){const r=e+n;if(this._ModifiedIsBoundary(r-1)||this._ModifiedIsBoundary(r))return!0}return!1}_boundaryScore(e,n,r,i){const o=this._OriginalRegionIsBoundary(e,n)?1:0,a=this._ModifiedRegionIsBoundary(r,i)?1:0;return o+a}ConcatenateChanges(e,n){let r=[];if(e.length===0||n.length===0)return n.length>0?n:e;if(this.ChangesOverlap(e[e.length-1],n[0],r)){const i=new Array(e.length+n.length-1);return _i.Copy(e,0,i,0,e.length-1),i[e.length-1]=r[0],_i.Copy(n,1,i,e.length,n.length-1),i}else{const i=new Array(e.length+n.length);return _i.Copy(e,0,i,0,e.length),_i.Copy(n,0,i,e.length,n.length),i}}ChangesOverlap(e,n,r){if(Ci.Assert(e.originalStart<=n.originalStart,"Left change is not less than or equal to right change"),Ci.Assert(e.modifiedStart<=n.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=n.originalStart||e.modifiedStart+e.modifiedLength>=n.modifiedStart){const i=e.originalStart;let o=e.originalLength;const a=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=n.originalStart&&(o=n.originalStart+n.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=n.modifiedStart&&(s=n.modifiedStart+n.modifiedLength-e.modifiedStart),r[0]=new Cr(i,o,a,s),!0}else return r[0]=null,!1}ClipDiagonalBound(e,n,r,i){if(e>=0&&e<i)return e;const o=r,a=i-r-1,s=n%2==0;if(e<0){const c=o%2==0;return s===c?0:1}else{const c=a%2==0;return s===c?i-1:i-2}}}u(Gr,"LcsDiff");var mu;(function(t){function e(r,i){return r instanceof vo?i:new f.Position(i.line,i.character)}u(e,"makePosition"),t.makePosition=e;function n(r,i){return r instanceof vo?i:new f.Range(i.start.line,i.start.character,i.end.line,i.end.character)}u(n,"makeRange"),t.makeRange=n})(mu||(mu={}));var Gf;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})(Gf||(Gf={}));const Kf=u(class{constructor(t,e,n,r){this.diffCache=new br(32),this.indexDocumentCache=new br(32),this.codeDocumentCache=new br(32),this.providerService=t,this.rootUri=e,this.index=n,this.code=r,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const n=t.uri;if(!n.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(n.toString());if(i===R.Created||i===R.Deleted)return;const o=await this.getIndexDocument(n);if(o===void 0)return;const a=this.getDiff(2,o,t);if(a.length===0)return e;const s=t.offsetAt(new f.Position(e.line,e.character));let c=s;for(const g of a){if(g.modifiedStart<=s&&s<g.modifiedStart+g.modifiedLength)return;if(c<g.modifiedStart)break;c=c-(g.modifiedLength-g.originalLength)}const l=o.positionAt(c),d=this.getWordAtOffset(o.lineAt(l.line).text,l.character),h=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(d===void 0||h===void 0||d!==h))return new f.Position(l.line,l.character)}async mapRangeFromIndexToCode(t,e){const n=t instanceof f.Uri?t:t.uri;if(!n.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(n.toString());if(i===R.Created||i===R.Deleted)return;const[o,a]=await Promise.all([this.getIndexDocument(n),this.getCodeDocument(t)]);if(o===void 0||a===void 0)return;const s=this.getDiff(1,o,a);if(s.length===0)return e;const c=o.offsetAt(e.start);let l=c;const d=o.offsetAt(e.end);let h=d;for(const v of s){if(h<v.originalStart)break;const S=v.modifiedLength-v.originalLength;if(v.originalStart<=c){if(c<v.originalStart+v.originalLength)return;l+=S}else if(d<v.originalStart+v.originalLength)return;if(v.originalStart<=d){if(d<v.originalStart+v.originalLength)return;h+=S}}const g=a.positionAt(l),p=a.positionAt(h),y=o.getText(e),m=a.getText(mu.makeRange(a,{start:g,end:p}));if(y===m)return new f.Range(g.line,g.character,p.line,p.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof f.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,n){let r=t.get(e.toString());if(r!==null)return r!==void 0||(r=this._getDocument(e,n),t.set(e.toString(),r),r.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),r}async _getDocument(t,e){const n=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,n).then(r=>new vo(t,Number.MAX_VALUE,Kf.textDecoder.decode(r)),()=>{})}getDiff(t,e,n){if(e.uri.toString()!==n.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${n.uri.toString()}) are pointing to a different document`);const r=`${t}${e.uri.toString()}`;let i=this.diffCache.get(r);return i!==void 0&&i.original===e.version&&i.modified===n.version||(i={original:e.version,modified:n.version,changes:qv(e.getText(),n.getText(),!0)},this.diffCache.set(r,i)),i.changes}getWordAtOffset(t,e){let n="findStart",r=0,i=t.length,o=0;for(;o<t.length&&n!=="endFound";){switch(o===e&&(n="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(n){case"findStart":r=o+1;break;case"findEnd":i=o,n="endFound";break}break}o++}return n==="endFound"?t.substring(r,i):void 0}},"_DiffMapper");let Qf=Kf;Qf.textDecoder=new TextDecoder("utf8");var Xf;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(Xf||(Xf={}));class vo{static computeLineOffsets(e,n,r=0){const i=n?[r]:[];for(let o=0;o<e.length;o++){const a=e.charCodeAt(o);(a===13||a===10)&&(a===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(r+o+1))}return i}constructor(e,n,r){this._content=r,this.uri=e,this.version=n,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=vo.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}lineAt(e){const n=this.getLineOffsets();if(e>=n.length)return{lineNumber:e,text:""};const r=n[e],i=n[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(r)};const o=this._content.substring(r,i);let a=o.length-1;for(;a>=0&&(o[a]===`
`||o[a]==="\r");)a--;return{lineNumber:e,text:o.substr(0,a+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const n=this.getLineOffsets();let r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){const a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}const o=r-1;return{line:o,character:e-n[o]}}offsetAt(e){const n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;const r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}}u(vo,"TextDocument");var Yf;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(Yf||(Yf={}));var Vs;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})(Vs||(Vs={}));var Jn;(function(t){function e(r,i){return r===Number.MAX_VALUE&&(r=Vs.MAX_VALUE),i===Number.MAX_VALUE&&(i=Vs.MAX_VALUE),{line:r,character:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.objectLiteral(i)&&T.uinteger(i.line)&&T.uinteger(i.character)}u(n,"is"),t.is=n})(Jn||(Jn={}));var Ct;(function(t){function e(r,i,o,a){if(T.uinteger(r)&&T.uinteger(i)&&T.uinteger(o)&&T.uinteger(a))return{start:Jn.create(r,i),end:Jn.create(o,a)};if(Jn.is(r)&&Jn.is(i))return{start:r,end:i};throw new Error("Range#create called with invalid arguments["+r+", "+i+", "+o+", "+a+"]")}u(e,"create"),t.create=e;function n(r){var i=r;return T.objectLiteral(i)&&Jn.is(i.start)&&Jn.is(i.end)}u(n,"is"),t.is=n})(Ct||(Ct={}));var vu;(function(t){function e(r,i){return{uri:r,range:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&Ct.is(i.range)&&(T.string(i.uri)||T.undefined(i.uri))}u(n,"is"),t.is=n})(vu||(vu={}));var qs;(function(t){function e(r,i,o,a){return{targetUri:r,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&Ct.is(i.targetRange)&&T.string(i.targetUri)&&(Ct.is(i.targetSelectionRange)||T.undefined(i.targetSelectionRange))&&(Ct.is(i.originSelectionRange)||T.undefined(i.originSelectionRange))}u(n,"is"),t.is=n})(qs||(qs={}));var wu;(function(t){function e(r,i,o,a){return{red:r,green:i,blue:o,alpha:a}}u(e,"create"),t.create=e;function n(r){var i=r;return T.numberRange(i.red,0,1)&&T.numberRange(i.green,0,1)&&T.numberRange(i.blue,0,1)&&T.numberRange(i.alpha,0,1)}u(n,"is"),t.is=n})(wu||(wu={}));var Jf;(function(t){function e(r,i){return{range:r,color:i}}u(e,"create"),t.create=e;function n(r){var i=r;return Ct.is(i.range)&&wu.is(i.color)}u(n,"is"),t.is=n})(Jf||(Jf={}));var Zf;(function(t){function e(r,i,o){return{label:r,textEdit:i,additionalTextEdits:o}}u(e,"create"),t.create=e;function n(r){var i=r;return T.string(i.label)&&(T.undefined(i.textEdit)||Kr.is(i))&&(T.undefined(i.additionalTextEdits)||T.typedArray(i.additionalTextEdits,Kr.is))}u(n,"is"),t.is=n})(Zf||(Zf={}));var va;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(va||(va={}));var eg;(function(t){function e(r,i,o,a,s){var c={startLine:r,endLine:i};return T.defined(o)&&(c.startCharacter=o),T.defined(a)&&(c.endCharacter=a),T.defined(s)&&(c.kind=s),c}u(e,"create"),t.create=e;function n(r){var i=r;return T.uinteger(i.startLine)&&T.uinteger(i.startLine)&&(T.undefined(i.startCharacter)||T.uinteger(i.startCharacter))&&(T.undefined(i.endCharacter)||T.uinteger(i.endCharacter))&&(T.undefined(i.kind)||T.string(i.kind))}u(n,"is"),t.is=n})(eg||(eg={}));var yu;(function(t){function e(r,i){return{location:r,message:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&vu.is(i.location)&&T.string(i.message)}u(n,"is"),t.is=n})(yu||(yu={}));var wo;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(wo||(wo={}));var zs;(function(t){t.Unnecessary=1,t.Deprecated=2})(zs||(zs={}));var bu;(function(t){function e(n){var r=n;return r!=null&&T.string(r.href)}u(e,"is"),t.is=e})(bu||(bu={}));var js;(function(t){function e(r,i,o,a,s,c){var l={range:r,message:i};return T.defined(o)&&(l.severity=o),T.defined(a)&&(l.code=a),T.defined(s)&&(l.source=s),T.defined(c)&&(l.relatedInformation=c),l}u(e,"create"),t.create=e;function n(r){var i,o=r;return T.defined(o)&&Ct.is(o.range)&&T.string(o.message)&&(T.number(o.severity)||T.undefined(o.severity))&&(T.integer(o.code)||T.string(o.code)||T.undefined(o.code))&&(T.undefined(o.codeDescription)||T.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(T.string(o.source)||T.undefined(o.source))&&(T.undefined(o.relatedInformation)||T.typedArray(o.relatedInformation,yu.is))}u(n,"is"),t.is=n})(js||(js={}));var wa;(function(t){function e(r,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s={title:r,command:i};return T.defined(o)&&o.length>0&&(s.arguments=o),s}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.string(i.title)&&T.string(i.command)}u(n,"is"),t.is=n})(wa||(wa={}));var Kr;(function(t){function e(o,a){return{range:o,newText:a}}u(e,"replace"),t.replace=e;function n(o,a){return{range:{start:o,end:o},newText:a}}u(n,"insert"),t.insert=n;function r(o){return{range:o,newText:""}}u(r,"del"),t.del=r;function i(o){var a=o;return T.objectLiteral(a)&&T.string(a.newText)&&Ct.is(a.range)}u(i,"is"),t.is=i})(Kr||(Kr={}));var yo;(function(t){function e(r,i,o){var a={label:r};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i!==void 0&&T.objectLiteral(i)&&T.string(i.label)&&(T.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(T.string(i.description)||i.description===void 0)}u(n,"is"),t.is=n})(yo||(yo={}));var Dt;(function(t){function e(n){var r=n;return typeof r=="string"}u(e,"is"),t.is=e})(Dt||(Dt={}));var Qr;(function(t){function e(o,a,s){return{range:o,newText:a,annotationId:s}}u(e,"replace"),t.replace=e;function n(o,a,s){return{range:{start:o,end:o},newText:a,annotationId:s}}u(n,"insert"),t.insert=n;function r(o,a){return{range:o,newText:"",annotationId:a}}u(r,"del"),t.del=r;function i(o){var a=o;return Kr.is(a)&&(yo.is(a.annotationId)||Dt.is(a.annotationId))}u(i,"is"),t.is=i})(Qr||(Qr={}));var ya;(function(t){function e(r,i){return{textDocument:r,edits:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&Ks.is(i.textDocument)&&Array.isArray(i.edits)}u(n,"is"),t.is=n})(ya||(ya={}));var bo;(function(t){function e(r,i,o){var a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i&&i.kind==="create"&&T.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||T.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||T.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Dt.is(i.annotationId))}u(n,"is"),t.is=n})(bo||(bo={}));var So;(function(t){function e(r,i,o,a){var s={kind:"rename",oldUri:r,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(s.options=o),a!==void 0&&(s.annotationId=a),s}u(e,"create"),t.create=e;function n(r){var i=r;return i&&i.kind==="rename"&&T.string(i.oldUri)&&T.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||T.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||T.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Dt.is(i.annotationId))}u(n,"is"),t.is=n})(So||(So={}));var Co;(function(t){function e(r,i,o){var a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i&&i.kind==="delete"&&T.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||T.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||T.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Dt.is(i.annotationId))}u(n,"is"),t.is=n})(Co||(Co={}));var Su;(function(t){function e(n){var r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(function(i){return T.string(i.kind)?bo.is(i)||So.is(i)||Co.is(i):ya.is(i)}))}u(e,"is"),t.is=e})(Su||(Su={}));var Gs=function(){function t(e,n){this.edits=e,this.changeAnnotations=n}return u(t,"TextEditChangeImpl"),t.prototype.insert=function(e,n,r){var i,o;if(r===void 0?i=Kr.insert(e,n):Dt.is(r)?(o=r,i=Qr.insert(e,n,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=Qr.insert(e,n,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,n,r){var i,o;if(r===void 0?i=Kr.replace(e,n):Dt.is(r)?(o=r,i=Qr.replace(e,n,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=Qr.replace(e,n,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,n){var r,i;if(n===void 0?r=Kr.del(e):Dt.is(n)?(i=n,r=Qr.del(e,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=Qr.del(e,i)),this.edits.push(r),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),tg=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return u(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,n){var r;if(Dt.is(e)?r=e:(r=this.nextId(),n=e),this._annotations[r]!==void 0)throw new Error("Id "+r+" is already in use.");if(n===void 0)throw new Error("No annotation provided for id "+r);return this._annotations[r]=n,this._size++,r},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),o0=function(){function t(e){var n=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new tg(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(r){if(ya.is(r)){var i=new Gs(r.edits,n._changeAnnotations);n._textEditChanges[r.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(r){var i=new Gs(e.changes[r]);n._textEditChanges[r]=i})):this._workspaceEdit={}}return u(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(Ks.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n={uri:e.uri,version:e.version},r=this._textEditChanges[n.uri];if(!r){var i=[],o={textDocument:n,edits:i};this._workspaceEdit.documentChanges.push(o),r=new Gs(i,this._changeAnnotations),this._textEditChanges[n.uri]=r}return r}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var r=this._textEditChanges[e];if(!r){var i=[];this._workspaceEdit.changes[e]=i,r=new Gs(i),this._textEditChanges[e]=r}return r}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new tg,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,n,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;yo.is(n)||Dt.is(n)?i=n:r=n;var o,a;if(i===void 0?o=bo.create(e,r):(a=Dt.is(i)?i:this._changeAnnotations.manage(i),o=bo.create(e,r,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t.prototype.renameFile=function(e,n,r,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;yo.is(r)||Dt.is(r)?o=r:i=r;var a,s;if(o===void 0?a=So.create(e,n,i):(s=Dt.is(o)?o:this._changeAnnotations.manage(o),a=So.create(e,n,i,s)),this._workspaceEdit.documentChanges.push(a),s!==void 0)return s},t.prototype.deleteFile=function(e,n,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;yo.is(n)||Dt.is(n)?i=n:r=n;var o,a;if(i===void 0?o=Co.create(e,r):(a=Dt.is(i)?i:this._changeAnnotations.manage(i),o=Co.create(e,r,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t}(),ng;(function(t){function e(r){return{uri:r}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.string(i.uri)}u(n,"is"),t.is=n})(ng||(ng={}));var rg;(function(t){function e(r,i){return{uri:r,version:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.string(i.uri)&&T.integer(i.version)}u(n,"is"),t.is=n})(rg||(rg={}));var Ks;(function(t){function e(r,i){return{uri:r,version:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.string(i.uri)&&(i.version===null||T.integer(i.version))}u(n,"is"),t.is=n})(Ks||(Ks={}));var ig;(function(t){function e(r,i,o,a){return{uri:r,languageId:i,version:o,text:a}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.string(i.uri)&&T.string(i.languageId)&&T.integer(i.version)&&T.string(i.text)}u(n,"is"),t.is=n})(ig||(ig={}));var _r;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(_r||(_r={})),function(t){function e(n){var r=n;return r===t.PlainText||r===t.Markdown}u(e,"is"),t.is=e}(_r||(_r={}));var Cu;(function(t){function e(n){var r=n;return T.objectLiteral(n)&&_r.is(r.kind)&&T.string(r.value)}u(e,"is"),t.is=e})(Cu||(Cu={}));var og;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(og||(og={}));var ag;(function(t){t.PlainText=1,t.Snippet=2})(ag||(ag={}));var sg;(function(t){t.Deprecated=1})(sg||(sg={}));var cg;(function(t){function e(r,i,o){return{newText:r,insert:i,replace:o}}u(e,"create"),t.create=e;function n(r){var i=r;return i&&T.string(i.newText)&&Ct.is(i.insert)&&Ct.is(i.replace)}u(n,"is"),t.is=n})(cg||(cg={}));var lg;(function(t){t.asIs=1,t.adjustIndentation=2})(lg||(lg={}));var ug;(function(t){function e(n){return{label:n}}u(e,"create"),t.create=e})(ug||(ug={}));var dg;(function(t){function e(n,r){return{items:n||[],isIncomplete:!!r}}u(e,"create"),t.create=e})(dg||(dg={}));var Qs;(function(t){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}u(e,"fromPlainText"),t.fromPlainText=e;function n(r){var i=r;return T.string(i)||T.objectLiteral(i)&&T.string(i.language)&&T.string(i.value)}u(n,"is"),t.is=n})(Qs||(Qs={}));var hg;(function(t){function e(n){var r=n;return!!r&&T.objectLiteral(r)&&(Cu.is(r.contents)||Qs.is(r.contents)||T.typedArray(r.contents,Qs.is))&&(n.range===void 0||Ct.is(n.range))}u(e,"is"),t.is=e})(hg||(hg={}));var fg;(function(t){function e(n,r){return r?{label:n,documentation:r}:{label:n}}u(e,"create"),t.create=e})(fg||(fg={}));var gg;(function(t){function e(n,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:n};return T.defined(r)&&(a.documentation=r),T.defined(i)?a.parameters=i:a.parameters=[],a}u(e,"create"),t.create=e})(gg||(gg={}));var ba;(function(t){t.Text=1,t.Read=2,t.Write=3})(ba||(ba={}));var pg;(function(t){function e(n,r){var i={range:n};return T.number(r)&&(i.kind=r),i}u(e,"create"),t.create=e})(pg||(pg={}));var _u;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(_u||(_u={}));var xu;(function(t){t.Deprecated=1})(xu||(xu={}));var mg;(function(t){function e(n,r,i,o,a){var s={name:n,kind:r,location:{uri:o,range:i}};return a&&(s.containerName=a),s}u(e,"create"),t.create=e})(mg||(mg={}));var vg;(function(t){function e(r,i,o,a,s,c){var l={name:r,detail:i,kind:o,range:a,selectionRange:s};return c!==void 0&&(l.children=c),l}u(e,"create"),t.create=e;function n(r){var i=r;return i&&T.string(i.name)&&T.number(i.kind)&&Ct.is(i.range)&&Ct.is(i.selectionRange)&&(i.detail===void 0||T.string(i.detail))&&(i.deprecated===void 0||T.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}u(n,"is"),t.is=n})(vg||(vg={}));var Zn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Zn||(Zn={}));var wg;(function(t){function e(r,i){var o={diagnostics:r};return i!=null&&(o.only=i),o}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.typedArray(i.diagnostics,js.is)&&(i.only===void 0||T.typedArray(i.only,T.string))}u(n,"is"),t.is=n})(wg||(wg={}));var yg;(function(t){function e(r,i,o){var a={title:r},s=!0;return typeof i=="string"?(s=!1,a.kind=i):wa.is(i)?a.command=i:a.edit=i,s&&o!==void 0&&(a.kind=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i&&T.string(i.title)&&(i.diagnostics===void 0||T.typedArray(i.diagnostics,js.is))&&(i.kind===void 0||T.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||wa.is(i.command))&&(i.isPreferred===void 0||T.boolean(i.isPreferred))&&(i.edit===void 0||Su.is(i.edit))}u(n,"is"),t.is=n})(yg||(yg={}));var bg;(function(t){function e(r,i){var o={range:r};return T.defined(i)&&(o.data=i),o}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&Ct.is(i.range)&&(T.undefined(i.command)||wa.is(i.command))}u(n,"is"),t.is=n})(bg||(bg={}));var Sg;(function(t){function e(r,i){return{tabSize:r,insertSpaces:i}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&T.uinteger(i.tabSize)&&T.boolean(i.insertSpaces)}u(n,"is"),t.is=n})(Sg||(Sg={}));var Cg;(function(t){function e(r,i,o){return{range:r,target:i,data:o}}u(e,"create"),t.create=e;function n(r){var i=r;return T.defined(i)&&Ct.is(i.range)&&(T.undefined(i.target)||T.string(i.target))}u(n,"is"),t.is=n})(Cg||(Cg={}));var _g;(function(t){function e(r,i){return{range:r,parent:i}}u(e,"create"),t.create=e;function n(r){var i=r;return i!==void 0&&Ct.is(i.range)&&(i.parent===void 0||t.is(i.parent))}u(n,"is"),t.is=n})(_g||(_g={}));var a0=null,xg;(function(t){function e(o,a,s,c){return new jv(o,a,s,c)}u(e,"create"),t.create=e;function n(o){var a=o;return!!(T.defined(a)&&T.string(a.uri)&&(T.undefined(a.languageId)||T.string(a.languageId))&&T.uinteger(a.lineCount)&&T.func(a.getText)&&T.func(a.positionAt)&&T.func(a.offsetAt))}u(n,"is"),t.is=n;function r(o,a){for(var s=o.getText(),c=i(a,function(y,m){var v=y.range.start.line-m.range.start.line;return v===0?y.range.start.character-m.range.start.character:v}),l=s.length,d=c.length-1;d>=0;d--){var h=c[d],g=o.offsetAt(h.range.start),p=o.offsetAt(h.range.end);if(p<=l)s=s.substring(0,g)+h.newText+s.substring(p,s.length);else throw new Error("Overlapping edit");l=g}return s}u(r,"applyEdits"),t.applyEdits=r;function i(o,a){if(o.length<=1)return o;var s=o.length/2|0,c=o.slice(0,s),l=o.slice(s);i(c,a),i(l,a);for(var d=0,h=0,g=0;d<c.length&&h<l.length;){var p=a(c[d],l[h]);p<=0?o[g++]=c[d++]:o[g++]=l[h++]}for(;d<c.length;)o[g++]=c[d++];for(;h<l.length;)o[g++]=l[h++];return o}u(i,"mergeSort")})(xg||(xg={}));var jv=function(){function t(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}return u(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content},t.prototype.update=function(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],n=this._content,r=!0,i=0;i<n.length;i++){r&&(e.push(i),r=!1);var o=n.charAt(i);r=o==="\r"||o===`
`,o==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return Jn.create(0,e);for(;r<i;){var o=Math.floor((r+i)/2);n[o]>e?i=o:r=o+1}var a=r-1;return Jn.create(a,e-n[a])},t.prototype.offsetAt=function(e){var n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;var r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),T;(function(t){var e=Object.prototype.toString;function n(p){return typeof p!="undefined"}u(n,"defined"),t.defined=n;function r(p){return typeof p=="undefined"}u(r,"undefined"),t.undefined=r;function i(p){return p===!0||p===!1}u(i,"boolean"),t.boolean=i;function o(p){return e.call(p)==="[object String]"}u(o,"string"),t.string=o;function a(p){return e.call(p)==="[object Number]"}u(a,"number"),t.number=a;function s(p,y,m){return e.call(p)==="[object Number]"&&y<=p&&p<=m}u(s,"numberRange"),t.numberRange=s;function c(p){return e.call(p)==="[object Number]"&&-2147483648<=p&&p<=2147483647}u(c,"integer"),t.integer=c;function l(p){return e.call(p)==="[object Number]"&&0<=p&&p<=2147483647}u(l,"uinteger"),t.uinteger=l;function d(p){return e.call(p)==="[object Function]"}u(d,"func"),t.func=d;function h(p){return p!==null&&typeof p=="object"}u(h,"objectLiteral"),t.objectLiteral=h;function g(p,y){return Array.isArray(p)&&p.every(y)}u(g,"typedArray"),t.typedArray=g})(T||(T={}));var Sa;(function(t){function e(r){return typeof r=="string"||r instanceof String}u(e,"string"),t.string=e;function n(r){return typeof r=="number"||r instanceof Number}u(n,"number"),t.number=n})(Sa||(Sa={}));var Iu;(function(t){function e(n){const r=n;return r!=null&&(Sa.number(r.value)||Sa.string(r.value))&&Sa.string(r.target)}u(e,"is"),t.is=e})(Iu||(Iu={}));class Ig extends f.Diagnostic{constructor(e,n,r,i){super(e,n,r);this.data=i,this.hasDiagnosticCode=!1}}u(Ig,"ProtocolDiagnostic");var er;(function(t){const e=Object.prototype.toString;function n(d){return typeof d!="undefined"}u(n,"defined"),t.defined=n;function r(d){return d===!0||d===!1}u(r,"boolean"),t.boolean=r;function i(d){return e.call(d)==="[object String]"}u(i,"string"),t.string=i;function o(d){return e.call(d)==="[object Number]"}u(o,"number"),t.number=o;function a(d){return d!==null&&typeof d=="object"}u(a,"objectLiteral"),t.objectLiteral=a;function s(d){return Array.isArray(d)}u(s,"array"),t.array=s;function c(d){return s(d)&&d.every(h=>i(h))}u(c,"stringArray"),t.stringArray=c;function l(d,h){return Array.isArray(d)&&d.every(h)}u(l,"typedArray"),t.typedArray=l})(er||(er={}));var Xs;(function(t){function e(n){const r=n;return r&&er.string(r.language)&&er.string(r.value)}u(e,"is"),t.is=e})(Xs||(Xs={}));function Gv(t){const e=u(_=>f.Uri.parse(_),"nullConverter"),n=t!=null?t:e;function r(_){return n(_)}u(r,"asUri");function i(_){return _.map(o)}u(i,"asDiagnostics");function o(_){const $=new Ig(h(_.range),_.message,p(_.severity),_.data);return _.code!==void 0&&(bu.is(_.codeDescription)?$.code={value:_.code,target:r(_.codeDescription.href)}:Iu.is(_.code)?($.hasDiagnosticCode=!0,$.code={value:_.code.value,target:r(_.code.target)}):$.code=_.code),_.source&&($.source=_.source),_.relatedInformation&&($.relatedInformation=a(_.relatedInformation)),Array.isArray(_.tags)&&($.tags=c(_.tags)),$}u(o,"asDiagnostic");function a(_){return _.map(s)}u(a,"asRelatedInformation");function s(_){return new f.DiagnosticRelatedInformation(P(_.location),_.message)}u(s,"asDiagnosticRelatedInformation");function c(_){if(!_)return;const $=[];for(const ye of _){const _t=l(ye);_t!==void 0&&$.push(_t)}return $.length>0?$:void 0}u(c,"asDiagnosticTags");function l(_){switch(_){case zs.Unnecessary:return f.DiagnosticTag.Unnecessary;case zs.Deprecated:return f.DiagnosticTag.Deprecated;default:return}}u(l,"asDiagnosticTag");function d(_){if(!!_)return new f.Position(_.line,_.character)}u(d,"asPosition");function h(_){if(!!_)return new f.Range(d(_.start),d(_.end))}u(h,"asRange");function g(_){return _.map($=>h($))}u(g,"asRanges");function p(_){if(_==null)return f.DiagnosticSeverity.Error;switch(_){case wo.Error:return f.DiagnosticSeverity.Error;case wo.Warning:return f.DiagnosticSeverity.Warning;case wo.Information:return f.DiagnosticSeverity.Information;case wo.Hint:return f.DiagnosticSeverity.Hint}return f.DiagnosticSeverity.Error}u(p,"asDiagnosticSeverity");function y(_){if(er.string(_))return new f.MarkdownString(_);if(Xs.is(_))return new f.MarkdownString().appendCodeblock(_.value,_.language);if(Array.isArray(_)){const ye=[];for(const _t of _){const Pa=new f.MarkdownString;Xs.is(_t)?Pa.appendCodeblock(_t.value,_t.language):Pa.appendMarkdown(_t),ye.push(Pa)}return ye}let $;switch(_.kind){case _r.Markdown:return new f.MarkdownString(_.value);case _r.PlainText:return $=new f.MarkdownString,$.appendText(_.value),$;default:return $=new f.MarkdownString,$.appendText(`Unsupported Markup content received. Kind is: ${_.kind}`),$}}u(y,"asHoverContent");function m(_){if(er.string(_))return _;switch(_.kind){case _r.Markdown:return new f.MarkdownString(_.value);case _r.PlainText:return _.value;default:return`Unsupported Markup content received. Kind is: ${_.kind}`}}u(m,"asDocumentation");function v(_){if(!!_)return new f.Hover(y(_.contents),h(_.range))}u(v,"asHover");function S(_){if(!!_)return new f.TextEdit(h(_.range),_.newText)}u(S,"asTextEdit");function w(_){if(!!_)return _.map(S)}u(w,"asTextEdits");function x(_){if(!_)return;const $=new f.SignatureHelp;return er.number(_.activeSignature)?$.activeSignature=_.activeSignature:$.activeSignature=0,er.number(_.activeParameter)?$.activeParameter=_.activeParameter:$.activeParameter=0,_.signatures&&($.signatures=E(_.signatures)),$}u(x,"asSignatureHelp");function E(_){return _.map(I)}u(E,"asSignatureInformations");function I(_){const $=new f.SignatureInformation(_.label);return _.documentation!==void 0&&($.documentation=m(_.documentation)),_.parameters!==void 0&&($.parameters=D(_.parameters)),_.activeParameter!==void 0&&($.activeParameter=_.activeParameter),$}u(I,"asSignatureInformation");function D(_){return _.map(B)}u(D,"asParameterInformations");function B(_){const $=new f.ParameterInformation(_.label);return _.documentation&&($.documentation=m(_.documentation)),$}u(B,"asParameterInformation");function P(_){if(!!_)return new f.Location(n(_.uri),h(_.range))}u(P,"asLocation");function G(_){if(!!_)return X(_)}u(G,"asDeclarationResult");function ee(_){if(!!_)return X(_)}u(ee,"asDefinitionResult");function te(_){if(!_)return;const $={targetUri:n(_.targetUri),targetRange:h(_.targetSelectionRange),originSelectionRange:h(_.originSelectionRange),targetSelectionRange:h(_.targetSelectionRange)};if(!$.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return $}u(te,"asLocationLink");function X(_){if(!!_)return er.array(_)?_.length===0?[]:qs.is(_[0])?_.map(_t=>te(_t)):_.map(ye=>P(ye)):qs.is(_)?[te(_)]:P(_)}u(X,"asLocationResult");function ae(_){if(!!_)return _.map($=>P($))}u(ae,"asReferences");function k(_){if(!!_)return _.map(O)}u(k,"asDocumentHighlights");function O(_){const $=new f.DocumentHighlight(h(_.range));return er.number(_.kind)&&($.kind=j(_.kind)),$}u(O,"asDocumentHighlight");function j(_){switch(_){case ba.Text:return f.DocumentHighlightKind.Text;case ba.Read:return f.DocumentHighlightKind.Read;case ba.Write:return f.DocumentHighlightKind.Write}return f.DocumentHighlightKind.Text}u(j,"asDocumentHighlightKind");function z(_,$){if(!!_)return _.map(ye=>Ce(ye,$))}u(z,"asSymbolInformations");function ne(_){return _<=_u.TypeParameter?_-1:f.SymbolKind.Property}u(ne,"asSymbolKind");function oe(_){switch(_){case xu.Deprecated:return f.SymbolTag.Deprecated;default:return}}u(oe,"asSymbolTag");function he(_){if(_==null)return;const $=[];for(const ye of _){const _t=oe(ye);_t!==void 0&&$.push(_t)}return $.length===0?void 0:$}u(he,"asSymbolTags");function Ce(_,$){const ye=new f.SymbolInformation(_.name,ne(_.kind),h(_.location.range),_.location.uri?n(_.location.uri):$);return F(ye,_),_.containerName&&(ye.containerName=_.containerName),ye}u(Ce,"asSymbolInformation");function Oe(_){if(_!=null)return _.map(mn)}u(Oe,"asDocumentSymbols");function mn(_){var $;const ye=new f.DocumentSymbol(_.name,($=_.detail)!=null?$:"",ne(_.kind),h(_.range),h(_.selectionRange));if(F(ye,_),_.children!==void 0&&_.children.length>0){const _t=[];for(const Pa of _.children)_t.push(mn(Pa));ye.children=_t}return ye}u(mn,"asDocumentSymbol");function F(_,$){_.tags=he($.tags),$.deprecated&&(_.tags?_.tags.includes(f.SymbolTag.Deprecated)||(_.tags=_.tags.concat(f.SymbolTag.Deprecated)):_.tags=[f.SymbolTag.Deprecated])}u(F,"fillTags");function q(_){const $={title:_.title,command:_.command};return _.arguments&&($.arguments=_.arguments),$}u(q,"asCommand");function Y(_){if(!!_)return _.map(q)}u(Y,"asCommands");const K=new Map;K.set(Zn.Empty,f.CodeActionKind.Empty),K.set(Zn.QuickFix,f.CodeActionKind.QuickFix),K.set(Zn.Refactor,f.CodeActionKind.Refactor),K.set(Zn.RefactorExtract,f.CodeActionKind.RefactorExtract),K.set(Zn.RefactorInline,f.CodeActionKind.RefactorInline),K.set(Zn.RefactorRewrite,f.CodeActionKind.RefactorRewrite),K.set(Zn.Source,f.CodeActionKind.Source),K.set(Zn.SourceOrganizeImports,f.CodeActionKind.SourceOrganizeImports);function re(_){if(_==null)return;let $=K.get(_);if($)return $;const ye=_.split(".");$=f.CodeActionKind.Empty;for(const _t of ye)$=$.append(_t);return $}u(re,"asCodeActionKind");function de(_){if(_!=null)return _.map($=>re($))}u(de,"asCodeActionKinds");function ue(_){if(_==null)return;const $=new f.CodeAction(_.title);return _.kind!==void 0&&($.kind=re(_.kind)),_.diagnostics&&($.diagnostics=i(_.diagnostics)),_.edit&&($.edit=_e(_.edit)),_.command&&($.command=q(_.command)),_.isPreferred!==void 0&&($.isPreferred=_.isPreferred),$}u(ue,"asCodeAction");function _e(_){if(!_)return;const $=new f.WorkspaceEdit;return _.documentChanges?_.documentChanges.forEach(ye=>{if(bo.is(ye))$.createFile(n(ye.uri),ye.options);else if(So.is(ye))$.renameFile(n(ye.oldUri),n(ye.newUri),ye.options);else if(Co.is(ye))$.deleteFile(n(ye.uri),ye.options);else if(ya.is(ye))$.set(n(ye.textDocument.uri),w(ye.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(ye,void 0,4)}`)}):_.changes&&Object.keys(_.changes).forEach(ye=>{$.set(n(ye),w(_.changes[ye]))}),$}u(_e,"asWorkspaceEdit");function Ve(_){return new f.Color(_.red,_.green,_.blue,_.alpha)}u(Ve,"asColor");function Xe(_){return new f.ColorInformation(h(_.range),Ve(_.color))}u(Xe,"asColorInformation");function Tt(_){if(Array.isArray(_))return _.map(Xe)}u(Tt,"asColorInformations");function Rr(_){const $=new f.ColorPresentation(_.label);return $.additionalTextEdits=w(_.additionalTextEdits),_.textEdit&&($.textEdit=S(_.textEdit)),$}u(Rr,"asColorPresentation");function uc(_){if(Array.isArray(_))return _.map(Rr)}u(uc,"asColorPresentations");function Eo(_){if(_)switch(_){case va.Comment:return f.FoldingRangeKind.Comment;case va.Imports:return f.FoldingRangeKind.Imports;case va.Region:return f.FoldingRangeKind.Region}}u(Eo,"asFoldingRangeKind");function vn(_){return new f.FoldingRange(_.startLine,_.endLine,Eo(_.kind))}u(vn,"asFoldingRange");function Ku(_){if(Array.isArray(_))return _.map(vn)}u(Ku,"asFoldingRanges");function Qu(_){return new f.SelectionRange(h(_.range),_.parent?Qu(_.parent):void 0)}u(Qu,"asSelectionRange");function Xw(_){if(!Array.isArray(_))return[];const $=[];for(const ye of _)$.push(Qu(ye));return $}return u(Xw,"asSelectionRanges"),{asUri:r,asDiagnostics:i,asDiagnostic:o,asRange:h,asRanges:g,asPosition:d,asDiagnosticSeverity:p,asDiagnosticTag:l,asHover:v,asTextEdit:S,asTextEdits:w,asSignatureHelp:x,asSignatureInformations:E,asSignatureInformation:I,asParameterInformations:D,asParameterInformation:B,asDeclarationResult:G,asDefinitionResult:ee,asLocation:P,asReferences:ae,asDocumentHighlights:k,asDocumentHighlight:O,asDocumentHighlightKind:j,asSymbolKind:ne,asSymbolTag:oe,asSymbolTags:he,asSymbolInformations:z,asSymbolInformation:Ce,asDocumentSymbols:Oe,asDocumentSymbol:mn,asCommand:q,asCommands:Y,asCodeAction:ue,asCodeActionKind:re,asCodeActionKinds:de,asWorkspaceEdit:_e,asFoldingRangeKind:Eo,asFoldingRange:vn,asFoldingRanges:Ku,asColor:Ve,asColorInformation:Xe,asColorInformations:Tt,asColorPresentation:Rr,asColorPresentations:uc,asSelectionRange:Qu,asSelectionRanges:Xw}}u(Gv,"createConverter");const st=J.loadMessageBundle();var tr;(function(t){function e(r,i){const{provider:o,repo:a}=i instanceof f.Uri?r.getVirtualUriMetadata(i):i;return r.getRemoteUri(o.id,{repo:a})}u(e,"externalUri"),t.externalUri=e;function n(r,i){const{provider:o,repo:a}=i instanceof f.Uri?r.getVirtualUriMetadata(i):i;return r.getRemoteUri(o.id,{repo:a})}u(n,"externalIndexUri"),t.externalIndexUri=n})(tr||(tr={}));var Xr;(function(t){function e(i){if(i.HEAD.type===me.Branch||i.HEAD.type===me.RemoteBranch)return i.HEAD.name}u(e,"getBranchName"),t.getBranchName=e;function n(i){if(i.HEAD.type!==me.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}u(n,"getIndexBranchName"),t.getIndexBranchName=n;async function r(i,o,a=gt.timeout){const s=await i.getMetadata(o),c=tr.externalIndexUri(i,s),l=t.getIndexBranchName(s);if(!(c===void 0||l===void 0))return gt.getIndexedTip(c,l,{authentication:i.getAuthentication(o)},a)}u(r,"getIndexedTip"),t.getIndexedTip=r})(Xr||(Xr={}));var Ca;(function(t){const e=new br(1024);function n(a,s,c){let l=e.get(c);return l!==void 0||(l=a.getCommit(s,c),e.set(c,l)),l}u(n,"get"),t.get=n;async function r(a,s,c){const l=[];for(const h of c)l.push(n(a,s,h));const d=[];for(const h of await Promise.all(l))h!==void 0&&d.push(h);return d}u(r,"all"),t.all=r;function i(a,s){const c=a.commitDate,l=s.commitDate;return c===void 0&&l===void 0?0:c===void 0?1:l===void 0?-1:c<l?1:c>l?-1:0}u(i,"sort"),t.sort=i;function o(a){const s=a.authorName!==void 0?`  \u2022  ${a.authorName}`:"",c=a.commitDate!==void 0?`  \u2022  ${po(a.commitDate,{ago:!0})}`:"",l=a.branchName!==void 0?` - ${a.branchName}`:"",d=a.tags!==void 0?typeof a.tags=="string"?`  \u2022  ${a.tags}`:`  \u2022  ${a.tags.join(" ")}`:"";return{author:s,date:c,branch:l,tag:d}}u(o,"getCommitInfo"),t.getCommitInfo=o})(Ca||(Ca={}));var Eg;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(Eg||(Eg={}));var Ys;(function(t){function e(r){return{workspaceId:r.WorkspaceId,snapshotId:r.SnapshotId,state:r.State,commitId:r.commitId.toLowerCase(),branchName:n(r.BranchName),creationDate:new Date(r._ts*1e3)}}u(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function n(r){if(r!==null)return r.startsWith("refs/heads/")?r.substr(11):r}u(n,"getBranchName")})(Ys||(Ys={}));var gt;(function(t){t.timeout=5*60*1e3;const e=new br(32),n=new br(32);async function r(h,g,p,y=t.timeout){const m=await i(h,g,p,y);if(!(m===void 0||m.length===0))return m[0]}u(r,"getIndexedTip"),t.getIndexedTip=r;async function i(h,g,p,y=t.timeout){const m=s(h,g);let v=e.get(m);if(v===void 0||v!==void 0&&Date.now()-v.time>y){const S=an.getAllWorkspaceSnapshots(h,p,g);v={time:Date.now(),promise:S,snapshots:void 0},e.set(m,v)}if(v.snapshots!==null){if(v.snapshots===void 0){let S=await v.promise;if(S===void 0){v.snapshots=null;return}S.sort((w,x)=>x.creationDate.getTime()-w.creationDate.getTime()),S=S.filter(w=>w.state===5||w.state===3),v.snapshots=S}return v.snapshots}}u(i,"all"),t.all=i;async function o(h,g,p,y,m=t.timeout){const v=a(h,g);let S=n.get(v);if(S===null)return;if(S!==void 0)return S;const w=s(h,p),x=e.get(w);if(x!==void 0&&Date.now()-x.time<=m){if(x.snapshots===null)return;const E=x.snapshots!==void 0?x.snapshots:await i(h,p,y);if(E!==void 0){for(const I of E)if(I.commitId===g)return n.set(v,I),I}return}if(S=await an.getWorkspaceSnapshot(g,y),S===void 0){n.set(v,null);return}return n.set(v,S),S}u(o,"single"),t.single=o;function a(h,g){return`${h.toString()}/${g}`}u(a,"getSingleCacheKey");function s(h,g){return g!==void 0?`${g}\\${h.toString()}`:h.toString()}u(s,"getAllCacheKey");async function c(h,g,p,y=t.timeout){return await o(h,g,void 0,p,y)!==void 0}u(c,"exists"),t.exists=c;async function l(h,g,p,y=t.timeout){return await i(h,g,p,y)!==void 0}u(l,"branch"),t.branch=l;async function d(h,g,p){const y=new Map(p.map(S=>[S.commitId,S])),m=await Ca.all(h,g.uri,p.map(S=>S.commitId));if(m.length===0)return;const v=[];for(const S of m){const w=y.get(S.hash);w!==void 0&&v.push({...w,commit:S})}if(v.length!==0)return v}u(d,"resolve"),t.resolve=d})(gt||(gt={}));var nr;(function(t){function e(n=!1){return{hoverProvider:n,declarationProvider:n,definitionProvider:n,typeDefinitionProvider:n,referencesProvider:n,documentSymbolProvider:n,foldingRangeProvider:n,diagnosticProvider:n,workspaceSymbolProvider:n}}u(e,"create"),t.create=e})(nr||(nr={}));var an;(function(t){const e="v0.1",n="https://prod.richnav.vsengsaas.visualstudio.com/api";async function r(w,x,E){var I;const D=await fa(w,{method:"POST",body:JSON.stringify(x),headers:{"Content-Type":"application/json",...(await E.authentication).getRichNavigationHeaders(),"x-correlation-id":(I=E.correlationId)!=null?I:Df()}});if(!!D.ok)return D.json()}u(r,"postRequest");async function i(w,x,E){const I=await fa(w,{method:"POST",body:x,headers:(await E.authentication).getRichNavigationHeaders()});if(!!I.ok)return await I.json()}u(i,"postForm");function o(w,x){return`${n}/${e}/HttpLanguageService/${w}/${x}`}u(o,"makeRequestUrl");async function a(w,x){const E=await fa(`${n}/${e}/WorkspaceSnapshot?commitId=${w}`,{headers:(await x.authentication).getRichNavigationHeaders()});if(E.ok){const I=await E.json();return{workspaceId:I.workspaceId,snapshotId:I.snapshotId,state:I.state,commitId:w.toLowerCase(),branchName:void 0,creationDate:new Date}}}u(a,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=a;async function s(w,x,E){const I=new Rf;I.append("uriString",w.toString(!0)),E!==void 0&&I.append("branchName",E);try{const D=await i(`${n}/${e}/WorkspaceSnapshot/all`,I,x);return D===void 0?void 0:D.map(Ys.asWorkspaceSnapshot)}catch(D){U.error(D);return}}u(s,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=s;async function c(w,x,E){const I=new Rf;I.append("uriString",w.toString(!0)),E!==void 0&&I.append("branchName",E);try{const D=await i(`${n}/${e}/WorkspaceSnapshot/latest`,I,x);return D===void 0?void 0:Ys.asWorkspaceSnapshot(D)}catch(D){U.error(D);return}}u(c,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=c;async function l(w,x,E){try{return r(o(w,"textDocument/capabilities"),x,E)}catch(I){U.error(I);return}}u(l,"capabilities"),t.capabilities=l;async function d(w,x,E){try{return r(o(w,"textDocument/hover"),x,E)}catch(I){U.error(I);return}}u(d,"provideHover"),t.provideHover=d;async function h(w,x,E){try{return r(o(w,"textDocument/definition"),x,E)}catch(I){U.error(I);return}}u(h,"provideDefinition"),t.provideDefinition=h;async function g(w,x,E){try{return r(o(w,"textDocument/declaration"),x,E)}catch(I){U.error(I);return}}u(g,"provideDeclaration"),t.provideDeclaration=g;async function p(w,x,E){try{return r(o(w,"textDocument/typeDefinition"),x,E)}catch(I){U.error(I);return}}u(p,"provideTypeDefinition"),t.provideTypeDefinition=p;async function y(w,x,E){try{return r(o(w,"textDocument/references"),x,E)}catch(I){U.error(I);return}}u(y,"provideReferences"),t.provideReferences=y;async function m(w,x,E){try{return r(o(w,"textDocument/foldingRange"),x,E)}catch(I){U.error(I);return}}u(m,"providerFoldingRanges"),t.providerFoldingRanges=m;async function v(w,x,E){if(x=="")return;const I=await fa(`${n}/${e}/Search/${w}/${x}`,{headers:(await E.authentication).getRichNavigationHeaders()});if(I.ok)return await I.json()}u(v,"provideWorkspaceSymbols"),t.provideWorkspaceSymbols=v;async function S(w,x,E){const I=f.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${w}/${x}/assets/designtime`,query:`id=${E}`});try{const D=await fa(I.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return D.ok?D.text():void 0}catch(D){U.error(D);return}}u(S,"getDesignTimeFileContent"),t.getDesignTimeFileContent=S})(an||(an={}));class kg{constructor(e,n){this.providerService=e,this.telemetryService=n,this.metadata=new Map;const r=[];r.push(this.providerService.onDidChangeRepositories(i=>{var o;for(const a of i.added){const s=a.uri,c=ce.getIndexMemento(s);if(c!==void 0){const l=tr.externalIndexUri(this.providerService,s);l!==void 0&&(typeof((o=c.branch)==null?void 0:o.name)=="string"?gt.all(l,c.branch.name,{authentication:this.providerService.getAuthentication(s)}).catch(void 0):typeof c.ref=="string"&&nt(c.ref)&&gt.single(l,c.ref,void 0,{authentication:this.providerService.getAuthentication(s)}).catch(void 0))}this.providerService.getMetadata(s).then(l=>{const d={},h=l.pullRequest===void 0?Xr.getIndexBranchName(l):void 0;h!==void 0?d.branch={name:h}:d.ref=l.HEAD.sha,ce.setIndexMemento(s,d).then(void 0,void 0)},void 0)}})),r.push(this.providerService.onDidChangeRepository(i=>{const o=i.repository.uri,a=N(o);this.metadata.delete(a),this.getIndexMetadata(o).catch(void 0)})),this.disposable=f.Disposable.from(...r)}dispose(){this.disposable.dispose()}async resolveIndexRef(e,n){const r=await this.providerService.getModeRefType(e),i=Si.decode(e);if(i!==void 0){if(i.type===on.Latest)return r===ke.Branch?this.getIndexedTip(e,n?0:gt.timeout):void 0;if(i.type===on.SHA){const a=tr.externalIndexUri(this.providerService,e);return a===void 0?void 0:await gt.exists(a,i.sha,{authentication:this.providerService.getAuthentication(e)},n?0:gt.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,r).index===ge.Latest)return this.getIndexedTip(e,n?0:gt.timeout)}refresh(e){for(const n of e)this.metadata.delete(n.toString())}getIndexMetadata(e){const n=this.providerService.getVirtualRootUri(e),r=N(n);let i=this.metadata.get(r);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(r,i)),i}async getIndexedTip(e,n=gt.timeout){const r=await Xr.getIndexedTip(this.providerService,e,n);return r!==void 0?r.commitId:void 0}async createIndexMetadata(e){const n=new Ae(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const r=tr.externalIndexUri(this.providerService,e);if(r===void 0)return;n.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),a=await i;n.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const s=this.providerService.getAuthentication(e),c=a.pullRequest===void 0?Xr.getIndexBranchName(a):void 0,l=await gt.single(r,a.HEAD.sha,c,{authentication:this.providerService.getAuthentication(e)});if(a.HEAD.type===me.Branch||a.HEAD.type===me.RemoteBranch){const p=Si.decode(e);if(p!==void 0)return n.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),l===void 0?p.type===on.Latest?(n.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),c!==void 0&&await gt.branch(r,c,{authentication:this.providerService.getAuthentication(e)})?{type:Re.Indexed}:{type:Re.NotIndexed}):{type:Re.NotIndexed}:p.type===on.Latest||p.type===on.SHA?{type:Re.Active,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}}:{type:Re.Match,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}}}n.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const h=this.providerService.getModeConfig(e,await o),g=this.providerService.getVirtualUriMetadata(e);if((h.index===ge.Latest||h.index===ge.Match)&&l!==void 0)return{type:Re.Active,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}};if(h.index===ge.TipPlusLatest&&g.provider.id==="github"){if(l!==void 0&&l.commitId===a.HEAD.sha)return{type:Re.Active,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}};if(a.HEAD.type===me.Branch&&c!==void 0){n.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const p=await gt.all(r,c,{authentication:s});if(p!==void 0&&p.length>0)return{type:Re.Active,sha:this.computeClosestIndex(e,a.HEAD.sha,p),branch:{name:c}}}}return l!==void 0?{type:Re.Indexed}:a.HEAD.type===me.Branch&&(n.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),c!==void 0&&await gt.branch(r,c,{authentication:s}))?{type:Re.Indexed}:{type:Re.NotIndexed}}finally{n.stop()}}async computeClosestIndex(e,n,r){if(r.length===0)throw new Error("At least on snapshot should exist");const i=new Set(r.map(d=>d.commitId)),o=await this.providerService.getCommits(e,{ref:n,limit:100});if(o===void 0)return;let a;for(const d of o.commits)if(d.hash===n){a=d;break}if(a===void 0)return;const s=new Map(o.commits.map(d=>[d.hash,d])),c=[a];let l;for(;c.length>0;){for(l=c.shift();l!==void 0&&!i.has(l.hash);)if(l.parents.length>0){for(let d=1;d<l.parents.length;d++){const h=s.get(l.parents[d]);h!==void 0&&c.push(h)}l=s.get(l.parents[0])}if(l!==void 0)break}return l!==void 0?l.hash:void 0}async getSnapshots(e,n){const r=tr.externalIndexUri(this.providerService,e);if(r===void 0)return[];const i=await gt.all(r,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const a of i)a.branchName!==void 0&&o.push({workspaceId:a.workspaceId,snapshotId:a.snapshotId,hash:a.commitId,branch:{name:a.branchName}});return o}async getStatusBarContributions(e){const n=await this.providerService.getMetadata(e),[r,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,n)]),o=this.providerService.getModeConfig(e,i);if(r===void 0)return[];const{HEAD:a}=n,s=[];if(r!==void 0){let c;const l=[`${Pe(a.sha)}`];if(r.type===Re.Active){const d=await r.sha;o.index===ge.Latest||o.index===ge.Match?(c=o.display===ve.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",l.push(st("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===ge.TipPlusLatest&&(c="$(layers-dot)",d!==n.HEAD.sha?l.push(st("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):l.push(st("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else r.type===Re.Match?(c="$(layers)",l.push(st("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):r.type===Re.Indexed&&(c="$(layers)",l.push(st("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));c&&s.push(Nn({command:"remoteHub.indexMode.select",title:c,tooltip:l.join(`
`),arguments:[{uri:e}]}))}return s}}u(kg,"RichNavIndexProvider");var xi;(function(t){let e;function n(){return e=f.window.createStatusBarItem(f.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,f.window.onDidChangeActiveTextEditor(()=>{c()}),f.commands.registerCommand("remoteHub.indexMode.select",d=>{l(d).catch(h=>U.log("Selecting index mode failed.",h))})]}u(n,"create"),t.create=n;const r=new Map;function i(d){r.set(d.key(),d)}u(i,"addService"),t.addService=i;function o(d){r.delete(d.key())}u(o,"removeService"),t.removeService=o;function a(d){return r.get(N(d))}u(a,"getService");async function s(d){for(const h of r.values())if(await h.handles(d))return h}u(s,"getServiceForDocument");async function c(){try{let d=u(function(y){const m=y.lastIndexOf("/");return m<=0?y:y.substr(m+1)},"basename");const h=f.window.activeTextEditor;if(h===void 0){e.hide();return}const g=await s(h.document);if(g===void 0){e.hide();return}const p=await g.isDocumentIndexed(h.document);p===Js.Indexed?(e.text="$(compass)",e.tooltip=new f.MarkdownString(st("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",d(h.document.uri.path))),e.show()):p===Js.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new f.MarkdownString(st("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",d(h.document.uri.path))),e.show()):e.hide()}catch(d){e.hide()}}u(c,"updateStatusBarItem"),t.updateStatusBarItem=c;async function l(d){var h;const g=d.uri,p=a(g);if(p===void 0)return;const[y,m,v,S]=await Promise.all([p.getBranchName(),p.getMetadata(),p.getIndexMetadata(),p.getModeRefType(g)]);if(v===void 0||!Re.hasIndex(v.type))return;let w,x=!1;const E=Si.decode(g);(E==null?void 0:E.type)===on.Latest||(E==null?void 0:E.type)===on.SHA?(x=!0,w={display:ve.Browse,index:E.type===on.Latest?ge.Latest:ge.Match}):w=(h=p.getCurrentIndexMode())!=null?h:p.getModeConfig(g,S);const I=p.getUriMetadata(),D=st("current item","{0} current","$(check)"),B={indexKind:"disable",label:st("RichNavStatus.disable.label","Disable"),description:w.index===ge.None?`  \u2022  ${D}`:void 0,detail:st("RichNavStatus.disable.detail","Disable rich navigation.")};let P,G;if(S===ke.PullRequestBranch||S===ke.PullRequestRemoteBranch||S===ke.Commit||S===ke.Tag){const ee={indexKind:"match",label:st("RichNavStatus.match.label","Current indexed commit - readonly"),description:w.index===ge.Match&&w.display===ve.Browse?`  \u2022  ${D}`:void 0,detail:st("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},te={indexKind:"match+writeable",label:st("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:w.index===ge.Match&&w.display===ve.Edit?`  \u2022  ${D}`:void 0,detail:st("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let X=I.provider.id==="github";X&&(X=m.HEAD.type===me.RemoteBranch?m.HEAD.branch.remote.accessLevel>=$t.Write:!0);const ae=X?[ee,te,B]:[ee,B];G=await f.window.showQuickPick(ae,{placeHolder:"Pick a rich navigation mode"})}else if(S===ke.Branch||S===ke.RemoteBranch){const ee={indexKind:"latest",label:st("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:w.index===ge.Latest?`  \u2022  ${D}`:void 0,detail:st("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},te={indexKind:"tip+latest",label:st("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:w.index===ge.TipPlusLatest?`  \u2022  ${D}`:void 0,detail:st("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},X=I.provider.id==="github"?[ee,te,B]:[ee,B];G=await f.window.showQuickPick(X,{placeHolder:st("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",y)})}if(G!==void 0&&(G.indexKind==="disable"?P={display:ve.Edit,index:ge.None}:G.indexKind==="match"?P={display:ve.Browse,index:ge.Match}:G.indexKind==="match+writeable"?P={display:ve.Edit,index:ge.Match}:G.indexKind==="tip+latest"?P={display:ve.Edit,index:ge.TipPlusLatest}:G.indexKind==="latest"&&(P={display:ve.Browse,index:ge.Latest}),P!==void 0&&!Ai.equals(w,P))){if(await p.hasChanges()&&P.display===ve.Browse){await f.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0});return}if(await p.updateIndexMode(P),x){const ee=await p.getNonIndexedWorkspaceDescriptor();ee!==void 0&&Mn(p.getProviderService(),ee)}}}u(l,"toggleIndexMode")})(xi||(xi={}));class Eu{constructor(e){this.telemetryService=e}static createStatus(){return xi.create()}async createNavigationService(e,n){const r=await e.getIndexMetadata(n.uri);if(!(r===void 0||r.type===Re.NotIndexed))return()=>new Ru(e,n,this.telemetryService)}}u(Eu,"RichNavServiceProvider");var _a;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function n(i){const o=e.exec(i);if(o===null||o.length!==5)return;const a={v:1,w:o[1],s:o[2],a:o[3]};return f.Uri.from({scheme:xr.scheme,authority:Bt(JSON.stringify(a)),path:o[4]})}u(n,"toVSCode"),t.toVSCode=n;function r(i){if(i.scheme!==xr.scheme)return;let o;try{return o=JSON.parse(Yt(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}u(r,"toRichNavComponents"),t.toRichNavComponents=r})(_a||(_a={}));const ku=u(class{constructor(){this._onDidChangeFile=new f.EventEmitter,this.cache=new br(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return ku.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw f.FileSystemError.FileNotFound();return{type:f.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:f.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw f.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw f.FileSystemError.FileNotFound();return e.content}writeFile(t,e,n){throw f.FileSystemError.NoPermissions()}delete(t,e){throw f.FileSystemError.NoPermissions()}rename(t,e,n){throw f.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==ku.scheme)return;const n=_a.toRichNavComponents(t);if(n===void 0)return;const r=await an.getDesignTimeFileContent(n.workspaceId,n.snapshotId,n.assetId);if(r!==void 0)return e={content:this.textEncoder.encode(r),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let xr=ku;xr.scheme="vsck-fs",xr.emptyDisposable={dispose:()=>{}};var Js;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(Js||(Js={}));const Un=u(class{static registerCapability(t,e,n){var r;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(r=n[e])!=null?r:!1}constructor(t,e,n){this.providerService=t,this.repository=e,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const r=u((o=!1)=>{const a=this.repository.uri;o||(this.metadata=this.providerService.getMetadata(a),this.indexMetadata=this.providerService.getIndexMetadata(a)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(a,this.metadata)]).then(async s=>{var c,l;const[d,h,g]=this.currentlyResolved,[p,y,m]=s,v=this.providerService.getModeConfig(a,m);if(d!==void 0&&h!==void 0&&g!==void 0&&d.HEAD.sha===p.HEAD.sha&&y!==void 0&&h.type===y.type&&g.index===v.index&&g.display===v.display){const w=(h==null?void 0:h.type)===Re.Active?await h.sha:void 0,x=(y==null?void 0:y.type)===Re.Active?await y.sha:void 0;if(w===x)return}const S={newDisplayMode:v.display,newIndexMode:v.index,newIndexType:(y==null?void 0:y.type)===void 0?"undefined":Re[y==null?void 0:y.type],currentDisplayMode:(c=g==null?void 0:g.display)!=null?c:"undefined",currentIndexMode:(l=g==null?void 0:g.index)!=null?l:"undefined",currentIndexType:(h==null?void 0:h.type)===void 0?"undefined":Re[h==null?void 0:h.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",S),this.currentlyResolved=[p,y,v];for(const w of this.registeredFeatures.values())w.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,fu.isActive(y)){const w=tr.externalIndexUri(this.providerService,p),x=await y.sha;if(w!==void 0&&x!==void 0){const E=await gt.single(w,x,Xr.getIndexBranchName(p),{authentication:this.providerService.getAuthentication(a)});E!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:E.snapshotId}),this.workspaceSnapshot=E,this.documentListeners=this.installDocumentListeners(),((v==null?void 0:v.display)===ve.Edit||p.HEAD.sha!==x)&&(this.mapper=new Qf(this.providerService,a,x,p.HEAD.sha)))}}await xi.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new br(2048),this.knownDesignTimeFiles=new Set;const i=[];i.push(this.providerService.onDidChangeRepository(o=>{N(o.repository.uri)===N(this.repository.uri)&&r()})),i.push(this.providerService.onDidRefresh(o=>{for(const a of o)if(N(a)===N(this.repository.uri)){r();break}})),this.environmentListeners=f.Disposable.from(...i),r(!0),xi.addService(this),this.indexMetadata.then(async o=>{var a;const s=this.repository.uri;let c=!1;const l=Si.decode(this.repository.uri);if(l!==void 0&&o!==void 0&&(l.type===on.Latest&&o.type!==Re.Active||l.type===on.SHA&&(o.type!==Re.Active||await o.sha!==l.sha))&&(c=!0),!c){await this.metadata;const d=await this.providerService.getModeRefType(s,this.metadata),h=(a=this.currentlyResolved[2])!=null?a:this.providerService.getModeConfig(s,d,!0);h!==void 0&&h.display===ve.Browse&&o!==void 0&&h.index!==ge.None&&o.type!==Re.Active?c=!0:(o==null?void 0:o.type)===Re.Active&&await o.sha===void 0&&((h==null?void 0:h.display)===ve.Browse,c=!0)}c&&f.window.showWarningMessage(st("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),Un.fileSystemProvider===void 0&&(Un.fileSystemProvider=new xr,f.workspace.registerFileSystemProvider(xr.scheme,Un.fileSystemProvider))}getRepository(){return this.repository}async updateIndexMode(t){const e=this.currentlyResolved[2],n=t!==void 0;if(t===void 0){const r=this.repository.uri,i=await this.providerService.getModeRefType(r,this.metadata);t=this.providerService.getModeConfig(r,i),await new Promise(o=>setTimeout(o,1e3))}if(e===void 0||e.index!==t.index||e.display!==t.display){if(t.index===ge.Latest){await Promise.all([this.metadata,this.indexMetadata]);const r=await this.getIndexedTip();if(r===void 0)return;await this.sync(r.hash)}else t.index===ge.TipPlusLatest&&(await Promise.all([this.metadata,this.indexMetadata]),await this.sync());n&&await ce.setMode(this.repository.uri,t),this.refresh()}}getCurrentIndexMode(){return this.currentlyResolved[2]}key(){return N(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),xi.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Ht.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Xr.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getProviderService(){return this.providerService}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:n}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:n}),location:ze.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===Re.NotIndexed||this.workspaceSnapshot===void 0)return 0;const n=this.pendingCapabilitiesRequests.get(t.uri.toString());return n!==void 0&&await n,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=tr.externalIndexUri(this.providerService,t),n=Xr.getIndexBranchName(t);if(e===void 0||n===void 0)return;const r=await gt.getIndexedTip(e,n,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(r===void 0)return;const i=await Ca.get(this.providerService,this.repository.uri,r.commitId);if(i!==void 0)return{...i,branchName:n}}hasChanges(){return this.providerService.getChangeStore(this.repository.uri).hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,n=tr.externalIndexUri(this.providerService,e);if(n===void 0)return;const[r,i]=await Promise.all([Ca.get(this.providerService,this.repository.uri,t),gt.single(n,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(r===void 0||i===void 0))return{...r,branchName:i.branchName}}installDocumentListeners(){const t=[],e=u(async n=>{const r=n.uri.scheme;if(Ht.scheme!==r&&xr.scheme!==r)return;const i=n.uri.toString();if(r===Ht.scheme&&!i.startsWith(this.repositoryRoot)||r===xr.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let a=this.capabilitiesCache.get(i);if(a!==null){if(a===void 0){const s=this.capabilities(n.uri);this.pendingCapabilitiesRequests.set(i,s),a=await s,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,a===void 0?null:a)}a===void 0||!f.workspace.textDocuments.some(s=>s===n)||this.registerProviders(n,a,o)}},"openHandler");return t.push(f.workspace.onDidOpenTextDocument(e)),f.workspace.textDocuments.forEach(e),t.push(f.workspace.onDidCloseTextDocument(n=>{const r=n.uri.toString(),i=this.registeredFeatures.get(r);i!==void 0&&(this.registeredFeatures.delete(n.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(r)})),f.Disposable.from(...t)}registerProviders(t,e,n){if(this.workspaceSnapshot===void 0)return;const r=this.workspaceSnapshot,i=t.languageId,a=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],s=[],c=new Promise((m,v)=>{const S=`/${r.snapshotId}/source/`;this.metadata.then(w=>{m(Gv(x=>{const E=f.Uri.parse(x);if(w===void 0)return E;try{if(E.scheme==="vsck"&&E.authority===r.workspaceId&&E.path.startsWith(S))return this.repository.createRelativeUri(E.path.substr(S.length));const I=_a.toVSCode(x);return I!==void 0?(this.knownDesignTimeFiles.add(I.toString()),I):E}catch(I){return E}}))},v)}),l=new RegExp(`^vsck:\\/\\/${r.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function d(m){const v=l.exec(m);return v===null||v.length===2}u(d,"designTimeFilter");function h(m){if(m==null)return m;if(Array.isArray(m)){if(m.length===0)return[];const v=m[0];return typeof v.uri=="string"?m.filter(x=>d(x.uri)):typeof v.targetUri=="string"?m.filter(x=>d(x.targetUri)):[]}return l.exec(m.uri)===null?m:void 0}u(h,"filterDesignTimeFiles");async function g(m,v,S){var w,x,E;if(S==null||m===void 0)return S;const I=new Map(f.workspace.textDocuments.map(B=>[B.uri.toString(!0),B]));if(Array.isArray(S)){const B=[],P=[];if(S.length===0)return[];for(const G of S){const ee=G;if(ee.uri instanceof f.Uri){const te=await m.mapRangeFromIndexToCode((w=I.get(ee.uri.toString()))!=null?w:ee.uri,ee.range);te!==void 0&&B.push(new f.Location(ee.uri,te))}else{const te=G,X=(x=I.get(te.targetUri.toString()))!=null?x:te.targetUri,ae=te.originSelectionRange?await m.mapRangeFromIndexToCode(v,te.originSelectionRange):void 0;if(ae!==void 0||te.originSelectionRange===void 0){const k=await m.mapRangeFromIndexToCode(X,te.targetRange);if(k!==void 0){const O=te.targetSelectionRange?await m.mapRangeFromIndexToCode(X,te.targetSelectionRange):void 0;(O!==void 0||te.targetSelectionRange===void 0)&&P.push({targetUri:te.targetUri,targetRange:k,targetSelectionRange:O,originSelectionRange:ae})}}}}return B.length>0?B:P}const D=await m.mapRangeFromIndexToCode((E=I.get(S.uri.toString()))!=null?E:S.uri,S.range);if(D!==void 0)return new f.Location(S.uri,D)}u(g,"mapLocations");const p=u(m=>({authentication:this.providerService.getAuthentication(m.uri),correlationId:Df()}),"getRestApiOptions"),y=u((m,v)=>{const S={method:m,correlationId:v.correlationId};this.telemetryService.publicLog2("codex.restAPICall",S)},"sendTelemetry");Un.registerCapability(i,"hoverProvider",e)&&s.push(f.languages.registerHoverProvider(a,{provideHover:async(m,v)=>{const S=await this.createTextDocumentPositionParams(m,v);if(S===void 0)return;const w=p(m);return y("codex.provideHover",w),(await c).asHover(await an.provideHover(n,S,w))}})),Un.registerCapability(i,"definitionProvider",e)&&s.push(f.languages.registerDefinitionProvider(a,{provideDefinition:async(m,v)=>{const S=await this.createTextDocumentPositionParams(m,v);if(S===void 0)return;const w=p(m);return y("codex.provideDefinition",w),g(this.mapper,m,(await c).asDefinitionResult(h(await an.provideDefinition(n,S,w))))}})),Un.registerCapability(i,"declarationProvider",e)&&s.push(f.languages.registerDeclarationProvider(a,{provideDeclaration:async(m,v)=>{const S=await this.createTextDocumentPositionParams(m,v);if(S===void 0)return;const w=p(m);return y("codex.provideDeclaration",w),g(this.mapper,m,(await c).asDeclarationResult(h(await an.provideDeclaration(n,S,w))))}})),Un.registerCapability(i,"typeDefinitionProvider",e)&&s.push(f.languages.registerTypeDefinitionProvider(a,{provideTypeDefinition:async(m,v)=>{const S=await this.createTextDocumentPositionParams(m,v);if(S===void 0)return;const w=p(m);return y("codex.provideTypeDefinition",w),g(this.mapper,m,(await c).asDefinitionResult(h(await an.provideTypeDefinition(n,S,w))))}})),Un.registerCapability(i,"referencesProvider",e)&&s.push(f.languages.registerReferenceProvider(a,{provideReferences:async(m,v,S)=>{const w=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(m,v):v;if(w===void 0)return;const x={position:{line:w.line,character:w.character},textDocument:{uri:this.createRichNavDocumentUri(m.uri).toString(!0)},context:{includeDeclaration:S.includeDeclaration}},E=p(m);return y("codex.provideReferences",E),g(this.mapper,m,(await c).asReferences(h(await an.provideReferences(n,x,E))))}})),Un.registerCapability(i,"foldingRangeProvider",e)&&s.push(f.languages.registerFoldingRangeProvider(a,{provideFoldingRanges:async m=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(m))return;const v=p(m);return y("codex.provideFoldingRanges",v),(await c).asFoldingRanges(await an.providerFoldingRanges(n,this.createTextDocumentParams(m.uri),v))}})),Un.registerCapability(i,"workspaceSymbolProvider",e)&&s.push(f.languages.registerWorkspaceSymbolProvider({provideWorkspaceSymbols:async m=>{const v=p(t),S=await an.provideWorkspaceSymbols(n,m,v);if(S!==void 0)return(await c).asSymbolInformations(S)}})),this.registeredFeatures.set(t.uri.toString(),f.Disposable.from(...s)),xi.updateStatusBarItem()}async capabilities(t){var e;const n=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(n!==void 0)return(e=await an.capabilities(n,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const n=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(n!==void 0)return{position:{line:n.line,character:n.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===xr.scheme){const r=_a.toRichNavComponents(t);return r===void 0?t:f.Uri.file(r.assetId)}const e=this.repository.uri.toString(!0),n=t.toString(!0);return f.Uri.file(n.substr(e.length))}},"_RichNavService");let Ru=Un;Ru.localCapabilities=new Map([["javascript",Object.assign(nr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(nr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(nr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(nr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),Ru.disabledCapabilities=new Map([["javascript",Object.assign(nr.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(nr.create(),{declarationProvider:!0})],["typescript",Object.assign(nr.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(nr.create(),{declarationProvider:!0})]]);var Rg=u((t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},"__accessCheck"),Yr=u((t,e,n)=>(Rg(t,e,"read from private field"),n?n.call(t):e.get(t)),"__privateGet"),Kv=u((t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},"__privateAdd"),Qv=u((t,e,n,r)=>(Rg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),"__privateSet"),On;class Dg{constructor(e){Kv(this,On,void 0),Qv(this,On,e)}async getMetadata(e){const n=Yr(this,On).getVirtualUriMetadata(e);if(n===void 0)return;const{provider:r,repo:i}=n;return{provider:{id:r.id,name:r.name},repo:i,getRevision:async()=>{const{HEAD:o}=await Yr(this,On).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return Yr(this,On).getRegisteredProvider(e)}getProviderUri(e){return se.getProviderUri(e)}getProviderRootUri(e){return Yr(this,On).getProviderRootUri(e)}isProviderUri(e,n){return e.scheme!==Ht.scheme&&Yr(this,On).hasProvider(e,n)}getVirtualUri(e){return se.getVirtualUri(e)}getVirtualWorkspaceUri(e){return Yr(this,On).getVirtualWorkspaceUri(e)}async loadWorkspaceContents(e){if(e.scheme!==se.scheme)return!1;const n=Yr(this,On).getProviderRootUri(e);return n.scheme!=="github"?!1:Yr(this,On).loadWorkspaceContents(n)}}u(Dg,"ExtensionApi"),On=new WeakMap;var Xv=Object.defineProperty,Yv=Object.getOwnPropertyDescriptor,Du=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Yv(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Xv(e,n,i),i},"fs_decorateClass");const Tu=f.FileSystemError.FileNotFound().code;class xa{constructor(e){this.providerService=e,this._onDidChangeFile=new f.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=f.Disposable.from(f.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),f.workspace.registerFileSearchProvider(this.scheme,this),f.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),e.onDidChangeChangeStore(n=>{const r=n.map(i=>{switch(i.type){case R.Created:return{type:f.FileChangeType.Created,uri:i.uri};case R.Changed:return{type:f.FileChangeType.Changed,uri:i.uri};case R.Deleted:return{type:f.FileChangeType.Deleted,uri:i.uri}}});setTimeout(()=>this._onDidChangeFile.fire(r),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Ht.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(n=>n.scheme===this.scheme),e.length!==0&&(U.log(`fs.onRefreshOrRepositoryChanged(${e.map(n=>n.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const n=se.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>Tr(o,a))&&(this.implicitlyWatchedUris.delete(i),n.set(i,o));U.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${n.size}`);for(const i of e)n.set(N(i),i);const r=[...n.values()].map(i=>({type:f.FileChangeType.Changed,uri:i}));setTimeout(()=>{U.debug(`fs.updateOpenOrWatchedUris: Firing events=${r.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(r)},0)}watch(e,n){const r=N(e);this.watchedUris.set(r,e);const i=Wt(this.providerService,e).then(()=>this.providerService.watch(se.getProviderUri(e),n));return{dispose:async()=>{this.watchedUris.delete(r),(await i).dispose()}}}async stat(e){const n=new Ae(`fs.stat(${e.toString()})`);await Wt(this.providerService,e);let r;try{if(this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(n.logStep("ChangeStore query"),r=await this.providerService.changeStoreStat(e),r!==void 0)return r;n.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else n.logStep("Provider query"),this.implicitlyWatchedUris.set(N(e),e);return r=await this.providerService.stat(se.getProviderUri(e)),r}finally{r===void 0&&this.implicitlyWatchedUris.delete(N(e)),n.stop()}}async readDirectory(e){const n=new Ae(`fs.readDirectory(${e.toString()})`);await Wt(this.providerService,e),this.implicitlyWatchedUris.set(N(e),e);try{n.logStep("Provider query");let r=await this.providerService.readDirectory(se.getProviderUri(e));return this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(n.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),r=await this.providerService.changeStoreUpdateDirectoryEntries(e,r)),r}finally{n.stop()}}async createDirectory(e){const n=new Ae(`fs.createDirectory(${e.toString()})`);await Wt(this.providerService,e);try{await this.providerService.changeStoreCreateDirectory(e)}catch(r){throw U.error(r,n.context),r}finally{n.stop()}}async readFile(e){const n=new Ae(`fs.readFile(${e.toString()})`),r=N(e);let i;await Wt(this.providerService,e);try{if(this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){n.logStep("ChangeStore query");const o=await this.providerService.changeStoreReadFile(e);if(o!==void 0)return o;n.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else n.logStep("Provider query"),this.implicitlyWatchedUris.set(r,e);return i=await this.providerService.readFile(se.getProviderUri(e)),i}catch(o){throw o instanceof Ot&&lu.showProviderNotFoundMessage(o),o}finally{i===void 0&&this.implicitlyWatchedUris.delete(r),n.stop()}}async writeFile(e,n,r){const i=new Ae(`fs.writeFile(${e.toString()})`,{},n.length,r);await Wt(this.providerService,e);try{let o;try{if(o=await this.stat(e),!r.overwrite)throw f.FileSystemError.FileExists()}catch(a){if(a instanceof f.FileSystemError&&a.code===Tu){if(!r.create)throw f.FileSystemError.FileNotFound(e)}else throw a}try{if(o===void 0)await this.providerService.changeStoreCreateFile(e,n);else{i.logStep("Provider original query");let a;try{a=await this.providerService.readFile(se.getProviderUri(e))}catch(s){if(s instanceof f.FileSystemError&&s.code===Tu)a=new Uint8Array;else throw s}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.providerService.changeStoreWriteFile(e,n,a)}}catch(a){throw U.error(a,i.context),a}}catch(o){throw o instanceof Ot&&lu.showProviderNotFoundMessage(o),o}finally{i.stop()}}async delete(e,n){const r=new Ae(`fs.delete(${e.toString()})`,{},n);await Wt(this.providerService,e);try{switch((await this.stat(e)).type){case f.FileType.File:await this.providerService.changeStoreDeleteFile(e);break;case f.FileType.Directory:{await this.deleteDirectory(e,n);break}default:throw f.FileSystemError.NoPermissions()}}catch(i){throw U.error(i,r.context),i}finally{r.stop()}}async deleteDirectory(e,n){const r=new Ae(`fs.deleteDirectory(${e.toString()})`,{},n);try{const i=await this.readDirectory(e);if(i.length!==0){if(!n.recursive&&i.some(([,o])=>o===f.FileType.Directory))throw f.FileSystemError.NoPermissions();for(const[o,a]of i)a===f.FileType.Directory?await this.deleteDirectory(f.Uri.joinPath(e,o),n):await this.providerService.changeStoreDeleteFile(f.Uri.joinPath(e,o))}await this.providerService.changeStoreDeleteDirectory(e)}catch(i){throw U.error(i,r.context),i}finally{r.stop()}}async rename(e,n,r){const i=new Ae(`fs.rename(${e.toString()} -> ${n.toString()})`,{},r);await Wt(this.providerService,e);try{switch((await this.stat(e)).type){case f.FileType.File:{const a=await this.readFile(e);await this.writeFile(n,a,{create:!0,overwrite:r.overwrite}),await this.delete(e,{recursive:!1});break}case f.FileType.Directory:{await this.renameDirectory(e,n,r);break}default:throw f.FileSystemError.NoPermissions()}}catch(o){throw U.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,n,r){const i=new Ae(`fs.renameDirectory(${e.toString()} -> ${n.toString()})`,{},r);try{await this.copyDirectory(e,n,r),await this.delete(e,{recursive:!0})}catch(o){throw U.error(o,i.context),o}finally{i.stop()}}async copy(e,n,r){const i=new Ae(`fs.copy(${e.toString()} -> ${n.toString()})`,{},r);try{switch((await this.stat(e)).type){case f.FileType.File:{const a=await this.readFile(e);await this.writeFile(n,a,{create:!0,overwrite:r.overwrite});break}case f.FileType.Directory:{await this.copyDirectory(e,n,r);break}default:throw f.FileSystemError.NoPermissions()}}catch(o){throw U.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,n,r){const i=new Ae(`fs.copyDirectory(${e.toString()} -> ${n.toString()})`,{},r);try{if(await this.exists(n))throw f.FileSystemError.FileExists();try{await this.createDirectory(n);const o=await this.readDirectory(e);for(const[a,s]of o)s===f.FileType.Directory?await this.copyDirectory(f.Uri.joinPath(e,a),f.Uri.joinPath(n,a),r):await this.copy(f.Uri.joinPath(e,a),f.Uri.joinPath(n,a),r)}catch(o){throw U.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(n){if(n instanceof f.FileSystemError&&n.code===Tu)return!1;throw n}}async provideFileSearchResults(e,n,r){var i;const o=new Ae(`fs.provideFileSearchResults(${e.pattern}, ${n.folder.toString()})`,{logLevel:rt.Debug});await Wt(this.providerService,n.folder);let a;try{return a=await this.providerService.provideFileSearchResults(e,{...n,folder:se.getProviderUri(n.folder)},r),a==null?void 0:a.map(s=>se.getVirtualUri(s))}catch(s){throw U.error(s,o.context),s}finally{o.stop({suffix:` \u2022 ${(i=a==null?void 0:a.length)!=null?i:0} results found`})}}async provideTextSearchResults(e,n,r,i){return await Wt(this.providerService,n.folder),this.providerService.provideTextSearchResults(e,{...n,folder:se.getProviderUri(n.folder)},{report:o=>r.report({...o,uri:se.getVirtualUri(o.uri)})},i)}}u(xa,"ChangeTrackingFileSystem"),Du([$s()],xa.prototype,"stat",1),Du([$s()],xa.prototype,"readDirectory",1),Du([$s()],xa.prototype,"readFile",1);const Ii=J.loadMessageBundle(),Tg=u(class{constructor(t){this.providerService=t,this.lock=new pa("PendingRepositoryOpenActions"),this.disposable=f.Disposable.from(t.onDidChangeRepositories(e=>e.added.length&&this.onRepositoriesOpened(e.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const n=await this.getAndDelete(e);(n==null?void 0:n.applyChangeset)&&await this.applyPendingChangeset(e,n.applyChangeset),(n==null?void 0:n.filesToOpen)&&this.openPendingFiles(e.uri,n.filesToOpen),this.fetchOrSync(e).then(async()=>{const r=ce.get("uncommittedChangesOnEntry");if(r==="none"||!await this.providerService.changeStoreHasChanges(e.uri)||(await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e.uri))).length===0&&r==="promptIfBehind")return;const{state:a}=await this.providerService.getMetadata(e.uri);if(a===void 0||a.behind<1)return;const s=await this.providerService.changeStoreGetChanges(e.uri),c=s.length===1?Ii("prompt uncommitted changes file","You have {0} file with uncommitted changes from a previous edit session.",s.length.toString()):Ii("prompt uncommitted changes files","You have {0} files with uncommitted changes from a previous edit session.",s.length.toString());let l="";a.behind===1?l=Ii("prompt incoming changes commit",`Your repository contents may be out of date until you sync.

You are {0} commit behind.`,a.behind.toString()):a.behind>1&&(l=Ii("prompt incoming changes commits",`Your repository contents may be out of date until you sync.

You are {0} commits behind.`,a.behind.toString()));const d=[c,l].join(`

`),h={title:Ii("sync uncommitted changes","Sync")},g={title:Ii("continue uncommitted changes","Continue Without Syncing"),isCloseAffordance:!0},p={title:Ii("don't show again","Don't Show Again")},y=await f.window.showInformationMessage(d,{modal:!0},h,g,p);switch(y==null?void 0:y.title){case h.title:await f.commands.executeCommand("remoteHub.sync");break;case p.title:await ce.updateEffective("uncommittedChangesOnEntry","none");break;default:break}})}}async fetchOrSync(t){await this.providerService.fetchOrSync(t.uri)}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){U.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const n=await this.getCore(t.uri);if(n!==void 0)return await this.storeCore(t.uri,void 0),n},"PendingRepositoryOpenActions.getAndDelete")}catch(e){U.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){U.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let n of e){const r=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(n);let i,o;(r==null?void 0:r.groups)!==void 0&&(i=Number(r.groups.start),isNaN(i)&&(i=void 0),o=Number(r.groups.end),isNaN(o)&&(o=void 0),n=n.substring(0,r.index));const a=f.Uri.joinPath(t,n);let s;try{s=await f.workspace.fs.stat(a)}catch{}if((s==null?void 0:s.type)===f.FileType.Directory)f.commands.executeCommand("revealInExplorer",a);else{let c;i!==void 0&&(c={selection:new f.Range(Number(i)-1,0,o!=null?o:i,0)}),f.commands.executeCommand("vscode.open",a,c)}}}}setChangesetToApply(t,e){return U.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const n=await this.getCore(t);await this.storeCore(t,{...n,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return U.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const n=await this.getCore(t);await this.storeCore(t,{...n,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){U.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);const n=ce.get("experimental.useSimplifiedMerge");try{await this.providerService.changeStoreApplyChangeset(t.uri,e,{save:!0,useSimplifiedMerge:n})}catch(r){U.error(r,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.providerService.getFromStorage(t,this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.providerService.deleteFromStorage(t,this.getStorageKey(t)):this.providerService.storeInStorage(t,this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${N(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(n,r)=>(n==="uri"||n.endsWith("Uri"))&&Ar(r)?f.Uri.from(r):r);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return U.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:Tg.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let Ag=Tg;Ag.storageSchemaVersion=1;function Ir(){}u(Ir,"Diff"),Ir.prototype={diff:u(function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.callback;typeof r=="function"&&(i=r,r={}),this.options=r;var o=this;function a(m){return i?(setTimeout(function(){i(void 0,m)},0),!0):m}u(a,"done"),e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var s=n.length,c=e.length,l=1,d=s+c,h=[{newPos:-1,components:[]}],g=this.extractCommon(h[0],n,e,0);if(h[0].newPos+1>=s&&g+1>=c)return a([{value:this.join(n),count:n.length}]);function p(){for(var m=-1*l;m<=l;m+=2){var v=void 0,S=h[m-1],w=h[m+1],x=(w?w.newPos:0)-m;S&&(h[m-1]=void 0);var E=S&&S.newPos+1<s,I=w&&0<=x&&x<c;if(!E&&!I){h[m]=void 0;continue}if(!E||I&&S.newPos<w.newPos?(v=Zv(w),o.pushComponent(v.components,void 0,!0)):(v=S,v.newPos++,o.pushComponent(v.components,!0,void 0)),x=o.extractCommon(v,n,e,m),v.newPos+1>=s&&x+1>=c)return a(Jv(o,v.components,n,e,o.useLongestToken));h[m]=v}l++}if(u(p,"execEditLength"),i)u(function m(){setTimeout(function(){if(l>d)return i();p()||m()},0)},"exec")();else for(;l<=d;){var y=p();if(y)return y}},"diff"),pushComponent:u(function(e,n,r){var i=e[e.length-1];i&&i.added===n&&i.removed===r?e[e.length-1]={count:i.count+1,added:n,removed:r}:e.push({count:1,added:n,removed:r})},"pushComponent"),extractCommon:u(function(e,n,r,i){for(var o=n.length,a=r.length,s=e.newPos,c=s-i,l=0;s+1<o&&c+1<a&&this.equals(n[s+1],r[c+1]);)s++,c++,l++;return l&&e.components.push({count:l}),e.newPos=s,c},"extractCommon"),equals:u(function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},"equals"),removeEmpty:u(function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},"removeEmpty"),castInput:u(function(e){return e},"castInput"),tokenize:u(function(e){return e.split("")},"tokenize"),join:u(function(e){return e.join("")},"join")};function Jv(t,e,n,r,i){for(var o=0,a=e.length,s=0,c=0;o<a;o++){var l=e[o];if(l.removed){if(l.value=t.join(r.slice(c,c+l.count)),c+=l.count,o&&e[o-1].added){var h=e[o-1];e[o-1]=e[o],e[o]=h}}else{if(!l.added&&i){var d=n.slice(s,s+l.count);d=d.map(function(p,y){var m=r[c+y];return m.length>p.length?m:p}),l.value=t.join(d)}else l.value=t.join(n.slice(s,s+l.count));s+=l.count,l.added||(c+=l.count)}}var g=e[a-1];return a>1&&typeof g.value=="string"&&(g.added||g.removed)&&t.equals("",g.value)&&(e[a-2].value+=g.value,e.pop()),e}u(Jv,"buildValues");function Zv(t){return{newPos:t.newPos,components:t.components.slice(0)}}u(Zv,"clonePath");var ew=new Ir;function s0(t,e,n){return ew.diff(t,e,n)}u(s0,"diffChars");function Pg(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}u(Pg,"generateOptions");var Fg=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Mg=/\S/,Zs=new Ir;Zs.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Mg.test(t)&&!Mg.test(e)},Zs.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<e.length-1;n++)!e[n+1]&&e[n+2]&&Fg.test(e[n])&&Fg.test(e[n+2])&&(e[n]+=e[n+2],e.splice(n+1,2),n--);return e};function c0(t,e,n){return n=Pg(n,{ignoreWhitespace:!0}),Zs.diff(t,e,n)}u(c0,"diffWords");function l0(t,e,n){return Zs.diff(t,e,n)}u(l0,"diffWordsWithSpace");var ec=new Ir;ec.tokenize=function(t){var e=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function tw(t,e,n){return ec.diff(t,e,n)}u(tw,"diffLines");function u0(t,e,n){var r=Pg(n,{ignoreWhitespace:!0});return ec.diff(t,e,r)}u(u0,"diffTrimmedLines");var Ng=new Ir;Ng.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function d0(t,e,n){return Ng.diff(t,e,n)}u(d0,"diffSentences");var Lg=new Ir;Lg.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function h0(t,e,n){return Lg.diff(t,e,n)}u(h0,"diffCss");function tc(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tc=u(function(e){return typeof e},"_typeof"):tc=u(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),tc(t)}u(tc,"_typeof");function Er(t){return nw(t)||rw(t)||iw(t)||ow()}u(Er,"_toConsumableArray");function nw(t){if(Array.isArray(t))return Au(t)}u(nw,"_arrayWithoutHoles");function rw(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}u(rw,"_iterableToArray");function iw(t,e){if(!!t){if(typeof t=="string")return Au(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Au(t,e)}}u(iw,"_unsupportedIterableToArray");function Au(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}u(Au,"_arrayLikeToArray");function ow(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}u(ow,"_nonIterableSpread");var aw=Object.prototype.toString,_o=new Ir;_o.useLongestToken=!0,_o.tokenize=ec.tokenize,_o.castInput=function(t){var e=this.options,n=e.undefinedReplacement,r=e.stringifyReplacer,i=r===void 0?function(o,a){return typeof a=="undefined"?n:a}:r;return typeof t=="string"?t:JSON.stringify(Pu(t,null,null,i),i,"  ")},_o.equals=function(t,e){return Ir.prototype.equals.call(_o,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function f0(t,e,n){return _o.diff(t,e,n)}u(f0,"diffJson");function Pu(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var a;if(aw.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),n.push(a),o=0;o<t.length;o+=1)a[o]=Pu(t[o],e,n,r,i);return e.pop(),n.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),tc(t)==="object"&&t!==null){e.push(t),a={},n.push(a);var s=[],c;for(c in t)t.hasOwnProperty(c)&&s.push(c);for(s.sort(),o=0;o<s.length;o+=1)c=s[o],a[c]=Pu(t[c],e,n,r,c);e.pop(),n.pop()}else a=t;return a}u(Pu,"canonicalize");var nc=new Ir;nc.tokenize=function(t){return t.slice()},nc.join=nc.removeEmpty=function(t){return t};function g0(t,e,n){return nc.diff(t,e,n)}u(g0,"diffArrays");function Ia(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.split(/\r\n|[\n\v\f\r\x85]/),r=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var l={};for(i.push(l);o<n.length;){var d=n[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var h=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);h&&(l.index=h[1]),o++}for(s(l),s(l),l.hunks=[];o<n.length;){var g=n[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(g))break;if(/^@@/.test(g))l.hunks.push(c());else{if(g&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(g));o++}}}u(a,"parseIndex");function s(l){var d=/^(---|\+\+\+)\s+(.*)$/.exec(n[o]);if(d){var h=d[1]==="---"?"old":"new",g=d[2].split("	",2),p=g[0].replace(/\\\\/g,"\\");/^".*"$/.test(p)&&(p=p.substr(1,p.length-2)),l[h+"FileName"]=p,l[h+"Header"]=(g[1]||"").trim(),o++}}u(s,"parseFileHeader");function c(){var l=o,d=n[o++],h=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),g={oldStart:+h[1],oldLines:typeof h[2]=="undefined"?1:+h[2],newStart:+h[3],newLines:typeof h[4]=="undefined"?1:+h[4],lines:[],linedelimiters:[]};g.oldLines===0&&(g.oldStart+=1),g.newLines===0&&(g.newStart+=1);for(var p=0,y=0;o<n.length&&!(n[o].indexOf("--- ")===0&&o+2<n.length&&n[o+1].indexOf("+++ ")===0&&n[o+2].indexOf("@@")===0);o++){var m=n[o].length==0&&o!=n.length-1?" ":n[o][0];if(m==="+"||m==="-"||m===" "||m==="\\")g.lines.push(n[o]),g.linedelimiters.push(r[o]||`
`),m==="+"?p++:m==="-"?y++:m===" "&&(p++,y++);else break}if(!p&&g.newLines===1&&(g.newLines=0),!y&&g.oldLines===1&&(g.oldLines=0),e.strict){if(p!==g.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(y!==g.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1))}return g}for(u(c,"parseHunk");o<n.length;)a();return i}u(Ia,"parsePatch");function sw(t,e,n){var r=!0,i=!1,o=!1,a=1;return u(function s(){if(r&&!o){if(i?a++:r=!1,t+a<=n)return a;o=!0}if(!i)return o||(r=!0),e<=t-a?-a++:(i=!0,s())},"iterator")}u(sw,"distanceIterator");function Ug(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=Ia(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var r=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,a=n.compareLine||function(O,j,z,ne){return j===ne},s=0,c=n.fuzzFactor||0,l=0,d=0,h,g;function p(O,j){for(var z=0;z<O.lines.length;z++){var ne=O.lines[z],oe=ne.length>0?ne[0]:" ",he=ne.length>0?ne.substr(1):ne;if(oe===" "||oe==="-"){if(!a(j+1,r[j],oe,he)&&(s++,s>c))return!1;j++}}return!0}u(p,"hunkFits");for(var y=0;y<o.length;y++){for(var m=o[y],v=r.length-m.oldLines,S=0,w=d+m.oldStart-1,x=sw(w,l,v);S!==void 0;S=x())if(p(m,w+S)){m.offset=d+=S;break}if(S===void 0)return!1;l=m.offset+m.oldStart+m.oldLines}for(var E=0,I=0;I<o.length;I++){var D=o[I],B=D.oldStart+D.offset+E-1;E+=D.newLines-D.oldLines;for(var P=0;P<D.lines.length;P++){var G=D.lines[P],ee=G.length>0?G[0]:" ",te=G.length>0?G.substr(1):G,X=D.linedelimiters[P];if(ee===" ")B++;else if(ee==="-")r.splice(B,1),i.splice(B,1);else if(ee==="+")r.splice(B,0,te),i.splice(B,0,X),B++;else if(ee==="\\"){var ae=D.lines[P-1]?D.lines[P-1][0]:null;ae==="+"?h=!0:ae==="-"&&(g=!0)}}}if(h)for(;!r[r.length-1];)r.pop(),i.pop();else g&&(r.push(""),i.push(`
`));for(var k=0;k<r.length-1;k++)r[k]=r[k]+i[k];return r.join("")}u(Ug,"applyPatch");function p0(t,e){typeof t=="string"&&(t=Ia(t));var n=0;function r(){var i=t[n++];if(!i)return e.complete();e.loadFile(i,function(o,a){if(o)return e.complete(o);var s=Ug(a,i,e);e.patched(i,s,function(c){if(c)return e.complete(c);r()})})}u(r,"processIndex"),r()}u(p0,"applyPatches");function Og(t,e,n,r,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var s=tw(n,r,a);s.push({value:"",lines:[]});function c(S){return S.map(function(w){return" "+w})}u(c,"contextLines");for(var l=[],d=0,h=0,g=[],p=1,y=1,m=u(function(w){var x=s[w],E=x.lines||x.value.replace(/\n$/,"").split(`
`);if(x.lines=E,x.added||x.removed){var I;if(!d){var D=s[w-1];d=p,h=y,D&&(g=a.context>0?c(D.lines.slice(-a.context)):[],d-=g.length,h-=g.length)}(I=g).push.apply(I,Er(E.map(function(k){return(x.added?"+":"-")+k}))),x.added?y+=E.length:p+=E.length}else{if(d)if(E.length<=a.context*2&&w<s.length-2){var B;(B=g).push.apply(B,Er(c(E)))}else{var P,G=Math.min(E.length,a.context);(P=g).push.apply(P,Er(c(E.slice(0,G))));var ee={oldStart:d,oldLines:p-d+G,newStart:h,newLines:y-h+G,lines:g};if(w>=s.length-2&&E.length<=a.context){var te=/\n$/.test(n),X=/\n$/.test(r),ae=E.length==0&&g.length>ee.oldLines;!te&&ae&&n.length>0&&g.splice(ee.oldLines,0,"\\ No newline at end of file"),(!te&&!ae||!X)&&g.push("\\ No newline at end of file")}l.push(ee),d=0,h=0,g=[]}p+=E.length,y+=E.length}},"_loop"),v=0;v<s.length;v++)m(v);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:l}}u(Og,"structuredPatch");function cw(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),e.push.apply(e,r.lines)}return e.join(`
`)+`
`}u(cw,"formatPatch");function lw(t,e,n,r,i,o,a){return cw(Og(t,e,n,r,i,o,a))}u(lw,"createTwoFilesPatch");function uw(t,e,n,r,i,o){return lw(t,t,e,n,r,i,o)}u(uw,"createPatch");function dw(t,e){return t.length!==e.length?!1:Fu(t,e)}u(dw,"arrayEqual");function Fu(t,e){if(e.length>t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}u(Fu,"arrayStartsWith");function hw(t){var e=Nu(t.lines),n=e.oldLines,r=e.newLines;n!==void 0?t.oldLines=n:delete t.oldLines,r!==void 0?t.newLines=r:delete t.newLines}u(hw,"calcLineCount");function m0(t,e,n){t=Hg(t,n),e=Hg(e,n);var r={};(t.index||e.index)&&(r.index=t.index||e.index),(t.newFileName||e.newFileName)&&(Wg(t)?Wg(e)?(r.oldFileName=rc(r,t.oldFileName,e.oldFileName),r.newFileName=rc(r,t.newFileName,e.newFileName),r.oldHeader=rc(r,t.oldHeader,e.oldHeader),r.newHeader=rc(r,t.newHeader,e.newHeader)):(r.oldFileName=t.oldFileName,r.newFileName=t.newFileName,r.oldHeader=t.oldHeader,r.newHeader=t.newHeader):(r.oldFileName=e.oldFileName||t.oldFileName,r.newFileName=e.newFileName||t.newFileName,r.oldHeader=e.oldHeader||t.oldHeader,r.newHeader=e.newHeader||t.newHeader)),r.hunks=[];for(var i=0,o=0,a=0,s=0;i<t.hunks.length||o<e.hunks.length;){var c=t.hunks[i]||{oldStart:1/0},l=e.hunks[o]||{oldStart:1/0};if(Bg(c,l))r.hunks.push($g(c,a)),i++,s+=c.newLines-c.oldLines;else if(Bg(l,c))r.hunks.push($g(l,s)),o++,a+=l.newLines-l.oldLines;else{var d={oldStart:Math.min(c.oldStart,l.oldStart),oldLines:0,newStart:Math.min(c.newStart+a,l.oldStart+s),newLines:0,lines:[]};fw(d,c.oldStart,c.lines,l.oldStart,l.lines),o++,i++,r.hunks.push(d)}}return r}u(m0,"merge");function Hg(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return Ia(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return Og(void 0,void 0,e,t)}return t}u(Hg,"loadPatch");function Wg(t){return t.newFileName&&t.newFileName!==t.oldFileName}u(Wg,"fileNameChanged");function rc(t,e,n){return e===n?e:(t.conflict=!0,{mine:e,theirs:n})}u(rc,"selectField");function Bg(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}u(Bg,"hunkBefore");function $g(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}u($g,"cloneHunk");function fw(t,e,n,r,i){var o={offset:e,lines:n,index:0},a={offset:r,lines:i,index:0};for(qg(t,o,a),qg(t,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var s=o.lines[o.index],c=a.lines[a.index];if((s[0]==="-"||s[0]==="+")&&(c[0]==="-"||c[0]==="+"))gw(t,o,a);else if(s[0]==="+"&&c[0]===" "){var l;(l=t.lines).push.apply(l,Er(Ei(o)))}else if(c[0]==="+"&&s[0]===" "){var d;(d=t.lines).push.apply(d,Er(Ei(a)))}else s[0]==="-"&&c[0]===" "?Vg(t,o,a):c[0]==="-"&&s[0]===" "?Vg(t,a,o,!0):s===c?(t.lines.push(s),o.index++,a.index++):Mu(t,Ei(o),Ei(a))}zg(t,o),zg(t,a),hw(t)}u(fw,"mergeLines");function gw(t,e,n){var r=Ei(e),i=Ei(n);if(jg(r)&&jg(i)){if(Fu(r,i)&&Gg(n,r,r.length-i.length)){var o;(o=t.lines).push.apply(o,Er(r));return}else if(Fu(i,r)&&Gg(e,i,i.length-r.length)){var a;(a=t.lines).push.apply(a,Er(i));return}}else if(dw(r,i)){var s;(s=t.lines).push.apply(s,Er(r));return}Mu(t,r,i)}u(gw,"mutualChange");function Vg(t,e,n,r){var i=Ei(e),o=pw(n,i);if(o.merged){var a;(a=t.lines).push.apply(a,Er(o.merged))}else Mu(t,r?o:i,r?i:o)}u(Vg,"removal");function Mu(t,e,n){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:n})}u(Mu,"conflict");function qg(t,e,n){for(;e.offset<n.offset&&e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r),e.offset++}}u(qg,"insertLeading");function zg(t,e){for(;e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n)}}u(zg,"insertTrailing");function Ei(t){for(var e=[],n=t.lines[t.index][0];t.index<t.lines.length;){var r=t.lines[t.index];if(n==="-"&&r[0]==="+"&&(n="+"),n===r[0])e.push(r),t.index++;else break}return e}u(Ei,"collectChange");function pw(t,e){for(var n=[],r=[],i=0,o=!1,a=!1;i<e.length&&t.index<t.lines.length;){var s=t.lines[t.index],c=e[i];if(c[0]==="+")break;if(o=o||s[0]!==" ",r.push(c),i++,s[0]==="+")for(a=!0;s[0]==="+";)n.push(s),s=t.lines[++t.index];c.substr(1)===s.substr(1)?(n.push(s),t.index++):a=!0}if((e[i]||"")[0]==="+"&&o&&(a=!0),a)return n;for(;i<e.length;)r.push(e[i++]);return{merged:r,changes:n}}u(pw,"collectContext");function jg(t){return t.reduce(function(e,n){return e&&n[0]==="-"},!0)}u(jg,"allRemoves");function Gg(t,e,n){for(var r=0;r<n;r++){var i=e[e.length-n+r].substr(1);if(t.lines[t.index+r]!==" "+i)return!1}return t.index+=n,!0}u(Gg,"skipRemoveSuperset");function Nu(t){var e=0,n=0;return t.forEach(function(r){if(typeof r!="string"){var i=Nu(r.mine),o=Nu(r.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),n!==void 0&&(i.newLines===o.newLines?n+=i.newLines:n=void 0)}else n!==void 0&&(r[0]==="+"||r[0]===" ")&&n++,e!==void 0&&(r[0]==="-"||r[0]===" ")&&e++}),{oldLines:e,newLines:n}}u(Nu,"calcOldNewLineCount");function v0(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}u(v0,"convertChangesToDMP");function w0(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(mw(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}u(w0,"convertChangesToXML");function mw(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}u(mw,"escapeHTML");var Kg=/[^a-zA-Z0-9]/,Qg=/\s/,Xg=/[\r\n]/,vw=/\n\r?\n$/,ww=/^\r?\n\r?\n/,H;(function(t){t[t.DIFF_DELETE=-1]="DIFF_DELETE",t[t.DIFF_INSERT=1]="DIFF_INSERT",t[t.DIFF_EQUAL=0]="DIFF_EQUAL"})(H||(H={}));function yw(t,e){return t<e?t:e}u(yw,"min");function bw(t,e){return t>e?t:e}u(bw,"max");var Qt=be,Ea=function(){function t(){this.diffs=[],this.start1=0,this.start2=0,this.length1=0,this.length2=0}return u(t,"PatchObject"),t.prototype.toString=function(){var e,n;this.length1===0?e=this.start1+",0":this.length1===1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?n=this.start2+",0":this.length2===1?n=this.start2+1:n=this.start2+1+","+this.length2;for(var r=["@@ -"+e+" +"+n+` @@
`],i,o=0;o<this.diffs.length;o++){switch(this.diffs[o][0]){case H.DIFF_INSERT:i="+";break;case H.DIFF_DELETE:i="-";break;case H.DIFF_EQUAL:i=" ";break}r[o+1]=i+encodeURI(this.diffs[o][1])+`
`}return r.join("").replace(/%20/g," ")},t}(),Sw=function(){function t(){this.diffTimeout=1,this.diffEditCost=4,this.matchThreshold=.5,this.matchDistance=1e3,this.patchDeleteThreshold=.5,this.patchMargin=4,this.matchMaxBits=32}return u(t,"DiffMatchPatch"),t.prototype.diff_main=function(e,n,r,i){typeof i=="undefined"&&(this.diffTimeout<=0?i=Number.MAX_VALUE:i=Date.now()+this.diffTimeout*1e3);var o=i;if(e==null||n==null)throw new Error("Null input. (diff_main)");if(e===n)return e?[[H.DIFF_EQUAL,e]]:[];typeof r=="undefined"&&(r=!0);var a=r,s=this.diff_commonPrefix(e,n),c=e.substring(0,s);e=e.substring(s),n=n.substring(s),s=this.diff_commonSuffix(e,n);var l=e.substring(e.length-s);e=e.substring(0,e.length-s),n=n.substring(0,n.length-s);var d=this.diff_compute_(e,n,a,o);return c&&d.unshift([H.DIFF_EQUAL,c]),l&&d.push([H.DIFF_EQUAL,l]),this.diff_cleanupMerge(d),d},t.prototype.diff_commonPrefix=function(e,n){if(!e||!n||e.charAt(0)!==n.charAt(0))return 0;for(var r=0,i=Qt.min(e.length,n.length),o=i,a=0;r<o;)e.substring(a,o)===n.substring(a,o)?(r=o,a=r):i=o,o=Math.floor((i-r)/2+r);return o},t.prototype.diff_commonSuffix=function(e,n){if(!e||!n||e.charAt(e.length-1)!==n.charAt(n.length-1))return 0;for(var r=0,i=Qt.min(e.length,n.length),o=i,a=0;r<o;)e.substring(e.length-o,e.length-a)===n.substring(n.length-o,n.length-a)?(r=o,a=r):i=o,o=Math.floor((i-r)/2+r);return o},t.prototype.diff_cleanupSemantic=function(e){for(var n=!1,r=[],i=0,o=null,a=0,s=0,c=0,l=0,d=0;a<e.length;)e[a][0]===H.DIFF_EQUAL?(r[i++]=a,s=l,c=d,l=0,d=0,o=e[a][1]):(e[a][0]===H.DIFF_INSERT?l+=e[a][1].length:d+=e[a][1].length,o&&o.length<=Qt.max(s,c)&&o.length<=Qt.max(l,d)&&(e.splice(r[i-1],0,[H.DIFF_DELETE,o]),e[r[i-1]+1][0]=H.DIFF_INSERT,i--,i--,a=i>0?r[i-1]:-1,s=0,c=0,l=0,d=0,o=null,n=!0)),a++;for(n&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]===H.DIFF_DELETE&&e[a][0]===H.DIFF_INSERT){var h=e[a-1][1],g=e[a][1],p=this.diff_commonOverlap_(h,g),y=this.diff_commonOverlap_(g,h);p>=y?(p>=h.length/2||p>=g.length/2)&&(e.splice(a,0,[H.DIFF_EQUAL,g.substring(0,p)]),e[a-1][1]=h.substring(0,h.length-p),e[a+1][1]=g.substring(p),a++):(y>=h.length/2||y>=g.length/2)&&(e.splice(a,0,[H.DIFF_EQUAL,h.substring(0,y)]),e[a-1][0]=H.DIFF_INSERT,e[a-1][1]=g.substring(0,g.length-y),e[a+1][0]=H.DIFF_DELETE,e[a+1][1]=h.substring(y),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){for(var n=1;n<e.length-1;){if(e[n-1][0]===H.DIFF_EQUAL&&e[n+1][0]===H.DIFF_EQUAL){var r=e[n-1][1],i=e[n][1],o=e[n+1][1],a=this.diff_commonSuffix(r,i);if(a){var s=i.substring(i.length-a);r=r.substring(0,r.length-a),i=s+i.substring(0,i.length-a),o=s+o}for(var c=r,l=i,d=o,h=this.diff_cleanupSemanticScore_(r,i)+this.diff_cleanupSemanticScore_(i,o);i.charAt(0)===o.charAt(0);){r+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);var g=this.diff_cleanupSemanticScore_(r,i)+this.diff_cleanupSemanticScore_(i,o);g>=h&&(h=g,c=r,l=i,d=o)}e[n-1][1]!==c&&(c?e[n-1][1]=c:(e.splice(n-1,1),n--),e[n][1]=l,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},t.prototype.diff_cleanupEfficiency=function(e){for(var n=!1,r=[],i=0,o=null,a=0,s=!1,c=!1,l=!1,d=!1;a<e.length;)e[a][0]===H.DIFF_EQUAL?(e[a][1].length<this.diffEditCost&&(l||d)?(r[i++]=a,s=l,c=d,o=e[a][1]):(i=0,o=null),l=d=!1):(e[a][0]===H.DIFF_DELETE?d=!0:l=!0,o&&(s&&c&&l&&d||o.length<this.diffEditCost/2&&Number(s)+Number(c)+Number(l)+Number(d)===3)&&(e.splice(r[i-1],0,[H.DIFF_DELETE,o]),e[r[i-1]+1][0]=H.DIFF_INSERT,i--,o=null,s&&c?(l=d=!0,i=0):(i--,a=i>0?r[i-1]:-1,l=d=!1),n=!0)),a++;n&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push([H.DIFF_EQUAL,""]);for(var n=0,r=0,i=0,o="",a="",s;n<e.length;)switch(e[n][0]){case H.DIFF_INSERT:i++,a+=e[n][1],n++;break;case H.DIFF_DELETE:r++,o+=e[n][1],n++;break;case H.DIFF_EQUAL:r+i>1?(r!==0&&i!==0&&(s=this.diff_commonPrefix(a,o),s!==0&&(n-r-i>0&&e[n-r-i-1][0]===H.DIFF_EQUAL?e[n-r-i-1][1]+=a.substring(0,s):(e.splice(0,0,[H.DIFF_EQUAL,a.substring(0,s)]),n++),a=a.substring(s),o=o.substring(s)),s=this.diff_commonSuffix(a,o),s!==0&&(e[n][1]=a.substring(a.length-s)+e[n][1],a=a.substring(0,a.length-s),o=o.substring(0,o.length-s))),n-=r+i,e.splice(n,r+i),o.length&&(e.splice(n,0,[H.DIFF_DELETE,o]),n++),a.length&&(e.splice(n,0,[H.DIFF_INSERT,a]),n++),n++):n!==0&&e[n-1][0]===H.DIFF_EQUAL?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=0,r=0,o="",a="";break}e[e.length-1][1]===""&&e.pop();var c=!1;for(n=1;n<e.length-1;)e[n-1][0]===H.DIFF_EQUAL&&e[n+1][0]===H.DIFF_EQUAL&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)===e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),c=!0):e[n][1].substring(0,e[n+1][1].length)===e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),c=!0)),n++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,n){var r=0,i=0,o=0,a=0,s;for(s=0;s<e.length&&(e[s][0]!==H.DIFF_INSERT&&(r+=e[s][1].length),e[s][0]!==H.DIFF_DELETE&&(i+=e[s][1].length),!(r>n));s++)o=r,a=i;return e.length!==s&&e[s][0]===H.DIFF_DELETE?a:a+(n-o)},t.prototype.diff_prettyHtml=function(e){for(var n=[],r=/&/g,i=/</g,o=/>/g,a=/\n/g,s=0;s<e.length;s++){var c=e[s][0],l=e[s][1],d=l.replace(r,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(c){case H.DIFF_INSERT:n[s]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case H.DIFF_DELETE:n[s]='<del style="background:#ffe6e6;">'+d+"</del>";break;case H.DIFF_EQUAL:n[s]="<span>"+d+"</span>";break}}return n.join("")},t.prototype.diff_text1=function(e){for(var n=[],r=0;r<e.length;r++)e[r][0]!==H.DIFF_INSERT&&(n[r]=e[r][1]);return n.join("")},t.prototype.diff_text2=function(e){for(var n=[],r=0;r<e.length;r++)e[r][0]!==H.DIFF_DELETE&&(n[r]=e[r][1]);return n.join("")},t.prototype.diff_levenshtein=function(e){for(var n=0,r=0,i=0,o=0;o<e.length;o++){var a=e[o][0],s=e[o][1];switch(a){case H.DIFF_INSERT:r+=s.length;break;case H.DIFF_DELETE:i+=s.length;break;case H.DIFF_EQUAL:n+=Qt.max(r,i),r=0,i=0;break}}return n+=Qt.max(r,i),n},t.prototype.diff_toDelta=function(e){for(var n=[],r=0;r<e.length;r++)switch(e[r][0]){case H.DIFF_INSERT:n[r]="+"+encodeURI(e[r][1]);break;case H.DIFF_DELETE:n[r]="-"+e[r][1].length;break;case H.DIFF_EQUAL:n[r]="="+e[r][1].length;break}return n.join("	").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,n){for(var r=[],i=0,o=0,a=n.split(/\t/g),s=0;s<a.length;s++){var c=a[s].substring(1);switch(a[s].charAt(0)){case"+":try{r[i++]=[H.DIFF_INSERT,decodeURI(c)]}catch(h){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var l=parseInt(c,10);if(isNaN(l)||l<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(o,o+=l);a[s].charAt(0)==="="?r[i++]=[H.DIFF_EQUAL,d]:r[i++]=[H.DIFF_DELETE,d];break;default:if(a[s])throw new Error("Invalid diff operation in diff_fromDelta: "+a[s])}}if(o!==e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+")");return r},t.prototype.diff_linesToChars=function(e,n){var r=[],i={};r[0]="";var o=this.diff_linesToCharsMunge_(e,r,i,4e4),a=this.diff_linesToCharsMunge_(n,r,i,65535);return{chars1:o,chars2:a,lineArray:r}},t.prototype.diff_charsToLines=function(e,n){for(var r=0;r<e.length;r++){for(var i=e[r][1],o=[],a=0;a<i.length;a++)o[a]=n[i.charCodeAt(a)];e[r][1]=o.join("")}},t.prototype.match_main=function(e,n,r){if(e==null||n==null||r==null)throw new Error("Null input. (match_main)");return r=Qt.max(0,Qt.min(r,e.length)),e===n?0:e.length?e.substring(r,r+n.length)===n?r:this.match_bitap_(e,n,r):-1},t.prototype.patch_make=function(e,n,r){var i,o;if(typeof e=="string"&&typeof n=="string"&&typeof r=="undefined")i=e,o=this.diff_main(i,n,!0),o.length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&typeof e=="object"&&typeof n=="undefined"&&typeof r=="undefined")o=e,i=this.diff_text1(o);else if(typeof e=="string"&&n&&typeof n=="object"&&typeof r=="undefined")i=e,o=n;else if(typeof e=="string"&&typeof n=="string"&&r&&typeof r=="object")i=e,o=r;else throw new Error("Unknown call format to patch_make");if(o.length===0)return[];for(var a=[],s=new Ea,c=0,l=0,d=0,h=i,g=i,p=0;p<o.length;p++){var y=o[p][0],m=o[p][1];switch(!c&&y!==H.DIFF_EQUAL&&(s.start1=l,s.start2=d),y){case H.DIFF_INSERT:s.diffs[c++]=o[p],s.length2+=m.length,g=g.substring(0,d)+m+g.substring(d);break;case H.DIFF_DELETE:s.length1+=m.length,s.diffs[c++]=o[p],g=g.substring(0,d)+g.substring(d+m.length);break;case H.DIFF_EQUAL:m.length<=2*this.patchMargin&&c&&o.length!==p+1?(s.diffs[c++]=o[p],s.length1+=m.length,s.length2+=m.length):m.length>=2*this.patchMargin&&c&&(this.patch_addContext_(s,h),a.push(s),s=new Ea,c=0,h=g,l=d);break}y!==H.DIFF_INSERT&&(l+=m.length),y!==H.DIFF_DELETE&&(d+=m.length)}return c&&(this.patch_addContext_(s,h),a.push(s)),a},t.prototype.patch_deepCopy=function(e){for(var n=[],r=0;r<e.length;r++){for(var i=e[r],o=new Ea,a=0;a<i.diffs.length;a++)o.diffs[a]=[i.diffs[a][0],i.diffs[a][1]];o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,n[r]=o}return n},t.prototype.patch_apply=function(e,n){if(e.length===0)return[n,[]];e=this.patch_deepCopy(e);var r=this.patch_addPadding(e);n=r+n+r,this.patch_splitMax(e);for(var i=0,o=[],a=0;a<e.length;a++){var s=e[a].start2+i,c=this.diff_text1(e[a].diffs),l=void 0,d=-1;if(c.length>this.matchMaxBits?(l=this.match_main(n,c.substring(0,this.matchMaxBits),s),l!==-1&&(d=this.match_main(n,c.substring(c.length-this.matchMaxBits),s+c.length-this.matchMaxBits),(d===-1||l>=d)&&(l=-1))):l=this.match_main(n,c,s),l===-1)o[a]=!1,i-=e[a].length2-e[a].length1;else{o[a]=!0,i=l-s;var h=void 0;if(d===-1?h=n.substring(l,l+c.length):h=n.substring(l,d+this.matchMaxBits),c===h)n=n.substring(0,l)+this.diff_text2(e[a].diffs)+n.substring(l+c.length);else{var g=this.diff_main(c,h,!1);if(c.length>this.matchMaxBits&&this.diff_levenshtein(g)/c.length>this.patchDeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(g);for(var p=0,y=0,m=0;m<e[a].diffs.length;m++){var v=e[a].diffs[m];v[0]!==H.DIFF_EQUAL&&(y=this.diff_xIndex(g,p)),v[0]===H.DIFF_INSERT?n=n.substring(0,l+y)+v[1]+n.substring(l+y):v[0]===H.DIFF_DELETE&&(n=n.substring(0,l+y)+n.substring(l+this.diff_xIndex(g,p+v[1].length))),v[0]!==H.DIFF_DELETE&&(p+=v[1].length)}}}}}return n=n.substring(r.length,n.length-r.length),[n,o]},t.prototype.patch_addPadding=function(e){for(var n=this.patchMargin,r="",i=1;i<=n;i++)r+=String.fromCharCode(i);for(var i=0;i<e.length;i++)e[i].start1+=n,e[i].start2+=n;var o=e[0],a=o.diffs;if(a.length===0||a[0][0]!==H.DIFF_EQUAL)a.unshift([H.DIFF_EQUAL,r]),o.start1-=n,o.start2-=n,o.length1+=n,o.length2+=n;else if(n>a[0][1].length){var s=n-a[0][1].length;a[0][1]=r.substring(a[0][1].length)+a[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}if(o=e[e.length-1],a=o.diffs,a.length===0||a[a.length-1][0]!==H.DIFF_EQUAL)a.push([H.DIFF_EQUAL,r]),o.length1+=n,o.length2+=n;else if(n>a[a.length-1][1].length){var s=n-a[a.length-1][1].length;a[a.length-1][1]+=r.substring(0,s),o.length1+=s,o.length2+=s}return r},t.prototype.patch_splitMax=function(e){for(var n=this.matchMaxBits,r=0;r<e.length;r++)if(!(e[r].length1<=n)){var i=e[r];e.splice(r--,1);for(var o=i.start1,a=i.start2,s="";i.diffs.length!==0;){var c=new Ea,l=!0;for(c.start1=o-s.length,c.start2=a-s.length,s!==""&&(c.length1=c.length2=s.length,c.diffs.push([H.DIFF_EQUAL,s]));i.diffs.length!==0&&c.length1<n-this.patchMargin;){var d=i.diffs[0][0],h=i.diffs[0][1];d===H.DIFF_INSERT?(c.length2+=h.length,a+=h.length,c.diffs.push(i.diffs.shift()),l=!1):d===H.DIFF_DELETE&&c.diffs.length===1&&c.diffs[0][0]===H.DIFF_EQUAL&&h.length>2*n?(c.length1+=h.length,o+=h.length,l=!1,c.diffs.push([d,h]),i.diffs.shift()):(h=h.substring(0,n-c.length1-this.patchMargin),c.length1+=h.length,o+=h.length,d===H.DIFF_EQUAL?(c.length2+=h.length,a+=h.length):l=!1,c.diffs.push([d,h]),h===i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(h.length))}s=this.diff_text2(c.diffs),s=s.substring(s.length-this.patchMargin);var g=this.diff_text1(i.diffs).substring(0,this.patchMargin);g!==""&&(c.length1+=g.length,c.length2+=g.length,c.diffs.length!==0&&c.diffs[c.diffs.length-1][0]===H.DIFF_EQUAL?c.diffs[c.diffs.length-1][1]+=g:c.diffs.push([H.DIFF_EQUAL,g])),l||e.splice(++r,0,c)}}},t.prototype.patch_toText=function(e){for(var n=[],r=0;r<e.length;r++)n[r]=e[r];return n.join("")},t.prototype.patch_fromText=function(e){var n=[];if(!e)return n;for(var r=e.split(`
`),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<r.length;){var a=r[i].match(o);if(!a)throw new Error("Invalid patch string: "+r[i]);var s=new Ea;n.push(s),s.start1=parseInt(a[1],10),a[2]===""?(s.start1--,s.length1=1):a[2]==="0"?s.length1=0:(s.start1--,s.length1=parseInt(a[2],10)),s.start2=parseInt(a[3],10),a[4]===""?(s.start2--,s.length2=1):a[4]==="0"?s.length2=0:(s.start2--,s.length2=parseInt(a[4],10)),i++;for(var c=void 0,l=void 0,d=void 0;i<r.length;){c=r[i].charAt(0),d=r[i].substring(1);try{l=decodeURI(d)}catch(h){throw new Error("Illegal escape in patch_fromText: "+d)}if(c==="-")s.diffs.push([H.DIFF_DELETE,l]);else if(c==="+")s.diffs.push([H.DIFF_INSERT,l]);else if(c===" ")s.diffs.push([H.DIFF_EQUAL,l]);else{if(c==="@")break;if(c!=="")throw new Error('Invalid patch mode "'+c+'" in: '+l)}i++}}return n},t.prototype.diff_compute_=function(e,n,r,i){var o;if(!e)return[[H.DIFF_INSERT,n]];if(!n)return[[H.DIFF_DELETE,e]];var a=e.length>n.length?e:n,s=e.length>n.length?n:e,c=a.indexOf(s);if(c!==-1)return o=[[H.DIFF_INSERT,a.substring(0,c)],[H.DIFF_EQUAL,s],[H.DIFF_INSERT,a.substring(c+s.length)]],e.length>n.length&&(o[0][0]=H.DIFF_DELETE,o[2][0]=H.DIFF_DELETE),o;if(s.length===1)return[[H.DIFF_DELETE,e],[H.DIFF_INSERT,n]];var l=this.diff_halfMatch_(e,n);if(l){var d=l[0],h=l[1],g=l[2],p=l[3],y=l[4],m=this.diff_main(d,g,r,i),v=this.diff_main(h,p,r,i);return m.concat([[H.DIFF_EQUAL,y]],v)}return r&&e.length>100&&n.length>100?this.diff_lineMode_(e,n,i):this.diff_bisect_(e,n,i)},t.prototype.diff_lineMode_=function(e,n,r){var i=this.diff_linesToChars(e,n);e=i.chars1,n=i.chars2;var o=i.lineArray,a=this.diff_main(e,n,!1,r);this.diff_charsToLines(a,o),this.diff_cleanupSemantic(a),a.push([H.DIFF_EQUAL,""]);for(var s=0,c=0,l=0,d="",h="";s<a.length;){switch(a[s][0]){case H.DIFF_INSERT:l++,h+=a[s][1];break;case H.DIFF_DELETE:c++,d+=a[s][1];break;case H.DIFF_EQUAL:if(c>=1&&l>=1){a.splice(s-c-l,c+l),s=s-c-l;for(var g=this.diff_main(d,h,!1,r),p=g.length-1;p>=0;p--)a.splice(s,0,g[p]);s=s+g.length}l=0,c=0,d="",h="";break}s++}return a.pop(),a},t.prototype.diff_bisect_=function(e,n,r){for(var i=e.length,o=n.length,a=Math.ceil((i+o)/2),s=a,c=2*a,l=new Array(c),d=new Array(c),h=0;h<c;h++)l[h]=-1,d[h]=-1;l[s+1]=0,d[s+1]=0;for(var g=i-o,p=g%2!=0,y=0,m=0,v=0,S=0,w=0;w<a&&!(Date.now()>r);w++){for(var x=-w+y;x<=w-m;x+=2){var E=s+x,I=void 0;x===-w||x!==w&&l[E-1]<l[E+1]?I=l[E+1]:I=l[E-1]+1;for(var D=I-x;I<i&&D<o&&e.charAt(I)===n.charAt(D);)I++,D++;if(l[E]=I,I>i)m+=2;else if(D>o)y+=2;else if(p){var B=s+g-x;if(B>=0&&B<c&&d[B]!==-1){var P=i-d[B];if(I>=P)return this.diff_bisectSplit_(e,n,I,D,r)}}}for(var G=-w+v;G<=w-S;G+=2){var B=s+G,P=void 0;G===-w||G!==w&&d[B-1]<d[B+1]?P=d[B+1]:P=d[B-1]+1;for(var ee=P-G;P<i&&ee<o&&e.charAt(i-P-1)===n.charAt(o-ee-1);)P++,ee++;if(d[B]=P,P>i)S+=2;else if(ee>o)v+=2;else if(!p){var E=s+g-G;if(E>=0&&E<c&&l[E]!==-1){var I=l[E],D=s+I-E;if(P=i-P,I>=P)return this.diff_bisectSplit_(e,n,I,D,r)}}}}return[[H.DIFF_DELETE,e],[H.DIFF_INSERT,n]]},t.prototype.diff_bisectSplit_=function(e,n,r,i,o){var a=e.substring(0,r),s=n.substring(0,i),c=e.substring(r),l=n.substring(i),d=this.diff_main(a,s,!1,o),h=this.diff_main(c,l,!1,o);return d.concat(h)},t.prototype.diff_linesToCharsMunge_=function(e,n,r,i){for(var o="",a=0,s=-1,c=n.length;s<e.length-1;){s=e.indexOf(`
`,a),s===-1&&(s=e.length-1);var l=e.substring(a,s+1);(r.hasOwnProperty?r.hasOwnProperty(l):r[l]!==void 0)?o+=String.fromCharCode(r[l]):(c===i&&(l=e.substring(a),s=e.length),o+=String.fromCharCode(c),r[l]=c,n[c++]=l),a=s+1}return o},t.prototype.diff_commonOverlap_=function(e,n){var r=e.length,i=n.length;if(r===0||i===0)return 0;r>i?e=e.substring(r-i):r<i&&(n=n.substring(0,r));var o=Qt.min(r,i);if(e===n)return o;for(var a=0,s=1;;){var c=e.substring(o-s),l=n.indexOf(c);if(l===-1)return a;s+=l,(l===0||e.substring(o-s)===n.substring(0,s))&&(a=s,s++)}},t.prototype.diff_halfMatch_=function(e,n){if(this.diffTimeout<=0)return null;var r=e.length>n.length?e:n,i=e.length>n.length?n:e;if(r.length<4||i.length*2<r.length)return null;var o=this.diff_halfMatchI_(r,i,Math.ceil(r.length/4)),a=this.diff_halfMatchI_(r,i,Math.ceil(r.length/2)),s;if(!o&&!a)return null;a?o?s=o[4].length>a[4].length?o:a:s=a:s=o;var c,l,d,h,g=s[4];return e.length>n.length?(c=s[0],l=s[1],d=s[2],h=s[3]):(d=s[0],h=s[1],c=s[2],l=s[3]),[c,l,d,h,g]},t.prototype.diff_halfMatchI_=function(e,n,r){for(var i=e.substring(r,r+Math.floor(e.length/4)),o="",a,s,c,l,d=n.indexOf(i,0);d!==-1;){var h=this.diff_commonPrefix(e.substring(r),n.substring(d)),g=this.diff_commonSuffix(e.substring(0,r),n.substring(0,d));o.length<g+h&&(o=n.substring(d-g,d)+n.substring(d,d+h),a=e.substring(0,r-g),s=e.substring(r+h),c=n.substring(0,d-g),l=n.substring(d+h)),d=n.indexOf(i,d+1)}return o.length*2>=e.length?[a,s,c,l,o]:null},t.prototype.diff_cleanupSemanticScore_=function(e,n){if(!e||!n)return 6;var r=e.charAt(e.length-1),i=n.charAt(0),o=r.match(Kg),a=i.match(Kg),s=o&&r.match(Qg),c=a&&i.match(Qg),l=s&&r.match(Xg),d=c&&i.match(Xg),h=l&&e.match(vw),g=d&&n.match(ww);return h||g?5:l||d?4:o&&!s&&c?3:s||c?2:o||a?1:0},t.prototype.match_bitap_=function(e,n,r){if(n.length>this.matchMaxBits)throw new Error("Pattern too long for this browser");var i=this.match_alphabet_(n),o=this.matchThreshold,a=e.indexOf(n,r);a!==-1&&(o=Qt.min(this.match_bitapScore_(0,a,n,r),o),a=e.lastIndexOf(n,r+n.length),a!==-1&&(o=Qt.min(this.match_bitapScore_(0,a,n,r),o)));var s=1<<n.length-1;a=-1;for(var c,l,d=n.length+e.length,h,g=0;g<n.length;g++){for(c=0,l=d;c<l;)this.match_bitapScore_(g,r+l,n,r)<=o?c=l:d=l,l=Math.floor((d-c)/2+c);d=l;var p=Qt.max(1,r-l+1),y=Qt.min(r+l,e.length)+n.length,m=Array(y+2);m[y+1]=(1<<g)-1;for(var v=y;v>=p;v--){var S=i[e.charAt(v-1)];if(g===0?m[v]=(m[v+1]<<1|1)&S:m[v]=(m[v+1]<<1|1)&S|((h[v+1]|h[v])<<1|1)|h[v+1],m[v]&s){var w=this.match_bitapScore_(g,v-1,n,r);if(w<=o)if(o=w,a=v-1,a>r)p=Qt.max(1,2*r-a);else break}}if(this.match_bitapScore_(g+1,r,n,r)>o)break;h=m}return a},t.prototype.match_bitapScore_=function(e,n,r,i){var o=e/r.length,a=Math.abs(i-n);return this.matchDistance?o+a/this.matchDistance:a?1:o},t.prototype.match_alphabet_=function(e){for(var n={},r=0;r<e.length;r++)n[e.charAt(r)]=0;for(var r=0;r<e.length;r++)n[e.charAt(r)]|=1<<e.length-r-1;return n},t.prototype.patch_addContext_=function(e,n){if(n.length!==0){if(e.start2==null)throw Error("patch not initialized");for(var r=n.substring(e.start2,e.start2+e.length1),i=0;n.indexOf(r)!==n.lastIndexOf(r)&&r.length<this.matchMaxBits-this.patchMargin-this.patchMargin;)i+=this.patchMargin,r=n.substring(e.start2-i,e.start2+e.length1+i);i+=this.patchMargin;var o=n.substring(e.start2-i,e.start2);o&&e.diffs.unshift([H.DIFF_EQUAL,o]);var a=n.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push([H.DIFF_EQUAL,a]),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},t}();function Lu(t,e){let n={};for(let o=0;o<e.length;o++){const a=e[o];n[a]?n[a].push(o):n[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const a=t[o],s=n[a]||[];let c=0,l=i[0];for(let d=0;d<s.length;d++){const h=s[d];let g;for(g=c;g<i.length&&!(i[g].buffer2index<h&&(g===i.length-1||i[g+1].buffer2index>h));g++);if(g<i.length){const p={buffer1index:o,buffer2index:h,chain:i[g]};if(c===i.length?i.push(l):i[c]=l,c=g+1,l=p,c===i.length)break}}i[c]=l}return i[i.length-1]}u(Lu,"LCS");function Cw(t,e){const n=Lu(t,e);let r=[],i=t.length,o=e.length,a={common:[]};function s(){a.common.length&&(a.common.reverse(),r.push(a),a={common:[]})}u(s,"processCommon");for(let c=n;c!==null;c=c.chain){let l={buffer1:[],buffer2:[]};for(;--i>c.buffer1index;)l.buffer1.push(t[i]);for(;--o>c.buffer2index;)l.buffer2.push(e[o]);(l.buffer1.length||l.buffer2.length)&&(s(),l.buffer1.reverse(),l.buffer2.reverse(),r.push(l)),i>=0&&a.common.push(t[i])}return s(),r.reverse(),r}u(Cw,"diffComm");function Yg(t,e){const n=Lu(t,e);let r=[],i=t.length,o=e.length;for(let a=n;a!==null;a=a.chain){const s=i-a.buffer1index-1,c=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(s||c)&&r.push({buffer1:[i+1,s],buffer1Content:t.slice(i+1,i+1+s),buffer2:[o+1,c],buffer2Content:e.slice(o+1,o+1+c)})}return r.reverse(),r}u(Yg,"diffIndices");function y0(t,e){const n=Lu(t,e);let r=[],i=t.length,o=e.length;function a(s,c,l){let d=[];for(let h=0;h<l;h++)d.push(s[c+h]);return{offset:c,length:l,chunk:d}}u(a,"chunkDescription");for(let s=n;s!==null;s=s.chain){const c=i-s.buffer1index-1,l=o-s.buffer2index-1;i=s.buffer1index,o=s.buffer2index,(c||l)&&r.push({buffer1:a(t,s.buffer1index+1,c),buffer2:a(e,s.buffer2index+1,l)})}return r.reverse(),r}u(y0,"diffPatch");function _w(t,e,n){let r=[];function i(c,l){r.push({ab:l,oStart:c.buffer1[0],oLength:c.buffer1[1],abStart:c.buffer2[0],abLength:c.buffer2[1]})}u(i,"addHunk"),Yg(e,t).forEach(c=>i(c,"a")),Yg(e,n).forEach(c=>i(c,"b")),r.sort((c,l)=>c.oStart-l.oStart);let o=[],a=0;function s(c){c>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:c-a,bufferContent:e.slice(a,c)}),a=c)}for(u(s,"advanceTo");r.length;){let c=r.shift(),l=c.oStart,d=c.oStart+c.oLength,h=[c];for(s(l);r.length;){const g=r[0],p=g.oStart;if(p>d)break;d=Math.max(d,p+g.oLength),h.push(r.shift())}if(h.length===1){if(c.abLength>0){const g=c.ab==="a"?t:n;o.push({stable:!0,buffer:c.ab,bufferStart:c.abStart,bufferLength:c.abLength,bufferContent:g.slice(c.abStart,c.abStart+c.abLength)})}}else{let g={a:[t.length,-1,e.length,-1],b:[n.length,-1,e.length,-1]};for(;h.length;){c=h.shift();const w=c.oStart,x=w+c.oLength,E=c.abStart,I=E+c.abLength;let D=g[c.ab];D[0]=Math.min(E,D[0]),D[1]=Math.max(I,D[1]),D[2]=Math.min(w,D[2]),D[3]=Math.max(x,D[3])}const p=g.a[0]+(l-g.a[2]),y=g.a[1]+(d-g.a[3]),m=g.b[0]+(l-g.b[2]),v=g.b[1]+(d-g.b[3]);let S={stable:!1,aStart:p,aLength:y-p,aContent:t.slice(p,y),oStart:l,oLength:d-l,oContent:e.slice(l,d),bStart:m,bLength:v-m,bContent:n.slice(m,v)};o.push(S)}a=d}return s(e.length),o}u(_w,"diff3MergeRegions");function Uu(t,e,n,r){r=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},r);const o=typeof t=="string",a=typeof e=="string",s=typeof n=="string";o&&(t=t.split(r.stringSeparator)),a&&(e=e.split(r.stringSeparator)),s&&(n=n.split(r.stringSeparator));let c=[];const l=_w(t,e,n);let d=[];function h(){d.length&&c.push({ok:d}),d=[]}u(h,"flushOk");function g(p,y){if(p.length!==y.length)return!1;for(let m=0;m<p.length;m++)if(p[m]!==y[m])return!1;return!0}return u(g,"isFalseConflict"),l.forEach(p=>{p.stable?d.push(...p.bufferContent):r.excludeFalseConflicts&&g(p.aContent,p.bContent)?d.push(...p.aContent):(h(),c.push({conflict:{a:p.aContent,aIndex:p.aStart,o:p.oContent,oIndex:p.oStart,b:p.bContent,bIndex:p.bStart}}))}),h(),c}u(Uu,"diff3Merge");function b0(t,e,n,r){r=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},r);const o=Uu(t,e,n,r);let a=!1,s=[];return o.forEach(c=>{c.ok?s=s.concat(c.ok):c.conflict&&(a=!0,s.push(`<<<<<<<${r.label.a?` ${r.label.a}`:""}`),s=s.concat(c.conflict.a),s.push(`|||||||${r.label.o?` ${r.label.o}`:""}`),s=s.concat(c.conflict.o),s.push("======="),s=s.concat(c.conflict.b),s.push(`>>>>>>>${r.label.b?` ${r.label.b}`:""}`))}),{conflict:a,result:s}}u(b0,"mergeDiff3");function xw(t,e,n,r){r=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},r);const o=Uu(t,e,n,r);let a=!1,s=[];for(let c=0;c<o.length;c++){const l=o[c];l.ok?s=s.concat(l.ok):(a=!0,s=s.concat([`
<<<<<<<<<
`],l.conflict.a,[`
=========
`],l.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:s}}u(xw,"node_diff3_merge");function S0(t,e,n,r){r=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},r);const o=Uu(t,e,n,r);let a=!1,s=[];for(let c=0;c<o.length;c++){const l=o[c];if(l.ok)s=s.concat(l.ok);else{const d=Cw(l.conflict.a,l.conflict.b);for(let h=0;h<d.length;h++){let g=d[h];g.common?s=s.concat(g.common):(a=!0,s=s.concat([`
<<<<<<<<<
`],g.buffer1,[`
=========
`],g.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:s}}u(S0,"mergeDigIn");function C0(t,e){let n=[],r=0;function i(o){for(;r<o;)n.push(t[r]),r++}u(i,"advanceTo");for(let o=0;o<e.length;o++){let a=e[o];i(a.buffer1.offset);for(let s=0;s<a.buffer2.chunk.length;s++)n.push(a.buffer2.chunk[s]);r+=a.buffer1.length}return i(t.length),n}u(C0,"patch");function _0(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}u(_0,"stripPatch");function x0(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}u(x0,"invertPatch");const Ou=new Sw;Ou.diffTimeout=0;function Iw(t,e,n){return ce.get("experimental.useDiffMatchPatch")===!0?Ou.patch_toText(Ou.patch_make(e,n)):uw(t,e,n)}u(Iw,"diffs_createPatch");function Jg(t,e,n){return Ug(t,e,n)}u(Jg,"diffs_applyPatch");function Ew(t,e){const n=[];for(const r of Ia(t,e))n.push({...r,oldFileName:r.newFileName,oldHeader:r.newHeader,newFileName:r.oldFileName,newHeader:r.oldHeader,hunks:r.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),n.push(r);return n}u(Ew,"reversePatch");function Zg(t,e,n,r,i){let o=`
`;const a=t.match(/(?:\r?\n)/g);if(a!==null&&a.length!==0){const d=a.filter(h=>h===`\r
`).length;o=d>a.length-d?`\r
`:`
`}const s=xw(t,e,n,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),c=s.result;let l=s.conflict;if(r){let d=!1;if(s.conflict){let h;const g=[];let p=0;for(const v of c)v===`
<<<<<<<<<
`?h={start:p,separator:p,end:p}:v===`
=========
`?h.separator=p:v===`
>>>>>>>>>
`&&(h.end=p,g.push(h)),p++;let y=0,m=0;for(const v of g)c.splice(v.start-y,1),y++,m=v.end-v.separator+1,c.splice(v.separator-y,m),y+=m;g.length&&(d=!0)}}else for(let d=0;d<c.length;d+=1)c[d]===`
<<<<<<<<<
`?c[d]="<<<<<<< HEAD":c[d]===`
=========
`?c[d]="=======":c[d]===`
>>>>>>>>>
`&&(c[d]=`>>>>>>> ${i}`);return{conflicts:l,mergedContent:c.join(o)}}u(Zg,"diffs_merge");var kw=Object.defineProperty,Rw=Object.getOwnPropertyDescriptor,Dw=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Rw(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&kw(e,n,i),i},"changeStore_decorateClass");const ct=J.loadMessageBundle(),Tw=f.FileSystemError.FileNotFound().code,ep=`===================================================================
`,rr=new TextDecoder,Aw=new TextEncoder;function Pw(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}u(Pw,"isOperation");function ka(t,e,n){return{type:t.type,rootUri:e,uri:n!=null?n:t.uri}}u(ka,"toEvent");const Ra=u(class{constructor(t,e,n,r,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=n,this.telemetryService=r,this.workspaceId=i,this._onDidChange=new f.EventEmitter,this.cache=new Map,this.lock=new Hf,this.scopedStores=new Map,o===void 0&&(this.disposable=f.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function n(r){const i=await f.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${r.toString(!0)}

${this.toStorage(await this.getWorkingOperations(r))}`});return void f.window.showTextDocument(i)}if(u(n,"exportCore"),t===void 0)for(const r of(e=f.workspace.workspaceFolders)!=null?e:[])await n.call(this,r.uri);else return n.call(this,t)}async getWorkspacesWithChanges(){var t;const e=new Ae("ChangeStore.getWorkspacesWithChanges()");try{const n=[];for(const r of(t=f.workspace.workspaceFolders)!=null?t:[])r.uri.scheme===se.scheme&&await this.hasChanges(r.uri)&&n.push(r.uri);return n.length>0?n:void 0}finally{e.stop()}}async acceptAll(t,e){const n=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let a=[];const s=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(c=>c.staged));for(const c of i){if(s&&!c.staged){a.push(c);continue}c.fileType===f.FileType.File&&await this.discardWorkingContent(t,c.uri);let l;if(c.type===R.Created&&c.fileType===f.FileType.Directory&&(i.some(d=>Di(d.uri,c.uri))||(l={type:R.Deleted,rootUri:t,uri:c.uri})),r.push(l!=null?l:ka(c,t)),c.type===R.Created){let d=c.uri;for(;;){const{parent:h}=this.findParent(d,i,g=>g.type===R.Created);if(h){o.push(h),d=h.uri;continue}break}}}a.length>0&&o.length>0&&(a=a.filter(c=>o.includes(c)?(r.push(ka(c,t)),!1):!0)),await this.saveWorkingOperations(t,a)},n),r.length!==0&&this._onDidChange.fire(r)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=`ChangeStore.discard(${t.toString()})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(e),async()=>this.discardCore(e,t,r),n),r.length!==0&&this._onDidChange.fire(r)}async discardCore(t,e,n){U.debug(`ChangeStore.discardCore(${e.toString()})`);let r=await this.getWorkingOperations(t);if(r.length===0)return;const i=ut(e),o=r.findIndex(c=>ut(c.uri)===i);if(o===-1)return;const[a]=r.splice(o,1);let s;switch(a.type){case R.Created:s=R.Deleted;break;case R.Deleted:s=R.Created;break;default:s=a.type;break}if(n.push({type:s,rootUri:t,uri:e}),a.type===R.Created){let c=a.uri;for(;;){const{parent:l,parentIndex:d}=this.findNewParentWithOnlyChild(c,r);if(l){r.splice(d,1),n.push({type:R.Deleted,rootUri:t,uri:l.uri}),c=l.uri;continue}break}}else if(a.type===R.Deleted){let c=a.uri;const l=this.findDeletedParents(c,r);let d=[...r];l.forEach(({parent:h,parentIndex:g})=>{d[g]=void 0,n.push({type:R.Created,rootUri:t,uri:h.uri})}),r=d.filter(h=>h!==void 0)}await this.saveWorkingOperations(t,r),a.fileType===f.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const n=this.getUriScope(t);if(n)return this.getScopedChangeStore(n).discardAll(t,e);const r=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;U.log(r);const i=[];await this.lock.synchronizeWrite(N(t),async()=>{const o=await this.getWorkingOperations(t),a=[];let s=[];const c=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(l=>l.staged));for(const l of o){if(c&&!l.staged){s.push(l);continue}l.fileType===f.FileType.File&&await this.discardWorkingContent(t,l.uri);let d;switch(l.type){case R.Created:d=R.Deleted;break;case R.Deleted:d=R.Created;break;default:d=l.type;break}if(i.push({type:d,rootUri:t,uri:l.uri}),l.type===R.Created){let h=l.uri;for(;;){const{parent:g}=this.findNewParentWithOnlyChild(h,o);if(g){a.push(g),h=g.uri;continue}break}}}s.length>0&&a.length>0&&(s=s.filter(l=>a.includes(l)?(i.push({type:R.Deleted,rootUri:t,uri:l.uri}),!1):!0)),await this.saveWorkingOperations(t,s)},r),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=`ChangeStore.stage(${t.toString()})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if(i!==void 0){if(i.conflicts){if(!i.conflicts.status.includes(R.Deleted)){const s=ct("yes","Yes");if(await f.window.showWarningMessage(ct("stage with merge conflicts","Are you sure you want to stage {0} with merge conflicts?",Je(t)),{modal:!0},s)!==s)return}const[,a]=i.conflicts.status;switch(a){case R.Changed:switch(i.type){case R.Created:return;case R.Changed:await this.spliceOperation(t,o,{...i,conflicts:void 0,staged:!0,timestamp:Date.now()},r);return;case R.Deleted:const s=ct("keep theirs","Keep Their Version"),c=ct("delete","Delete File"),l=await f.window.showInformationMessage(ct("deleted by us",`File '{0}' was deleted by us and modified by them.

What would you like to do?`,Je(t)),{modal:!0},s,c);if(l===s){await this.discardCore(e,t,r);return}else if(l===c){await this.spliceOperation(t,o,{...i,type:R.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,staged:!0,timestamp:Date.now()},r);return}else return}case R.Created:switch(i.type){case R.Changed:case R.Deleted:return;case R.Created:await this.spliceOperation(t,o,{...i,type:R.Changed,conflicts:void 0,size:i.size,hash:i.hash,originalHash:i.originalHash,staged:!0,timestamp:Date.now()},r);return}case R.Deleted:switch(i.type){case R.Created:case R.Changed:{const s=ct("keep ours","Keep Our Version"),c=ct("delete","Delete File"),l=await f.window.showInformationMessage(ct("deleted by them",`File '{0}' was deleted by them and modified by us.

What would you like to do?`,Je(t)),{modal:!0},s,c);if(l===s){await this.spliceOperation(t,o,{...i,type:R.Created,originalHash:void 0,conflicts:void 0,staged:!0,timestamp:Date.now()},r);return}else if(l===c){await this.discardCore(e,t,r);return}else return}case R.Deleted:await this.discardCore(e,t,r);return}}}await this.spliceOperation(t,o,{...i,staged:!0,conflicts:void 0,timestamp:Date.now()},r)}},n),r.length!==0&&this._onDidChange.fire(r)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;U.log(e);const n=[];await this.lock.synchronizeWrite(N(t),async()=>{const r=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));r.length!==0&&(await this.saveWorkingOperations(t,r),n.push(...r.map(i=>ka(i,t))))},e),n.length!==0&&this._onDidChange.fire(n)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=`ChangeStore.unstage(${t.toString()})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},r)},n),r.length!==0&&this._onDidChange.fire(r)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;U.log(e);const n=[];await this.lock.synchronizeWrite(N(t),async()=>{const r=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));r.length!==0&&(await this.saveWorkingOperations(t,r),n.push(...r.map(i=>ka(i,t))))},e),n.length!==0&&this._onDidChange.fire(n)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const n=N(t),r=this.cache.get(n);return r!==void 0?r.length!==0:this.lock.synchronizeRead(n,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const n=this.getUriScope(t);if(n)return this.getScopedChangeStore(n).maybeHasChanges(t,e);const r=N(t),i=this.cache.get(r);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=ut(e);return i.some(a=>ut(a.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const n=this.providerService.getVirtualRootUri(t);if(n!==void 0)return this.lock.synchronizeRead(N(n),async()=>{const{operation:r}=await this.getWorkingOperation(t,n);return r},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const n=this.getUriScope(t);return n?this.getScopedChangeStore(n).getChanges(t,e):this.lock.synchronizeRead(N(t),async()=>{let r=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;r=r.filter(a=>{var s;return(!i||a.conflicts===void 0)&&((s=o==null?void 0:o(a))!=null?s:!0)})}return r},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const n=this.getUriScope(t);return n?this.getScopedChangeStore(n).getGroupedChanges(t,e):this.lock.synchronizeRead(N(t),async()=>{var r,i;const o=await this.getWorkingOperations(t),a={conflicts:[],staged:[],working:[]};for(const s of o)!((i=(r=e==null?void 0:e.predicate)==null?void 0:r.call(e,s))!=null?i:!0)||(s.conflicts?a.conflicts.push(s):s.staged?a.staged.push(s):a.working.push(s));return a},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const n=N(e),r=this.cache.get(n);if((r==null?void 0:r.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(n,async()=>{const i=rr.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).filter(r=>{var i,o;return r.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,r))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).filter(r=>{var i,o;return r.staged&&r.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,r))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).filter(r=>{var i,o;return!r.staged&&r.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,r))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,n,r){var i;let o;Pw(n)?o=n:r=r!=null?r:n,U.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,r==null?void 0:r.save);const a=this.getScopedChangeStore(e.workspaceId),s=(i=e.patch)!=null?i:await a.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,s,{...r,getIncomingContent:async c=>{const l=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,c),e.workspaceId);return rr.decode(await f.workspace.fs.readFile(l))},merge:async(c,l,d)=>{try{const h=se.getProviderUri(c),g=rr.decode(await f.workspace.fs.readFile(h)),p=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,l),e.workspaceId),y=rr.decode(await f.workspace.fs.readFile(p)),m=await this.providerService.getMetadata(p);return{...Zg(d,g,y,Boolean(r==null?void 0:r.useSimplifiedMerge),m.HEAD.sha),baseUri:h,incomingUri:p}}catch(h){throw new Error(`Unable to apply patch to ${l}: ${String(h)}`)}}})}async applyPatch(t,e,n){if(U.log(`ChangeStore.applyPatch(${t.toString()})`,n==null?void 0:n.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,n)}async applyPatchCore(t,e,n={}){const r=`ChangeStore.applyPatchCore(${t.toString()})`;U.debug(r,n==null?void 0:n.save);const i=new f.WorkspaceEdit,o=[],a=new Map;async function s(g){var p;const y=N(g),m=f.workspace.textDocuments.find(v=>N(v.uri)===y);return(p=m==null?void 0:m.getText())!=null?p:rr.decode(await f.workspace.fs.readFile(g))}u(s,"getContent");async function c(g){try{const p=await f.workspace.fs.stat(g);return Boolean(p)}catch{return!1}}u(c,"exists");async function l(g,p,y){let m=Jg("",y,{fuzzFactor:0});if(m===!1){if(!n.getIncomingContent)throw new Error(`Unable to apply patch to ${p}`);m=await n.getIncomingContent(p)}i.createFile(g,{overwrite:!0}),i.replace(g,new f.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),m)}u(l,"applyCreate");async function d(g,p,y,m){const v=await s(g);let S=Jg(v,y,{fuzzFactor:1});if(S===!1){if(n.merge===void 0)throw new Error(`Unable to apply patch to ${p}; Resulted in conflicts`);const w={title:ct("apply patch failed prompt confirm","Merge")},x={title:ct("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await f.window.showWarningMessage(ct("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,p),{modal:!0},w,x)!==w)return;const I=await n.merge(g,p,v);S=I.mergedContent,I.conflicts&&a.set(N(g),{type:m,baseUri:I.baseUri,incomingUri:I.incomingUri})}i.replace(g,new f.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),S)}u(d,"applyModification");const h=(n==null?void 0:n.reverse)?Ew(e,{}):Ia(e,{});for(const g of h)if(g.oldFileName==="/dev/null"){if(!g.newFileName)continue;const p=g.newFileName.startsWith("b/")?g.newFileName.substr(2):g.newFileName,y=this.providerService.createRelativeVirtualUri(t,p);o.push(N(y)),!await c(y)?await l(y,p,g):await d(y,p,g,R.Created)}else if(g.newFileName==="/dev/null"){if(!g.oldFileName)continue;const p=g.oldFileName.startsWith("a/")?g.oldFileName.substr(2):g.oldFileName,y=this.providerService.createRelativeVirtualUri(t,p);await c(y)&&i.deleteFile(y)}else if(g.oldFileName===g.newFileName){if(!g.newFileName)continue;const p=this.providerService.createRelativeVirtualUri(t,g.newFileName);o.push(N(p)),!await c(p)?await l(p,g.newFileName,g):await d(p,g.newFileName,g,R.Changed)}else throw new Error(`Unable to apply patch to ${g.oldFileName}; Renames aren't currently supported`);if(await f.workspace.applyEdit(i),n.save&&o.length)for(const g of o){const p=f.workspace.textDocuments.find(y=>N(y.uri)===g);await(p==null?void 0:p.save())}a.size&&setTimeout(async()=>{const g=[];await this.lock.synchronizeWrite(N(t),async()=>{const p=await this.getWorkingOperations(t);if(p.length===0)return;let y=-1;for(const m of p){y++;const v=a.get(N(m.uri));v!==void 0&&await this.spliceOperation(m.uri,y,{...m,conflicts:{baseUri:v.baseUri,incomingUri:v.incomingUri,status:[m.type,v.type]},timestamp:Date.now()},g)}},r),g.length!==0&&this._onDidChange.fire(g)},0)}async createChangeset(t){U.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,n){if(U.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((n==null?void 0:n.staged)&&(o=o.filter(s=>s.staged)),o.length===0)return"";const a=[];for(const s of o){const c=await this.createPatchCore(t,s);a.push(c)}return a.join("")}const{operation:r}=await this.getWorkingOperation(e,t);if(r===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(n==null?void 0:n.staged)&&r.staged?"":await this.createPatchCore(t,r)}async createPatchCore(t,e){const n=this.providerService.getRelativeFilePath(t,e.uri),r=`diff --git a/${n} b/${n}`;if(e.type===R.Created){let c=await this.getContent(e.uri),l;!c.endsWith(`
`)&&!c.endsWith(`\r
`)?l=`
\\ No newline at end of file`:l="";const d=/\r?\n/g,h=c.split(d),g=c.match(d)||[],p=h.length,y=[];for(let m=0;m<p;m+=1)(m<h.length-1||m===h.length-1&&h[m]!=="")&&y.push("+"),y.push(h[m]),m<g.length&&y.push(g[m]);return c=y.join(""),`${r}
new file mode 100644
--- /dev/null
+++ b/${n}
@@ -0,0 +1,${p} @@
${c}${l}`}if(e.type===R.Deleted){let c=rr.decode(await f.workspace.fs.readFile(se.getProviderUri(e.uri))),l=0;return c=c.replace(/\r?\n/g,d=>(l++,`${d}-`)),`${r}
deleted file mode 100644
--- a/${n}
+++ /dev/null
@@ -1,${l} +0,0 @@
-${c}`}const i=await this.getContent(e.uri),o=rr.decode(await f.workspace.fs.readFile(se.getProviderUri(e.uri))),a=Iw(n,o,i),s=a.indexOf(ep);return`${r}
${a.substr(s+ep.length)}`}async keep(t,e){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const r=`ChangeStore.keep(${t.toString()})`;U.log(r,e);const i=[];await this.lock.synchronizeWrite(N(n),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(t,n);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,c]=o.conflicts.status;switch(c){case R.Changed:switch(o.type){case R.Changed:case R.Created:case R.Deleted:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case R.Created:switch(o.type){case R.Changed:case R.Deleted:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case R.Created:await this.spliceOperation(t,a,{...o,type:R.Changed,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case R.Deleted:switch(o.type){case R.Deleted:await this.discardCore(n,t,i);break;case R.Changed:await this.spliceOperation(t,a,{...o,type:R.Created,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case R.Created:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case R.Changed:switch(o.type){case R.Deleted:await this.spliceOperation(t,a,{...o,type:R.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case R.Created:break;case R.Changed:break}break;case R.Created:switch(o.type){case R.Changed:case R.Deleted:return;case R.Created:break}break;case R.Deleted:switch(o.type){case R.Deleted:return this.discardCore(n,t,i);case R.Changed:await this.spliceOperation(t,a,{...o,type:R.Created,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case R.Created:return}}const s=e!==void 0?await f.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,a,{...o,type:R.Changed,originalHash:s!==void 0?await Zr(s):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},r),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,n,r){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=`ChangeStore.merge(${t.toString()})`;U.log(o,e,n);const a=[];await this.lock.synchronizeWrite(N(i),async()=>{const{operation:s,index:c}=await this.getWorkingOperation(t,i);if(s===void 0)return;switch(e.type){case R.Changed:switch(s.type){case R.Deleted:await this.spliceOperation(t,c,{...s,type:R.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:n.providerUri,incomingUri:e.providerUri,status:[s.type,e.type]},timestamp:Date.now()},a);return;case R.Created:break;case R.Changed:break}break;case R.Created:switch(s.type){case R.Deleted:case R.Changed:return;case R.Created:break}break;case R.Deleted:switch(s.type){case R.Deleted:return this.discardCore(i,t,a);case R.Changed:await this.spliceOperation(t,c,{...s,type:R.Created,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[s.type,e.type]},timestamp:Date.now()},a);return;case R.Created:return}}const l=await this.providerService.getMetadata(e.providerUri),d=await this.getWorkingContent(i,t),h=s.type===R.Created?new Uint8Array(0):await f.workspace.fs.readFile(n.providerUri),g=await f.workspace.fs.readFile(e.providerUri),p=Zg(rr.decode(d),rr.decode(h),rr.decode(g),r,l.HEAD.sha);await this.writeFileCore(i,t,a,Aw.encode(p.mergedContent),g!=null?g:new Uint8Array(0),p.conflicts?{baseUri:n.providerUri,incomingUri:e.providerUri,status:[s.type,e.type]}:void 0)},o),a.length!==0&&this._onDidChange.fire(a)}async resolveDiffCommand(t,e,n,r){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===R.Deleted?this.resolveOpenCommand(e):((i==null?void 0:i.type)===R.Created&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,n,r]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const n=typeof e=="string"?e:e.workspaceId;return n===this.workspaceId?t:t.with({fragment:n})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;U.log(`ChangeStore.getScopedChangeStore(${e})`);let n=this.scopedStores.get(e);return n===void 0&&(n=e===this.workspaceId?new Ra.ScopedChangeStore(this,e,this.workspaceId):new Ra.ScopedChangeStore(new Ra(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,n)),n}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const r=N(n),i=this.cache.get(r);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(r,async()=>{var o;const{operation:a}=await this.getWorkingOperation(t,n);if(a!==void 0){if(a.type===R.Deleted)throw f.FileSystemError.FileNotFound(`The ${a.fileType===f.FileType.Directory?"folder":"file"} has been deleted.`);return{type:a.fileType,size:(o=a.size)!=null?o:0,ctime:0,mtime:a.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const n=new Ae(`ChangeStore.readFile(${t.toString()})`);try{const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const i=N(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const a=this.cache.get(i);if((a==null?void 0:a.length)===0){n.log({message:": Not found; no operations"});return}return this.getWorkingContent(r,t)},n.context)}finally{n.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=new Ae(`ChangeStore.createDirectory(${t.toString()})`);try{const r=[];if(await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:R.Created,uri:t,fileType:f.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},r)},n.context),r.length===0)return;this._onDidChange.fire(r)}finally{n.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=new Ae(`ChangeStore.deleteDirectory(${t.toString()})`);try{const r=[];if(await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===R.Created)return this.discardCore(e,t,r);const a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:R.Deleted,uri:t,fileType:f.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},r)},n.context),r.length===0)return;this._onDidChange.fire(r)}finally{n.stop()}}async updateDirectoryEntries(t,e){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return e;const r=new Ae(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=N(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:a}=Dr(n,t),s=await this.getWorkingOperations(n);for(const c of s)switch(c.type){case R.Changed:break;case R.Created:{if(Di(c.uri,a)){const l=this.providerService.getRelativeFilePath(t,c.uri);e.push([l,c.fileType])}break}case R.Deleted:{if(Di(c.uri,a)){const l=this.providerService.getRelativeFilePath(t,c.uri),d=e.findIndex(([h])=>h===l);d!==-1&&e.splice(d,1)}break}}return e},r.context)}finally{r.stop()}}async writeFile(t,e,n,r){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new Ae(`ChangeStore.writeFile(${t.toString()})`,{},e.length,r);try{const a=[];if(await this.lock.synchronizeWrite(N(i),async()=>this.writeFileCore(i,t,a,e,n,r),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(t,e,n,r,i,o){const a=new Ae(`ChangeStore.writeFileCore(${e.toString()})`,{},r.length,o);try{const[{operation:s,index:c},l,d]=await Promise.all([this.getWorkingOperation(e,t),Zr(r),Zr(i)]);if(l===d&&(!s||(s==null?void 0:s.type)===R.Changed))return this.discardCore(t,e,n);if(l===(s==null?void 0:s.hash)&&d===(s==null?void 0:s.originalHash))return;const[{HEAD:h}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,r)]);await this.spliceOperation(e,c,s===void 0?{type:R.Changed,uri:e,fileType:f.FileType.File,revision:h.sha,timestamp:Date.now(),size:r.byteLength,hash:l,originalHash:d,conflicts:o,staged:!1}:{...s,revision:h.sha,timestamp:Date.now(),size:r.byteLength,hash:l,originalHash:d,conflicts:o,staged:!1},n)}finally{a.stop()}}async createFile(t,e){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const r=new Ae(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(N(n),async()=>{const[{operation:o,index:a},s,c]=await Promise.all([this.getWorkingOperation(t,n),Zr(e),this.providerService.getMetadata(t),this.saveWorkingContent(n,t,e)]);await this.spliceOperation(t,a,o===void 0?{type:R.Created,uri:t,fileType:f.FileType.File,revision:c.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s,originalHash:s}:{...o,type:R.Created,revision:c.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s},i)},r.context),i.length===0)return;this._onDidChange.fire(i)}finally{r.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=new Ae(`ChangeStore.deleteFile(${t.toString()})`);try{const r=[];if(await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===R.Created)return this.discardCore(e,t,r);const[a]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:R.Deleted,uri:t,fileType:f.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},r)},n.context),r.length===0)return;this._onDidChange.fire(r)}finally{n.stop()}}findParent(t,e,n){const r=xt(t),{operation:i,index:o}=this.findWorkingOperation(r,e);return i!==void 0&&n(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const n=ut(t);return this.findParent(t,e,(r,i)=>r.type===R.Created&&!i.some(o=>Di(o.uri,r.uri)&&ut(o.uri)!==n))}findDeletedParents(t,e){const n=[];for(let r=0;r<e.length;r+=1){const i=e[r];i.type===R.Deleted&&Tr(t,i.uri)&&n.push({parent:i,parentIndex:r})}return n}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const n=ut(t);let r=-1;const i=e.find((o,a)=>ut(o.uri)!==n?!1:(r=a,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:r}}async getWorkingOperations(t){const e=N(t);let n=this.cache.get(e);return n===void 0&&(n=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,n)),n}async saveWorkingOperations(t,e){U.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const n=N(t);this.cache.set(n,e);try{await this.storageService.store(this.getOperationsStorageKey(n),this.toStorage(e))}catch(r){throw this.cache.delete(n),U.error(r,`Failed to save repository changes for ${n}`),r}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(n){throw U.error(n),this.telemetryService.sendException(n),n}}async discardWorkingContent(t,e){U.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(n){if(n instanceof f.FileSystemError&&n.code===Tw)return;throw U.error(n),this.telemetryService.sendException(n),n}}async saveWorkingContent(t,e,n){U.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,n.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),n)}catch(r){throw U.error(r),this.telemetryService.sendException(r),r}}getFileStorageKey(t,e){return`changestore/${vt(e)}`}async spliceOperation(t,e,n,r){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,n):o.push(n),await this.saveWorkingOperations(i,o),r.push(ka(n,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(n,r)=>(n==="uri"||n.endsWith("Uri"))&&Ar(r)?typeof r=="string"?f.Uri.parse(r):f.Uri.from(r):r);return Array.isArray(e)?e:e.operations}catch(e){throw U.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:Ra.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let Hu=Ra;Hu.operationsStorageSchemaVersion=1,Hu.ScopedChangeStore=class{constructor(t,e,n){this.changeStore=t,this.scope=e,this.workspaceId=n}createPatch(t,e,n){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),n)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const n=this.changeStore.getUriScope(t)!==this.workspaceId,r=await this.changeStore.stat(this.stripUriScope(t));return r!==void 0&&n&&(r.permissions=f.FilePermission.Readonly),r}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,n,r){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),n,r)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},Dw([Sr()],Hu.prototype,"getWorkingOperations",1);function Fw(t){switch(t){case R.Changed:return ct("change type changed","Modified");case R.Created:return ct("change type created","Added");case R.Deleted:return ct("change type deleted","Deleted")}}u(Fw,"getStatusText");function Mw(t){const[e,n]=t;switch(e){case R.Changed:switch(n){case R.Changed:case R.Created:return ct("conflict status changed both","Modified by Both");case R.Deleted:return ct("conflict status deleted them","Deleted by Incoming")}case R.Created:switch(n){case R.Changed:case R.Created:return ct("conflict status created both","Added by Both");case R.Deleted:return ct("conflict status deleted them","Deleted by Incoming")}case R.Deleted:switch(n){case R.Changed:case R.Created:return ct("conflict status deleted us","Deleted by Current");case R.Deleted:return ct("conflict status deleted both","Deleted by Both")}}}u(Mw,"getConflictStatusText");const pn=J.loadMessageBundle();class tp{constructor(e){this.providerService=e,this._onDidChangeFileDecorations=new f.EventEmitter,this._decorations=new Map,this.disposable=f.Disposable.from(f.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),e.onDidChangeChangeStore(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const n=e.map(({uri:r})=>(this._decorations.delete(N(r)),r));setTimeout(()=>this._onDidChangeFileDecorations.fire(n),0)}async provideFileDecoration(e,n){if(e.scheme!==Ht.scheme)return;await Wt(this.providerService,e);const r=N(e);let i=this._decorations.get(r);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let a;o.length>0&&(a=o.find(c=>N(c.uri)===r));const s=await this.providerService.changeStoreGetChange(e);if(s===void 0){if(a!==void 0)switch(a.type){case R.Created:i={badge:"\u2193A",color:new f.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:pn("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case R.Deleted:i={badge:"\u2193D",color:new f.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:pn("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case R.Changed:i={badge:"\u2193M",color:new f.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:pn("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new f.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:pn("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(r,i!=null?i:null),i}if(s.conflicts)i={badge:"!",color:new f.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:pn("decoration tooltip conflicts","Merge Conflicts ({0})",Mw(s.conflicts.status))};else if(a!==void 0)switch(a.type){case R.Created:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:pn("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case R.Deleted:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:pn("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case R.Changed:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:pn("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:pn("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(s.type){case R.Created:i={badge:"A",color:new f.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:pn("decoration tooltip added","Added")};break;case R.Changed:i={badge:"M",color:new f.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:pn("decoration tooltip modified","Modified")};break;case R.Deleted:i={badge:"D",color:new f.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:pn("decoration tooltip deleted","Deleted")};break}return this._decorations.set(r,i!=null?i:null),i}}u(tp,"ScmDecorationProvider");class Wu{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,n=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((r,i)=>{this.resolver=r,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const r=this.task;return this.task=void 0,r()}})),this.timeout=setTimeout(()=>{var r;this.timeout=void 0,(r=this.resolver)==null||r.call(this,void 0)},n),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}u(Wu,"TaskDebouncer");const Nw=J.loadMessageBundle();class kr{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await f.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}u(kr,"CommandQuickPickItem");var ic;(function(t){async function e(n,r,i,o,a,s){let c;Array.isArray(a)?c=a:s===void 0&&(c=[],s=a);const l=f.window.createQuickPick(),d=new Wu(500),h=[d],{defaultBranch:g,HEAD:p}=await n.getMetadata(r);async function y(x){var E;const[I,D,B]=await Promise.all([n.getBranches(r,{query:x,limit:100}),n.getTags(r,{query:x,limit:100}),n.getSnapshots(r)]),P=new Set,G=new Set;for(const ae of B)P.add(ae.hash),G.add(ae.branch.name);const ee=((s==null?void 0:s.filterBranches)?I.branches.filter(s==null?void 0:s.filterBranches):I.branches).filter(ae=>ae.name!==g.name),te=Nw("indexedCommit","Open indexed commit"),X=[{iconPath:new f.ThemeIcon("layers-active"),tooltip:te}];return[...c,...((E=p.branch)==null?void 0:E.name)!==g.name?[{label:`$(git-branch) ${g.name} (default)`,description:`\u2022$(git-commit) ${Pe(g.sha)}${G.has(g.name)||P.has(g.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:Fe.Branch,name:void 0,sha:g.sha,buttons:G.has(g.name)||P.has(g.sha)?X:void 0}]:[],...ee.map(ae=>({label:`$(git-branch) ${ae.name}`,description:`\u2022$(git-commit) ${Pe(ae.commit)}${G.has(ae.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:Fe.Branch,name:ae.name,sha:ae.commit,buttons:G.has(ae.name)?X:void 0})),...D.tags.map(ae=>({label:`$(tag) ${ae.name}`,description:`\u2022$(git-commit) ${Pe(ae.commit)}${P.has(ae.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:Fe.Tag,name:ae.name,sha:ae.commit,buttons:P.has(ae.commit)?X:void 0}))]}u(y,"getItems");const m=y(void 0);let v,S=!1;async function w(x){v=void 0;const E=l.activeItems;l.items=x!=null?x:await m,S&&E.length!==0&&(l.activeItems=l.items.filter(I=>E.some(D=>D.label===I.label))),l.busy=!1}u(w,"setItems");try{return await new Promise(E=>{var I;h.push(l.onDidHide(()=>E(void 0)),l.onDidChangeValue(D=>{if(S=!1,D=D.trim(),(s==null?void 0:s.allowResetToSha)&&p.branch&&nt(D)){w([{label:`Reset $(git-branch) ${p.branch.name} to $(git-commit) ${D}`,name:p.branch.name,sha:D,type:Fe.Branch}]);return}l.busy=!0;const B=d.debounce(D?()=>y(D):()=>m);v===void 0&&(v=B.then(async P=>w(P)))}),l.onDidAccept(()=>{if(l.activeItems.length!==0){const[D]=l.activeItems;E(D)}}),l.onDidTriggerItemButton(D=>{const B=D.item;B instanceof kr||(B.useIndex=!0),E(B)})),l.title=o,l.placeholder=i,l.matchOnDescription=!0,l.ignoreFocusOut=(I=s==null?void 0:s.ignoreFocusOut)!=null?I:!0,l.busy=!0,l.show(),v=d.debounce(async()=>m,0).then(D=>w(D))})}finally{l.dispose(),h.forEach(x=>void x.dispose())}}u(e,"show"),t.show=e})(ic||(ic={}));const A=J.loadMessageBundle(),Lw=new TextDecoder;class np{constructor(e,n,r){this.providerService=e,this.openActionsService=n,this.telemetryService=r,this._onDidCloseRepository=new f.EventEmitter,this._onDidOpenRepository=new f.EventEmitter,this._onDidChangeState=new f.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=f.Disposable.from(ce.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:o})=>{const a=this.getScmProvider(se.getVirtualUri(o.uri));a!==void 0&&await this.updateStatusBarCommands(a,void 0)}),this.providerService.onDidSyncRepository(async({repository:o,syncing:a})=>{const s=this.getScmProvider(se.getVirtualUri(o.uri));s!==void 0&&await this.updateStatusBarCommands(s,{syncing:a})}),this.providerService.onDidRefresh(o=>{for(const a of o)this.update(a)}),this.providerService.onDidChangeChangeStore(o=>this.update(o[0].rootUri)),...this.registerCommands());const i=this.providerService.repositories;this.onRepositoriesChanged({added:i,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=ce.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){ce.changed(e,"staging")&&(this._staging=void 0,ce.changed(e,"staging.enabled")&&this.refresh()),ce.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const n of e.added){const r=await this.update(n.uri);(r==null?void 0:r.repository)&&this._onDidOpenRepository.fire(r.repository)}if(e.removed.length)for(const n of e.removed){const r=this._scmProviders.findIndex(i=>N(i.sourceControl.rootUri)===N(n.uri));if(r!==-1){const i=this._scmProviders[r];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(r,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state))}registerCommands(){return[f.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.publicLog2("command.createPullRequest"),void this.createPullRequest(e)}),f.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.publicLog2("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),f.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.publicLog2("command.commit"),void this.commitChanges(e,{empty:!1})}),f.commands.registerCommand("remoteHub.commitEmpty",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.publicLog2("command.commitEmpty"),void this.commitChanges(e,{empty:!0})}),f.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(rp(e)){const a=e.resourceStates.filter(Da);if(a.length!==0){if(await $u(a))for(const s of a)await this.providerService.getChangeStore(s.resourceUri).discard(s.resourceUri);else this.telemetryService.publicLog2("command.discardAllChanges.abort",{reason:"aborted"});return}}let n=!1;e!==void 0&&"confirmDiscard"in e&&(n=!0,e=void 0);const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.publicLog2("command.discardAllChanges");const i=await this.providerService.getChangeStore(r.rootUri).getChanges(r.rootUri);n||await $u(i)?await this.providerService.getChangeStore(r.rootUri).discardAll(r.rootUri):this.telemetryService.publicLog2("command.discardAllChanges.abort",{reason:"aborted"})}),f.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const n of e)!Da(n)||(this.telemetryService.publicLog2("command.discardChanges"),await $u([n])?await this.providerService.getChangeStore(n.resourceUri).discard(n.resourceUri):this.telemetryService.publicLog2("command.discardChanges.abort",{reason:"aborted"}))}),f.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const n=this.getSourceControlFrom(e);(n==null?void 0:n.rootUri)!==void 0&&(this.telemetryService.publicLog2("command.stageAllChanges"),await this.providerService.getChangeStore(n.rootUri).stageAll(n.rootUri))}),f.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const n of e)!Da(n)||(this.telemetryService.publicLog2("command.stageChanges"),await this.providerService.getChangeStore(n.resourceUri).stage(n.resourceUri))}),f.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const n=this.getSourceControlFrom(e);if((n==null?void 0:n.rootUri)!==void 0)return this.telemetryService.publicLog2("command.unstageAllChanges"),void this.providerService.getChangeStore(n.rootUri).unstageAll(n.rootUri)}),f.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const n of e)!Da(n)||(this.telemetryService.publicLog2("command.unstageChanges"),await this.providerService.getChangeStore(n.resourceUri).unstage(n.resourceUri))}),f.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const n of e)!Da(n)||(this.telemetryService.publicLog2("command.keepChanges"),await this.providerService.getChangeStore(n.resourceUri).keep(n.resourceUri))}),f.commands.registerCommand("remoteHub.openChanges",e=>{var n;const{command:r}=e;if(!!r)return this.telemetryService.publicLog2("command.openChanges"),void f.commands.executeCommand(r.command,...(n=r.arguments)!=null?n:[])}),f.commands.registerCommand("remoteHub.openFile",async(...e)=>{var n;for(const r of e)if(Bu(r)){const i=r,o=this.providerService.getChangeStore(i.resourceUri).resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:f.ViewColumn.Active});this.telemetryService.publicLog2("command.openFile"),await f.commands.executeCommand(o.command,...(n=o.arguments)!=null?n:[])}else if(r instanceof f.Uri){this.telemetryService.publicLog2("command.openFile");const i=r;await f.window.showTextDocument(i)}}),f.commands.registerCommand("remoteHub.createBranch",async e=>{await Lf("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),f.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Ta(this._scmProviders,A("choose repo for create branch placeholder","Choose which repository to create a new branch on"),A("choose repo for create branch title","Create Branch"));if(r===void 0)return;this.telemetryService.publicLog2("command.createBranchFrom");const i=await this.providerService.getMetadata(r);if(i.accessLevel<$t.Write){this.telemetryService.publicLog2("command.createBranchFrom.abort",{reason:"no permissions"}),f.window.showErrorMessage(A("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,a=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const p=await ic.show(this.providerService,r,A("choose branch for create placeholder","Choose which branch to create the new branch from"),A("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!p){this.telemetryService.publicLog2("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=p.sha,a=Boolean(p.useIndex)}let s;try{s=await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>oc(this.providerService,r,o,A("create branch","Please provide a new branch name"),A("create branch placeholder","New branch name"),A("create branch title","Create Branch \u2022 {0}",i.name)))}catch(p){U.error(p),f.window.showErrorMessage(A("unable to create branch","Unable to create the new branch."));return}if(!s){this.telemetryService.publicLog2("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const c=await this.providerService.switchTo(r,{type:Fe.Branch,id:s});if(!c)return;const l=await this.providerService.getChangeStore(r).createChangeset(r);l&&await this.openActionsService.setChangesetToApply(c.uri,l);const d=A("switch to branch prompt open","Switch to Branch"),h=A("switch to branch prompt open in new window","Open in New Window"),g=await f.window.showInformationMessage(A("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,s),{modal:!0},d,h);!g||(c.location=g===h?ze.NewWindow:ze.CurrentWindow,a&&await ce.setMode(c.uri,Fr.getIndexDefault(ke.Branch)),await Mn(this.providerService,c,{skipChangesPrompt:!0}))}),f.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.publicLog2("command.applyPatch");let n;const r=f.window.activeTextEditor;if((r==null?void 0:r.document.languageId)!=="diff"){const i=await f.window.showOpenDialog({openLabel:A("open patch","Open Patch"),title:A("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;n=Lw.decode(await f.workspace.fs.readFile(i[0]))}else n=r.document.getText();try{await this.providerService.getChangeStore(e.rootUri).applyPatch(e.rootUri,n)}catch{f.window.showErrorMessage(A("invalid patch file","Invalid patch file"))}}),f.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const n=Array.isArray(e)?e:[e];for(const r of n){const i=this.getSourceControlFrom(r);if((i==null?void 0:i.rootUri)===void 0)return;let o;Bu(r)&&(o=r.resourceUri),this.telemetryService.publicLog2("command.exportPatch");const a=await this.providerService.getChangeStore(i.rootUri).createPatch(i.rootUri,o),s=await f.workspace.openTextDocument({language:"diff",content:a});await f.window.showTextDocument(s)}}),f.commands.registerCommand("remoteHub.switchToBranch",async e=>{var n,r;const i=(n=e==null?void 0:e.uri)!=null?n:await Ta(this._scmProviders,A("choose repo for switch branch placeholder","Choose which repository to switch branches on"),A("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.publicLog2("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(a.accessLevel>=$t.Write&&o.push(new kr(Nn({command:"remoteHub.createBranch",title:A("create branch command.v2","{0} Create New Branch...","$(add)"),arguments:[{uri:i}]})),new kr(Nn({command:"remoteHub.createBranchFrom",title:A("create branch from command.v2","{0} Create New Branch from...","$(add)"),arguments:[{uri:i}]}))),a.HEAD.type){case me.Branch:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:A("open branch on remote command.v2","{0} Open Branch on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case me.RemoteBranch:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:A("open remote branch on remote command.v2","{0} Open Remote Branch on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.HEAD.branch.remote.repo,branch:a.HEAD.branch.name}]})));break;case me.Tag:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:A("open tag on remote command.v2","{0} Open Tag on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,tag:a.HEAD.detached.name}]})));break;case me.Commit:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:A("open commit on remote command.v2","{0} Open Commit on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const s=(r=a.HEAD.branch)==null?void 0:r.name,c=Boolean(s&&!await this.providerService.getChangeStore(i).hasChanges(i)),l=await ic.show(this.providerService,i,A("choose switch branch placeholder","Choose which branch to switch to"),A("choose switch branch title","Switch to Branch or Tag \u2022 {0}",a.name),o,{allowResetToSha:c,filterBranches:s?d=>d.name!==s:void 0,ignoreFocusOut:!1});if(!l){this.telemetryService.publicLog2("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return l instanceof kr?void l.execute():c&&l.type===Fe.Branch&&l.name===s&&l.sha?f.window.withProgress({location:f.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,{to:l.sha})}catch(d){U.error(d),f.window.showErrorMessage(A("reset failed","Unable to reset the repository to commit '{0}'.",Pe(l.sha)))}}):void f.window.withProgress({location:f.ProgressLocation.SourceControl},async()=>{const d=await this.providerService.switchTo(i,l.name?{type:l.type,id:l.name}:void 0);if(d!==void 0){if(l.useIndex){const h=await this.providerService.getModeRefType(d.uri);await ce.setMode(d.uri,Fr.getIndexDefault(h))}return Mn(this.providerService,d)}})}),f.commands.registerCommand("remoteHub.fetch",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Ta(this._scmProviders,A("choose repo for fetch placeholder","Choose which repository to fetch"),A("choose repo for fetch title","Fetch Repository"));if(r!==void 0){this.telemetryService.publicLog2("command.fetch");try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.providerService.fetch(r,{force:!0}))}catch(i){f.window.showErrorMessage(A("fetch failed","Unable to fetch repository"))}}}),f.commands.registerCommand("remoteHub.fetchAll",async e=>{const n=this.providerService.repositories;if(n.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.publicLog2("command.fetchAll"),(await f.window.withProgress({location:f.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of n)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(e==null?void 0:e.automated)&&f.window.showErrorMessage(n.length?A("fetch all failed","Unable to fetch repositories"):A("fetch failed","Unable to fetch repository"))}),f.commands.registerCommand("remoteHub.pull",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Ta(this._scmProviders,A("choose repo for pull placeholder","Choose which repository to pull"),A("choose repo for pull title","Pull Repository"));if(r!==void 0){this.telemetryService.publicLog2("command.pull");try{await this.sync(r,{pull:!0})}catch{}}}),f.commands.registerCommand("remoteHub.sync",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Ta(this._scmProviders,A("choose repo for sync placeholder","Choose which repository to sync"),A("choose repo for sync title","Synchronize Repository"));if(r!==void 0){this.telemetryService.publicLog2("command.sync");try{await this.sync(r)}catch{}}}),f.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.publicLog2("command.disableCommitDirectlyWarning"),ce.updateEffective("commitDirectlyWarning",Pr.Off)})]}async sync(e,{pull:n,...r}={pull:!1}){this.telemetryService.publicLog2("sync");try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.providerService.sync(e,r))}catch(i){if(Ze.asVirtualProviderErrorCode(i)===je.SyncConflictsError){const o={title:A("sync confirm","Continue")},a={title:A("sync cancel","Cancel"),isCloseAffordance:!0};await f.window.showWarningMessage(n?A("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):A("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0},o,a)===o?await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.providerService.sync(e,{conflictResolution:Jr.Merge})):this.telemetryService.publicLog2("sync.abort",{reason:"abandoned"})}else if(Ze.asVirtualProviderErrorCode(i)===je.UnresolvedConflictsError)await f.window.showErrorMessage(n?A("pull with unresolved merge conflicts","You must resolve any pending conflicts before pulling."):A("sync with unresolved merge conflicts","You must resolve any pending conflicts before syncing."),{modal:!0});else throw U.error(i),this.telemetryService.sendException(i),f.window.showErrorMessage(A("sync failed","Unable to sync the repository.")),i}}async commitChanges(e,n){try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.commitChangesCore(e,n))}catch(r){if(Ze.asVirtualProviderErrorCode(r)===je.NothingToCommitError){f.window.showInformationMessage(A("no changes to commit","There are no changes to commit."));return}U.error(r),f.window.showErrorMessage(A("commit unable","Unable to commit.")),this.telemetryService.sendException(r)}}async commitChangesCore(e,n){const r=e.rootUri;this.telemetryService.publicLog2("commit",{staging:String(this.staging.enabled)});const i=new Ae(`VirtualSourceControl.commitChanges(${r.toString()})`);let o;try{const a=await this.providerService.getMetadata(r);let s,c;const l=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const h=e.inputBox.value;if(await this.providerService.getChangeStore(r).hasMergeConflicts(r)){e.inputBox.showValidationMessage(A("commit resolve conflicts","You must resolve any pending conflicts before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.publicLog2("commit.abort",{reason:"aborted conflicts"}),o=": Aborted; Unresolved conflicts";return}const g=await this.providerService.getCommitOperations(r,{staged:l});if(g.length===0&&!n.empty){e.inputBox.showValidationMessage(this.staging.enabled?A("commit no staged changes","There are no staged changes to commit."):A("commit no changes","There are no changes to commit."),f.SourceControlInputBoxValidationType.Information),this.telemetryService.publicLog2("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),o=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!h){e.inputBox.showValidationMessage(A("specify commit message","You must specify a commit message before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.publicLog2("commit.abort",{reason:"aborted no message"}),o=": Aborted; No message";return}let p,y;if(a.HEAD.type===me.RemoteBranch?(y=a.HEAD.branch.remote.accessLevel<$t.Write,p=y&&a.accessLevel<$t.Write):(p=a.accessLevel<$t.Write,y=p),c===void 0&&p&&(c=await this.providerService.getFork(r),c===void 0)){const m={title:A("fork confirm","Fork Repository")},v={title:A("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showInformationMessage(A("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0},m,v)!==m){this.telemetryService.publicLog2("commit.abort",{reason:"abandoned fork prompt"}),o=": Aborted; Abandoned fork prompt";return}if(c=await f.window.withProgress({location:f.ProgressLocation.Notification,title:A("fork progress","Forking {0}...",a.name)},()=>this.providerService.fork(r)),c===void 0){f.window.showErrorMessage(A("unable to fork","Unable to fork repository.")),this.telemetryService.publicLog2("commit.abort",{reason:"aborted fork failed"}),o=": Aborted; Fork failed";return}}if(c||y){if(c===void 0){const v={title:A("remote branch create branch prompt confirm","Commit to New Branch")},S={title:A("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showErrorMessage(A("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0},v,S)!==v){this.telemetryService.publicLog2("commit.abort",{reason:"abandoned remote branch prompt"}),o=": Aborted; Abandoned commit to new branch prompt";return}}let m=0;try{const v=await this.providerService.getBranches(c?this.providerService.createVirtualUri(r,c):r,{query:"patch-"});for(const S of v.branches){const w=/^patch-(?<num>\d+)$/.exec(S.name);if(w==null?void 0:w.groups){const x=Number(w.groups.num);x>m&&(m=x)}}}catch{}if(s=await oc(this.providerService,r,a.HEAD.sha,A("create new branch prompt","Create a new branch to commit your changes to"),A("create new branch placeholder","New branch name"),A("create new branch title","Commit \u2022 Create Branch \u2022 {0}",c?c.name:a.name),c,`patch-${m+1}`),!s){this.telemetryService.publicLog2("commit.abort",{reason:"abandoned create branch prompt"}),o=": Aborted; Abandoned create branch prompt";return}}try{await this.providerService.createAndPushCommit(r,h,g,s,n,c)}catch(m){const v=Ze.asVirtualProviderErrorCode(m);if(v===je.DetachedHEADError){const S={title:A("detached head prompt confirm","Commit to New Branch")},w={title:A("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showErrorMessage(A("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},S,w)!==S){this.telemetryService.publicLog2("commit.abort",{reason:"abandoned detached head prompt"}),o=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(s=await oc(this.providerService,r,a.HEAD.sha,A("create new branch prompt","Create a new branch to commit your changes to"),A("create new branch placeholder","New branch name"),A("create new branch title","Commit \u2022 Create Branch \u2022 {0}",c?c.name:a.name),c),!s){this.telemetryService.publicLog2("commit.abort",{reason:"abandoned detached head create branch prompt"}),o=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(v===je.MergeConflictError){const S={title:A("push conflicts prompt pull","Pull")},w={title:A("push conflicts prompt sync","Sync (Pull & Push)")},x={title:A("cancel","Cancel"),isCloseAffordance:!0},E=await f.window.showErrorMessage(A("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},S,w,x);if(E!==S&&E!==w){this.telemetryService.publicLog2("commit.abort",{reason:"abandoned conflicts prompt"}),o=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(r,{pull:E===S,conflictResolution:Jr.Merge}),E===S){o=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw U.error(m),o=`: Aborted; ${String(m)}`,m}break}if(e.inputBox.value="",c?await this.providerService.getChangeStore(r).discardAll(r,{staged:l}):await this.providerService.getChangeStore(r).acceptAll(r,{staged:l}),zu(Ri.HasCommitted,!0),!c&&!s)return;async function d(){if(c){const y={title:A("commit to fork confirm","Switch to Fork")},m={title:A("cancel","Cancel"),isCloseAffordance:!0},v=await f.window.showInformationMessage(A("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",a.name),{modal:!0},y,m);if(this.telemetryService.publicLog2("commit.switchToFork",{confirm:String(v===y)}),v===y){let S;s!==void 0?S={type:Fe.Branch,id:s}:a.HEAD.branch!==void 0&&(S={type:Fe.Branch,id:a.HEAD.branch.name}),Mn(this.providerService,{name:c.name,uri:this.providerService.createVirtualUri(r,{repo:c.repo,ref:S}),location:ze.CurrentWindow})}return}const h={title:A("commit to new branch confirm","Switch to Branch")},g={title:A("cancel","Cancel"),isCloseAffordance:!0},p=await f.window.showInformationMessage(A("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",s),{modal:!0},h,g);this.telemetryService.publicLog2("commit.switchToBranch",{confirm:String(p===h)}),p===h&&Mn(this.providerService,{name:a.name,uri:this.providerService.createVirtualUri(r,{repo:a.repo,ref:s?{type:Fe.Branch,id:s}:void 0}),location:ze.CurrentWindow})}u(d,"showSwitchToPrompt"),d.call(this)}finally{i.stop(o?{message:o}:void 0)}}async createPullRequest(e,n){try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,n))}catch(r){const i=Ze.asVirtualProviderErrorCode(r);if(i===je.NothingToCommitError){f.window.showInformationMessage(A("no changes to commit","There are no changes to commit."));return}if(i===je.CommitFailedError){f.window.showErrorMessage(A("commit unable","Unable to commit."));return}U.error(r),f.window.showErrorMessage(A("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(r)}}async createPullRequestCore(e,n){var r;const i=e.rootUri,o=(r=n==null?void 0:n.draft)!=null?r:!1;this.telemetryService.publicLog2("createPullRequest",{draft:String(o),staging:String(this.staging.enabled)});const a=new Ae(`VirtualSourceControl.createPullRequest(${i.toString()})`);let s;try{let c=u(function(){this.telemetryService.publicLog2("createPullRequest.abort",{reason:"abandoned branch prompt"}),s=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),l;const d=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(n==null?void 0:n.sha)){if(await this.providerService.getChangeStore(i).hasMergeConflicts(i)){e.inputBox.showValidationMessage(A("commit resolve conflicts","You must resolve any pending conflicts before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.publicLog2("createPullRequest.abort",{reason:"aborted conflicts"}),s=": Aborted; Unresolved conflicts";return}if(l=await this.providerService.getCommitOperations(i,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),l.length===0){e.inputBox.showValidationMessage(this.staging.enabled?A("commit no staged changes","There are no staged changes to commit."):A("commit no changes","There are no changes to commit."),f.SourceControlInputBoxValidationType.Information),this.telemetryService.publicLog2("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),s=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const h=e.inputBox.value;if(!h){e.inputBox.showValidationMessage(A("specify commit message","You must specify a commit message before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.publicLog2("createPullRequest.abort",{reason:"aborted no message"}),s=": Aborted; No message";return}const g=await this.providerService.getMetadata(i);let p,y;g.HEAD.type===me.RemoteBranch?(y=g.HEAD.branch.remote.accessLevel<$t.Write,p=y&&g.accessLevel<$t.Write):(p=g.accessLevel<$t.Write,y=p);let m=n==null?void 0:n.fork;if(m===void 0&&p&&(m=await this.providerService.getFork(i),m===void 0)){const I={title:A("fork confirm","Fork Repository")},D={title:A("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showInformationMessage(A("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0},I,D)!==I){this.telemetryService.publicLog2("createPullRequest.abort",{reason:"abandoned fork prompt"}),s=": Aborted; Abandoned fork prompt";return}if(m=await f.window.withProgress({location:f.ProgressLocation.Notification,title:A("fork progress","Forking {0}...",g.name)},()=>this.providerService.fork(i)),m===void 0){f.window.showErrorMessage(A("unable to fork","Unable to fork repository.")),this.telemetryService.publicLog2("createPullRequest.abort",{reason:"aborted fork failed"}),s=": Aborted; Fork failed";return}}const v=await f.window.showInputBox({ignoreFocusOut:!0,placeHolder:A("create pr placeholder","Pull request title"),prompt:A("create pr prompt","Enter a title for the new pull request"),title:A("create pr title","New Pull Request"),value:h});if(!v){this.telemetryService.publicLog2("createPullRequest.abort",{reason:"abandoned title prompt"}),s=": Aborted; Abandoned title prompt";return}async function S(I){let D=0;try{const B=await this.providerService.getBranches(m?this.providerService.createVirtualUri(i,m):i,{query:"patch-"});for(const P of B.branches){const G=/^patch-(?<num>\d+)$/.exec(P.name);if(G==null?void 0:G.groups){const ee=Number(G.groups.num);ee>D&&(D=ee)}}}catch{}return oc(this.providerService,i,I,A("create pr branch prompt","Create a new branch for this pull request"),A("create pr branch placeholder","New branch name"),A("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",m?m.name:g.name),m,`patch-${D+1}`)}u(S,"createBranch");const w=await S.call(this,g.HEAD.sha);if(!w){c.call(this);return}(l==null?void 0:l.length)&&await this.providerService.createAndPushCommit(i,h,l,w,void 0,m);const x=await this.providerService.createPullRequest(i,w,v,{draft:o},m);e.inputBox.value="",(l==null?void 0:l.length)&&(m?await this.providerService.getChangeStore(i).discardAll(i,{staged:d}):await this.providerService.getChangeStore(i).acceptAll(i,{staged:d}));async function E(){const I={title:A("created pr notification confirm","Switch to Pull Request")},D={title:A("cancel","Cancel"),isCloseAffordance:!0},B=await f.window.showInformationMessage(A("created pr notification","Created pull request #{0} in {1}. Do you want to switch to the new pull request?",x.id,g.name),{modal:!0},I,D);this.telemetryService.publicLog2("commit.switchToPullRequest",{confirm:String(B===I)}),B===I&&Mn(this.providerService,{name:g.name,uri:this.providerService.createVirtualUri(i,{repo:g.repo,ref:{type:Fe.PullRequest,id:x.id}}),location:ze.CurrentWindow})}u(E,"showSwitchToPrompt"),E.call(this)}finally{a.stop(s?{message:s}:void 0)}}async update(e){const n=f.workspace.getWorkspaceFolder(e);if(n===void 0)return;const r=await this.createOrUpdateScmProvider(e,n.name),i=await this.providerService.getChangeStore(e).getGroupedChanges(e,{predicate:c=>c.fileType===f.FileType.File}),o=await Promise.all(i.conflicts.map(async c=>({type:c.type,resourceUri:c.uri,command:await this.providerService.getChangeStore(c.uri).resolveDiffCommand(c.uri,c.conflicts.incomingUri,A("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",Je(c.uri)))}))),a=await Promise.all(i.staged.map(async c=>({type:c.type,resourceUri:c.uri,command:await this.providerService.getChangeStore(c.uri).resolveDiffCommand(c.uri,se.getProviderUri(c.uri),A("diff title index","{0} (Index)",Je(c.uri)))}))),s=await Promise.all(i.working.map(async c=>({type:c.type,resourceUri:c.uri,decorations:{strikeThrough:c.type===R.Deleted},command:await this.providerService.getChangeStore(c.uri).resolveDiffCommand(c.uri,se.getProviderUri(c.uri),A("diff title working","{0} (Working Tree)",Je(c.uri)))})));return this.ensureMergeConflictsGroup(r).resourceStates=o,this.ensureStagedChangesGroup(r).resourceStates=this.staging.enabled?a:[],this.ensureWorkingChangesGroup(r).resourceStates=this.staging.enabled?s:[...a,...s],r}async createOrUpdateScmProvider(e,n){const r=await this.providerService.getMetadata(e);let i;const o=r.HEAD.branch?r.HEAD.name:void 0;let a=this.getScmProvider(e);if(a===void 0){n=r.name,i=f.scm.createSourceControl(`remoteHub:${r.provider.id}`,n,e),i.quickDiffProvider={provideOriginalResource:c=>se.getProviderUri(c)};const s=this.providerService.createIGitRepository(e,i,r);a={id:r.provider.id,name:r.provider.name,sourceControl:i,groups:[],repository:s},this.ensureMergeConflictsGroup(a),this.ensureStagedChangesGroup(a),this.ensureWorkingChangesGroup(a),this._scmProviders.push(a)}else i=a.sourceControl;return r.accessLevel>=$t.Write?(i.acceptInputCommand={command:"remoteHub.commit",title:A("scm input accept command title commit","Commit"),arguments:[i]},o?i.inputBox.placeholder=A("scm input placeholder commit","Message (Ctrl+Enter to commit and push to '{0}' on {1})",o,r.provider.name):i.inputBox.placeholder=A("scm input placeholder commit","Message (Ctrl+Enter to commit and push to {0})",r.provider.name),ce.get("commitDirectlyWarning")===Pr.Off?i.inputBox.validateInput=void 0:i.inputBox.validateInput=s=>{if(ce.get("commitDirectlyWarning")===Pr.Auto&&pp(Ri.HasCommitted))return;const c=new f.MarkdownString(o?A("scm input validation commit branch directly","Your changes will be committed and immediately pushed to the '{0}' branch on {1}.",o,r.provider.name):A("scm input validation commit directly","Your changes will be committed and immediately pushed to {0}.",r.provider.name));return c.isTrusted=!0,c.appendMarkdown(`&nbsp; [${A("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${A("scm input validation action tip","Hide")}')`),{message:c,type:f.SourceControlInputBoxValidationType.Information}}):(i.acceptInputCommand={command:"remoteHub.createPullRequest",title:A("scm input accept command title pr","Create a Pull Request"),arguments:[i]},i.inputBox.placeholder=A("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}')",n)),await this.updateStatusBarCommands(a,{syncing:!1},r),a}async updateStatusBarCommands(e,n,r){var i,o,a;const s=e.sourceControl.rootUri;r=r!=null?r:await this.providerService.getMetadata(s);const{HEAD:c}=r,l=await this.providerService.getIndexMetadata(s),d=(l==null?void 0:l.type)===Re.Active,h=(l==null?void 0:l.type)===Re.Active,g=Re.hasIndex(l==null?void 0:l.type),p=await this.providerService.getChangeStore(s).hasChanges(s),y=Bs(c.type),m=[];if(m.push(Nn({command:"remoteHub.switchToBranch",title:`${y} ${c.name}${p?"*":""}`,tooltip:`${Pe(c.sha)}`,arguments:[{uri:s,commands:!0}]})),c.detached||((n==null?void 0:n.syncing)?m.push(Nn({command:"",title:"$(sync~spin)",tooltip:A("sync command syncing","Syncing Changes..."),arguments:[]})):m.push(Nn({command:"remoteHub.sync",title:`$(sync)${((o=(i=r.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=r.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:d||h?A("sync index","Sync to latest indexed commit"):A("sync command","Sync (Pull & Push)"),arguments:[{uri:s}]}))),r.pullRequest&&m.push(Nn({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${r.pullRequest.id}`,tooltip:A("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,r.pullRequest.id,r.provider.name,r.pullRequest.title),arguments:[{provider:r.provider,repo:r.repo,pullRequest:{id:r.pullRequest.id}}]})),g){const v=this.providerService.getIndexProvider(s);v&&m.push(...await v.getStatusBarContributions(s))}e.sourceControl.statusBarCommands=m}ensureMergeConflictsGroup(e){const n="conflicts";let r=e.groups.find(i=>i.id===n);return r===void 0&&(r=e.sourceControl.createResourceGroup(n,A("scm group conflicts","Merge Conflicts")),r.hideWhenEmpty=!0,e.groups.push(r)),r}ensureStagedChangesGroup(e){const n="staged";let r=e.groups.find(i=>i.id===n);return r===void 0&&(r=e.sourceControl.createResourceGroup(n,A("scm group staged","Staged Changes")),r.hideWhenEmpty=!0,e.groups.push(r)),r}ensureWorkingChangesGroup(e){const n="changes";let r=e.groups.find(i=>i.id===n);return r===void 0&&(r=e.sourceControl.createResourceGroup(n,A("scm group changes","Changes")),e.groups.push(r)),r}getScmProvider(e){const n=N(e);return this._scmProviders.find(r=>N(r.sourceControl.rootUri)===n)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let n;if(Uw(e))n=e;else if(rp(e)){const r=e,i=this._scmProviders.find(o=>o.groups.includes(r));n=i==null?void 0:i.sourceControl}else if(Bu(e)){const r=e,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(r)));n=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;n=this._scmProviders[0].sourceControl}return n}}u(np,"VirtualSourceControl");function Uw(t){return"rootUri"in t&&"inputBox"in t}u(Uw,"isSourceControl");function rp(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}u(rp,"isSourceControlResourceGroup");function Bu(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof f.Uri}u(Bu,"isSourceControlResourceState");function Da(t){return"type"in t}u(Da,"isTrackedChange");async function $u(t){var e,n,r;if(t.length===0)return!0;let i,o=A("discard","Discard Changes");if(t.length===1){const s=t[0];s.type===R.Created?(i=A("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,Je((e=s.resourceUri)!=null?e:s.uri)),o=A("delete file","Delete file")):s.type===R.Deleted?(o=A("restore file","Restore file"),i=A("confirm restore","Are you sure you want to restore {0}?",Je((n=s.resourceUri)!=null?n:s.uri))):i=A("confirm discard","Are you sure you want to discard changes in {0}?",Je((r=s.resourceUri)!=null?r:s.uri))}else t.every(s=>s.type===R.Created)?i=A("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(s=>s.type===R.Deleted)?(o=A("restore files","Restore files"),i=A("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=A("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await f.window.showWarningMessage(i,{modal:!0},o)===o}u($u,"confirmDiscard");async function Ta(t,e,n){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const r=await f.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:n});if(!!r)return r.uri}u(Ta,"getOrPickRootUri");async function oc(t,e,n,r,i,o,a,s){const c=new Set;let l;const d=f.window.createInputBox();d.ignoreFocusOut=!0;try{return await new Promise((h,g)=>{l=f.Disposable.from(d.onDidHide(()=>h(void 0)),d.onDidChangeValue(p=>{if(p=p.trim(),!p){d.validationMessage=A("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(c.has(p)){d.validationMessage=A("scm create branch prompt validation already exists","Branch '{0}' already exists",p);return}if(!Hn(p)){d.validationMessage=A("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",p);return}d.validationMessage=void 0}),d.onDidAccept(async()=>{const p=d.value;try{d.enabled=!1,d.busy=!0;const y=await t.createBranch(e,p,n,a);h(y)}catch(y){if(Ze.asVirtualProviderErrorCode(y)===je.InvalidBranchNameError){d.enabled=!0,d.busy=!1,d.validationMessage=y.message,c.add(p);return}g(y)}})),d.prompt=r,d.placeholder=i,d.title=o,s&&(d.value=s),d.show()})}finally{d.dispose(),l==null||l.dispose()}}u(oc,"createBranchWithPrompt");const lt=J.loadMessageBundle();class ir extends f.TimelineItem{static is(e){return e instanceof ir}constructor(e,n,r,i,{dateType:o,showAuthor:a,dateFormatter:s}){var c;const l=r.message.indexOf(`
`),d=l!==-1?`${r.message.substring(0,l)} \u2026`:r.message,h=o==="authored"?r.authorDate:r.commitDate;super(d,(c=h==null?void 0:h.getTime())!=null?c:0);this.id=r.hash,this.contextValue=`${se.scheme}:${n}:file:commit`,this.command=i,a&&(this.description=r.authorName),this.tooltip=lt("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,r.authorName,r.authorEmail,Pe(r.hash),s.format(h),r.message),this.iconPath=new f.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=n,this.hash=r.hash,this.parents=r.parents,this.message=r.message}}u(ir,"CommitTimelineItem");class ki extends f.TimelineItem{static is(e){return e instanceof ki}constructor(e,n,r,i,o,{dateFormatter:a}){const s=lt("timeline staged changes","Staged Changes");super(s,r.timestamp);this.id="index",this.contextValue=`${se.scheme}:${n}:file:${this.id}`,this.command=o,this.iconPath=new f.ThemeIcon("git-commit"),this.tooltip=lt("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,lt("timeline you","You"),lt("timeline index","Index"),a.format(new Date(r.timestamp)),Fw(r.type)),this.rootUri=e,this.providerId=n,this.hash="~",this.parents=i,this.message=s}}u(ki,"ChangeOperationTimelineItem");class ip{constructor(e){this.providerService=e,this._onDidChange=new f.EventEmitter,this.id="github-file-history",this.label=lt("timeline.source","GitHub File History"),this.debouncer=new Wu(500),this.disposable=f.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),e.onDidChangeChangeStore(this.onUrisChanged,this),ce.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const n=N(this.rootUri);!e.some(r=>N(r)===n)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const n=N(this.rootUri);(e.added.some(r=>N(r.uri)===n)||e.removed.some(r=>N(r.uri)===n))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||N(this.rootUri)!==N(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const n=N(this.rootUri);e.some(r=>N(r.rootUri)===n)&&this.fireChanged()}async provideTimeline(e,n,r){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const y of this.providerService.repositories)if(y.uri.path===this.rootUri.path){this.rootUri=y.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),a=await this.providerService.getMetadata(this.rootUri);if(!a||r.isCancellationRequested)return{items:[]};const s=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:n.cursor,limit:typeof n.limit=="number"?n.limit:void 0});if(s===void 0||s.commits.length===0||r.isCancellationRequested)return{items:[]};const c=((i=s.paging)==null?void 0:i.more)?{cursor:s.paging.cursor}:void 0,l=new Intl.DateTimeFormat(f.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),d=ce.getAny("git.timeline.date",void 0,"committed"),h=ce.getAny("git.timeline.showAuthor",void 0,!0),g=await Promise.all(s.commits.map(async y=>new ir(this.rootUri,a.provider.id,y,await this.resolveDiffCommand(y,a,e,o),{dateType:d,showAuthor:h,dateFormatter:l}))),p=n.cursor===void 0?await this.providerService.changeStoreGetChange(e):void 0;if(p&&Boolean(p.staged&&ce.get("staging.enabled"))){const m=new ki(this.rootUri,a.provider.id,p,[s.commits[0].hash],await this.providerService.changeStoreResolveDiffCommand(p.uri,se.getProviderUri(p.uri),lt("diff title index","{0} (Index)",Je(p.uri))),{dateFormatter:l});g.splice(0,0,m)}return{items:g,paging:c}}catch(o){return U.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=f.workspace.registerTimelineProvider([Ht.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[f.commands.registerCommand("remoteHub.timeline.copyCommitId",(n,r,i)=>{!ir.is(n)||f.env.clipboard.writeText(n.hash)}),f.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(n,r,i)=>{!ir.is(n)||f.env.clipboard.writeText(n.message)}),f.commands.registerCommand("remoteHub.timeline.openDiff",async(n,r,i)=>{var o;!ir.is(n)&&!ki.is(n)||n.command!==void 0&&await f.commands.executeCommand(n.command.command,...(o=n.command.arguments)!=null?o:[])}),f.commands.registerCommand("remoteHub.timeline.openOnGitHub",async n=>{await this.openOnRemote(n)}),f.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async n=>{await this.openOnRemote(n)}),f.commands.registerCommand("remoteHub.timeline.selectForCompare",async(n,r,i)=>{!r||!ir.is(n)&&!ki.is(n)||(e={uri:r,left:n},await f.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),f.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(n,r,i)=>{if(!r||!e||!ir.is(n)&&!ki.is(n)||N(r)!==N(e.uri))return;const{left:o}=e,a=this.providerService.getRelativeFilePath(n.rootUri,r),s=await this.providerService.getMetadata(n.rootUri),c=Je(r),l=o.parents[0];let d;l===void 0?d=lt("timeline diff title ref","{0} ({1})",c,Pe(n.hash)):o.hash===""?d=lt("timeline diff title working","{0} (Working Tree)",c):o.hash==="~"?d=lt("timeline diff title index","{0} (Index)",c):d=lt("timeline diff title ref","{0} ({1})",c,Pe(o.hash));let h=o.hash===""||o.hash==="~"?r:this.providerService.createProviderUri(r,{repo:s.repo,ref:{type:Fe.Commit,id:l!=null?l:"0000000000000000000000000000000000000000"}},a);l===void 0&&(h=h.with({query:"~"}));const g=n.parents[0];let p;g===void 0?p=lt("timeline diff title ref","{0} ({1})",c,Pe(n.hash)):g==="~"&&n.hash===""?p=lt("timeline diff title working","{0} (Working Tree)",c):n.hash==="~"?p=lt("timeline diff title index","{0} (Index)",c):p=lt("timeline diff title ref","{0} ({1})",c,Pe(n.hash));const y=lt("timeline diff title","{0} \u27F7 {1}",d,p),m=n.hash===""||n.hash==="~"?r:this.providerService.createProviderUri(r,{repo:s.repo,ref:{type:Fe.Commit,id:n.hash}},a);await f.commands.executeCommand("vscode.diff",h,m,y)})]}async resolveDiffCommand(e,n,r,i,o){const a=Je(r);let s=e.parents[0],c=this.providerService.createProviderUri(r,{repo:n.repo,ref:{type:Fe.Commit,id:s!=null?s:"0000000000000000000000000000000000000000"}},i);try{await this.providerService.stat(c)}catch(h){s=void 0}let l;s===void 0?l=lt("timeline diff title ref","{0} ({1})",a,Pe(e.hash)):e.hash===""?l=lt("timeline diff title working","{0} (Working Tree)",a):e.hash==="~"?l=lt("timeline diff title index","{0} (Index)",a):l=lt("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,Pe(s),Pe(e.hash)),s===void 0&&(c=c.with({query:"~"}));const d=e.hash===""||e.hash==="~"?r:this.providerService.createProviderUri(r,{repo:n.repo,ref:{type:Fe.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[c,d,l,o]}}async openOnRemote(e){if(!ir.is(e))return;const n=await this.providerService.getMetadata(e.rootUri);await Lf("remoteHub.openOnRemote",{provider:n.provider,repo:n.repo,sha:e.hash})}}u(ip,"VirtualTimelineProvider");class op{constructor(e,n){this.providerService=e,this.telemetryService=n,this.disposable=f.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var n;const r=new Ae(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);await Wt(this.providerService,void 0);try{switch(e.path){case"/open":{this.telemetryService.publicLog2("handleUri.open");let i,o;for(const s of e.query.split("&")){const[c,l]=s.split("=");switch(c){case"url":i=decodeURIComponent(l);break;case"location":o=l===ze.CurrentWindow?ze.CurrentWindow:ze.NewWindow;break}}if(!i){r.log({message:": Unable to find url parameter"}),this.telemetryService.publicLog2("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:ze.NewWindow;const a=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!a){r.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.publicLog2("handleUri.open.abort",{reason:"aborted invalid url"});return}r.log({message:`: Opening ${i} in ${o}`}),Mn(this.providerService,a);break}case"/open-files":{let i;for(const a of e.query.split("&")){const[s,c]=a.split("=");if(s==="url"){i=decodeURIComponent(c);break}}if(!i){r.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){r.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(r.log({message:`: Opening files/folders for ${i}`}),await((n=cc())==null?void 0:n.openPendingFiles(o.uri,o.filesToOpen))):r.log({message:`: No files/folders found to open for ${i}`});break}default:{r.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{r.stop()}}}u(op,"RemoteUriHandler");var Ow=Object.defineProperty,Hw=Object.getOwnPropertyDescriptor,Ww=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Hw(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Ow(e,n,i),i},"view_decorateClass"),xo;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(xo||(xo={}));const ap=u(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof ap}get id(){}toString(){return`${U.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,n){return this.splatted&&this.parent!==void 0&&this.parent!==n?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let Io=ap;Ww([Sr((t=!1,e=!1,n)=>JSON.stringify([t,e,n==null?void 0:n.toString()]))],Io.prototype,"triggerChange",1);class sp{constructor(e,n,r,i){this.id=e,this.name=n,this.providerService=r,this.telemetryService=i,this._onDidChangeTreeData=new f.EventEmitter,this.disposables=[];const o=!1;if(U.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(s){var c;const l=await a.apply(this,[s]),d=s.getParent();return l.tooltip===void 0&&(l.tooltip=new f.MarkdownString(l.label!==void 0&&typeof l.label!="string"?l.label.label:(c=l.label)!=null?c:"")),typeof l.tooltip=="string"?l.tooltip=`${l.tooltip}

---
context: ${l.contextValue}
node: ${s.toString()}${d!==void 0?`
parent: ${d.toString()}`:""}`:l.tooltip.appendMarkdown(`

---

context: \`${l.contextValue}\`\\
node: \`${s.toString()}\`${d!==void 0?`\\
parent: \`${d.toString()}\``:""}`),l}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!ce.changed(e,`views.${this.configKey}`)}dispose(){f.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=f.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(ce.onDidChange(n=>{!this.filterConfigurationChanged(n)||(this._config=void 0,this.onConfigurationChanged(n))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.publicLog2("view.open",{view:this.id}),this.root=this.getRoot()),this.root}async getChildren(e){return e!==void 0?e.getChildren():(await Wt(this.providerService,void 0),this.ensureRoot().getChildren())}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var n,r;await((r=(n=this.root)==null?void 0:n.refresh)==null?void 0:r.call(n,e)),this.triggerNodeChange()}async refreshNode(e,n=!1,r=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,n));!r&&o===!0||this.triggerNodeChange(e)}async reveal(e,n){if(this.tree!==void 0)try{await this.tree.reveal(e,n)}catch(r){U.error(r)}}async show(){try{await f.commands.executeCommand(`${this.id}.focus`)}catch(e){U.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=ce.get("views")[this.configKey]),this._config}}u(sp,"View");class cp extends Io{constructor(e,n,r,i,o,a,s){super(e,n);this._message=r,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=s}getChildren(){return[]}getTreeItem(){var e;const n=new f.TreeItem(this._message,f.TreeItemCollapsibleState.None);return n.contextValue=(e=this._contextValue)!=null?e:xo.Message,n.description=this._description,n.tooltip=this._tooltip,n.iconPath=this._iconPath,n}}u(cp,"MessageNode");var Bw=Object.defineProperty,$w=Object.getOwnPropertyDescriptor,Vu=u((t,e,n,r)=>{for(var i=r>1?void 0:r?$w(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Bw(e,n,i),i},"workspaceRepositoriesView_decorateClass");const pt=J.loadMessageBundle(),lp=u(class extends Io{constructor(t,e,n,r,i,o,a){super(t,e);this.changeStore=n,this.canonical=r,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(t,e,n){return`${Aa.getId(t,e)}:${this.key}(${n.uri.toString()})`}get id(){return lp.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new f.TreeItem(t,f.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${xo.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.providerService.getChangeStore(this.operation.uri).getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const n=Boolean(this.operation.staged&&ce.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const r=se.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,r,n?pt("diff title index","{0} (Index)",Je(this.operation.uri),this.workspaceRepository.ref.name):pt("diff title working","{0} (Working Tree)",Je(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:r}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:r,ref:{type:Fe.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,n?pt("diff title changeset index","{0} (Index of {1})",Je(this.operation.uri),this.workspaceRepository.ref.name):pt("diff title changeset working","{0} (Working Tree of {1})",Je(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await f.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.providerService.getChangeStore(this.operation.uri).getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await f.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.providerService.getChangeStore(t.uri).applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){f.window.showErrorMessage(String(e))}}},"_FileChangeNode");let up=lp;up.key=":changes";const dp=u(class extends Io{constructor(t,e,n,r,i){super(t,e);this.canonical=n,this.workspaceRepository=r,this.root=i}static getId(t,e){return`${ac.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return dp.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||f.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.providerService.getChangeStore(this.workspaceRepository.uri).getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(n=>new up(this.view,this,t,this.canonical,this.workspaceRepository,n,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=Ov(this.workspaceRepository),n=Ht.isCanonicalUri(this.workspaceRepository.uri)?pt("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,r=new f.TreeItem(this.root?this.canonical.name:n,e?f.TreeItemCollapsibleState.Collapsed:f.TreeItemCollapsibleState.None);return r.id=this.id,r.contextValue=`${xo.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,r.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${po(this.workspaceRepository.timestamp,{ago:!0})}`,r.iconPath=t?new f.ThemeIcon("check"):this.root?gp(this.canonical.provider.id):Tv(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),r.tooltip=new f.MarkdownString(void 0,!0).appendMarkdown(pt("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?pt("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",Vw(this.workspaceRepository.ref.type),Bs(this.workspaceRepository.ref.type),n,t?` \u2014 _${pt("repositories view repository tooltip active","Active")}_ `:"",po(this.workspaceRepository.timestamp,{ago:!0}),hu(this.workspaceRepository.changes,{preamble:`${pt("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(r.resourceUri=f.Uri.parse("remotehub-view://wsrepo/changes")),r}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.providerService.getChangeStore(t.uri).applyChangeset(t.uri,this.workspaceRepository)}catch(e){f.window.showErrorMessage(String(e))}}remove(){return this.view.providerService.workspaceRepositoriesRemoveRepository(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let Aa=dp;Aa.key=":wsrepo",Vu([Sr()],Aa.prototype,"refresh",1);const hp=u(class extends Io{constructor(t,e,n,r){super(t,e);this.canonical=n,this.workspaceRepositories=r}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return hp.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new cp(this.view,this,pt("repositories view message empty","No remote repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new Aa(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(n=>n.workspaceId===this.view.workspaceId),e=new f.TreeItem(this.canonical.name,t?f.TreeItemCollapsibleState.Expanded:f.TreeItemCollapsibleState.Collapsed);return e.contextValue=xo.WorkspaceRepositories,e.iconPath=gp(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let ac=hp;ac.key=":wsrepos",Vu([Sr()],ac.prototype,"refresh",1);class qu extends Io{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.providerService.workspaceRepositoriesGetRepositoriesByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const n=[];for(const[r,i]of e){const o=f.Uri.parse(r);try{const{name:a,provider:s}=this.view.providerService.getVirtualUriMetadata(o),c={uri:o,name:a,provider:s,hasActive:i.some(l=>l.workspaceId===this.view.workspaceId)};i.length===1?n.push(new Aa(this.view,this,c,i[0],!0)):n.push(new ac(this.view,this,c,i))}catch(a){if(a instanceof Ot)continue;U.error(a)}}this.children=n}return this.children}getTreeItem(){return new f.TreeItem("Repositories",f.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}u(qu,"WorkspaceRepositoriesViewNode"),Vu([Sr()],qu.prototype,"refresh",1);class fp extends sp{constructor(e,n,r){super("remoteHub.views.workspaceRepositories",pt("remote view title","Remote Repositories"),e,r);this.workspaceId=n,this.configKey="workspaceRepositories",this.disposables.push(this.providerService.onDidChangeWorkspaceRepositories(this.onRepositoriesChanged,this),f.window.registerFileDecorationProvider({provideFileDecoration:(i,o)=>{if(!(i.scheme!=="remotehub-view"||i.authority!=="wsrepo"||!i.path.includes("/changes")))return{badge:"\u25CF",color:new f.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:pt("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new qu(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[f.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.refresh"),this.providerService.workspaceRepositoriesRefresh(),void this.refresh(!0)),this),f.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.open"),Mn(this.providerService,{name:e.name,uri:e.uri,location:ze.CurrentWindow})),this),f.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.openInNewWindow"),Mn(this.providerService,{name:e.name,uri:e.uri,location:ze.NewWindow})),this),f.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),f.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.remove"),e.remove()),this),f.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),f.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.openFile"),e.openFile()),this),f.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.publicLog2("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const n=N(this.providerService.getVirtualCanonicalRootUri(e.uri)),r=this.providerService.repositories.filter(o=>N(o.canonicalUri)===n);return await qw(r,pt("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}u(fp,"WorkspaceRepositoriesView");function Vw(t,e){switch(t){case me.Branch:return e?pt("type pr branch","Pull Request #{0}",e.id):pt("type branch","Branch");case me.RemoteBranch:return e?pt("type pr remote branch","Pull Request #{0}",e.id):pt("type remote branch","Remote Branch");case me.Tag:return pt("type tag","Tag");case me.Commit:return pt("type commit","Commit")}}u(Vw,"headTypeToString");function gp(t){switch(t){case"github":return new f.ThemeIcon("github");case"azurerepos":return new f.ThemeIcon("azure-devops");default:return new f.ThemeIcon("vm")}}u(gp,"providerToIconPath");async function qw(t,e){if(t.length!==0){if(t.length>1){const n=await f.window.showQuickPick(t.map(r=>({label:r.name,description:r.provider.name,repository:r})),{placeHolder:e});return n?n.repository:void 0}return t[0]}}u(qw,"getRepository");let sc;function cc(){return sc}u(cc,"getOpenActionsService");var Ri;(function(t){t.HasCommitted="has:committed",t.Version="version"})(Ri||(Ri={}));let lc;function pp(t){return lc.globalState.get(t)}u(pp,"getState");async function zu(t,e){return lc.globalState.update(t,e)}u(zu,"updateState");let mp=!1;function zw(){return mp}u(zw,"isPreRelease");async function jw(t){lc=t,Do.configure("remoteHub",t),U.configure(t,"Remote Repositories",ce.get("logLevel")),Ae.start("Time to root directory",{log:!1});const e=Ni.configure(t),n=new da(t),r=t.extension.packageJSON.version;await zu(Ri.Version,r),await t.workspaceState.update(Ri.Version,r);const[,i]=lc.extension.packageJSON.version.split(".");mp=Number.parseInt(i)%2==1;try{const o=new Ht(n,t.workspaceState);sc=new Ag(o);const a=new np(o,sc,n),s=new Dg(o);return t.subscriptions.push(ce.onDidChange(c=>{!ce.changed(c,"logLevel")||(U.logLevel=ce.get("logLevel"))}),o.onDidChangeRepositories(async c=>{for(const l of c.added)try{const d=await l.getMetadata(),{HEAD:h,defaultBranch:g,name:p,provider:y,pullRequest:m}=d,v=h.name.replace(/\//g,"\u2009\u2215\u2009");let S=" ";if(m!==void 0)S=` (PR ${m.id}) `;else if(h.type===me.Tag)S=` (${v}) `;else if(h.type===me.Commit)S=` (${v}) `;else if(h.type===me.Branch||h.type===me.RemoteBranch){const x=h.branch.name.replace(/\//g,"\u2009\u2215\u2009");h.branch.name!==g.name&&(S=` (${x})`)}const w={uri:l.uri,type:"folder",label:`${p}${S}[${y.name}]`};f.commands.executeCommand("_workbench.addToRecentlyOpened",w)}catch(d){U.error(d,"Failed to add repository to recently opened")}}),new tp(o),new xa(o),new op(o,n),...kv(o,t.extension.id,n),...Qw(o,n),...await Gw(o,a,t,n),new ip(o),new fp(o,e,n),a,sc,o,n),n.publicLog2("activate"),Promise.resolve(s)}catch(o){throw U.error(o),o}}u(jw,"activate");async function Gw(t,e,n,r){const i=[];if(vp()){const o=new kg(t,r);t.registerVirtualIndexProvider("github",o),t.registerVirtualIndexProvider("azurerepos",o),i.push(o)}return i.push(Kw(t,e)),i}u(Gw,"registerProviders");function Kw(t,e){async function n(){var i;try{let o=(i=f.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?i:f.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");o||(U.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(h=>{const g=f.extensions.onDidChange(()=>{var p;o=(p=f.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?p:f.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),o&&(g.dispose(),h())})})),U.log("[ GHPR] Registering..."),Cn(lr.HasPullRequestExtension,!0);const a=await o.activate();if(!a)throw new Error("Unable to get registration api");const s=a.registerGitProvider(e),c=t.onDidChangeRepositories(h=>l(h));async function l(h){const g=h.added.filter(p=>p.provider.id==="github");if(g.length!==0){U.log("[ GHPR] Checking for opened PRs...");for(const p of g){const y=await t.getBestRemoteUri(p.uri,Ln.PullRequest);if(!!y){c.dispose(),U.log("[ GHPR] Opened PR found; preloading"),f.commands.executeCommand("github.api.preloadPullRequest",y.toString());return}}U.log("[ GHPR] No opened PRs found")}}u(l,"onRepositoriesChanged"),U.log("[ GHPR] Registration complete");const d=t.repositories;return d.length&&l({added:d,removed:[]}),f.Disposable.from(s,c)}catch(o){return U.error(o,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}u(n,"registerWithGHPR");const r=n();return f.Disposable.from({dispose:async()=>{var i;return void((i=await r)==null?void 0:i.dispose())}})}u(Kw,"registerGitHub");function Qw(t,e){if(!vp())return[];e.publicLog2("codex.enableRichNav",{});const n=new kf(t);return[n,n.register(new Eu(e)),...Eu.createStatus()]}u(Qw,"registerNavigationServiceProviders");function vp(){return f.env.uiKind===f.UIKind.Desktop||ce.get("richNavigation.enabled")===!0}u(vp,"isRichNavEnabled");const ju=new Map,Gu=new Map;async function Wt(t,e){var n,r,i;if(e!==void 0&&typeof e!="string"&&(e=Ht.getProviderId(e)),e&&Gu.has(e)){const o=Gu.get(e);if(!o)return;await ju.get(o);return}for(const o of f.extensions.all){const a=o.id,{contributes:s}=o.packageJSON;if(!s||!["github.remotehub","ms-vscode.azure-repos"].includes(a.toLowerCase()))continue;const c=ju.get(a),l=(r=(n=s.virtualWorkspaces)==null?void 0:n.providers)!=null?r:[],d=l.find(g=>g===e)!==void 0,h=l.length&&e===void 0;if(!c&&(h||d)){const g=(i=f.extensions.getExtension(a))==null?void 0:i.activate().then(p=>p.registerVirtualProviderService(t));if(g===void 0)return;ju.set(a,g);for(const p of l)Gu.set(p,a);if(await g,e!==void 0&&d)return}else c&&await c}}u(Wt,"ensureProvidersRegistered")})(),module.exports=hc})();
