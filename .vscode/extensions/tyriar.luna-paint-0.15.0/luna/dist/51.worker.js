"use strict";const a3_0x1124=["smoothing","strokeStyle","floor",'" dimensions differ',"toRgba","isInteger","toHsl","Could not attain 2d context","top","rgba(","getContext","createReadonlyRgbaColor","createReadonlyHsvColor","max","pointA","toHsv","abs","The line can not be drawn outside of the selection and viewport","ceil","357905mWkpvj","moveTo","bottom","strokeWidth",")->(","27RGoCgs","blendMode","selection","261691xhMsOm","2444875adXPSL","update","webpackChunkluna","length","rgba","createRgbColor","pointB","lineTo","getImageData","buffer","data","709303QCvbTt","targetImage","createReadonlyRgbColor","cos","325883OUDEdW",'Range "',"height","right","type","push","replace","createEmptyRgbColor","createEmptyRgbaColor","3GcZTQF","createHslColor",'": ',"left","subarray","createHsvColor","SharedArrayBuffer",'Invalid dimensions for image "',"color",'" dimensions are equal'," must be contained within ","createRgbaColor","createEmptyHslColor","createEmptyHsvColor","min","pow","sin","1288516otcyOQ",'" and "',"width","round","set","18536jtaBdN","stroke","toRgb",'Images "'],a3_0x595d=function(t,n){return a3_0x1124[t-=308]},a3_0x3ced8e=a3_0x595d;!function(t,n){const o=a3_0x595d;for(;;)try{if(846243===-parseInt(o(372))*parseInt(o(319))+-parseInt(o(369))*-parseInt(o(341))+parseInt(o(310))+-parseInt(o(336))+-parseInt(o(384))+parseInt(o(364))+parseInt(o(373)))break;t.push(t.shift())}catch(n){t.push(t.shift())}}(a3_0x1124),(self.webpackChunkluna=self[a3_0x3ced8e(375)]||[])[a3_0x3ced8e(315)]([[51],{51:(t,n,o)=>{o.r(n),o.d(n,{run:()=>h});var r=o(371),e=o(517),a=o(587),c=o(939),i=o(3),s=o(742);const h=async(t,n,o)=>{const h=a3_0x595d;return(0,s.ap)(o,h(385)),!o[h(345)]&&o[h(367)]<=1?function(t){const n=a3_0x595d,o=t[n(359)],s=t.pointB;o.x=Math.round(o.x),o.y=Math[n(339)](o.y),s.x=Math[n(339)](s.x),s.y=Math[n(339)](s.y);const h=t[n(385)][n(338)],f=t[n(385)].width,u=(0,i.tH)(o.x,o.y,s.x,s.y);if(u[n(322)]=(0,c.u)(Math.floor(u.left),h,0),u.right=(0,c.u)(Math[n(363)](u[n(313)]),h,0),u[n(353)]=(0,c.u)(Math[n(363)](u[n(353)]),f,0),u.bottom=(0,c.u)(Math[n(363)](u[n(366)]),f,0),t[n(371)]&&(t[n(371)].left>u[n(322)]&&(u[n(322)]=Math.min(t[n(371)][n(322)],u[n(313)])),t.selection[n(313)]<u[n(313)]&&(u.right=Math[n(358)](t.selection[n(313)],u[n(322)])),t[n(371)].top>u[n(353)]&&(u[n(353)]=Math.min(t[n(371)].top,u.bottom)),t[n(371)][n(366)]<u.bottom&&(u[n(366)]=Math[n(358)](t[n(371)].bottom,u[n(353)]))),u[n(322)]===u[n(313)]||u[n(353)]===u.bottom)throw new Error("The line can not be drawn outside of the selection and viewport");let l=(0,r.X$)(Math.max((0,i.Oq)(u),(0,i.rY)(u)),h*f*4,!0),d=new Uint8Array(new SharedArrayBuffer(4*l.length)),M=new Uint8Array(new SharedArrayBuffer(4*l.length)),x=0,y=0;(0,a.j)(t.color,o.x,o.y,s.x,s.y,((o,a,c)=>{const i=n;o<u[i(322)]||o>=u[i(313)]||a<u[i(353)]||a>=u.bottom||(x>=l.length&&(l=(0,r.Rs)(l),d=(0,r.Rs)(d),M=(0,r.Rs)(M)),y=4*(a*h+o),l[x]=y,(0,r.Yr)(d,4*x,t[i(385)][i(383)],y),"replace"===t[i(370)]?t[i(385)][i(383)][i(340)](c,y):(0,e.B)(t[i(370)],t.targetImage[i(383)],y,c,0),(0,r.Yr)(M,4*x++,t[i(385)][i(383)],y))}),t[n(345)],t[n(367)]);const g=l[n(323)](0,x);return{undoData:{indexList:g,colorData:d[n(323)](0,4*x)},redoData:{indexList:g,colorData:M[n(323)](0,4*x)},range:u}}(o):function(t,n){const o=a3_0x595d,a=n.pointA,s=n[o(379)],h=n[o(385)].width,f=n[o(385)].height,u=(0,i.tH)(a.x+.5,a.y+.5,s.x+.5,s.y+.5);u.left=Math.floor(u[o(322)]),u[o(313)]=Math[o(363)](u[o(313)]),u[o(353)]=Math.floor(u[o(353)]),u[o(366)]=Math[o(363)](u[o(366)]);const l=Math[o(363)](n.strokeWidth/2);if(u.left-=l,u[o(313)]+=l,u[o(353)]-=l,u[o(366)]+=l,u[o(322)]=(0,c.u)(Math[o(347)](u[o(322)]),h,0),u[o(313)]=(0,c.u)(Math[o(363)](u[o(313)]),h,0),u[o(353)]=(0,c.u)(Math[o(363)](u[o(353)]),f,0),u.bottom=(0,c.u)(Math.ceil(u.bottom),f,0),n[o(371)]&&(n[o(371)][o(322)]>u[o(322)]&&(u[o(322)]=Math[o(333)](n[o(371)][o(322)],u[o(313)])),n.selection.right<u.right&&(u[o(313)]=Math[o(358)](n[o(371)].right,u.left)),n[o(371)][o(353)]>u[o(353)]&&(u.top=Math[o(333)](n.selection.top,u[o(366)])),n[o(371)][o(366)]<u.bottom&&(u[o(366)]=Math[o(358)](n[o(371)].bottom,u[o(353)]))),u[o(322)]===u[o(313)]||u[o(353)]===u[o(366)])throw new Error(o(362));const d=(0,i.Oq)(u),M=(0,i.rY)(u),x=.5,y=.5,g=.5,m=.5,w=new OffscreenCanvas(d,M)[o(355)]("2d");if(!w)throw new Error(o(352));w[o(346)]=o(354)+n[o(327)][0]+","+n[o(327)][1]+","+n[o(327)][2]+","+n.color[3]/255+")",w.lineWidth=n[o(367)],w.beginPath(),n[o(345)]||n[o(367)]%2!=0?(w.moveTo(a.x-u[o(322)]+x,a.y-u[o(353)]+y),w[o(380)](s.x-u[o(322)]+g,s.y-u[o(353)]+m)):(w[o(365)](Math[o(339)](a.x-u.left+x),Math[o(339)](a.y-u.top+y)),w[o(380)](Math[o(339)](s.x-u[o(322)]+g),Math[o(339)](s.y-u[o(353)]+m))),w[o(342)]();const b=w[o(381)](0,0,d,M),p=(0,r.X$)(h*f,h*f*4,!0),_=(0,r.X$)(h*f*2,Math.max(h,f),!0);let A=0,v=0,R=0,C=0;if(n[o(345)])for(R=0;R<M;R++)for(v=0;v<d;v++)C=4*(R*d+v),b[o(383)][C+3]>0&&(_[2*A]=v,_[2*A+1]=R,p[A++]=4*((u[o(353)]+R)*h+u[o(322)]+v));else for(R=0;R<M;R++)for(v=0;v<d;v++)C=4*(R*d+v),b[o(383)][C+3]>n[o(327)][3]/2&&(b[o(383)][C+3]=n[o(327)][3],_[2*A]=v,_[2*A+1]=R,p[A++]=4*((u.top+R)*h+u[o(322)]+v));const U=p[o(323)](0,A);t.update(.25);const B=new Uint8Array(new SharedArrayBuffer(4*p[o(376)]));for(C=0;C<p[o(376)];C++)(0,r.Yr)(B,4*C,n[o(385)][o(383)],p[C]);if(t[o(374)](.5),"replace"===n[o(370)])for(C=0;C<U[o(376)];C++)(0,r.Yr)(n[o(385)][o(383)],U[C],b.data,4*(_[2*C+1]*d+_[2*C]));else for(C=0;C<U[o(376)];C++)(0,e.B)(n[o(370)],n[o(385)].data,U[C],b[o(383)],4*(_[2*C+1]*d+_[2*C]));t[o(374)](.75);const I=new Uint8Array(new SharedArrayBuffer(4*p.length));for(C=0;C<p.length;C++)(0,r.Yr)(I,4*C,n[o(385)][o(383)],p[C]);return t[o(374)](1),{undoData:{indexList:U,colorData:B},redoData:{indexList:U,colorData:I},range:u}}(n,o)}},742:(t,n,o)=>{o.d(n,{ap:()=>e,TO:()=>a,zg:()=>c});var r=o(3);function e(t,n){const o=a3_0x595d,r=t[n];if(r[o(338)]<1||r.height<1)throw new Error(o(326)+n+o(321)+r[o(338)]+" x "+r[o(312)])}function a(t,n,o){const r=a3_0x595d,e=t[n],a=t[o];if(e[r(338)]===a[r(338)]&&e[r(312)]===a[r(312)])throw new Error(r(344)+n+r(337)+o+r(328))}function c(t,n,o){const e=a3_0x595d,a=t[n];if(!(0,r.ur)(o,a))throw new Error(e(311)+n+'" '+(0,r.PW)(a)+e(329)+(0,r.PW)(o))}},371:(t,n,o)=>{const r=a3_0x3ced8e;function e(t,n=2*t[r(376)]){const o=r;let e;if(t instanceof Float32Array)e=new Float32Array(n);else if(t instanceof Uint8Array)e=new Uint8Array(n);else if(t instanceof Uint16Array)e=new Uint16Array(n);else{if(!(t instanceof Uint32Array))throw new Error("Unrecognized array type");e=new Uint32Array(n)}return e[o(340)](t),e}function a(t,n,o=!1){const e=r;return n<Math[e(334)](2,8)?o?new Uint8Array(new SharedArrayBuffer(t)):new Uint8Array(t):n<Math[e(334)](2,16)?o?new Uint16Array(new SharedArrayBuffer(2*t)):new Uint16Array(t):o?new Uint32Array(new SharedArrayBuffer(4*t)):new Uint32Array(t)}function c(t,n,o,r){t[n]=o[r],t[n+1]=o[r+1],t[n+2]=o[r+2],t[n+3]=o[r+3]}o.d(n,{Rs:()=>e,X$:()=>a,Yr:()=>c})},517:(t,n,o)=>{const r=a3_0x3ced8e;o.d(n,{B:()=>s});var e=o(371);const a=new Float32Array(6);let c;const i={normal:(t,n)=>n,darken:(t,n)=>Math[r(333)](t,n),multiply:(t,n)=>t*n,linearBurn:(t,n)=>Math[r(358)](t+n-1,0),lighten:(t,n)=>Math.max(t,n),screen:(t,n)=>1-(1-t)*(1-n),linearDodgeAdd:(t,n)=>Math[r(333)](t+n,1),overlay:(t,n)=>t<.5?2*t*n:1-2*(1-t)*(1-n),softLight:(t,n)=>n<.5?2*t*n+t*t*(1-2*n):Math.sqrt(t)*(2*n-1)+2*t*(1-n),difference:(t,n)=>Math[r(361)](t-n),exclusion:(t,n)=>t+n-2*t*n};function s(t,n,o,s,f,u=n,l=o){const d=r;if(t!==d(316)){if(a[0]=s[f+3]/255,0===a[0])return n[o]=u[l],n[o+1]=u[l+1],n[o+2]=u[l+2],void(n[o+3]=u[l+3]);if(a[1]=u[l+3]/255,0===a[1])return n[o]=s[f],n[o+1]=s[f+1],n[o+2]=s[f+2],void(n[o+3]=s[f+3]);c=i[t],a[3]=c(u[l]/255,s[f]/255),a[4]=c(u[l+1]/255,s[f+1]/255),a[5]=c(u[l+2]/255,s[f+2]/255),a[2]=a[0]+a[1]*(1-a[0]),n[o]=Math[d(339)](h(u[l]/255,a[1],s[f]/255,a[0],a[3])/a[2]*255),n[o+1]=Math[d(339)](h(u[l+1]/255,a[1],s[f+1]/255,a[0],a[4])/a[2]*255),n[o+2]=Math.round(h(u[l+2]/255,a[1],s[f+2]/255,a[0],a[5])/a[2]*255),n[o+3]=Math[d(339)](255*a[2])}else(0,e.Yr)(n,o,s,f)}function h(t,n,o,r,e){return(n-n*r)*t+(r-n*r)*o+n*r*e}},587:(t,n,o)=>{o.d(n,{j:()=>s});var r,e,a,c,i=o(939);function s(t,n,o,r,e,a,c,i=1){c?function(t,n,o,r,e,a,c){const i=a3_0x595d;c<1&&(t=d(t,c));const s=Math.abs(e-o)>Math[i(361)](r-n);let h=0;s&&(h=n,n=o,o=h,h=r,r=e,e=h),n>r&&(h=n,n=r,r=h,h=o,o=e,e=h);const f=r-n;let M=(e-o)/f;0===f&&(M=1);let x=Math[i(339)](n),y=o+M*(x-n),g=l(n+.5);const m=x,w=Math[i(347)](y);let b=u(y)*g;s?(a(w,m,d(t,l(y)*g)),b>0&&a(w+1,m,d(t,b))):(a(m,w,d(t,l(y)*g)),b>0&&a(m,w+1,d(t,b)));let p=y+M;x=Math[i(339)](r),y=e+M*(x-r),g=u(r+.5);const _=x,A=Math[i(347)](y);if(b=u(y)*g,s?(a(A,_,d(t,l(y)*g)),b>0&&a(A+1,_,d(t,u(y)*g))):(a(_,A,d(t,l(y)*g)),b>0&&a(_,A+1,d(t,u(y)*g))),s)for(let n=m+1;n<_;n++)a(Math[i(347)](p),n,d(t,l(p))),b=u(p),b>0&&a(Math.floor(p)+1,n,d(t,b)),p+=M;else for(let n=m+1;n<_;n++)a(n,Math[i(347)](p),d(t,l(p))),b=u(p),b>0&&a(n,Math[i(347)](p)+1,d(t,b)),p+=M}(t,n,o,r,e,a,i):function(t,n,o,r,e,a,c){const i=a3_0x595d;c<1&&(t=d(t,c)),Math.abs(e-o)<Math[i(361)](r-n)?n>r?h(t,r,e,n,o,a):h(t,n,o,r,e,a):o>e?f(t,r,e,n,o,a):f(t,n,o,r,e,a)}(t,n,o,r,e,a,i)}function h(t,n,o,r,e,a){const c=r-n;let i=e-o,s=1;i<0&&(s=-1,i=-i);let h=2*i-c,f=o;for(let o=n;o<=r;o++)a(o,f,t),h>0?(f+=s,h+=2*(i-c)):h+=2*i}function f(t,n,o,r,e,a){let c=r-n;const i=e-o;let s=1;c<0&&(s=-1,c=-c);let h=2*c-i,f=n;for(let n=o;n<=e;n++)a(f,n,t),h>0?(f+=s,h+=2*(c-i)):h+=2*c}function u(t){return t%1}function l(t){return 1-t%1}function d(t,n){const o=a3_0x595d;if(void 0!==t)return e[o(356)](t[0],t[1],t[2],Math[o(339)](t[3]*n))}!function(t){const n=a3_0x595d;function o(){const t=a3_0x595d,n=new Float32Array(3);return n[t(314)]="rgb",n}function r(t,n,r){const e=o();return e[0]=t,e[1]=n,e[2]=r,e}t[n(317)]=o,t[n(378)]=r,t[n(308)]=function(t,n,o){return r(t,n,o)},t[n(360)]=function(t,o){const r=n,e=t[0]/255,a=t[1]/255,s=t[2]/255,h=Math[r(358)](e,a,s),f=h-Math[r(333)](e,a,s);let u;u=0===f?0:h===e?(a-s)/f%6:h===a?(s-e)/f+2:(e-a)/f+4,u=Math[r(339)](60*u),u<0&&(u+=360);const l=(0,i.s)(0===h?0:f/h,2),d=(0,i.s)(h,2);return void 0!==o&&(0===l||0===d)&&(u=o),c[r(357)](u,l,d)},t[n(351)]=function(t){const o=n,r=a[o(331)](),e=t[0]/255,c=t[1]/255,i=t[2]/255,s=Math.max(e,c,i),h=Math[o(333)](e,c,i),f=s-h,u=(s+h)/2;return r[0]=0===f?0:s===e?(c-i)/f%6:s===c?(i-e)/f+2:(e-c)/f+4,r[0]=Math[o(339)](60*r[0]),r[0]<0&&(r[0]+=360),r[1]=0===f?0:f/(1-Math.abs(2*u-1)),r[2]=u,r},t.toRgba=function(t,o){return e[n(330)](t[0],t[1],t[2],o)}}(r||(r={})),function(t){const n=a3_0x595d;function o(){const t=a3_0x595d,n=new Float32Array(4);return n[t(314)]=t(377),n}function e(t,n,r,e=255){const a=o();return a[0]=t,a[1]=n,a[2]=r,a[3]=e,a}t[n(318)]=o,t[n(330)]=e,t[n(356)]=function(t,n,o,r=255){return e(t,n,o,r)},t[n(343)]=function(t){return r[n(308)](t[0],t[1],t[2])}}(e||(e={})),function(t){const n=a3_0x595d;function o(){const t=a3_0x595d,n=new Float32Array(3);return n[t(314)]="hsl",n}function r(t,n,r){const e=o();return e[0]=t,e[1]=n,e[2]=r,e}t.createEmptyHslColor=o,t[n(320)]=r,t.createReadonlyHslColor=function(t,n,o){return r(t,n,o)},t.toRgba=function(t,o=255){const r=n,a=e[r(318)]();a[3]=o;const c=(1-Math[r(361)](2*t[2]-1))*t[1],i=c*(1-Math.abs(t[0]/60%2-1)),s=t[2]-c/2;return t[0]<60?(a[0]=c,a[1]=i,a[2]=0):t[0]<120?(a[0]=i,a[1]=c,a[2]=0):t[0]<180?(a[0]=0,a[1]=c,a[2]=i):t[0]<240?(a[0]=0,a[1]=i,a[2]=c):t[0]<300?(a[0]=i,a[1]=0,a[2]=c):(a[0]=c,a[1]=0,a[2]=i),a[0]=Math[r(339)](255*(a[0]+s)),a[1]=Math[r(339)](255*(a[1]+s)),a[2]=Math.round(255*(a[2]+s)),a}}(a||(a={})),function(t){const n=a3_0x595d;function o(){const t=a3_0x595d,n=new Float32Array(3);return n[t(314)]="hsv",n}function a(t,n,r){const e=o();return e[0]=t,e[1]=n,e[2]=r,e}function c(t){const o=n,e=r[o(317)](),a=t[2]*t[1],c=a*(1-Math[o(361)](t[0]/60%2-1)),i=t[2]-a;return t[0]<60?(e[0]=a,e[1]=c,e[2]=0):t[0]<120?(e[0]=c,e[1]=a,e[2]=0):t[0]<180?(e[0]=0,e[1]=a,e[2]=c):t[0]<240?(e[0]=0,e[1]=c,e[2]=a):t[0]<300?(e[0]=c,e[1]=0,e[2]=a):(e[0]=a,e[1]=0,e[2]=c),e[0]=Math[o(339)](255*(e[0]+i)),e[1]=Math[o(339)](255*(e[1]+i)),e[2]=Math.round(255*(e[2]+i)),e}t[n(332)]=o,t[n(324)]=a,t.createReadonlyHsvColor=function(t,n,o){return a(t,n,o)},t[n(343)]=c,t[n(349)]=function(t,o=255){const r=n,a=c(t);return e[r(330)](a[0],a[1],a[2],(0,i.u)(o,255,0))}}(c||(c={}))},939:(t,n,o)=>{function r(t,n,o=0){const r=a3_0x595d;return Math[r(358)](Math[r(333)](t,n),o)}function e(t,n){const o=a3_0x595d,r=Math[o(334)](10,n);return Math[o(339)](t*r)/r}o.d(n,{u:()=>r,s:()=>e})},3:(t,n,o)=>{function r(t){const n=a3_0x595d;if(t)return{left:t[n(322)],top:t[n(353)],right:t[n(313)],bottom:t[n(366)]}}function e(t,n){return{left:t,top:n,right:t+1,bottom:n+1}}function a(t,n){return{left:0,top:0,right:t,bottom:n}}function c(t,n,o,r){const e=a3_0x595d,a=function(t){const n=a3_0x595d;if(t[n(322)]>t[n(313)]){const o=t[n(313)];t[n(313)]=t.left,t[n(322)]=o}if(t[n(353)]>t[n(366)]){const o=t[n(366)];t[n(366)]=t[n(353)],t[n(353)]=o}if(t.right<t[n(322)]){const o=t.left;t[n(322)]=t[n(313)],t[n(313)]=o}if(t[n(366)]<t[n(353)]){const o=t[n(353)];t.top=t.bottom,t[n(366)]=o}return t}({left:t,top:n,right:o,bottom:r});return a[e(313)]++,a[e(366)]++,a}function i(t,n){const o=a3_0x595d;return t[o(322)]=Math[o(333)](Math[o(358)](t[o(322)],n[o(322)]),n[o(313)]),t[o(353)]=Math.min(Math.max(t[o(353)],n[o(353)]),n[o(366)]),t[o(313)]=Math.max(Math[o(333)](t[o(313)],n[o(313)]),n[o(322)]),t.bottom=Math[o(358)](Math[o(333)](t[o(366)],n.bottom),n[o(353)]),t}function s(t){const n=a3_0x595d;return t[n(322)]=Math[n(347)](t[n(322)]),t[n(313)]=Math[n(363)](t.right),t[n(353)]=Math[n(347)](t[n(353)]),t.bottom=Math[n(363)](t.bottom),t}function h(t,n,o){const r=a3_0x595d;if(function(t){const n=a3_0x595d;return t.left===t[n(313)]||t[n(353)]===t[n(366)]}(t))return t[r(322)]=n,t[r(313)]=n+1,t[r(353)]=o,void(t[r(366)]=o+1);t[r(322)]=Math[r(333)](t.left,n),t[r(353)]=Math[r(333)](t[r(353)],o),t[r(313)]=Math[r(358)](t[r(313)],n+1),t[r(366)]=Math.max(t[r(366)],o+1)}function f(t,n,o){const r=a3_0x595d;return n>=t.left&&n<t[r(313)]&&o>=t.top&&o<t[r(366)]}function u(t,n){const o=a3_0x595d;return n[o(322)]>=t[o(322)]&&n[o(313)]<=t[o(313)]&&n[o(353)]>=t[o(353)]&&n[o(366)]<=t.bottom}function l(t){const n=a3_0x595d;return"("+t.left+","+t.top+n(368)+t[n(313)]+","+t.bottom+")"}function d(t){const n=a3_0x595d;return t[n(313)]-t[n(322)]}function M(t){const n=a3_0x595d;return t[n(366)]-t[n(353)]}o.d(n,{BN:()=>r,Re:()=>e,DI:()=>a,tH:()=>c,l$:()=>i,kq:()=>s,Hv:()=>h,RB:()=>f,ur:()=>u,PW:()=>l,Oq:()=>d,rY:()=>M})}}]);