"use strict";const a51_0x6f9c=["moveTo","11WYWkbY","smoothing","5sfCDrx","22357MlrBsU","The line can not be drawn outside of the selection and viewport","sqrt","replace","68577Mdtajm","update","Could not attain 2d context","targetImage","subarray",'Range "','" and "',"left","webpackChunkluna","height","getImageData","right","abs","data","width","min","ceil","blendMode","pointB","max",'": ',"createReadonlyRgbaColor","34KoqDQp","strokeWidth","push","stroke","72953MWyCIw","strokeStyle","top","floor","round","17218hZlfrz",'" dimensions differ',"464561DdHEev",'" dimensions are equal',"14JzCVPO","lineTo","pointA","pow","selection","getContext","cos","rgba(","set","20tEmmyG","39481oHqxgY",'Images "',"length",'Invalid dimensions for image "',"atan2","1528883jaSSNn","color","beginPath","bottom"],a51_0x5513=function(t,a){return a51_0x6f9c[t-=150]},a51_0x26008e=a51_0x5513;!function(t,a){const n=a51_0x5513;for(;;)try{if(834672===-parseInt(n(170))*-parseInt(n(161))-parseInt(n(189))+-parseInt(n(165))*parseInt(n(196))+parseInt(n(183))*parseInt(n(201))+parseInt(n(197))*-parseInt(n(194))+parseInt(n(172))+-parseInt(n(174))*-parseInt(n(184)))break;t.push(t.shift())}catch(a){t.push(t.shift())}}(a51_0x6f9c),(self.webpackChunkluna=self[a51_0x26008e(209)]||[])[a51_0x26008e(163)]([[6051],{6051:(t,a,n)=>{n.r(a),n.d(a,{run:()=>c});var e=n(4371),o=n(7517),r=n(1019),h=n(2939),i=n(1003),s=n(7742);const c=async(t,a,n)=>{const c=a51_0x5513;return(0,s.ap)(n,"targetImage"),!n[c(195)]&&n[c(162)]<=1?function(t){const a=a51_0x5513,n=t[a(176)],s=t[a(157)];n.x=Math[a(169)](n.x),n.y=Math[a(169)](n.y),s.x=Math.round(s.x),s.y=Math[a(169)](s.y);const c=t.targetImage[a(153)],f=t[a(204)][a(153)],l=(0,i.tH)(n.x,n.y,s.x,s.y);if(l.left=(0,h.u)(Math.floor(l[a(208)]),c,0),l[a(150)]=(0,h.u)(Math[a(155)](l[a(150)]),c,0),l[a(167)]=(0,h.u)(Math.ceil(l.top),f,0),l[a(192)]=(0,h.u)(Math[a(155)](l[a(192)]),f,0),t[a(178)]&&(t[a(178)][a(208)]>l[a(208)]&&(l[a(208)]=Math[a(154)](t[a(178)].left,l.right)),t[a(178)].right<l[a(150)]&&(l[a(150)]=Math[a(158)](t[a(178)].right,l[a(208)])),t[a(178)].top>l[a(167)]&&(l.top=Math[a(154)](t.selection[a(167)],l[a(192)])),t[a(178)][a(192)]<l[a(192)]&&(l[a(192)]=Math[a(158)](t[a(178)].bottom,l[a(167)]))),l.left===l[a(150)]||l[a(167)]===l.bottom)throw new Error("The line can not be drawn outside of the selection and viewport");let u=(0,e.X$)(Math[a(158)]((0,i.Oq)(l),(0,i.rY)(l)),c*f*4,!0),M=new Uint8Array(new SharedArrayBuffer(4*u[a(186)])),d=new Uint8Array(new SharedArrayBuffer(4*u[a(186)])),x=0,g=0;(0,r.j)(t[a(190)],n.x,n.y,s.x,s.y,((n,r,h)=>{const i=a;n<l.left||n>=l.right||r<l.top||r>=l[i(192)]||(x>=u[i(186)]&&(u=(0,e.Rs)(u),M=(0,e.Rs)(M),d=(0,e.Rs)(d)),g=4*(r*c+n),u[x]=g,(0,e.Yr)(M,4*x,t[i(204)][i(152)],g),"replace"===t.blendMode?t[i(204)][i(152)][i(182)](h,g):(0,o.B)(t.blendMode,t[i(204)].data,g,h,0),(0,e.Yr)(d,4*x++,t.targetImage.data,g))}),t[a(195)],t[a(162)]);const p=u[a(205)](0,x);return{undoData:{indexList:p,colorData:M[a(205)](0,4*x)},redoData:{indexList:p,colorData:d[a(205)](0,4*x)},range:l}}(n):function(t,a){const n=a51_0x5513,r=a[n(176)],s=a[n(157)],c=a[n(204)][n(153)],f=a.targetImage[n(210)],l=(0,i.tH)(r.x+.5,r.y+.5,s.x+.5,s.y+.5);l[n(208)]=Math[n(168)](l[n(208)]),l[n(150)]=Math.ceil(l[n(150)]),l[n(167)]=Math[n(168)](l[n(167)]),l.bottom=Math.ceil(l.bottom);const u=Math[n(155)](a[n(162)]/2);if(l.left-=u,l[n(150)]+=u,l[n(167)]-=u,l.bottom+=u,l[n(208)]=(0,h.u)(Math.floor(l[n(208)]),c,0),l[n(150)]=(0,h.u)(Math.ceil(l.right),c,0),l[n(167)]=(0,h.u)(Math.ceil(l[n(167)]),f,0),l[n(192)]=(0,h.u)(Math[n(155)](l.bottom),f,0),a[n(178)]&&(a[n(178)][n(208)]>l[n(208)]&&(l.left=Math[n(154)](a[n(178)][n(208)],l[n(150)])),a[n(178)].right<l.right&&(l[n(150)]=Math[n(158)](a[n(178)][n(150)],l[n(208)])),a[n(178)][n(167)]>l.top&&(l[n(167)]=Math[n(154)](a.selection.top,l[n(192)])),a[n(178)][n(192)]<l.bottom&&(l[n(192)]=Math[n(158)](a[n(178)][n(192)],l[n(167)]))),l[n(208)]===l[n(150)]||l[n(167)]===l.bottom)throw new Error(n(198));const M=(0,i.Oq)(l),d=(0,i.rY)(l),x=.5,g=.5,p=.5,y=.5,w=new OffscreenCanvas(M,d)[n(179)]("2d");if(!w)throw new Error(n(203));w[n(166)]=n(181)+a[n(190)][0]+","+a.color[1]+","+a[n(190)][2]+","+a[n(190)][3]/255+")",w.lineWidth=a[n(162)],w[n(191)](),a.smoothing||a[n(162)]%2!=0?(w[n(193)](r.x-l[n(208)]+x,r.y-l.top+g),w[n(175)](s.x-l[n(208)]+p,s.y-l[n(167)]+y)):(w[n(193)](Math[n(169)](r.x-l[n(208)]+x),Math.round(r.y-l[n(167)]+g)),w[n(175)](Math[n(169)](s.x-l[n(208)]+p),Math[n(169)](s.y-l.top+y))),w[n(164)]();const m=w[n(211)](0,0,M,d),b=(0,e.X$)(c*f,c*f*4,!0),I=(0,e.X$)(c*f*2,Math[n(158)](c,f),!0);let _=0,D=0,v=0,k=0;if(a.smoothing)for(v=0;v<d;v++)for(D=0;D<M;D++)k=4*(v*M+D),m[n(152)][k+3]>0&&(I[2*_]=D,I[2*_+1]=v,b[_++]=4*((l[n(167)]+v)*c+l[n(208)]+D));else for(v=0;v<d;v++)for(D=0;D<M;D++)k=4*(v*M+D),m[n(152)][k+3]>a[n(190)][3]/2&&(m[n(152)][k+3]=a[n(190)][3],I[2*_]=D,I[2*_+1]=v,b[_++]=4*((l[n(167)]+v)*c+l[n(208)]+D));const A=b[n(205)](0,_);t[n(202)](.25);const Y=new Uint8Array(new SharedArrayBuffer(4*b.length));for(k=0;k<b[n(186)];k++)(0,e.Yr)(Y,4*k,a[n(204)].data,b[k]);if(t[n(202)](.5),a[n(156)]===n(200))for(k=0;k<A[n(186)];k++)(0,e.Yr)(a[n(204)][n(152)],A[k],m.data,4*(I[2*k+1]*M+I[2*k]));else for(k=0;k<A[n(186)];k++)(0,o.B)(a[n(156)],a[n(204)][n(152)],A[k],m[n(152)],4*(I[2*k+1]*M+I[2*k]));t.update(.75);const C=new Uint8Array(new SharedArrayBuffer(4*b[n(186)]));for(k=0;k<b.length;k++)(0,e.Yr)(C,4*k,a[n(204)][n(152)],b[k]);return t[n(202)](1),{undoData:{indexList:A,colorData:Y},redoData:{indexList:A,colorData:C},range:l}}(a,n)}},7742:(t,a,n)=>{n.d(a,{ap:()=>o,TO:()=>r,zg:()=>h});var e=n(1003);function o(t,a){const n=a51_0x5513,e=t[a];if(e[n(153)]<1||e[n(210)]<1)throw new Error(n(187)+a+n(159)+e.width+" x "+e[n(210)])}function r(t,a,n){const e=a51_0x5513,o=t[a],r=t[n];if(o[e(153)]===r[e(153)]&&o.height===r[e(210)])throw new Error(e(185)+a+e(207)+n+e(173))}function h(t,a,n){const o=a51_0x5513,r=t[a];if(!(0,e.ur)(n,r))throw new Error(o(206)+a+'" '+(0,e.PW)(r)+" must be contained within "+(0,e.PW)(n))}},1019:(t,a,n)=>{n.d(a,{X:()=>r,j:()=>h});var e=n(8752),o=n(9455);function r(t,a,n,e,r,h){const i=a51_0x5513,s=(0,o.zz)(t,a,n,e),c=.5*h*r*Math.sin(s),f=.5*h*r*Math[i(180)](s);return[{x:t-c,y:a-f},{x:t+c,y:a+f},{x:n+c,y:e+f},{x:n-c,y:e-f}]}function h(t,a,n,e,o,r,h,u=1){var M,d,x,g,p,y,w;h?function(t,a,n,e,o,r,h){const i=a51_0x5513;h<1&&(t=l(t,h));const s=Math[i(151)](o-n)>Math[i(151)](e-a);let u=0;s&&(u=a,a=n,n=u,u=e,e=o,o=u),a>e&&(u=a,a=e,e=u,u=n,n=o,o=u);const M=e-a;let d=(o-n)/M;0===M&&(d=1);let x=Math[i(169)](a),g=n+d*(x-a),p=f(a+.5);const y=x,w=Math[i(168)](g);let m=c(g)*p;s?(r(w,y,l(t,f(g)*p)),m>0&&r(w+1,y,l(t,m))):(r(y,w,l(t,f(g)*p)),m>0&&r(y,w+1,l(t,m)));let b=g+d;x=Math[i(169)](e),g=o+d*(x-e),p=c(e+.5);const I=x,_=Math[i(168)](g);if(m=c(g)*p,s?(r(_,I,l(t,f(g)*p)),m>0&&r(_+1,I,l(t,c(g)*p))):(r(I,_,l(t,f(g)*p)),m>0&&r(I,_+1,l(t,c(g)*p))),s)for(let a=y+1;a<I;a++)r(Math[i(168)](b),a,l(t,f(b))),m=c(b),m>0&&r(Math.floor(b)+1,a,l(t,m)),b+=d;else for(let a=y+1;a<I;a++)r(a,Math[i(168)](b),l(t,f(b))),m=c(b),m>0&&r(a,Math[i(168)](b)+1,l(t,m)),b+=d}(t,a,n,e,o,r,u):(M=t,d=a,x=n,g=e,p=o,y=r,(w=u)<1&&(M=l(M,w)),Math.abs(p-x)<Math.abs(g-d)?d>g?i(M,g,p,d,x,y):i(M,d,x,g,p,y):x>p?s(M,g,p,d,x,y):s(M,d,x,g,p,y))}function i(t,a,n,e,o,r){const h=e-a;let i=o-n,s=1;i<0&&(s=-1,i=-i);let c=2*i-h,f=n;for(let n=a;n<=e;n++)r(n,f,t),c>0?(f+=s,c+=2*(i-h)):c+=2*i}function s(t,a,n,e,o,r){let h=e-a;const i=o-n;let s=1;h<0&&(s=-1,h=-h);let c=2*h-i,f=a;for(let a=n;a<=o;a++)r(f,a,t),c>0?(f+=s,c+=2*(h-i)):c+=2*h}function c(t){return t%1}function f(t){return 1-t%1}function l(t,a){const n=a51_0x5513;if(void 0!==t)return e.m4[n(160)](t[0],t[1],t[2],Math.round(t[3]*a))}},9455:(t,a,n)=>{function e(t,a,n,e){return 180*o(t,a,n,e)/Math.PI}function o(t,a,n,e){let o=-Math[a51_0x5513(188)](e-a,n-t);return-180===o&&(o=180),o}function r(t){return t*Math.PI/180}function h(t,a,n,e,o,r){const h=a51_0x5513,i=Math.sqrt(Math[h(177)](t-n,2)+Math[h(177)](a-e,2)),s=Math[h(199)](Math[h(177)](n-o,2)+Math[h(177)](e-r,2)),c=Math.sqrt(Math[h(177)](o-t,2)+Math[h(177)](r-a,2)),f=(i+s+c)/2;return Math[h(199)](f*(f-i)*(f-s)*(f-c))}function i(t,a,n,e,o,r,i,s){return h(t,a,n,e,o,r)+h(n,e,o,r,i,s)+h(o,r,i,s,t,a)+h(i,s,t,a,n,e)}n.d(a,{AM:()=>e,zz:()=>o,Ht:()=>r,ku:()=>h,hu:()=>i})}}]);