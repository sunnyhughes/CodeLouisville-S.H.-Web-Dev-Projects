"use strict";const a12_0x259e=["getOutlineSvgPath","_sc","floor","pointerUp","zoom","exclusion","fill","_outlineModel","selectionService","string","removeChild","_onRequestRender","ellipse","onRequestRender","6SOkFUw","register","createDomRenderProgram","linearDodgeAdd","_onUpdate","display","1877ybMALi","rightTriangle","http://www.w3.org/2000/svg","containsCoord","range","683933EqFEqX","flipX","setAttribute","webpackChunkluna","left","atan2","block","_imageService","_setPixel","sin","softLight","clientWidth","default","422131txViai","difference","diamond","push","type","_value","_onHistoryUpdateValue","stroke","value","_svgPath2","getCoordsFromEvent","onHistoryUpdateValue","_container","height","string-combo","fire","41czXnsF","style","createElementNS","Eraser","3nDkMbd","number","lighten","86283wAINOX","_updateOutline","bind","none","_edit","width","darken","normal","order","allowUnchecking","212682GcBzNz","imageService","var(--luna-focusColor)","name","path","strokeWidth","currentLayer","multiply","208021jlMyth","then","viewportService","setValueFromHistoryChange","requestRender","options","_model","_viewportService","overlay","abs","pow","74119EMFDxh","pointerDownMove","_svgPath","event","sqrt","Brush Size","cos","triangle","position","append","flipY","transparent","max","linearBurn","toString","round","version","absolute","top","replace","createExtendedEdit","min","_brushSizeOption","screen","_drawLine","_lastCoord","onUpdate","_getEdit","_svg"],a12_0x4330=function(t,s){return a12_0x259e[t-=343]},a12_0x266927=a12_0x4330;!function(t,s){const e=a12_0x4330;for(;;)try{if(391709===-parseInt(e(436))*-parseInt(e(402))-parseInt(e(453))+parseInt(e(443))+parseInt(e(407))+-parseInt(e(353))*parseInt(e(396))+-parseInt(e(420))+-parseInt(e(461))*-parseInt(e(440)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a12_0x259e),(self[a12_0x266927(410)]=self[a12_0x266927(410)]||[])[a12_0x266927(423)]([[2996],{3315:(t,s,e)=>{e.d(s,{d:()=>a});var i=e(5120),n=e(1003),h=e(1674);let o,r;class a extends i.JT{constructor(t,s,e,i){const n=a12_0x4330;super(),this[n(432)]=t,this._imageService=s,this[n(349)]=e,this[n(348)]=i,this[n(451)]=2,this[n(381)]=document.createElementNS(h.q,"svg"),this[n(381)][n(409)](n(369),"1.1"),this[n(381)][n(437)][n(361)]=n(370),this[n(355)]=document[n(438)](h.q,n(457)),this[n(355)][n(437)][n(427)]=n(455),this[n(355)].style.fill=n(364),this[n(355)].style[n(458)]="1",this[n(429)]=document[n(438)](h.q,n(457)),this._svgPath2.style[n(427)]=n(455),this._svgPath2[n(437)][n(388)]="transparent",this[n(429)][n(437)][n(458)]="1",this[n(381)][n(362)](this[n(355)],this[n(429)]),this[n(432)].prepend(this._svg),this.register({dispose:()=>this._container[n(392)](this._svg)})}async render(){const t=a12_0x4330,s=this[t(348)][t(406)],i=this._viewportService;if(!s)return void(this[t(381)][t(437)][t(401)]=t(446));if(this[t(381)].style[t(401)]=t(413),!this._imageService[t(459)])return;if(o!==this[t(348)].shape){let s;switch(o=this[t(348)].shape,o){case t(422):s=e.e(727).then(e.bind(e,727));break;case t(394):s=e.e(8459)[t(343)](e[t(445)](e,8459));break;case t(360):s=e.e(4012)[t(343)](e.bind(e,4012));break;case t(403):s=e.e(6243)[t(343)](e.bind(e,6243));break;default:s=void 0}r=s?new Promise((async e=>{const i=t;e(new((await s)[i(419)]))})):s}const h=await r,a=Math.round(this[t(432)][t(418)]/2)-this._imageService[t(448)]/2*i[t(386)]+i.x*i.zoom,c=Math[t(368)](this._container.clientHeight/2)-this[t(414)][t(433)]/2*i[t(386)]+i.y*i.zoom,l=(0,n.Oq)(s)*i.zoom,u=(0,n.rY)(s)*i.zoom;this._svg[t(437)].left=a+s[t(411)]*i.zoom-2+"px",this[t(381)][t(437)][t(371)]=c+s[t(371)]*i.zoom-2+"px",this[t(381)].setAttribute(t(448),(l+5)[t(367)]()),this._svg[t(409)](t(433),(u+5)[t(367)]()),this[t(355)][t(409)]("d","M2.5 2.5 h"+l+" v"+u+" h"+-l+" v"+-u),h?.[t(382)]?(this[t(429)][t(437)][t(401)]=t(413),this[t(429)][t(409)]("d",h[t(382)](l,u,this[t(348)][t(408)],this._model[t(363)]))):this._svgPath2[t(437)][t(401)]=t(446)}}},9904:(t,s,e)=>{const i=a12_0x266927;e.d(s,{FV:()=>r,rP:()=>a,tv:()=>c,Jp:()=>l,X5:()=>u,qv:()=>d});var n=e(1815),h=e(5120),o=e(2939);class r extends h.JT{constructor(t,s,e,i=!0){const h=a12_0x4330;super(),this.name=t,this.hasImage=s,this[h(425)]=e,this[h(452)]=i,this[h(424)]="boolean",this[h(426)]=this[h(397)](new n.v),this[h(431)]=this[h(426)][h(356)],this[h(400)]=this.register(new n.v),this[h(379)]=this._onUpdate.event}get[i(428)](){return this[i(425)]}set value(t){this[i(425)]=t,this._onUpdate.fire(t)}[i(345)](t){this._value=t,this._onHistoryUpdateValue.fire(t)}}class a extends h.JT{constructor(t,s,e){const h=i;super(),this.name=t,this[h(347)]=s,this[h(425)]=e,this[h(424)]=h(391),this._onHistoryUpdateValue=this[h(397)](new n.v),this[h(431)]=this[h(426)][h(356)],this._onUpdate=this[h(397)](new n.v),this[h(379)]=this[h(400)][h(356)]}get value(){return this._value}set[i(428)](t){const s=i;this._value=t,this._onUpdate[s(435)](t)}[i(345)](t){const s=i;this[s(425)]=t,this[s(426)].fire(t)}}class c extends h.JT{constructor(t,s,e){const h=i;super(),this[h(456)]=t,this[h(347)]=s,this[h(425)]=e,this[h(424)]=h(434),this._onHistoryUpdateValue=this[h(397)](new n.v),this[h(431)]=this[h(426)].event,this[h(400)]=this[h(397)](new n.v),this.onUpdate=this[h(400)].event}get[i(428)](){return this[i(425)]}set[i(428)](t){const s=i;this._value=t,this[s(400)][s(435)](t)}[i(345)](t){const s=i;this[s(425)]=t,this[s(426)][s(435)](t)}}class l extends a{constructor(){const t=i;super("Blend Mode",[t(450),t(372),t(449),t(460),t(366),"lighten","screen",t(399),t(350),t(417),t(421),t(387)],t(450))}}class u extends h.JT{constructor(t,s,e,h){const o=i;super(),this[o(456)]=t,this[o(425)]=s,this.min=e,this[o(365)]=h,this[o(424)]=o(441),this[o(426)]=this[o(397)](new n.v),this[o(431)]=this[o(426)][o(356)],this[o(400)]=this[o(397)](new n.v),this[o(379)]=this[o(400)][o(356)]}get[i(428)](){const t=i;return(0,o.u)(this[t(425)],this[t(365)],this[t(374)])}set value(t){const s=i;this[s(425)]=t,this[s(400)].fire(t)}[i(345)](t){const s=i;this[s(425)]=t,this._onHistoryUpdateValue[s(435)](t)}}class d extends u{constructor(t,s,e,n){const h=i;super(t,s,e,n),this[h(424)]=h(441)}get[i(428)](){const t=i;return(0,o.u)(this[t(425)],this[t(365)],this[t(374)])}set[i(428)](t){const s=i;this[s(425)]=Math[s(384)](t),this[s(400)].fire(t)}}},2996:(t,s,e)=>{const i=a12_0x266927;e.r(s),e.d(s,{default:()=>u});var n=e(1815),h=e(5120),o=e(3315),r=e(9904),a=e(1019);const c=e(8752).m4.createReadonlyRgbaColor(0,0,0,0);class l extends h.JT{constructor(t){const s=a12_0x4330;super(),this[s(383)]=t,this.id="eraser",this[s(375)]=new r.qv(s(358),1,1,1e3),this.options=[this[s(375)]],this._outlineModel={range:void 0},this[s(393)]=this[s(397)](new n.v),this[s(395)]=this[s(393)].event}[i(398)](t){const s=i;return new o.d(t,this[s(383)][s(454)],this[s(383)][s(344)],this[s(389)])}pointerDown(t){const s=i,e=this._sc[s(454)];if(!e[s(459)])return;const n=this[s(383)][s(344)][s(430)](t);if(n){if(e[s(405)](n[0],n[1])){const t=this[s(380)]();this[s(415)](this[s(380)](),n[0],n[1],this[s(375)][s(428)],c),t[s(346)]()}this[s(378)]=n}}pointerMove(t){const s=i;if(!this[s(383)][s(454)][s(459)])return;const e=this[s(383)][s(344)][s(430)](t);this._updateOutline(e)}[i(444)](t){const s=i;if(this[s(383)].imageService[s(459)]&&(this[s(389)][s(406)]?.[s(411)]!==t[0]||this[s(389)].range?.[s(371)]!==t[1])){if(this._sc[s(454)].containsCoord(t[0],t[1])){const e=(this[s(375)][s(428)]-1)/2;this._outlineModel[s(406)]={left:t[0]-Math.floor(e),top:t[1]-Math[s(384)](e),right:t[0]+Math.ceil(e)+1,bottom:t[1]+Math.ceil(e)+1}}else this[s(389)].range=void 0;this[s(393)][s(435)]()}}[i(354)](t){const s=i;if(!this[s(378)])return;const e=this[s(383)][s(454)];if(!e.currentLayer)return;const n=this[s(383)].viewportService.getCoordsFromEvent(t);(e.containsCoord(n[0],n[1])||e[s(405)](this._lastCoord[0],this._lastCoord[1]))&&this[s(377)](this[s(378)],n,c),this._lastCoord=n}async[i(385)](){const t=i;this[t(383)][t(454)][t(459)]&&(this[t(447)]?.commit(t(439)),this[t(447)]=void 0),this[t(378)]=void 0}[i(377)](t,s,e){const n=i,h=this[n(380)]();(0,a.j)(e,t[0],t[1],s[0],s[1],((t,s,e)=>this[n(415)](h,t,s,this[n(375)][n(428)],e)),!1),h[n(346)]()}[i(380)](){const t=i;if(!this._edit&&(this._edit=this[t(383)][t(454)].currentLayer?.[t(373)](),!this._edit))throw new Error("Could not create extended edit");return this[t(447)]}[i(415)](t,s,e,n,h){const o=i;this[o(383)][o(390)][o(405)](s,e)&&this[o(383)][o(454)][o(405)](s,e)&&t.drawCircle(s,e,n,!0,h)}}const u=l},1019:(t,s,e)=>{e.d(s,{X:()=>h,j:()=>o});var i=e(8752),n=e(9455);function h(t,s,e,i,h,o){const r=a12_0x4330,a=(0,n.zz)(t,s,e,i),c=.5*o*h*Math[r(416)](a),l=.5*o*h*Math[r(359)](a);return[{x:t-c,y:s-l},{x:t+c,y:s+l},{x:e+c,y:i+l},{x:e-c,y:i-l}]}function o(t,s,e,i,n,h,o,d=1){o?function(t,s,e,i,n,h,o){const r=a12_0x4330;o<1&&(t=u(t,o));const a=Math.abs(n-e)>Math[r(351)](i-s);let d=0;a&&(d=s,s=e,e=d,d=i,i=n,n=d),s>i&&(d=s,s=i,i=d,d=e,e=n,n=d);const _=i-s;let p=(n-e)/_;0===_&&(p=1);let v=Math.round(s),f=e+p*(v-s),g=l(s+.5);const M=v,x=Math.floor(f);let m=c(f)*g;a?(h(x,M,u(t,l(f)*g)),m>0&&h(x+1,M,u(t,m))):(h(M,x,u(t,l(f)*g)),m>0&&h(M,x+1,u(t,m)));let w=f+p;v=Math[r(368)](i),f=n+p*(v-i),g=c(i+.5);const y=v,b=Math[r(384)](f);if(m=c(f)*g,a?(h(b,y,u(t,l(f)*g)),m>0&&h(b+1,y,u(t,c(f)*g))):(h(y,b,u(t,l(f)*g)),m>0&&h(y,b+1,u(t,c(f)*g))),a)for(let s=M+1;s<y;s++)h(Math[r(384)](w),s,u(t,l(w))),m=c(w),m>0&&h(Math.floor(w)+1,s,u(t,m)),w+=p;else for(let s=M+1;s<y;s++)h(s,Math[r(384)](w),u(t,l(w))),m=c(w),m>0&&h(s,Math[r(384)](w)+1,u(t,m)),w+=p}(t,s,e,i,n,h,d):function(t,s,e,i,n,h,o){const c=a12_0x4330;o<1&&(t=u(t,o)),Math[c(351)](n-e)<Math[c(351)](i-s)?s>i?r(t,i,n,s,e,h):r(t,s,e,i,n,h):e>n?a(t,i,n,s,e,h):a(t,s,e,i,n,h)}(t,s,e,i,n,h,d)}function r(t,s,e,i,n,h){const o=i-s;let r=n-e,a=1;r<0&&(a=-1,r=-r);let c=2*r-o,l=e;for(let e=s;e<=i;e++)h(e,l,t),c>0?(l+=a,c+=2*(r-o)):c+=2*r}function a(t,s,e,i,n,h){let o=i-s;const r=n-e;let a=1;o<0&&(a=-1,o=-o);let c=2*o-r,l=s;for(let s=e;s<=n;s++)h(l,s,t),c>0?(l+=a,c+=2*(o-r)):c+=2*o}function c(t){return t%1}function l(t){return 1-t%1}function u(t,s){const e=a12_0x4330;if(void 0!==t)return i.m4.createReadonlyRgbaColor(t[0],t[1],t[2],Math[e(368)](t[3]*s))}},1674:(t,s,e)=>{const i=a12_0x266927;e.d(s,{q:()=>n});const n=i(404)},9455:(t,s,e)=>{function i(t,s,e,i){return 180*n(t,s,e,i)/Math.PI}function n(t,s,e,i){let n=-Math[a12_0x4330(412)](i-s,e-t);return-180===n&&(n=180),n}function h(t){return t*Math.PI/180}function o(t,s,e,i,n,h){const o=a12_0x4330,r=Math[o(357)](Math[o(352)](t-e,2)+Math[o(352)](s-i,2)),a=Math[o(357)](Math[o(352)](e-n,2)+Math[o(352)](i-h,2)),c=Math[o(357)](Math.pow(n-t,2)+Math[o(352)](h-s,2)),l=(r+a+c)/2;return Math[o(357)](l*(l-r)*(l-a)*(l-c))}function r(t,s,e,i,n,h,r,a){return o(t,s,e,i,n,h)+o(e,i,n,h,r,a)+o(n,h,r,a,t,s)+o(r,a,t,s,e,i)}e.d(s,{AM:()=>i,zz:()=>n,Ht:()=>h,ku:()=>o,hu:()=>r})}}]);