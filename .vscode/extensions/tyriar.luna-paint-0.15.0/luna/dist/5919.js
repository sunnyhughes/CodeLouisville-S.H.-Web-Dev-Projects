"use strict";const a53_0x34d9=["width","length","getContext","max","replace","measureText","225133APcFVd","bottom"," bold","min","textBaseline","reduce","59793vZLThQ","fillText"," must be contained within ","split","top","height","floor","fontFamily","fontSize",'" dimensions differ',"737613nobiAz","alignment","blendMode","primaryColor","1duXfVN","data","update","isBold","1284289pMSDol","push","ceil","selection","targetImage","707847tyEKvY","round","map","left",'" and "','Images "',"518286foUrZj",'Range "',"1dbCziq","textAlign",'": ',"verticalAlignment"," italic","right","dimensions","center","justify","304774PaTtao","fillStyle","text","middle"],a53_0x5b4c=function(t,e){return a53_0x34d9[t-=251]},a53_0x2c006a=a53_0x5b4c;!function(t,e){const a=a53_0x5b4c;for(;;)try{if(656335===-parseInt(a(268))+parseInt(a(279))*-parseInt(a(270))+parseInt(a(305))+-parseInt(a(295))+parseInt(a(253))*parseInt(a(289))+-parseInt(a(262))+parseInt(a(257)))break;t.push(t.shift())}catch(e){t.push(t.shift())}}(a53_0x34d9),(self.webpackChunkluna=self.webpackChunkluna||[])[a53_0x2c006a(258)]([[5919],{5919:(t,e,a)=>{a.r(e),a.d(e,{run:()=>c});var n=a(4371),r=a(7517),o=a(2939),i=a(1003),s=a(7742);const c=async(t,e,a)=>{const c=a53_0x5b4c;return(0,s.ap)(a,c(261)),function(t,e){const a=a53_0x5b4c,s=e[a(261)][a(283)],c=e.targetImage[a(300)],l={...e[a(276)]};if(l[a(265)]=Math[a(301)](l.left),l[a(275)]=Math[a(259)](l[a(275)]),l[a(299)]=Math[a(301)](l[a(299)]),l[a(290)]=Math[a(259)](l[a(290)]),l[a(265)]=(0,o.u)(Math.floor(l[a(265)]),s,0),l[a(275)]=(0,o.u)(Math[a(259)](l[a(275)]),s,0),l.top=(0,o.u)(Math[a(259)](l[a(299)]),c,0),l.bottom=(0,o.u)(Math[a(259)](l[a(290)]),c,0),e[a(260)]&&(e.selection[a(265)]>l.left&&(l[a(265)]=Math[a(292)](e.selection[a(265)],l.right)),e.selection[a(275)]<l.right&&(l[a(275)]=Math[a(286)](e[a(260)].right,l[a(265)])),e.selection[a(299)]>l[a(299)]&&(l[a(299)]=Math[a(292)](e[a(260)][a(299)],l[a(290)])),e.selection[a(290)]<l.bottom&&(l[a(290)]=Math[a(286)](e.selection[a(290)],l[a(299)]))),l[a(265)]===l.right||l[a(299)]===l[a(290)])throw new Error("The text can not be drawn outside of the selection and viewport");const f=(0,i.Oq)(l),h=(0,i.rY)(l),d=(0,i.Oq)(e[a(276)]),u=(0,i.rY)(e.dimensions),p=new OffscreenCanvas(f,h)[a(285)]("2d");if(!p)throw new Error("Could not attain 2d context");let x="";e[a(256)]&&(x+=a(291)),e.isItalic&&(x+=a(274)),x+=" "+e[a(303)]+"px "+e[a(302)],p.font=x.trim(),p[a(271)]=a(265),p[a(293)]=a(299),p[a(280)]="rgba("+e[a(252)][0]+","+e[a(252)][1]+","+e.primaryColor[2]+","+e[a(252)][3]/255+")";const g=function(t,e,a){const n=a53_0x5b4c,r=[],o=e[n(298)]("\n");for(const e of o){const o=e.split(" ");let i=o[0];for(let e=1;e<o[n(284)];e++){const s=o[e];t[n(288)](i+" "+s)[n(283)]<a?i+=" "+s:(r[n(258)]({text:i,width:t[n(288)](i).width}),i=s)}r[n(258)]({text:i,width:t[n(288)](i).width})}return r}(p,e[a(281)],d),w=e.fontSize;let b;switch(e[a(273)]){case"top":b=0;break;case a(282):b=Math[a(263)]((u-g[a(284)]*w)/2);break;case a(290):b=u-w*g[a(284)]}if(b+=e[a(276)][a(299)]-l[a(299)],e[a(306)]===a(278))for(const t of g){const n=t[a(281)].split(" ")[a(264)]((t=>{const e=a;return{text:t,width:p[e(288)](t)[e(283)]}})),r=(d-n[a(294)](((t,e)=>t+e[a(283)]),0))/(n[a(284)]-1);let o=e[a(276)].left-l[a(265)];for(const t of n)p[a(296)](t[a(281)],Math.round(o),b),o+=t[a(283)]+r;b+=w}else for(const t of g){let n;switch(e[a(306)]){case a(265):n=0;break;case a(277):n=d/2,p[a(271)]=a(277);break;case a(275):n=d,p[a(271)]=a(275)}n+=e[a(276)].left-l[a(265)],p.fillText(t[a(281)],n,b),b+=w}const m=p.getImageData(0,0,f,h),I=(0,n.X$)(s*c,s*c*4,!0),M=(0,n.X$)(s*c*2,Math[a(286)](s,c),!0);let _=0,y=0,k=0,v=0;for(k=0;k<h;k++)for(y=0;y<f;y++)v=4*(k*f+y),m[a(254)][v+3]>0&&(M[2*_]=y,M[2*_+1]=k,I[_++]=4*((l.top+k)*s+l[a(265)]+y));const A=I.subarray(0,_);t[a(255)](.25);const C=new Uint8Array(new SharedArrayBuffer(4*I[a(284)]));for(v=0;v<I[a(284)];v++)(0,n.Yr)(C,4*v,e[a(261)][a(254)],I[v]);if(t[a(255)](.5),e[a(251)]===a(287))for(v=0;v<A.length;v++)(0,n.Yr)(e.targetImage.data,A[v],m[a(254)],4*(M[2*v+1]*f+M[2*v]));else for(v=0;v<A.length;v++)(0,r.B)(e[a(251)],e[a(261)].data,A[v],m[a(254)],4*(M[2*v+1]*f+M[2*v]));t[a(255)](.75);const T=new Uint8Array(new SharedArrayBuffer(4*I[a(284)]));for(v=0;v<I[a(284)];v++)(0,n.Yr)(T,4*v,e.targetImage.data,I[v]);return t[a(255)](1),{undoData:{indexList:A,colorData:C},redoData:{indexList:A,colorData:T},range:l}}(e,a)}},7742:(t,e,a)=>{a.d(e,{ap:()=>r,TO:()=>o,zg:()=>i});var n=a(1003);function r(t,e){const a=a53_0x5b4c,n=t[e];if(n[a(283)]<1||n.height<1)throw new Error('Invalid dimensions for image "'+e+a(272)+n[a(283)]+" x "+n[a(300)])}function o(t,e,a){const n=a53_0x5b4c,r=t[e],o=t[a];if(r[n(283)]===o[n(283)]&&r[n(300)]===o[n(300)])throw new Error(n(267)+e+n(266)+a+'" dimensions are equal')}function i(t,e,a){const r=a53_0x5b4c,o=t[e];if(!(0,n.ur)(a,o))throw new Error(r(269)+e+'" '+(0,n.PW)(o)+r(297)+(0,n.PW)(a))}}}]);