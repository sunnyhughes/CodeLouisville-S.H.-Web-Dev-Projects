"use strict";const a15_0x7911=["clientWidth","Move Line","Line is ","_brushSizeOption","strokeWidth","_setPointPosition","difference","stroke","line","_sc","ctrlKey","sin"," pixels wide by ","taskWorkerService","options","rgba","setColors","_updateColors","_downPointA","element","_elementContainer"," pixels tall","createDomRenderProgram","shiftKey","forceSolid","createElement","visible","secondaryColor","configService","1591516JSZwIb","offsetX","config","paletteService","Set Line Brush Size","ArrowRight","append","render","push","right","point","_range","prepend","_topLeft","normal","1369117XqsKuY","altKey","cos","_onHistoryUpdateValue","primaryColor","Set Line Blend Mode","_blendModeOption","_updateOutline","text","isVisible","fire","secondary","4272bAuNtS","ArrowDown","949492QCQXhG","Line top left position is x=","pow","onUpdate","svg","blendMode","reduce","613333BJcemT","imageService","onTemporaryLayerRegistered","appendChild","value","keyDown","floor"," 0z","pointerDownMove","fill","var(--luna-focusColor)","selectionService","getInfo","Shift Line","clientHeight","_onOptionsChange","_imageService","_getClosestSnapDegrees","resize-stroke-a-nwse","webpackChunkluna","textContent","angle","_pointA","viewportService","_isVisible","zoom","_color","softLight","_getTopLeft","pointB","name","l0 ","resize-stroke-a-ew","_value","_topLeftInfo"," Line Smoothing","getColorFromPointerEvent","map","_onUpdate"," x ","_svgPath","_downCoord","isValid","block","Smoothing","_pointB","zone","Enable","pointerMove","serialize","_onStateChange","offsetY","height","onCommit","setValueFromHistoryChange","1144018nUvxEj","_lengthInfo","_element","onBeforeRunLayerTask","linearBurn","createReadonlyRgbaColor","transparent","_isShiftDown","_svg","onStateChange","max","onRequestRender","replace","createElementNS","onHistoryAction","move-point-b","width","Disable","_cursorCoord","hasLineLayer","getPointerState","handleOptionUpdate","screen","_getLineLength","dispose","type","_setState","_model","currentLayer","_setupActiveTemporaryLayer","keyUp","_resizeStrokeB","range","state","ArrowLeft","add","_getCoords","step","includes","_container","commit","number","pointA","_syncOutlineModelToLayer","resize-stroke-a-ns","move","_resizeStrokeA","977461rDTbDW","taskService","smoothing","163ZTezXV","overlay","length","abs","_finish","_sizeInfo","resize-stroke-b-ns","_angle","topLeft","triggerRequestRender","_downPointB","devicePixelRatio","_getAngle","_outlineModel","_shiftPoints","snapToPixelGrid","toString","primary","order","move-handle","setVisible","_hideCursorInfo","getCoordsFromEvent","_clearLineLayer","metaKey","min","display","lighten","getDetailedInfo","onLayerChange","top","info","bottom","buttons","classList","round","_onRequestRender","onHistoryUpdateValue","Draw Line","_smoothingOption","Blend Mode","ArrowUp"," y=","startsWith","style","boolean","setAttribute","deserialize","_updateCursorInfo","_cursorInfo","_lineLayerOwner","new","topleft","_viewportService","lineLayer","register","left","currentState","event","darken","_renderer","registerTemporaryLayer","multiply","sqrt","move-point-a","getFineCoordsFromEvent","_angleInfo","pointerUp","http://www.w3.org/2000/svg","key","div","resize-stroke-b-nesw","removeChild","exclusion","linearDodgeAdd","_refreshInfo"],a15_0x5b1e=function(t,s){return a15_0x7911[t-=212]},a15_0x10ba43=a15_0x5b1e;!function(t,s){const i=a15_0x5b1e;for(;;)try{if(749133===parseInt(i(391))+-parseInt(i(384))+parseInt(i(446))+-parseInt(i(370))+parseInt(i(382))*parseInt(i(250))+-parseInt(i(247))+parseInt(i(355)))break;t.push(t.shift())}catch(s){t.push(t.shift())}}(a15_0x7911),(self[a15_0x10ba43(410)]=self[a15_0x10ba43(410)]||[])[a15_0x10ba43(363)]([[2844],{7571:(t,s,i)=>{const e=a15_0x10ba43;i.d(s,{P:()=>n});var h=i(5120);class n extends h.JT{constructor(t,s){const i=a15_0x5b1e;super(),this[i(239)]=t,this._model=s,this[i(268)]=2,this[i(448)]=document[i(351)]("div"),this._element.classList[i(235)]("cursor-info"),this[i(239)].appendChild(this._element),this[i(305)]({dispose:()=>this[i(239)][i(322)](this._element)})}[e(362)](){const t=e;this[t(448)].style[t(276)]=this._model.isVisible?t(434):"none",this._element.style[t(306)]=this[t(227)].x+"px",this[t(448)][t(294)][t(280)]=this[t(227)].y+"px",this[t(448)][t(411)]=this._model[t(378)]}}},566:(t,s,i)=>{const e=a15_0x10ba43;i.d(s,{d:()=>r,I:()=>a});var h=i(1019),n=i(5120),o=i(1674);class r extends n.JT{constructor(t,s,i,e){const h=a15_0x5b1e;super(),this[h(239)]=t,this[h(407)]=s,this[h(303)]=i,this[h(227)]=e,this.order=2,this._svg=document[h(213)](o.q,h(388)),this._svgPath=document[h(213)](o.q,"path"),this[h(431)][h(294)][h(333)]=h(401),this[h(431)][h(294)][h(400)]=h(452),this[h(431)][h(294)][h(330)]="1",this[h(454)][h(361)](this[h(431)]),this._container[h(367)](this[h(454)]),this[h(305)]({dispose:()=>this[h(239)].removeChild(this[h(454)])})}[e(362)](){const t=e,s=this[t(303)];if(!this[t(227)][t(433)]||!this[t(407)][t(228)])return void(this[t(454)].style[t(276)]="none");if(this._svg[t(294)][t(276)]=t(434),!this[t(227)][t(350)]&&this[t(227)][t(330)]<=1&&s[t(416)]>=3){const i=[];(0,h.j)(void 0,this._model.x1,this[t(227)].y1,this[t(227)].x2,this[t(227)].y2,((s,e)=>i[t(363)]([s,e])),!1,this[t(227)][t(330)]);const e=[];let n=0;for(;n<i[t(252)]-1;n++){const s=i[n];let h=n;if(s[0]===i[h+1][0]){for(;h+1<i.length&&s[0]===i[h+1][0];)h++;e.push([s[0],s[1],1,h-n+1])}else if(s[1]===i[h+1][1]){for(;h+1<i[t(252)]&&s[1]===i[h+1][1];)h++;e[t(363)]([s[0],s[1],h-n+1,1])}else e[t(363)]([s[0],s[1],1,1]);n=h}n===i[t(252)]-1&&e[t(363)]([i[n][0],i[n][1],1,1]);const o=Math[t(285)](this[t(239)].clientWidth/2)-this[t(407)][t(216)]/2*s[t(416)]+s.x*s[t(416)],r=Math[t(285)](this[t(239)][t(405)]/2)-this[t(407)].height/2*s[t(416)]+s.y*s[t(416)];let a="";for(const i of e)a+="M"+(o+i[0]*s[t(416)])+" "+(r+i[1]*s.zoom),a+="l"+i[2]*s[t(416)]+" 0",a+=t(422)+i[3]*s[t(416)],a+="l-"+i[2]*s[t(416)]+t(398);return this[t(454)][t(296)](t(216),this[t(239)][t(326)].toString()),this[t(454)][t(296)](t(443),this[t(239)][t(405)][t(266)]()),void this._svgPath.setAttribute("d",a)}this[t(454)][t(294)].display=t(434);const i=Math[t(285)](this._container.clientWidth/2)-this[t(407)][t(216)]/2*s.zoom+s.x*s.zoom,n=Math[t(285)](this[t(239)][t(405)]/2)-this[t(407)][t(443)]/2*s.zoom+s.y*s[t(416)],o=i+(this._model.x1+.5)*s[t(416)],r=n+(this[t(227)].y1+.5)*s.zoom,a=i+(this[t(227)].x2+.5)*s[t(416)],c=n+(this._model.y2+.5)*s[t(416)];if(this._svg[t(296)](t(216),this[t(239)].clientWidth[t(266)]()),this[t(454)][t(296)](t(443),this._container[t(405)][t(266)]()),s[t(416)]>=3){const i=(0,h.X)(o,r,a,c,this[t(227)].strokeWidth,s[t(416)]);this[t(431)][t(296)]("d","M"+i[t(428)]((t=>t.x+","+t.y)).join(" L")+"z")}else this[t(431)][t(296)]("d","M"+o+","+r+" L"+a+","+c)}}class a{constructor(){const t=e;this[t(433)]=!1,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this[t(330)]=1,this.forceSolid=!1}}},9865:(t,s,i)=>{i.d(s,{q:()=>n});var e=i(1815),h=i(5120);class n extends h.JT{constructor(){const t=a15_0x5b1e;super(...arguments),this[t(429)]=this[t(305)](new e.v),this.onUpdate=this._onUpdate[t(308)]}}},9904:(t,s,i)=>{const e=a15_0x10ba43;i.d(s,{FV:()=>r,rP:()=>a,tv:()=>c,Jp:()=>l,X5:()=>u,qv:()=>d});var h=i(1815),n=i(5120),o=i(2939);class r extends n.JT{constructor(t,s,i,e=!0){const n=a15_0x5b1e;super(),this.name=t,this.hasImage=s,this[n(424)]=i,this.allowUnchecking=e,this[n(225)]=n(295),this[n(373)]=this[n(305)](new h.v),this[n(287)]=this[n(373)][n(308)],this._onUpdate=this[n(305)](new h.v),this[n(387)]=this[n(429)].event}get[e(395)](){return this._value}set[e(395)](t){this._value=t,this._onUpdate.fire(t)}[e(445)](t){const s=e;this[s(424)]=t,this[s(373)][s(380)](t)}}class a extends n.JT{constructor(t,s,i){const n=e;super(),this[n(421)]=t,this[n(340)]=s,this[n(424)]=i,this[n(225)]="string",this[n(373)]=this[n(305)](new h.v),this[n(287)]=this[n(373)][n(308)],this[n(429)]=this[n(305)](new h.v),this[n(387)]=this[n(429)][n(308)]}get value(){return this[e(424)]}set value(t){const s=e;this._value=t,this[s(429)][s(380)](t)}[e(445)](t){const s=e;this._value=t,this[s(373)][s(380)](t)}}class c extends n.JT{constructor(t,s,i){const n=e;super(),this.name=t,this[n(340)]=s,this._value=i,this[n(225)]="string-combo",this[n(373)]=this[n(305)](new h.v),this.onHistoryUpdateValue=this[n(373)][n(308)],this._onUpdate=this[n(305)](new h.v),this.onUpdate=this._onUpdate[n(308)]}get[e(395)](){return this[e(424)]}set[e(395)](t){const s=e;this._value=t,this[s(429)][s(380)](t)}[e(445)](t){const s=e;this[s(424)]=t,this[s(373)][s(380)](t)}}class l extends a{constructor(){const t=e;super(t(290),[t(369),t(212),"darken",t(312),"linearBurn",t(277),t(222),t(324),t(251),t(418),t(332),"exclusion"],"normal")}}class u extends n.JT{constructor(t,s,i,n){const o=e;super(),this[o(421)]=t,this[o(424)]=s,this[o(275)]=i,this.max=n,this[o(225)]=o(241),this[o(373)]=this[o(305)](new h.v),this.onHistoryUpdateValue=this[o(373)][o(308)],this[o(429)]=this[o(305)](new h.v),this[o(387)]=this[o(429)][o(308)]}get[e(395)](){const t=e;return(0,o.u)(this[t(424)],this[t(456)],this.min)}set[e(395)](t){const s=e;this._value=t,this[s(429)].fire(t)}setValueFromHistoryChange(t){const s=e;this[s(424)]=t,this[s(373)][s(380)](t)}}class d extends u{constructor(t,s,i,h){const n=e;super(t,s,i,h),this[n(225)]=n(241)}get[e(395)](){const t=e;return(0,o.u)(this[t(424)],this[t(456)],this[t(275)])}set[e(395)](t){const s=e;this._value=Math[s(397)](t),this._onUpdate[s(380)](t)}}},2844:(t,s,i)=>{const e=a15_0x10ba43;i.r(s),i.d(s,{default:()=>m});var h=i(8752),n=i(1815),o=i(1019),r=i(5120),a=i(2939),c=i(7896),l=i(1003),u=i(9455);function d(t){if(void 0!==t)return{x:t.x,y:t.y}}var _=i(2811),y=i(7571),p=i(566),x=i(9865),f=i(9904);const v=[-180,-165,-150,-135,-120,-105,-90,-75,-60,-45,-30,-15,0,15,30,45,60,75,90,105,120,135,150,165,180];class g extends r.JT{constructor(t){const s=a15_0x5b1e;super(),this[s(335)]=t,this.id=s(334),this[s(233)]=s(301),this[s(218)]=[0,0],this[s(453)]=!1,this[s(263)]=new p.I,this._blendModeOption=new f.Jp,this[s(289)]=new f.FV(s(435),!0,!0),this[s(329)]=new f.X5("Brush Size",1,0,1e3),this[s(340)]=[this[s(376)],this[s(289)],this[s(329)]],this[s(425)]=new w,this[s(255)]=new M,this._lengthInfo=new L,this[s(316)]=new b,this[s(281)]=[this[s(425)],this[s(255)],this[s(447)],this[s(316)]],this[s(286)]=this[s(305)](new n.v),this[s(457)]=this[s(286)][s(308)],this[s(441)]=this[s(305)](new n.v),this[s(455)]=this[s(441)][s(308)],this[s(299)]={x:0,y:0,text:"",isVisible:!1},this.register(this[s(335)].imageService[s(279)]((()=>this[s(254)]()))),this[s(305)](this._sc[s(248)][s(449)]((()=>this[s(254)]()))),this[s(305)]({dispose:()=>this._finish()}),this[s(305)](this._sc[s(414)][s(387)]((()=>this[s(271)]()))),this[s(263)][s(350)]=this[s(289)][s(395)],this[s(305)](this[s(335)].paletteService[s(387)]((()=>this[s(343)]()))),this.register(this[s(376)][s(387)]((t=>this[s(304)]?.[s(221)](t,s(389),s(375))))),this[s(305)](this._smoothingOption[s(387)]((t=>{const i=s;this[i(263)][i(350)]=t,this[i(304)]?.[i(221)](t,i(249),i(t?438:217)+i(426))}))),this[s(305)](this[s(329)].onUpdate((t=>{const i=s;this[i(263)].strokeWidth=t,this[i(304)]?.handleOptionUpdate(t,i(330),i(359),!0)}))),this[s(305)](this[s(335)][s(392)][s(393)]((t=>this._setupActiveTemporaryLayer(t)))),this[s(335)].imageService[s(228)]?.temporaryLayer&&this._setupActiveTemporaryLayer(this[s(335)][s(392)][s(228)].temporaryLayer)}[e(229)](t){const s=e;t[s(225)]===s(334)&&(this[s(304)]=t,this[s(305)](this[s(304)][s(444)]((()=>this[s(273)]()))),this[s(305)](this[s(304)][s(214)]((()=>{const t=s;this._onOptionsChange(),this[t(325)](),this[t(377)](null,!1),this[t(243)]()}))),this[s(305)](this[s(304)].onHistoryUnset((()=>this[s(273)]()))),this[s(310)]?.[s(270)](!0),this[s(286)].fire())}[e(406)](){const t=e;this[t(304)]&&(this[t(376)][t(445)](this[t(304)].currentState.blendMode),this[t(329)][t(445)](this[t(304)][t(307)][t(330)]),this[t(289)][t(445)](this[t(304)].currentState[t(249)]),(!(0,h.WC)(this[t(335)][t(358)][t(267)][t(341)],this[t(304)][t(307)].primaryColor)||!(0,h.WC)(this[t(335)][t(358)][t(381)].rgba,this.lineLayer.currentState[t(353)]))&&this[t(335)][t(358)][t(342)](this[t(304)].currentState[t(374)],this[t(304)][t(307)][t(353)]))}_updateColors(){const t=e;if(!this.lineLayer)return;const s=this[t(335)][t(358)][t(267)][t(341)],i=this[t(335)][t(358)][t(381)][t(341)];(0,h.WC)(this[t(304)][t(307)][t(374)],s)&&(0,h.WC)(this.lineLayer[t(307)].secondaryColor,i)||(this[t(304)].currentState[t(374)]=s,this.lineLayer[t(307)][t(353)]=i,this[t(304)][t(237)]("Set Line Color",!0),this[t(304)][t(259)]())}async[e(254)](){const t=e;await(this.lineLayer?.[t(240)]()),this[t(273)]()}[e(273)](){const t=e;this[t(304)]=void 0,this[t(310)]?.[t(270)](!1),this[t(263)][t(433)]=!1,this[t(325)](),this._onRequestRender[t(380)]()}[e(348)](t){const s=e;return this[s(310)]=new C(t,this,this[s(335)].viewportService,this[s(335)].imageService),this[s(310)][s(270)](!!this.lineLayer),[new y.P(t,this._cursorInfo),new p.d(t,this._sc[s(392)],this._sc[s(414)],this[s(263)]),this._renderer]}async pointerDown(t){const s=e,i=this[s(335)][s(392)][s(228)];if(!i)return;if(this[s(417)]=this._sc[s(358)][s(427)](t),!this[s(417)])return;if(this._downCoord=this[s(236)](t),this[s(233)]!==s(301))return this[s(344)]=d(this[s(304)]?.[s(307)][s(242)]),void(this[s(260)]=d(this[s(304)]?.[s(307)].pointB));this[s(218)]=[...this[s(432)]];const h=!(1&t[s(283)]);this.lineLayer=new _.B(i,{invertColors:h},{primaryColor:this._sc[s(358)][s(267)][s(341)],secondaryColor:this[s(335)][s(358)][s(381)].rgba,pointA:{x:this[s(432)][0],y:this[s(432)][1]},pointB:{x:this[s(218)][0],y:this._cursorCoord[1]},blendMode:this[s(376)][s(395)],smoothing:this[s(289)].value,strokeWidth:this[s(329)].value},this._sc.historyService,this._sc[s(402)],this._sc[s(339)]),this[s(377)](t,!0),await i[s(311)](this[s(304)])}[e(236)](t){const s=e;if(this._smoothingOption[s(395)]&&!this[s(335)][s(354)][s(357)].snapToPixelGrid){const i=this._sc[s(414)][s(315)](t);return i[0]-=.5,i[1]-=.5,i}return this[s(335)][s(414)][s(272)](t)}[e(399)](t){const s=e;this._downCoord&&this[s(417)]&&this[s(335)][s(392)][s(228)]&&this._updateOutline(t,!0)}async[e(317)](t,s){const i=e;if(this[i(233)]===i(301)&&s)return this[i(304)]&&this[i(335)][i(392)][i(228)]?.unregisterTemporaryLayer(this[i(304)]),this[i(304)]?.[i(224)](),void this[i(273)]();if(!this[i(432)]||!this[i(304)]||!this[i(417)])return;let h;switch(this.state){case i(301):h=i(288);break;case"move":h=i(327);break;default:h="Adjust Line"}this.lineLayer[i(307)].pointA.x=this[i(263)].x1,this.lineLayer[i(307)][i(242)].y=this[i(263)].y1,this.lineLayer[i(307)][i(420)].x=this._outlineModel.x2,this.lineLayer[i(307)][i(420)].y=this[i(263)].y2,this.lineLayer.step(h),this._downCoord=void 0,this[i(439)](t,!1)}async[e(439)](t,s){const i=e;this[i(299)].x=t[i(356)],this[i(299)].y=t[i(442)],this[i(218)]=this[i(236)](t),s&&t[i(349)]?this[i(298)]():this[i(299)][i(379)]&&this[i(271)](),!s&&this[i(310)]&&this[i(226)](this[i(310)].getPointerState(t,this[i(329)][i(395)],this[i(335)].viewportService[i(416)]))}[e(226)](t){const s=e;this[s(233)]!==t&&(this[s(233)]=t,this._onStateChange[s(380)]())}[e(396)](t,s){const i=e;if(!this[i(453)]&&t[i(349)]&&(this._isShiftDown=!0,this[i(377)](t,s)),this[i(304)]&&!s&&[i(291),i(234),"ArrowDown",i(360)][i(238)](t[i(319)])){const s=(c.V5?t[i(274)]:t[i(336)])?10:1;switch(t.key){case i(291):this[i(264)](0,-s);break;case i(383):this[i(264)](0,s);break;case i(234):this[i(264)](-s,0);break;case i(360):this[i(264)](s,0)}this[i(304)][i(237)](i(404)),this.lineLayer[i(259)]()}this[i(325)]()}[e(264)](t,s){const i=e;this[i(304)]&&(this.lineLayer[i(307)][i(242)].x+=t,this[i(304)][i(307)][i(242)].y+=s,this.lineLayer[i(307)][i(420)].x+=t,this.lineLayer.currentState[i(420)].y+=s,this[i(263)].x1+=t,this._outlineModel.y1+=s,this._outlineModel.x2+=t,this._outlineModel.y2+=s)}[e(230)](t,s){const i=e;!t[i(349)]&&(this._isShiftDown=!1,this[i(377)](t,s)),this[i(325)]()}[e(377)](t,s){const i=e,h=this[i(304)]?.currentState.pointA,n=this[i(304)]?.currentState.pointB;if(!(s&&this[i(432)]&&h&&n))return(!h||!n)&&(this[i(263)][i(433)]=!1),void this[i(325)]();if(this.state[i(293)]("resize-stroke")){const t=(h.x+n.x)/2,s=(h.y+n.y)/2;let e=2*Math[i(313)](Math[i(386)](t-this[i(218)][0],2)+Math[i(386)](s-this[i(218)][1],2));return e=!this._smoothingOption[i(395)]||this[i(335)][i(354)][i(357)][i(265)]?Math.max(Math[i(285)](e),1):(0,a.s)(e,2),this._brushSizeOption[i(395)]=e,this._brushSizeOption.setValueFromHistoryChange(e),void this[i(325)]()}let o="move-point-b"===this[i(233)]?[n.x,n.y]:[h.x,h.y];const r=this[i(233)]===i(215)?[h.x,h.y]:[n.x,n.y];if(this[i(453)]&&this[i(233)]!==i(245)){const t=this._getAngle(r,o),s=(0,u.Ht)(this[i(408)](t)),e=Math.sqrt(Math[i(386)](r[0]-o[0],2)+Math[i(386)](r[1]-o[1],2));o=[r[0]+e*Math[i(372)](s),r[1]-e*Math[i(337)](s)],!this._smoothingOption[i(395)]&&(o[0]=Math[i(285)](o[0]),o[1]=Math[i(285)](o[1]))}if(this[i(263)].x1=r[0],this[i(263)].y1=r[1],t[i(371)])switch(this[i(233)]){case i(301):this[i(263)].x1=2*this[i(432)][0]-o[0],this._outlineModel.y1=2*this[i(432)][1]-o[1];break;case i(314):this._downPointB&&(this._outlineModel.x1=2*this[i(260)].x-o[0],this._outlineModel.y1=2*this._downPointB.y-o[1]);break;case i(215):this[i(344)]&&(this[i(263)].x1=2*this._downPointA.x-o[0],this._outlineModel.y1=2*this._downPointA.y-o[1])}if(this[i(263)].x2=o[0],this[i(263)].y2=o[1],this._outlineModel[i(330)]=this[i(329)][i(395)],this[i(263)][i(433)]=!0,this.lineLayer)switch(this.state){case i(301):case i(314):this[i(304)][i(307)].pointA.x=this[i(218)][0],this[i(304)][i(307)][i(242)].y=this[i(218)][1];break;case i(215):this[i(304)][i(307)][i(420)].x=this[i(218)][0],this[i(304)][i(307)][i(420)].y=this._cursorCoord[1];break;case"move":this._downPointA&&this[i(260)]&&(this[i(304)].currentState[i(242)].x=this._downPointA.x+this[i(218)][0]-this[i(432)][0],this[i(304)][i(307)][i(242)].y=this[i(344)].y+this[i(218)][1]-this._downCoord[1],this[i(304)][i(307)][i(420)].x=this._downPointB.x+this[i(218)][0]-this._downCoord[0],this[i(304)][i(307)][i(420)].y=this[i(260)].y+this[i(218)][1]-this[i(432)][1])}this[i(286)][i(380)](),this[i(298)](),this[i(325)]()}[e(298)](){const t=e;this[t(432)]&&this._cursorCoord&&this.lineLayer&&"move"!==this[t(233)]&&(this[t(257)]=this._getAngle([this.lineLayer[t(307)][t(420)].x,this[t(304)][t(307)][t(420)].y],[this[t(304)].currentState[t(242)].x,this[t(304)][t(307)][t(242)].y]),this[t(453)]&&(this[t(257)]=this[t(408)](this[t(257)])),this[t(299)][t(378)]=this[t(257)]+"°",this[t(299)][t(379)]=this._isShiftDown,this[t(286)].fire())}[e(262)](t,s){return(0,a.s)((0,u.AM)(t[0],t[1],s[0],s[1]),1)}[e(408)](t){const s=e;return v[s(390)](((i,e)=>Math.abs(e-t)<Math[s(253)](i-t)?e:i))}[e(271)](){const t=e;this[t(299)][t(379)]=!1,this._onRequestRender[t(380)]()}[e(325)](){const t=e;this.lineLayer?(this[t(425)].topLeft=this[t(419)](),this[t(255)].range=(0,l.tH)(this.lineLayer[t(307)][t(242)].x,this[t(304)][t(307)][t(242)].y,this[t(304)][t(307)][t(420)].x,this.lineLayer[t(307)].pointB.y),this[t(447)][t(232)]=this[t(255)][t(232)],this[t(316)][t(412)]=this[t(257)]):(this[t(425)][t(258)]=void 0,this[t(255)][t(232)]=void 0,this[t(447)][t(232)]=void 0,this[t(316)][t(412)]=void 0)}_getTopLeft(){const t=e;if(!this.lineLayer)return;const s=this[t(304)][t(307)],i=s.pointA.x<s[t(420)].x?s[t(242)]:s[t(420)],h=s.pointA.y<s.pointB.y?s[t(242)]:s[t(420)];return{x:i.x,y:h.y}}[e(243)](){const t=e;this[t(304)]&&(this[t(263)][t(350)]=this.lineLayer[t(307)][t(249)],this[t(263)].strokeWidth=this[t(304)].currentState[t(330)],this[t(263)].x1=this.lineLayer[t(307)].pointA.x,this._outlineModel.y1=this.lineLayer[t(307)].pointA.y,this[t(263)].x2=this[t(304)][t(307)][t(420)].x,this._outlineModel.y2=this[t(304)][t(307)][t(420)].y,this[t(263)][t(433)]=!0)}[e(440)](){const t=e;return{state:this[t(233)],hasLineLayer:!!this[t(304)],angle:this[t(257)]}}[e(297)](t){const s=e;this[s(257)]=t[s(412)],t[s(219)]?(this[s(310)]?.[s(270)](!0),this[s(243)]()):this[s(273)](),this[s(226)](t[s(233)]),this._onOptionsChange(),this[s(325)]()}}const m=g;class w extends x.q{constructor(){const t=e;super(...arguments),this[t(225)]=t(302)}set[e(258)](t){const s=e;var i,h;h=t,!(!(i=this[s(368)])&&!h||i&&h&&i.x===h.x&&i.y===h.y)&&(this[s(368)]=t,this._onUpdate[s(380)]())}get[e(352)](){return!!this[e(368)]}getInfo(){const t=e;return this[t(368)]?(0,a.s)(this[t(368)].x,2)+", "+(0,a.s)(this[t(368)].y,2):""}[e(278)](){const t=e;return this._topLeft?t(385)+(0,a.s)(this._topLeft.x,2)+t(292)+(0,a.s)(this._topLeft.y,2):""}}class M extends x.q{constructor(){const t=e;super(...arguments),this[t(225)]="size"}get[e(232)](){return this._range}set[e(232)](t){const s=e;this[s(366)]!==t&&(this[s(366)]=t,this._onUpdate[s(380)]())}get[e(352)](){return!!this[e(366)]}[e(403)](){const t=e;if(!this[t(366)])return"";const s=(0,a.s)((0,l.Oq)(this[t(366)])-1,2),i=(0,a.s)((0,l.rY)(this._range)-1,2);return s+t(430)+i}getDetailedInfo(){const t=e;if(!this[t(366)])return"";const s=(0,a.s)((0,l.Oq)(this[t(366)])-1,2),i=(0,a.s)((0,l.rY)(this[t(366)])-1,2);return"Line is "+s+t(338)+i+t(347)}}class L extends x.q{constructor(){const t=e;super(...arguments),this[t(225)]=t(252)}set range(t){const s=e;this[s(366)]!==t&&(this[s(366)]=t,this[s(429)][s(380)]())}get visible(){return!!this[e(366)]}getInfo(){const t=this[e(223)]();return void 0===t?"":t.toString()}getDetailedInfo(){const t=e,s=this[t(223)]();return void 0===s?"":t(328)+s+" pixels long"}[e(223)](){const t=e;if(!this[t(366)])return;const s=(0,l.Oq)(this[t(366)])-1,i=(0,l.rY)(this[t(366)])-1,h=Math[t(313)](Math.pow(s,2)+Math.pow(i,2));return(0,a.s)(h,2)}}class b extends x.q{constructor(){const t=e;super(...arguments),this[t(225)]=t(412)}set[e(412)](t){const s=e;this[s(257)]!==t&&(this[s(257)]=t,this[s(429)].fire())}get visible(){return void 0!==this[e(257)]}getInfo(){const t=e;return void 0===this[t(257)]?"":this[t(257)]+"°"}getDetailedInfo(){const t=e;return void 0===this[t(257)]?"":"Line angle is "+this[t(257)]+"°"}}function S(){const t=e;return{point:{x:-1,y:-1},element:document[t(351)](t(320)),zone:(0,l.Pq)()}}class C extends r.JT{constructor(t,s,i,h){const n=e;super(),this[n(239)]=t,this[n(300)]=s,this[n(303)]=i,this._imageService=h,this[n(268)]=2,this[n(413)]=S(),this[n(436)]=S(),this[n(246)]=S(),this[n(231)]=S(),this[n(415)]=!0,this[n(346)]=document[n(351)]("div"),this[n(413)].element[n(284)].add(n(269)),this[n(436)].element.classList[n(235)](n(269)),this[n(246)][n(345)][n(284)][n(235)]("move-handle"),this._resizeStrokeB[n(345)].classList[n(235)]("move-handle"),this[n(346)].append(this._pointA[n(345)],this[n(436)][n(345)],this[n(246)][n(345)],this[n(231)][n(345)]),this[n(239)][n(394)](this[n(346)]),this[n(305)]({dispose:()=>{this._container.removeChild(this._elementContainer)}})}[e(270)](t){const s=e;t!==this[s(415)]&&(this[s(346)][s(294)].display=t?"":"none",this[s(415)]=t)}[e(362)](){const t=e;if(!this[t(300)][t(304)])return;const s=this[t(407)][t(228)];if(!s)return;const i=this[t(300)][t(304)][t(307)][t(242)],h=this[t(300)][t(304)][t(307)][t(420)],n=this[t(303)],r=Math.round(this._container.clientWidth/2)-s[t(216)]/2*n[t(416)],a=Math[t(285)](this._container[t(405)]/2)-s[t(443)]/2*n[t(416)];this[t(331)](this[t(413)],r+(n.x+i.x+.5)*n[t(416)],a+(n.y+i.y+.5)*n[t(416)]),this[t(331)](this[t(436)],r+(n.x+h.x+.5)*n[t(416)],a+(n.y+h.y+.5)*n[t(416)]);const c=(0,o.X)(this._pointA[t(365)].x,this._pointA[t(365)].y,this[t(436)][t(365)].x,this._pointB[t(365)].y,this[t(300)][t(304)][t(307)][t(330)],n[t(416)]);this[t(331)](this[t(246)],(c[1].x+c[2].x)/2,(c[1].y+c[2].y)/2),this[t(331)](this[t(231)],(c[3].x+c[0].x)/2,(c[3].y+c[0].y)/2)}[e(331)](t,s,i){const h=e,n=10*window[h(261)];t[h(365)].x=s,t[h(365)].y=i,t[h(437)][h(306)]=t[h(365)].x-n,t[h(437)][h(364)]=t[h(365)].x+n,t[h(437)][h(280)]=t[h(365)].y-n,t[h(437)][h(282)]=t[h(365)].y+n,t[h(345)][h(294)][h(306)]=t[h(365)].x+"px",t.element.style.top=t[h(365)].y+"px"}[e(220)](t,s,i){const h=e;if(!this._lineLayerOwner[h(304)])return h(301);if(k(this[h(413)][h(437)],t.offsetX,t[h(442)]))return h(314);if(k(this[h(436)][h(437)],t[h(356)],t[h(442)]))return h(215);if(this[h(413)]&&this[h(436)]){if(k(this[h(246)].zone,t[h(356)],t[h(442)])){const t=((0,u.AM)(this[h(413)].point.x,this[h(413)].point.y,this[h(436)][h(365)].x,this[h(436)][h(365)].y)+180)%180;return t<22.5?"resize-stroke-a-ns":t<67.5?h(409):t<112.5?h(423):t<157.5?"resize-stroke-a-nesw":h(244)}if(k(this._resizeStrokeB.zone,t[h(356)],t[h(442)])){const t=((0,u.AM)(this[h(413)][h(365)].x,this._pointA.point.y,this._pointB.point.x,this[h(436)][h(365)].y)+180)%180;return t<22.5?h(256):t<67.5?"resize-stroke-b-nwse":t<112.5?"resize-stroke-b-ew":t<157.5?h(321):"resize-stroke-b-ns"}}const n=(0,o.X)(this[h(413)].point.x,this[h(413)][h(365)].y,this[h(436)][h(365)].x,this[h(436)][h(365)].y,s,i),r=Math.round((0,u.hu)(n[0].x,n[0].y,n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y));return Math[h(285)](2*((0,u.ku)(n[0].x,n[0].y,n[1].x,n[1].y,t[h(356)],t[h(442)])+(0,u.ku)(n[1].x,n[1].y,n[2].x,n[2].y,t[h(356)],t.offsetY)+(0,u.ku)(n[2].x,n[2].y,n[3].x,n[3].y,t[h(356)],t[h(442)])+(0,u.ku)(n[3].x,n[3].y,n[0].x,n[0].y,t[h(356)],t[h(442)])))<=r?"move":h(301)}}function k(t,s,i){const h=e;return s>=t.left&&s<t[h(364)]&&i>=t.top&&i<t.bottom}},1019:(t,s,i)=>{i.d(s,{X:()=>n,j:()=>o});var e=i(8752),h=i(9455);function n(t,s,i,e,n,o){const r=(0,h.zz)(t,s,i,e),a=.5*o*n*Math.sin(r),c=.5*o*n*Math.cos(r);return[{x:t-a,y:s-c},{x:t+a,y:s+c},{x:i+a,y:e+c},{x:i-a,y:e-c}]}function o(t,s,i,e,h,n,o,d=1){o?function(t,s,i,e,h,n,o){const r=a15_0x5b1e;o<1&&(t=u(t,o));const a=Math[r(253)](h-i)>Math[r(253)](e-s);let d=0;a&&(d=s,s=i,i=d,d=e,e=h,h=d),s>e&&(d=s,s=e,e=d,d=i,i=h,h=d);const _=e-s;let y=(h-i)/_;0===_&&(y=1);let p=Math[r(285)](s),x=i+y*(p-s),f=l(s+.5);const v=p,g=Math.floor(x);let m=c(x)*f;a?(n(g,v,u(t,l(x)*f)),m>0&&n(g+1,v,u(t,m))):(n(v,g,u(t,l(x)*f)),m>0&&n(v,g+1,u(t,m)));let w=x+y;p=Math[r(285)](e),x=h+y*(p-e),f=c(e+.5);const M=p,L=Math.floor(x);if(m=c(x)*f,a?(n(L,M,u(t,l(x)*f)),m>0&&n(L+1,M,u(t,c(x)*f))):(n(M,L,u(t,l(x)*f)),m>0&&n(M,L+1,u(t,c(x)*f))),a)for(let s=v+1;s<M;s++)n(Math[r(397)](w),s,u(t,l(w))),m=c(w),m>0&&n(Math[r(397)](w)+1,s,u(t,m)),w+=y;else for(let s=v+1;s<M;s++)n(s,Math[r(397)](w),u(t,l(w))),m=c(w),m>0&&n(s,Math[r(397)](w)+1,u(t,m)),w+=y}(t,s,i,e,h,n,d):function(t,s,i,e,h,n,o){const c=a15_0x5b1e;o<1&&(t=u(t,o)),Math.abs(h-i)<Math[c(253)](e-s)?s>e?r(t,e,h,s,i,n):r(t,s,i,e,h,n):i>h?a(t,e,h,s,i,n):a(t,s,i,e,h,n)}(t,s,i,e,h,n,d)}function r(t,s,i,e,h,n){const o=e-s;let r=h-i,a=1;r<0&&(a=-1,r=-r);let c=2*r-o,l=i;for(let i=s;i<=e;i++)n(i,l,t),c>0?(l+=a,c+=2*(r-o)):c+=2*r}function a(t,s,i,e,h,n){let o=e-s;const r=h-i;let a=1;o<0&&(a=-1,o=-o);let c=2*o-r,l=s;for(let s=i;s<=h;s++)n(l,s,t),c>0?(l+=a,c+=2*(o-r)):c+=2*o}function c(t){return t%1}function l(t){return 1-t%1}function u(t,s){const i=a15_0x5b1e;if(void 0!==t)return e.m4[i(451)](t[0],t[1],t[2],Math[i(285)](t[3]*s))}},1674:(t,s,i)=>{const e=a15_0x10ba43;i.d(s,{q:()=>h});const h=e(318)},9455:(t,s,i)=>{function e(t,s,i,e){return 180*h(t,s,i,e)/Math.PI}function h(t,s,i,e){let h=-Math.atan2(e-s,i-t);return-180===h&&(h=180),h}function n(t){return t*Math.PI/180}function o(t,s,i,e,h,n){const o=a15_0x5b1e,r=Math[o(313)](Math[o(386)](t-i,2)+Math[o(386)](s-e,2)),a=Math[o(313)](Math.pow(i-h,2)+Math[o(386)](e-n,2)),c=Math.sqrt(Math[o(386)](h-t,2)+Math.pow(n-s,2)),l=(r+a+c)/2;return Math[o(313)](l*(l-r)*(l-a)*(l-c))}function r(t,s,i,e,h,n,r,a){return o(t,s,i,e,h,n)+o(i,e,h,n,r,a)+o(h,n,r,a,t,s)+o(r,a,t,s,i,e)}i.d(s,{AM:()=>e,zz:()=>h,Ht:()=>n,ku:()=>o,hu:()=>r})}}]);