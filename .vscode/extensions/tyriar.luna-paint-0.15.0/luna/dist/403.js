"use strict";const a17_0x2b38=["clientHeight","move-handle","round","register","_originalSelection","currentLayer","render","type","_cropToSelectionAction","_directionalMoveZones","5413yHYSYn","classList","_viewportService","style","ArrowDown","2PJAfGd","Crop to Selection","MoveImageRangeRenderer","359qfplXv","new","state","imageService","_imageService","getCoordsFromEvent","1625fZIIel","zoom","208499rWVbLm","_refreshActionEnabledState","appendChild","getPointerState","offsetY","_onUpdate","117PvJQzN","96966QCiAtL","pointerDown","display","fire","right","slice","_renderer","actions","_cursorCurrent","_allowNewState","topleft","_isVisible","left","includes","max","pointerMove","get","enabled","ArrowUp","_container","1dHeDNE","range","onStateChange","altKey","createElement","_onStateChange","name","11CgCUbZ","devicePixelRatio","bottomleft","offsetX","_directionalMoveElements","commit","89242OehHdf","setVisible","bottom","setTopLeft","createDomRenderProgram","ArrowRight","webpackChunkluna","pointerDownMove","key","selectionService","shiftKey","_getRange","_sc","setRange","moveSelection","bottomright","viewportService","selectAll","ctrlKey","set","4044urcbKU","topright","isSelectionTool","Move Selection","_cursorOrigin","metaKey","_elementContainer","event","onUpdate","2pobrak","move","width","clientWidth","423593lHLYsW","top","removeChild","_enabled","crop-to-selection"],a17_0x26db=function(t,e){return a17_0x2b38[t-=220]},a17_0xba3e9c=a17_0x26db;!function(t,e){const s=a17_0x26db;for(;;)try{if(431839===-parseInt(s(267))*parseInt(s(317))+-parseInt(s(310))*parseInt(s(252))+parseInt(s(248))*parseInt(s(323))+-parseInt(s(272))*parseInt(s(283))+parseInt(s(281))*parseInt(s(275))+parseInt(s(289))*parseInt(s(239))+parseInt(s(290)))break;t.push(t.shift())}catch(e){t.push(t.shift())}}(a17_0x2b38),(self.webpackChunkluna=self[a17_0xba3e9c(225)]||[]).push([[403,504],{6173:(t,e,s)=>{const i=a17_0xba3e9c;s.d(e,{f:()=>n});var o=s(1815),h=s(5120);class n extends h.JT{constructor(t,e,s){const i=a17_0x26db;super(),this[i(316)]=t,this[i(264)]=e,this._enabled=s,this._onUpdate=this[i(260)](new o.v),this[i(247)]=this[i(288)][i(246)]}get[i(307)](){return this[i(255)]}set[i(307)](t){const e=i;this[e(255)]!==t&&(this[e(255)]=t,this[e(288)][e(293)]())}}},504:(t,e,s)=>{const i=a17_0xba3e9c;s.r(e),s.d(e,{MoveImageRangeRenderer:()=>n});var o=s(5120),h=s(1003);class n extends o.JT{constructor(t,e,s,i,o){const n=a17_0x26db;super(),this[n(309)]=t,this[n(230)]=e,this._allowNewState=s,this._viewportService=i,this[n(279)]=o,this.order=2,this[n(321)]=new Map,this[n(266)]=new Map,this._isVisible=!0,this[n(245)]=document[n(314)]("div");const r=[n(300),n(240),n(319),n(234),n(253),"bottom",n(302),n(294)];for(const t of r){const e=document[n(314)]("div");e[n(268)].add(n(258),t),this[n(245)][n(285)](e),this[n(321)][n(238)](t,e),this[n(266)][n(238)](t,(0,h.Pq)())}this[n(309)][n(285)](this[n(245)]),this[n(260)]({dispose:()=>{const t=n;this[t(309)][t(254)](this[t(245)])}})}setVisible(t){const e=a17_0x26db;t!==this._isVisible&&(this[e(245)].style[e(292)]=t?"":"none",this[e(301)]=t)}[i(232)](t){}[i(263)](){const t=i,e=this[t(230)]();if(!e)return;const s=this[t(279)][t(262)];if(!s)return;const o=this[t(269)],h=Math[t(259)](this._container[t(251)]/2)-s.width/2*o.zoom,n=Math[t(259)](this[t(309)][t(257)]/2)-s.height/2*o.zoom,r=h+(o.x+e.left)*o[t(282)],a=n+(o.y+e[t(253)])*o[t(282)],c=h+(o.x+e[t(294)])*o[t(282)],l=n+(o.y+e[t(221)])*o[t(282)],p=Math.round((r+c)/2),d=Math.round((a+l)/2),f=10*window[t(318)],_={left:Math.min(r+f,Math[t(304)](r,p-f)),top:Math.min(a+f,Math[t(304)](a,d-f)),right:Math[t(304)](c-f,Math.min(c,p+f)),bottom:Math.max(l-f,Math.min(l,d+f))},b={left:r-f,top:a-f,right:c+f,bottom:l+f},g=this[t(266)][t(306)]("topleft");g[t(302)]=b[t(302)],g[t(294)]=_.left,g[t(253)]=b[t(253)],g[t(221)]=_.top;const m=this[t(321)][t(306)](t(300));m[t(270)].left=r+"px",m[t(270)].top=a+"px";const u=this[t(266)][t(306)]("topright");u[t(302)]=_[t(294)],u[t(294)]=b[t(294)],u[t(253)]=b[t(253)],u[t(221)]=_.top;const v=this[t(321)][t(306)](t(240));v[t(270)].left=c+"px",v.style.top=a+"px";const M=this[t(266)][t(306)](t(319));M[t(302)]=b[t(302)],M[t(294)]=_[t(302)],M[t(253)]=_[t(221)],M[t(221)]=b[t(221)];const x=this._directionalMoveElements[t(306)]("bottomleft");x[t(270)][t(302)]=r+"px",x.style[t(253)]=l+"px";const w=this[t(266)].get(t(234));w[t(302)]=_.right,w[t(294)]=b[t(294)],w[t(253)]=_[t(221)],w.bottom=b[t(221)];const S=this[t(321)][t(306)](t(234));S[t(270)][t(302)]=c+"px",S[t(270)][t(253)]=l+"px";const y=this[t(266)][t(306)](t(253));y.left=_[t(302)],y.right=_[t(294)],y.top=b[t(253)],y[t(221)]=_[t(253)];const I=this._directionalMoveElements[t(306)](t(253));I[t(270)].left=p+"px",I[t(270)][t(253)]=a+"px";const k=this._directionalMoveZones[t(306)](t(221));k[t(302)]=_[t(302)],k[t(294)]=_.right,k[t(253)]=_[t(221)],k[t(221)]=b.bottom;const C=this[t(321)].get("bottom");C[t(270)][t(302)]=p+"px",C.style[t(253)]=l+"px";const A=this[t(266)].get(t(302));A.left=b[t(302)],A[t(294)]=_.left,A.top=_[t(253)],A[t(221)]=_[t(221)];const R=this[t(321)][t(306)]("left");R[t(270)][t(302)]=r+"px",R[t(270)][t(253)]=d+"px";const L=this._directionalMoveZones.get(t(294));L[t(302)]=_[t(294)],L[t(294)]=b[t(294)],L[t(253)]=_.top,L.bottom=_[t(221)];const T=this[t(321)][t(306)](t(294));T[t(270)][t(302)]=c+"px",T.style[t(253)]=d+"px"}[i(286)](t){const e=i;if(!this[e(230)]())return this[e(299)]?"new":e(249);for(const[s,i]of this[e(266)])if((0,h.RB)(i,t[e(320)],t[e(287)]))return s;const s=this._directionalMoveZones[e(306)](e(300)),o=this[e(266)].get("bottomright"),n={left:s[e(302)],top:s.top,right:o[e(294)],bottom:o.bottom};return(0,h.RB)(n,t.offsetX,t[e(287)])?e(249):this[e(299)]?e(276):e(249)}}},403:(t,e,s)=>{const i=a17_0xba3e9c;s.r(e),s.d(e,{default:()=>d});var o=s(1815),h=s(7896),n=s(5120),r=s(1003),a=s(6173),c=s(504);const l=[i(308),"ArrowLeft",i(271),i(224)];class p extends n.JT{constructor(t){const e=i;super(),this[e(231)]=t,this.id=e(233),this[e(241)]=!0,this[e(277)]=e(249),this._cropToSelectionAction=new a.f(e(273),e(256),!1),this[e(297)]=[this[e(265)]],this._onStateChange=this.register(new o.v),this[e(312)]=this[e(315)][e(246)],this[e(260)](this[e(231)][e(228)][e(247)]((()=>this._refreshActionEnabledState()))),this[e(284)]()}[i(291)](t){const e=i;!this[e(231)][e(228)][e(311)]&&this._sc[e(278)][e(236)](),this._cursorOrigin=this[e(231)][e(235)][e(280)](t),this[e(298)]=this[e(243)][e(295)](),this._originalSelection=this[e(231)][e(228)][e(311)],this[e(277)]===e(276)||this[e(261)]&&((this[e(277)]===e(253)||"topleft"===this[e(277)]||this.state===e(240))&&(this[e(243)][1]=this[e(261)][e(253)]),(this[e(277)]===e(221)||this[e(277)]===e(319)||"bottomright"===this[e(277)])&&(this[e(243)][1]=this[e(261)][e(221)]-1),(this[e(277)]===e(302)||this[e(277)]===e(300)||this[e(277)]===e(319))&&(this[e(243)][0]=this[e(261)][e(302)]),(this[e(277)]===e(294)||this[e(277)]===e(240)||"bottomright"===this[e(277)])&&(this[e(243)][0]=this[e(261)][e(294)]-1))}pointerUp(t){const e=i;this[e(231)].selectionService[e(311)]&&this[e(231)][e(228)][e(322)](e(242),e(233))}[i(305)](t,e){const s=i;if(this._renderer&&!e){const e=this[s(296)][s(286)](t);this[s(277)]!==e&&(this[s(277)]=e,this[s(315)][s(293)]())}}[i(226)](t){const e=i;if(!this._sc.selectionService[e(311)]||!this[e(243)]||!this[e(261)])return;this[e(298)]=this[e(231)][e(235)][e(280)](t);const s=this[e(298)][0]-this[e(243)][0],o=this[e(298)][1]-this[e(243)][1];if(this.state===e(249))return void this._sc.selectionService.setTopLeft(this._originalSelection.left+s,this[e(261)][e(253)]+o);let h;if(!t[e(229)]||"topleft"!==this[e(277)]&&"topright"!==this.state&&"bottomleft"!==this[e(277)]&&this[e(277)]!==e(234))h=(0,r.BN)(this[e(261)]),(this[e(277)]===e(253)||this[e(277)]===e(300)||this[e(277)]===e(240))&&(h[e(253)]+=o,h[e(221)]<=h[e(253)]&&h[e(253)]++,t.altKey&&(h.bottom-=o)),(this[e(277)]===e(221)||this[e(277)]===e(319)||this[e(277)]===e(234))&&(h[e(221)]+=o,h[e(221)]<=h.top&&h[e(221)]--,t[e(313)]&&(h.top-=o)),("left"===this.state||this[e(277)]===e(300)||"bottomleft"===this[e(277)])&&(h[e(302)]+=s,h[e(294)]<=h[e(302)]&&h[e(302)]++,t[e(313)]&&(h[e(294)]-=s)),(this.state===e(294)||"topright"===this[e(277)]||"bottomright"===this.state)&&(h[e(294)]+=s,h[e(294)]<=h[e(302)]&&h[e(294)]--,t[e(313)]&&(h[e(302)]-=s));else{const i=(0,r.n3)(this[e(261)]);let n;switch(h=(0,r.BN)(this[e(261)]),this[e(277)]){case e(300):n=(1/i*-s-o)/2,h[e(302)]-=Math[e(259)](n*i),h.top-=Math[e(259)](n),t.altKey&&(h.right+=Math[e(259)](n*i),h[e(221)]+=Math[e(259)](n));break;case"topright":n=(s*(1/i)-o)/2,h[e(294)]+=Math[e(259)](n*i),h[e(253)]-=Math.round(n),t.altKey&&(h.left-=Math[e(259)](n*i),h[e(221)]+=Math[e(259)](n));break;case e(319):n=(1/i*-s+o)/2,h[e(302)]-=Math[e(259)](n*i),h[e(221)]+=Math[e(259)](n),t[e(313)]&&(h[e(294)]+=Math.round(n*i),h.top-=Math.round(n));break;case"bottomright":n=(s*(1/i)+o)/2,h[e(294)]+=Math[e(259)](n*i),h[e(221)]+=Math[e(259)](n),t[e(313)]&&(h[e(302)]-=Math.round(n*i),h.top-=Math.round(n))}}this[e(231)][e(228)][e(311)]=(0,r.FJ)(h)}keyDown(t){const e=i;if(!this._sc[e(278)])return;if(!l[e(303)](t[e(227)]))return;const s=this[e(231)][e(228)].range||this[e(231)][e(278)][e(236)](),o=(h.V5?t[e(244)]:t[e(237)])?10:1;switch(t.key){case e(308):this[e(231)][e(228)][e(222)](s[e(302)],s[e(253)]-o);break;case e(271):this[e(231)][e(228)].setTopLeft(s[e(302)],s.top+o);break;case"ArrowLeft":this[e(231)].selectionService[e(222)](s[e(302)]-o,s.top);break;case e(224):this[e(231)][e(228)][e(222)](s[e(302)]+o,s[e(253)])}}[i(284)](){const t=i,e=this[t(231)][t(228)][t(311)];this._cropToSelectionAction[t(307)]=!(!e||0===e[t(302)]&&0===e[t(253)]&&e.right===this._sc[t(278)][t(250)]&&e[t(221)]===this[t(231)][t(278)].height)}[i(223)](t){const e=i,s=new(c[e(274)])(t,(()=>this._sc[e(228)].range),!1,this[e(231)][e(235)],this[e(231)][e(278)]);return this[e(231)][e(228)][e(247)]((()=>s[e(220)](void 0!==this[e(231)].selectionService[e(311)]))),s[e(220)](void 0!==this[e(231)][e(228)].range),this[e(296)]=s,this[e(296)]}}const d=p}}]);