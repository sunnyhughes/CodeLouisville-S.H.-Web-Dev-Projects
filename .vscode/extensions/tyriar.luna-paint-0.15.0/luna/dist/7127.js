"use strict";const a24_0x4de0=['Unsupported color map bit depth "',"depth",'" is invalid',"extensionArea","bitDepth",'" is greater than color map length "',"TRUEVISION-XFILE.","trim","developerDirectoryOffset","EOF while reading text",'Invalid image type "',"getUint16","_le","1419271gsnjVD","ambiguousAlpha","byteLength","length",'Color map origin "',"message","header","readUint32",'" cannot have a color map',"options","15CARVEy","Color map type unrecognized","strictMode","offset","height",'Image type "',"byteOffset","developerDirectory","idLength","imageType","ceil","reader",'Unsupported TGA bit depth "',"readUint16","detectAmbiguousAlphaChannel",'" with image type ',"view",'Extension area offset "',"hasAlpha","webpackChunkluna","extensionAreaOffset","getUint8","fromCharCode","data","290065aZwyPl","65740ISLNKV","858066pRViVP",'Developer directory offset "',"identificationField","width","Image has ambiguous alpha and is fully transparent, alpha has been disabled","893001WxfKWa","76441whoMra","image","readUint8","type","436660ktgtPa","footer","colorMap","decode"],a24_0x13b0=function(e,t){return a24_0x4de0[e-=190]},a24_0x463f10=a24_0x13b0;!function(e,t){const r=a24_0x13b0;for(;;)try{if(968576===parseInt(r(218))+parseInt(r(235))+-parseInt(r(208))+parseInt(r(213))+-parseInt(r(207))+parseInt(r(206))+parseInt(r(214))*-parseInt(r(245)))break;e.push(e.shift())}catch(t){e.push(e.shift())}}(a24_0x4de0),(self[a24_0x463f10(201)]=self.webpackChunkluna||[]).push([[7127],{7127:(e,t,r)=>{const n=a24_0x463f10;r.r(t),r.d(t,{decodeTga:()=>s});var i=r(8984);class o{constructor(e,t){const r=a24_0x13b0;this.data=e,this[r(234)]=t,this[r(248)]=0,this[r(198)]=new DataView(e.buffer,e.byteOffset,e[r(237)])}[n(216)](){const e=n;return this[e(198)][e(203)](this[e(248)]++)}readUint16(){const e=n,t=this[e(198)][e(233)](this[e(248)],this[e(234)]);return this[e(248)]+=2,t}[n(242)](){const e=n,t=this.view.getUint32(this[e(248)],this[e(234)]);return this.offset+=4,t}}function a(e,t,r,o){const a=n,s=[];let d=0,f=0;const c=e[a(193)][a(248)];for(;f<r;f++){try{d=e[a(193)].view[a(203)](e.reader[a(248)])}catch(t){throw t instanceof Error&&"Offset is outside the bounds of the DataView"===t[a(240)]&&(0,i.pP)(e,new i.b4(a(231),e[a(193)][a(248)])),t}if(!o&&0===d)break;e[a(193)][a(248)]++,s.push(d)}return e[a(193)].offset=c+r,t?t[a(221)](new Uint8Array(s)):String[a(204)](...s)}async function s(e,t={}){const r=n;var s,c;const v={reader:new o(e,!0),hasAlpha:!1,ambiguousAlpha:!1,options:t,warnings:[]},w=function(e){const t=n,r=e[t(193)][t(216)](),o=e[t(193)].readUint8();let a;0===o||1===o?a=o:((0,i.pP)(e,new i.b4(t(246),e.reader[t(248)]-1)),a=2);const s=e[t(193)][t(216)]();if(1!==(d=s)&&2!==d&&3!==d&&9!==d&&10!==d&&11!==d)throw new i._9(e,t(232)+s+'"',e[t(193)][t(248)]-1);var d;1===a&&1!==s&&9!==s&&(0,i.pP)(e,new i.b4(t(250)+s+t(243),e[t(193)][t(248)]-2));const f=e[t(193)].readUint16(),c=e[t(193)][t(195)](),h=e[t(193)][t(216)]();if(1===a&&(f>=c&&(0,i.pP)(e,new i.b4(t(239)+f+t(227)+c+'"',e.reader.offset-5)),15!==(l=h)&&16!==l&&24!==l&&32!==l))throw new i._9(e,t(222)+h+'"',e[t(193)].offset-1);var l;const u=e[t(193)][t(195)](),p=e[t(193)][t(195)](),g=e[t(193)][t(195)](),v=e.reader[t(195)](),w=e[t(193)][t(216)]();if(b=w,!(1===(m=s)||9===m?8===b:3===m||11===m?8===b||16===b:15===b||16===b||24===b||32===b))throw new i._9(e,t(194)+w+t(197)+s,16);var b,m;const y=e.reader[t(216)]();return{idLength:r,colorMap:0!==a?{type:a,depth:h,length:c,origin:f}:void 0,imageType:s,origin:{x:u,y:p},width:g,height:v,bitDepth:w,imageDescriptor:y,attributeBitsPerPixel:(15&y)>>0,screenOrigin:(48&y)>>4}}(v),b={...v,header:w};b.identificationField=a(b,void 0,b[r(241)][r(190)]);const m=b[r(193)][r(248)];return b[r(219)]=function(e){const t=n;if(e[t(193)][t(248)]=e[t(193)].view[t(237)]-26+8,a(e,void 0,17)!==t(228)||0!==e.reader.readUint8())return{extensionAreaOffset:0,developerDirectoryOffset:0};e.reader[t(248)]=e[t(193)][t(198)].byteLength-26;let r=e[t(193)][t(242)]();r>=e.reader.view[t(237)]&&((0,i.pP)(e,new i.b4(t(199)+r+t(224),e[t(193)][t(248)]-4)),r=0);let o=e[t(193)].readUint32();return o>=e[t(193)][t(198)][t(237)]&&((0,i.pP)(e,new i.b4(t(209)+o+'" is invalid',e[t(193)].offset-4)),o=0),{extensionAreaOffset:r,developerDirectoryOffset:o}}(b),b[r(225)]=function(e){const t=n;var r;if(void 0===(null===(r=e.footer)||void 0===r?void 0:r.extensionAreaOffset)||0===e[t(219)][t(202)])return;e.reader[t(248)]=e[t(219)][t(202)];const o=e[t(193)][t(195)]();495!==o&&(0,i.pP)(e,new i.b4("TGA file is a version other than v2",e[t(193)][t(248)]-2));const s=a(e,void 0,41).trim()||void 0,d=a(e,void 0,324)[t(229)]()||void 0,f=function(e){const t=n,r=e[t(193)][t(195)](),i=e[t(193)][t(195)](),o=e[t(193)][t(195)](),a=e[t(193)][t(195)](),s=e[t(193)].readUint16(),d=e[t(193)][t(195)]();return 0===r&&0===i&&0===o&&0===a&&0===s&&0===d?void 0:new Date(o,r,i,a,s,d)}(e),c=a(e,void 0,41)[t(229)]()||void 0,h=function(e){const t=n,r=e[t(193)][t(195)](),i=e[t(193)][t(195)](),o=e[t(193)][t(195)]();return 0===r&&0===i&&0===o?void 0:{hours:r,minutes:i,seconds:o}}(e),l=a(e,void 0,41).trim()||void 0,u=e.reader[t(216)]()/100,p=a(e,void 0,2);let g;g=0!==u||" "!==p&&0!==p[t(238)]?""+u+p:void 0;const v=e[t(193)][t(216)](),w=e[t(193)][t(216)](),b=e[t(193)][t(216)](),m=e[t(193)][t(216)]();let y;y=0===v&&0===w&&0===b&&0===m?void 0:new Uint8Array([w,b,m,v]);const U=e.reader[t(195)](),x=e[t(193)].readUint16();let A;A=0===x?void 0:U/x;const O=e[t(193)][t(195)](),I=e[t(193)][t(195)]();let P;P=0===I?void 0:O/I;return{extensionSize:o,authorName:s,authorComments:d,dateTimestamp:f,jobName:c,jobTime:h,softwareId:l,softwareVersion:g,keyColor:y,aspectRatio:A,gamma:P,colorCorrectionOffset:e[t(193)][t(242)](),postageStampOffset:e[t(193)][t(242)](),scanLineOffset:e[t(193)].readUint32(),attributesType:e.reader[t(216)]()}}(b),b[r(252)]=function(e){const t=n;var r;if(void 0===(null===(r=e[t(219)])||void 0===r?void 0:r.developerDirectoryOffset)||0===e[t(219)][t(230)])return[];e.reader[t(248)]=e[t(219)][t(230)];const i=e.reader[t(195)](),o=[];for(let r=0;r<i;r++){const r=e[t(193)].readUint16(),n=e.reader.readUint32(),i=e[t(193)][t(242)]();o.push({tag:r,offset:n,length:i})}return o}(b),b[r(193)][r(248)]=m,1===(null===(s=b[r(241)].colorMap)||void 0===s?void 0:s[r(217)])&&(b[r(220)]=function(e,t){const r=n,i=e[r(193)].offset,o=Math[r(192)](t[r(223)]/8);let a;switch(e.reader[r(248)]+=t[r(238)]*o,t[r(223)]){case 15:a=h;break;case 16:a=e[r(200)]?l:h;break;case 24:a=u;break;case 32:a=p}return(t,n,s,d)=>{const f=r,c=s[f(203)](d);return a(t,n,e[f(193)][f(198)],i+c*o),1}}(b,b[r(241)].colorMap)),b.hasAlpha=b[r(220)]&&32===(null===(c=b[r(241)][r(220)])||void 0===c?void 0:c.depth)||(b[r(241)].attributeBitsPerPixel>0||32===b[r(241)][r(226)])&&(void 0===b[r(225)]||b[r(225)].attributesType>2),b[r(236)]=b.hasAlpha&&0===b.header.attributeBitsPerPixel,b[r(215)]=function(e,t){const r=n,o={width:e[r(241)].width,height:e[r(241)].height,data:new Uint8Array(e[r(241)][r(211)]*e[r(241)][r(249)]*4)};let a;if(e.colorMap)a=e.colorMap;else switch(e[r(241)][r(226)]){case 8:a=d;break;case 15:a=h;break;case 16:a=11===e[r(241)][r(191)]||3===e[r(241)][r(191)]?f:e[r(200)]?l:h;break;case 24:a=u;break;case 32:a=e[r(200)]?p:g}let s=e[r(193)][r(198)];if(8&e[r(241)][r(191)]){const i=function(e){const t=n,r=Math.ceil(e[t(241)][t(226)]/8),i=new Uint8Array(e.header[t(211)]*e[t(241)][t(249)]*r);let o=0,a=0,s=0,d=0,f=0;for(;s<i.length-1;)if(o=e[t(193)][t(216)](),a=1+(127&o),128&o){for(d=0;d<r;d++)for(o=e[t(193)][t(216)](),f=0;f<a;f++)i[s+f*r+d]=o;s+=a*r}else{a*=r;for(let r=0;r<a;r++)i[s++]=e[t(193)][t(216)]()}return i}(e);s=new DataView(i.buffer,i[r(251)],i[r(238)]),t=0}if(2===e[r(241)].screenOrigin){let e=0;for(let n=0;n<o.height;n++)for(let n=0;n<o[r(211)];n++)t+=a(o[r(205)],e,s,t),e+=4}else{let n=0;for(let i=o[r(249)]-1;i>=0;i--){n=e[r(241)].width*i*4;for(let e=0;e<o[r(211)];e++)t+=a(o[r(205)],n,s,t),n+=4}}if(e.ambiguousAlpha&&!e[r(244)][r(247)]&&e[r(244)][r(196)]){let t=!1;for(let e=3;e<o[r(211)]*o[r(249)]*4;e+=4)o[r(205)][e]>0&&(t=!0);if(!t){(0,i.pP)(e,new i.b4(r(212),-1));for(let e=3;e<o[r(211)]*o[r(249)]*4;e+=4)o[r(205)][e]=255}}return o}(b,b.reader[r(248)]),{image:b[r(215)],details:{header:b.header,imageId:b[r(210)],footer:b[r(219)],extensionArea:b[r(225)],developerDirectory:b[r(252)]},warnings:b.warnings}}function d(e,t,r,i){const o=n;return e[t]=r[o(203)](i),e[t+1]=e[t],e[t+2]=e[t],e[t+3]=255,1}function f(e,t,r,i){const o=n;return e[t]=r[o(203)](i),e[t+1]=e[t],e[t+2]=e[t],e[t+3]=r[o(203)](i+1),2}let c=0;function h(e,t,r,i){return c=r[n(233)](i,!0),e[t]=c>>10&31,e[t+1]=c>>5&31,e[t+2]=31&c,e[t]=e[t]<<3|e[t]>>2,e[t+1]=e[t+1]<<3|e[t+1]>>2,e[t+2]=e[t+2]<<3|e[t+2]>>2,e[t+3]=255,2}function l(e,t,r,n){return c=r.getUint16(n,!0),e[t]=c>>10&31,e[t+1]=c>>5&31,e[t+2]=31&c,e[t]=e[t]<<3|e[t]>>2,e[t+1]=e[t+1]<<3|e[t+1]>>2,e[t+2]=e[t+2]<<3|e[t+2]>>2,e[t+3]=32768&c?0:255,2}function u(e,t,r,i){const o=n;return e[t]=r.getUint8(i+2),e[t+1]=r.getUint8(i+1),e[t+2]=r[o(203)](i),e[t+3]=255,3}function p(e,t,r,i){const o=n;return e[t]=r[o(203)](i+2),e[t+1]=r[o(203)](i+1),e[t+2]=r.getUint8(i),e[t+3]=r[o(203)](i+3),4}function g(e,t,r,i){const o=n;return e[t]=r[o(203)](i+2),e[t+1]=r[o(203)](i+1),e[t+2]=r[o(203)](i),e[t+3]=255,4}}}]);